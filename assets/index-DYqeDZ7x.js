(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function i(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=i(o);fetch(o.href,u)}})();var pd={exports:{}},gl={};var yy;function Sw(){if(yy)return gl;yy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(r,o,u){var h=null;if(u!==void 0&&(h=""+u),o.key!==void 0&&(h=""+o.key),"key"in o){u={};for(var m in o)m!=="key"&&(u[m]=o[m])}else u=o;return o=u.ref,{$$typeof:t,type:r,key:h,ref:o!==void 0?o:null,props:u}}return gl.Fragment=e,gl.jsx=i,gl.jsxs=i,gl}var Ty;function Rw(){return Ty||(Ty=1,pd.exports=Sw()),pd.exports}var C=Rw(),gd={exports:{}},yl={},yd={exports:{}},Td={};var Ey;function Iw(){return Ey||(Ey=1,(function(t){function e(K,re){var ye=K.length;K.push(re);e:for(;0<ye;){var je=ye-1>>>1,Je=K[je];if(0<o(Je,re))K[je]=re,K[ye]=Je,ye=je;else break e}}function i(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var re=K[0],ye=K.pop();if(ye!==re){K[0]=ye;e:for(var je=0,Je=K.length,L=Je>>>1;je<L;){var te=2*(je+1)-1,se=K[te],fe=te+1,be=K[fe];if(0>o(se,ye))fe<Je&&0>o(be,se)?(K[je]=be,K[fe]=ye,je=fe):(K[je]=se,K[te]=ye,je=te);else if(fe<Je&&0>o(be,ye))K[je]=be,K[fe]=ye,je=fe;else break e}}return re}function o(K,re){var ye=K.sortIndex-re.sortIndex;return ye!==0?ye:K.id-re.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;t.unstable_now=function(){return u.now()}}else{var h=Date,m=h.now();t.unstable_now=function(){return h.now()-m}}var _=[],p=[],y=1,v=null,w=3,S=!1,x=!1,V=!1,H=!1,Q=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,le=typeof setImmediate<"u"?setImmediate:null;function ce(K){for(var re=i(p);re!==null;){if(re.callback===null)r(p);else if(re.startTime<=K)r(p),re.sortIndex=re.expirationTime,e(_,re);else break;re=i(p)}}function ot(K){if(V=!1,ce(K),!x)if(i(_)!==null)x=!0,ze||(ze=!0,U());else{var re=i(p);re!==null&&Bt(ot,re.startTime-K)}}var ze=!1,O=-1,R=5,D=-1;function P(){return H?!0:!(t.unstable_now()-D<R)}function M(){if(H=!1,ze){var K=t.unstable_now();D=K;var re=!0;try{e:{x=!1,V&&(V=!1,$(O),O=-1),S=!0;var ye=w;try{t:{for(ce(K),v=i(_);v!==null&&!(v.expirationTime>K&&P());){var je=v.callback;if(typeof je=="function"){v.callback=null,w=v.priorityLevel;var Je=je(v.expirationTime<=K);if(K=t.unstable_now(),typeof Je=="function"){v.callback=Je,ce(K),re=!0;break t}v===i(_)&&r(_),ce(K)}else r(_);v=i(_)}if(v!==null)re=!0;else{var L=i(p);L!==null&&Bt(ot,L.startTime-K),re=!1}}break e}finally{v=null,w=ye,S=!1}re=void 0}}finally{re?U():ze=!1}}}var U;if(typeof le=="function")U=function(){le(M)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,_t=I.port2;I.port1.onmessage=M,U=function(){_t.postMessage(null)}}else U=function(){Q(M,0)};function Bt(K,re){O=Q(function(){K(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_next=function(K){switch(w){case 1:case 2:case 3:var re=3;break;default:re=w}var ye=w;w=re;try{return K()}finally{w=ye}},t.unstable_requestPaint=function(){H=!0},t.unstable_runWithPriority=function(K,re){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ye=w;w=K;try{return re()}finally{w=ye}},t.unstable_scheduleCallback=function(K,re,ye){var je=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?je+ye:je):ye=je,K){case 1:var Je=-1;break;case 2:Je=250;break;case 5:Je=1073741823;break;case 4:Je=1e4;break;default:Je=5e3}return Je=ye+Je,K={id:y++,callback:re,priorityLevel:K,startTime:ye,expirationTime:Je,sortIndex:-1},ye>je?(K.sortIndex=ye,e(p,K),i(_)===null&&K===i(p)&&(V?($(O),O=-1):V=!0,Bt(ot,ye-je))):(K.sortIndex=Je,e(_,K),x||S||(x=!0,ze||(ze=!0,U()))),K},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(K){var re=w;return function(){var ye=w;w=re;try{return K.apply(this,arguments)}finally{w=ye}}}})(Td)),Td}var vy;function kw(){return vy||(vy=1,yd.exports=Iw()),yd.exports}var Ed={exports:{}},Se={};var wy;function Ow(){if(wy)return Se;wy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),w=Symbol.iterator;function S(L){return L===null||typeof L!="object"?null:(L=w&&L[w]||L["@@iterator"],typeof L=="function"?L:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,H={};function Q(L,te,se){this.props=L,this.context=te,this.refs=H,this.updater=se||x}Q.prototype.isReactComponent={},Q.prototype.setState=function(L,te){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,te,"setState")},Q.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function $(){}$.prototype=Q.prototype;function le(L,te,se){this.props=L,this.context=te,this.refs=H,this.updater=se||x}var ce=le.prototype=new $;ce.constructor=le,V(ce,Q.prototype),ce.isPureReactComponent=!0;var ot=Array.isArray;function ze(){}var O={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function D(L,te,se){var fe=se.ref;return{$$typeof:t,type:L,key:te,ref:fe!==void 0?fe:null,props:se}}function P(L,te){return D(L.type,te,L.props)}function M(L){return typeof L=="object"&&L!==null&&L.$$typeof===t}function U(L){var te={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(se){return te[se]})}var I=/\/+/g;function _t(L,te){return typeof L=="object"&&L!==null&&L.key!=null?U(""+L.key):te.toString(36)}function Bt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(ze,ze):(L.status="pending",L.then(function(te){L.status==="pending"&&(L.status="fulfilled",L.value=te)},function(te){L.status==="pending"&&(L.status="rejected",L.reason=te)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function K(L,te,se,fe,be){var Ne=typeof L;(Ne==="undefined"||Ne==="boolean")&&(L=null);var Be=!1;if(L===null)Be=!0;else switch(Ne){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(L.$$typeof){case t:case e:Be=!0;break;case y:return Be=L._init,K(Be(L._payload),te,se,fe,be)}}if(Be)return be=be(L),Be=fe===""?"."+_t(L,0):fe,ot(be)?(se="",Be!=null&&(se=Be.replace(I,"$&/")+"/"),K(be,te,se,"",function(ur){return ur})):be!=null&&(M(be)&&(be=P(be,se+(be.key==null||L&&L.key===be.key?"":(""+be.key).replace(I,"$&/")+"/")+Be)),te.push(be)),1;Be=0;var Gt=fe===""?".":fe+":";if(ot(L))for(var pt=0;pt<L.length;pt++)fe=L[pt],Ne=Gt+_t(fe,pt),Be+=K(fe,te,se,Ne,be);else if(pt=S(L),typeof pt=="function")for(L=pt.call(L),pt=0;!(fe=L.next()).done;)fe=fe.value,Ne=Gt+_t(fe,pt++),Be+=K(fe,te,se,Ne,be);else if(Ne==="object"){if(typeof L.then=="function")return K(Bt(L),te,se,fe,be);throw te=String(L),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Be}function re(L,te,se){if(L==null)return L;var fe=[],be=0;return K(L,fe,"","",function(Ne){return te.call(se,Ne,be++)}),fe}function ye(L){if(L._status===-1){var te=L._result;te=te(),te.then(function(se){(L._status===0||L._status===-1)&&(L._status=1,L._result=se)},function(se){(L._status===0||L._status===-1)&&(L._status=2,L._result=se)}),L._status===-1&&(L._status=0,L._result=te)}if(L._status===1)return L._result.default;throw L._result}var je=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},Je={map:re,forEach:function(L,te,se){re(L,function(){te.apply(this,arguments)},se)},count:function(L){var te=0;return re(L,function(){te++}),te},toArray:function(L){return re(L,function(te){return te})||[]},only:function(L){if(!M(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Se.Activity=v,Se.Children=Je,Se.Component=Q,Se.Fragment=i,Se.Profiler=o,Se.PureComponent=le,Se.StrictMode=r,Se.Suspense=_,Se.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Se.__COMPILER_RUNTIME={__proto__:null,c:function(L){return O.H.useMemoCache(L)}},Se.cache=function(L){return function(){return L.apply(null,arguments)}},Se.cacheSignal=function(){return null},Se.cloneElement=function(L,te,se){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var fe=V({},L.props),be=L.key;if(te!=null)for(Ne in te.key!==void 0&&(be=""+te.key),te)!R.call(te,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&te.ref===void 0||(fe[Ne]=te[Ne]);var Ne=arguments.length-2;if(Ne===1)fe.children=se;else if(1<Ne){for(var Be=Array(Ne),Gt=0;Gt<Ne;Gt++)Be[Gt]=arguments[Gt+2];fe.children=Be}return D(L.type,be,fe)},Se.createContext=function(L){return L={$$typeof:h,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Se.createElement=function(L,te,se){var fe,be={},Ne=null;if(te!=null)for(fe in te.key!==void 0&&(Ne=""+te.key),te)R.call(te,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(be[fe]=te[fe]);var Be=arguments.length-2;if(Be===1)be.children=se;else if(1<Be){for(var Gt=Array(Be),pt=0;pt<Be;pt++)Gt[pt]=arguments[pt+2];be.children=Gt}if(L&&L.defaultProps)for(fe in Be=L.defaultProps,Be)be[fe]===void 0&&(be[fe]=Be[fe]);return D(L,Ne,be)},Se.createRef=function(){return{current:null}},Se.forwardRef=function(L){return{$$typeof:m,render:L}},Se.isValidElement=M,Se.lazy=function(L){return{$$typeof:y,_payload:{_status:-1,_result:L},_init:ye}},Se.memo=function(L,te){return{$$typeof:p,type:L,compare:te===void 0?null:te}},Se.startTransition=function(L){var te=O.T,se={};O.T=se;try{var fe=L(),be=O.S;be!==null&&be(se,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(ze,je)}catch(Ne){je(Ne)}finally{te!==null&&se.types!==null&&(te.types=se.types),O.T=te}},Se.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Se.use=function(L){return O.H.use(L)},Se.useActionState=function(L,te,se){return O.H.useActionState(L,te,se)},Se.useCallback=function(L,te){return O.H.useCallback(L,te)},Se.useContext=function(L){return O.H.useContext(L)},Se.useDebugValue=function(){},Se.useDeferredValue=function(L,te){return O.H.useDeferredValue(L,te)},Se.useEffect=function(L,te){return O.H.useEffect(L,te)},Se.useEffectEvent=function(L){return O.H.useEffectEvent(L)},Se.useId=function(){return O.H.useId()},Se.useImperativeHandle=function(L,te,se){return O.H.useImperativeHandle(L,te,se)},Se.useInsertionEffect=function(L,te){return O.H.useInsertionEffect(L,te)},Se.useLayoutEffect=function(L,te){return O.H.useLayoutEffect(L,te)},Se.useMemo=function(L,te){return O.H.useMemo(L,te)},Se.useOptimistic=function(L,te){return O.H.useOptimistic(L,te)},Se.useReducer=function(L,te,se){return O.H.useReducer(L,te,se)},Se.useRef=function(L){return O.H.useRef(L)},Se.useState=function(L){return O.H.useState(L)},Se.useSyncExternalStore=function(L,te,se){return O.H.useSyncExternalStore(L,te,se)},Se.useTransition=function(){return O.H.useTransition()},Se.version="19.2.4",Se}var by;function om(){return by||(by=1,Ed.exports=Ow()),Ed.exports}var vd={exports:{}},hn={};var Ay;function Dw(){if(Ay)return hn;Ay=1;var t=om();function e(_){var p="https://react.dev/errors/"+_;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+_+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var r={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(_,p,y){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:_,containerInfo:p,implementation:y}}var h=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(_,p){if(_==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,hn.createPortal=function(_,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(_,p,null,y)},hn.flushSync=function(_){var p=h.T,y=r.p;try{if(h.T=null,r.p=2,_)return _()}finally{h.T=p,r.p=y,r.d.f()}},hn.preconnect=function(_,p){typeof _=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(_,p))},hn.prefetchDNS=function(_){typeof _=="string"&&r.d.D(_)},hn.preinit=function(_,p){if(typeof _=="string"&&p&&typeof p.as=="string"){var y=p.as,v=m(y,p.crossOrigin),w=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;y==="style"?r.d.S(_,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:w,fetchPriority:S}):y==="script"&&r.d.X(_,{crossOrigin:v,integrity:w,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},hn.preinitModule=function(_,p){if(typeof _=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var y=m(p.as,p.crossOrigin);r.d.M(_,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(_)},hn.preload=function(_,p){if(typeof _=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var y=p.as,v=m(y,p.crossOrigin);r.d.L(_,y,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},hn.preloadModule=function(_,p){if(typeof _=="string")if(p){var y=m(p.as,p.crossOrigin);r.d.m(_,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(_)},hn.requestFormReset=function(_){r.d.r(_)},hn.unstable_batchedUpdates=function(_,p){return _(p)},hn.useFormState=function(_,p,y){return h.H.useFormState(_,p,y)},hn.useFormStatus=function(){return h.H.useHostTransitionStatus()},hn.version="19.2.4",hn}var Sy;function Nw(){if(Sy)return vd.exports;Sy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),vd.exports=Dw(),vd.exports}var Ry;function Cw(){if(Ry)return yl;Ry=1;var t=kw(),e=om(),i=Nw();function r(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)a+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var a=n,s=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(s=a.return),n=a.return;while(n)}return a.tag===3?s:null}function h(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function m(n){if(n.tag===31){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function _(n){if(u(n)!==n)throw Error(r(188))}function p(n){var a=n.alternate;if(!a){if(a=u(n),a===null)throw Error(r(188));return a!==n?null:n}for(var s=n,l=a;;){var f=s.return;if(f===null)break;var d=f.alternate;if(d===null){if(l=f.return,l!==null){s=l;continue}break}if(f.child===d.child){for(d=f.child;d;){if(d===s)return _(f),n;if(d===l)return _(f),a;d=d.sibling}throw Error(r(188))}if(s.return!==l.return)s=f,l=d;else{for(var T=!1,b=f.child;b;){if(b===s){T=!0,s=f,l=d;break}if(b===l){T=!0,l=f,s=d;break}b=b.sibling}if(!T){for(b=d.child;b;){if(b===s){T=!0,s=d,l=f;break}if(b===l){T=!0,l=d,s=f;break}b=b.sibling}if(!T)throw Error(r(189))}}if(s.alternate!==l)throw Error(r(190))}if(s.tag!==3)throw Error(r(188));return s.stateNode.current===s?n:a}function y(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=y(n),a!==null)return a;n=n.sibling}return null}var v=Object.assign,w=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),le=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),ot=Symbol.for("react.suspense"),ze=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function U(n){return n===null||typeof n!="object"?null:(n=M&&n[M]||n["@@iterator"],typeof n=="function"?n:null)}var I=Symbol.for("react.client.reference");function _t(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===I?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V:return"Fragment";case Q:return"Profiler";case H:return"StrictMode";case ot:return"Suspense";case ze:return"SuspenseList";case D:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case x:return"Portal";case le:return n.displayName||"Context";case $:return(n._context.displayName||"Context")+".Consumer";case ce:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case O:return a=n.displayName||null,a!==null?a:_t(n.type)||"Memo";case R:a=n._payload,n=n._init;try{return _t(n(a))}catch{}}return null}var Bt=Array.isArray,K=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},je=[],Je=-1;function L(n){return{current:n}}function te(n){0>Je||(n.current=je[Je],je[Je]=null,Je--)}function se(n,a){Je++,je[Je]=n.current,n.current=a}var fe=L(null),be=L(null),Ne=L(null),Be=L(null);function Gt(n,a){switch(se(Ne,a),se(be,n),se(fe,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?Bg(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=Bg(a),n=Gg(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}te(fe),se(fe,n)}function pt(){te(fe),te(be),te(Ne)}function ur(n){n.memoizedState!==null&&se(Be,n);var a=fe.current,s=Gg(a,n.type);a!==s&&(se(be,n),se(fe,s))}function Kr(n){be.current===n&&(te(fe),te(be)),Be.current===n&&(te(Be),dl._currentValue=ye)}var Qr,Zr;function Ei(n){if(Qr===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\n( *(at )?)/);Qr=a&&a[1]||"",Zr=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qr+n+Zr}var fo=!1;function cr(n,a){if(!n||fo)return"";fo=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(a){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(F){var Y=F}Reflect.construct(n,[],J)}else{try{J.call()}catch(F){Y=F}n.call(J.prototype)}}else{try{throw Error()}catch(F){Y=F}(J=n())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(F){if(F&&Y&&typeof F.stack=="string")return[F.stack,Y.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=l.DetermineComponentFrameRoot(),T=d[0],b=d[1];if(T&&b){var k=T.split(`
`),q=b.split(`
`);for(f=l=0;l<k.length&&!k[l].includes("DetermineComponentFrameRoot");)l++;for(;f<q.length&&!q[f].includes("DetermineComponentFrameRoot");)f++;if(l===k.length||f===q.length)for(l=k.length-1,f=q.length-1;1<=l&&0<=f&&k[l]!==q[f];)f--;for(;1<=l&&0<=f;l--,f--)if(k[l]!==q[f]){if(l!==1||f!==1)do if(l--,f--,0>f||k[l]!==q[f]){var X=`
`+k[l].replace(" at new "," at ");return n.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",n.displayName)),X}while(1<=l&&0<=f);break}}}finally{fo=!1,Error.prepareStackTrace=s}return(s=n?n.displayName||n.name:"")?Ei(s):""}function mo(n,a){switch(n.tag){case 26:case 27:case 5:return Ei(n.type);case 16:return Ei("Lazy");case 13:return n.child!==a&&a!==null?Ei("Suspense Fallback"):Ei("Suspense");case 19:return Ei("SuspenseList");case 0:case 15:return cr(n.type,!1);case 11:return cr(n.type.render,!1);case 1:return cr(n.type,!0);case 31:return Ei("Activity");default:return""}}function _o(n){try{var a="",s=null;do a+=mo(n,s),s=n,n=n.return;while(n);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Ot=Object.prototype.hasOwnProperty,qt=t.unstable_scheduleCallback,pa=t.unstable_cancelCallback,gh=t.unstable_shouldYield,Xl=t.unstable_requestPaint,_n=t.unstable_now,hr=t.unstable_getCurrentPriorityLevel,po=t.unstable_ImmediatePriority,go=t.unstable_UserBlockingPriority,ga=t.unstable_NormalPriority,yh=t.unstable_LowPriority,Kl=t.unstable_IdlePriority,Ql=t.log,Zl=t.unstable_setDisableYieldValue,ii=null,Zt=null;function zn(n){if(typeof Ql=="function"&&Zl(n),Zt&&typeof Zt.setStrictMode=="function")try{Zt.setStrictMode(ii,n)}catch{}}var At=Math.clz32?Math.clz32:Jl,$l=Math.log,$r=Math.LN2;function Jl(n){return n>>>=0,n===0?32:31-($l(n)/$r|0)|0}var vi=256,fr=262144,Dt=4194304;function wi(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function bi(n,a,s){var l=n.pendingLanes;if(l===0)return 0;var f=0,d=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var b=l&134217727;return b!==0?(l=b&~d,l!==0?f=wi(l):(T&=b,T!==0?f=wi(T):s||(s=b&~n,s!==0&&(f=wi(s))))):(b=l&~d,b!==0?f=wi(b):T!==0?f=wi(T):s||(s=l&~n,s!==0&&(f=wi(s)))),f===0?0:a!==0&&a!==f&&(a&d)===0&&(d=f&-f,s=a&-a,d>=s||d===32&&(s&4194048)!==0)?a:f}function ai(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function Th(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eu(){var n=Dt;return Dt<<=1,(Dt&62914560)===0&&(Dt=4194304),n}function Ai(n){for(var a=[],s=0;31>s;s++)a.push(n);return a}function dr(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Eh(n,a,s,l,f,d){var T=n.pendingLanes;n.pendingLanes=s,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=s,n.entangledLanes&=s,n.errorRecoveryDisabledLanes&=s,n.shellSuspendCounter=0;var b=n.entanglements,k=n.expirationTimes,q=n.hiddenUpdates;for(s=T&~s;0<s;){var X=31-At(s),J=1<<X;b[X]=0,k[X]=-1;var Y=q[X];if(Y!==null)for(q[X]=null,X=0;X<Y.length;X++){var F=Y[X];F!==null&&(F.lane&=-536870913)}s&=~J}l!==0&&mr(n,l,0),d!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=d&~(T&~a))}function mr(n,a,s){n.pendingLanes|=a,n.suspendedLanes&=~a;var l=31-At(a);n.entangledLanes|=a,n.entanglements[l]=n.entanglements[l]|1073741824|s&261930}function yo(n,a){var s=n.entangledLanes|=a;for(n=n.entanglements;s;){var l=31-At(s),f=1<<l;f&a|n[l]&a&&(n[l]|=a),s&=~f}}function To(n,a){var s=a&-a;return s=(s&42)!==0?1:_r(s),(s&(n.suspendedLanes|a))!==0?0:s}function _r(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Xi(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function tu(){var n=re.p;return n!==0?n:(n=window.event,n===void 0?32:hy(n.type))}function ri(n,a){var s=re.p;try{return re.p=n,a()}finally{re.p=s}}var si=Math.random().toString(36).slice(2),Nt="__reactFiber$"+si,Ft="__reactProps$"+si,Si="__reactContainer$"+si,Jr="__reactEvents$"+si,vh="__reactListeners$"+si,nu="__reactHandles$"+si,iu="__reactResources$"+si,Ri="__reactMarker$"+si;function es(n){delete n[Nt],delete n[Ft],delete n[Jr],delete n[vh],delete n[nu]}function Ii(n){var a=n[Nt];if(a)return a;for(var s=n.parentNode;s;){if(a=s[Si]||s[Nt]){if(s=a.alternate,a.child!==null||s!==null&&s.child!==null)for(n=Kg(n);n!==null;){if(s=n[Nt])return s;n=Kg(n)}return a}n=s,s=n.parentNode}return null}function Un(n){if(n=n[Nt]||n[Si]){var a=n.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return n}return null}function On(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(r(33))}function ki(n){var a=n[iu];return a||(a=n[iu]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ct(n){n[Ri]=!0}var Eo=new Set,vo={};function Oi(n,a){Di(n,a),Di(n+"Capture",a)}function Di(n,a){for(vo[n]=a,n=0;n<a.length;n++)Eo.add(a[n])}var wo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bo={},Ao={};function au(n){return Ot.call(Ao,n)?!0:Ot.call(bo,n)?!1:wo.test(n)?Ao[n]=!0:(bo[n]=!0,!1)}function ts(n,a,s){if(au(a))if(s===null)n.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var l=a.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+s)}}function Dn(n,a,s){if(s===null)n.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+s)}}function Mt(n,a,s,l){if(l===null)n.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttributeNS(a,s,""+l)}}function Wt(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ya(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function So(n,a,s){var l=Object.getOwnPropertyDescriptor(n.constructor.prototype,a);if(!n.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,d=l.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return f.call(this)},set:function(T){s=""+T,d.call(this,T)}}),Object.defineProperty(n,a,{enumerable:l.enumerable}),{getValue:function(){return s},setValue:function(T){s=""+T},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function et(n){if(!n._valueTracker){var a=ya(n)?"checked":"value";n._valueTracker=So(n,a,""+n[a])}}function pr(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var s=a.getValue(),l="";return n&&(l=ya(n)?n.checked?"true":"false":n.value),n=l,n!==s?(a.setValue(n),!0):!1}function Ni(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var gr=/[\n"\\]/g;function yn(n){return n.replace(gr,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ns(n,a,s,l,f,d,T,b){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),a!=null?T==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+Wt(a)):n.value!==""+Wt(a)&&(n.value=""+Wt(a)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),a!=null?Ro(n,T,Wt(a)):s!=null?Ro(n,T,Wt(s)):l!=null&&n.removeAttribute("value"),f==null&&d!=null&&(n.defaultChecked=!!d),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?n.name=""+Wt(b):n.removeAttribute("name")}function ru(n,a,s,l,f,d,T,b){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(n.type=d),a!=null||s!=null){if(!(d!=="submit"&&d!=="reset"||a!=null)){et(n);return}s=s!=null?""+Wt(s):"",a=a!=null?""+Wt(a):s,b||a===n.value||(n.value=a),n.defaultValue=a}l=l??f,l=typeof l!="function"&&typeof l!="symbol"&&!!l,n.checked=b?n.checked:!!l,n.defaultChecked=!!l,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),et(n)}function Ro(n,a,s){a==="number"&&Ni(n.ownerDocument)===n||n.defaultValue===""+s||(n.defaultValue=""+s)}function Ta(n,a,s,l){if(n=n.options,a){a={};for(var f=0;f<s.length;f++)a["$"+s[f]]=!0;for(s=0;s<n.length;s++)f=a.hasOwnProperty("$"+n[s].value),n[s].selected!==f&&(n[s].selected=f),f&&l&&(n[s].defaultSelected=!0)}else{for(s=""+Wt(s),a=null,f=0;f<n.length;f++){if(n[f].value===s){n[f].selected=!0,l&&(n[f].defaultSelected=!0);return}a!==null||n[f].disabled||(a=n[f])}a!==null&&(a.selected=!0)}}function su(n,a,s){if(a!=null&&(a=""+Wt(a),a!==n.value&&(n.value=a),s==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=s!=null?""+Wt(s):""}function Ea(n,a,s,l){if(a==null){if(l!=null){if(s!=null)throw Error(r(92));if(Bt(l)){if(1<l.length)throw Error(r(93));l=l[0]}s=l}s==null&&(s=""),a=s}s=Wt(a),n.defaultValue=s,l=n.textContent,l===s&&l!==""&&l!==null&&(n.value=l),et(n)}function Tn(n,a){if(a){var s=n.firstChild;if(s&&s===n.lastChild&&s.nodeType===3){s.nodeValue=a;return}}n.textContent=a}var ou=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Io(n,a,s){var l=a.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?l?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":l?n.setProperty(a,s):typeof s!="number"||s===0||ou.has(a)?a==="float"?n.cssFloat=s:n[a]=(""+s).trim():n[a]=s+"px"}function ko(n,a,s){if(a!=null&&typeof a!="object")throw Error(r(62));if(n=n.style,s!=null){for(var l in s)!s.hasOwnProperty(l)||a!=null&&a.hasOwnProperty(l)||(l.indexOf("--")===0?n.setProperty(l,""):l==="float"?n.cssFloat="":n[l]="");for(var f in a)l=a[f],a.hasOwnProperty(f)&&s[f]!==l&&Io(n,f,l)}else for(var d in a)a.hasOwnProperty(d)&&Io(n,d,a[d])}function is(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),va=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function as(n){return va.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function oi(){}var Oo=null;function Bn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var wa=null,Ci=null;function yr(n){var a=Un(n);if(a&&(n=a.stateNode)){var s=n[Ft]||null;e:switch(n=a.stateNode,a.type){case"input":if(ns(n,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),a=s.name,s.type==="radio"&&a!=null){for(s=n;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+yn(""+a)+'"][type="radio"]'),a=0;a<s.length;a++){var l=s[a];if(l!==n&&l.form===n.form){var f=l[Ft]||null;if(!f)throw Error(r(90));ns(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(a=0;a<s.length;a++)l=s[a],l.form===n.form&&pr(l)}break e;case"textarea":su(n,s.value,s.defaultValue);break e;case"select":a=s.value,a!=null&&Ta(n,!!s.multiple,a,!1)}}}var rs=!1;function ba(n,a,s){if(rs)return n(a,s);rs=!0;try{var l=n(a);return l}finally{if(rs=!1,(wa!==null||Ci!==null)&&(tc(),wa&&(a=wa,n=Ci,Ci=wa=null,yr(a),n)))for(a=0;a<n.length;a++)yr(n[a])}}function li(n,a){var s=n.stateNode;if(s===null)return null;var l=s[Ft]||null;if(l===null)return null;s=l[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(n=n.type,l=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!l;break e;default:n=!1}if(n)return null;if(s&&typeof s!="function")throw Error(r(231,a,typeof s));return s}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tr=!1;if(Gn)try{var it={};Object.defineProperty(it,"passive",{get:function(){Tr=!0}}),window.addEventListener("test",it,it),window.removeEventListener("test",it,it)}catch{Tr=!1}var Mi=null,Do=null,Er=null;function No(){if(Er)return Er;var n,a=Do,s=a.length,l,f="value"in Mi?Mi.value:Mi.textContent,d=f.length;for(n=0;n<s&&a[n]===f[n];n++);var T=s-n;for(l=1;l<=T&&a[s-l]===f[d-l];l++);return Er=f.slice(n,1<l?1-l:void 0)}function vr(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function Ki(){return!0}function ui(){return!1}function $t(n){function a(s,l,f,d,T){this._reactName=s,this._targetInst=f,this.type=l,this.nativeEvent=d,this.target=T,this.currentTarget=null;for(var b in n)n.hasOwnProperty(b)&&(s=n[b],this[b]=s?s(d):d[b]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?Ki:ui,this.isPropagationStopped=ui,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Ki)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Ki)},persist:function(){},isPersistent:Ki}),a}var Qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vi=$t(Qi),Aa=v({},Qi,{view:0,detail:0}),Co=$t(Aa),Sa,ss,Li,os=v({},Aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ra,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Li&&(Li&&n.type==="mousemove"?(Sa=n.screenX-Li.screenX,ss=n.screenY-Li.screenY):ss=Sa=0,Li=n),Sa)},movementY:function(n){return"movementY"in n?n.movementY:ss}}),Mo=$t(os),wr=v({},os,{dataTransfer:0}),uu=$t(wr),cu=v({},Aa,{relatedTarget:0}),br=$t(cu),Vo=v({},Qi,{animationName:0,elapsedTime:0,pseudoElement:0}),hu=$t(Vo),ls=v({},Qi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),fu=$t(ls),du=v({},Qi,{data:0}),Hi=$t(du),mu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_u={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gu(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=pu[n])?!!a[n]:!1}function Ra(){return gu}var pn=v({},Aa,{key:function(n){if(n.key){var a=mu[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=vr(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?_u[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ra,charCode:function(n){return n.type==="keypress"?vr(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vr(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),yu=$t(pn),Tu=v({},os,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zi=$t(Tu),c=v({},Aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ra}),g=$t(c),E=v({},Qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=$t(E),B=v({},os,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),j=$t(B),ae=v({},Qi,{newState:0,oldState:0}),ke=$t(ae),St=[9,13,27,32],Qe=Gn&&"CompositionEvent"in window,gt=null;Gn&&"documentMode"in document&&(gt=document.documentMode);var qn=Gn&&"TextEvent"in window&&!gt,xi=Gn&&(!Qe||gt&&8<gt&&11>=gt),ci=" ",hi=!1;function Ar(n,a){switch(n){case"keyup":return St.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function us(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var cs=!1;function KE(n,a){switch(n){case"compositionend":return us(a);case"keypress":return a.which!==32?null:(hi=!0,ci);case"textInput":return n=a.data,n===ci&&hi?null:n;default:return null}}function QE(n,a){if(cs)return n==="compositionend"||!Qe&&Ar(n,a)?(n=No(),Er=Do=Mi=null,cs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return xi&&a.locale!=="ko"?null:a.data;default:return null}}var ZE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $m(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!ZE[n.type]:a==="textarea"}function Jm(n,a,s,l){wa?Ci?Ci.push(l):Ci=[l]:wa=l,a=lc(a,"onChange"),0<a.length&&(s=new Vi("onChange","change",null,s,l),n.push({event:s,listeners:a}))}var Lo=null,Ho=null;function $E(n){Lg(n,0)}function Eu(n){var a=On(n);if(pr(a))return n}function e_(n,a){if(n==="change")return a}var t_=!1;if(Gn){var wh;if(Gn){var bh="oninput"in document;if(!bh){var n_=document.createElement("div");n_.setAttribute("oninput","return;"),bh=typeof n_.oninput=="function"}wh=bh}else wh=!1;t_=wh&&(!document.documentMode||9<document.documentMode)}function i_(){Lo&&(Lo.detachEvent("onpropertychange",a_),Ho=Lo=null)}function a_(n){if(n.propertyName==="value"&&Eu(Ho)){var a=[];Jm(a,Ho,n,Bn(n)),ba($E,a)}}function JE(n,a,s){n==="focusin"?(i_(),Lo=a,Ho=s,Lo.attachEvent("onpropertychange",a_)):n==="focusout"&&i_()}function ev(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Eu(Ho)}function tv(n,a){if(n==="click")return Eu(a)}function nv(n,a){if(n==="input"||n==="change")return Eu(a)}function iv(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Nn=typeof Object.is=="function"?Object.is:iv;function xo(n,a){if(Nn(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var s=Object.keys(n),l=Object.keys(a);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var f=s[l];if(!Ot.call(a,f)||!Nn(n[f],a[f]))return!1}return!0}function r_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function s_(n,a){var s=r_(n);n=0;for(var l;s;){if(s.nodeType===3){if(l=n+s.textContent.length,n<=a&&l>=a)return{node:s,offset:a-n};n=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=r_(s)}}function o_(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?o_(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function l_(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=Ni(n.document);a instanceof n.HTMLIFrameElement;){try{var s=typeof a.contentWindow.location.href=="string"}catch{s=!1}if(s)n=a.contentWindow;else break;a=Ni(n.document)}return a}function Ah(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var av=Gn&&"documentMode"in document&&11>=document.documentMode,hs=null,Sh=null,Po=null,Rh=!1;function u_(n,a,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Rh||hs==null||hs!==Ni(l)||(l=hs,"selectionStart"in l&&Ah(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Po&&xo(Po,l)||(Po=l,l=lc(Sh,"onSelect"),0<l.length&&(a=new Vi("onSelect","select",null,a,s),n.push({event:a,listeners:l}),a.target=hs)))}function Sr(n,a){var s={};return s[n.toLowerCase()]=a.toLowerCase(),s["Webkit"+n]="webkit"+a,s["Moz"+n]="moz"+a,s}var fs={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionrun:Sr("Transition","TransitionRun"),transitionstart:Sr("Transition","TransitionStart"),transitioncancel:Sr("Transition","TransitionCancel"),transitionend:Sr("Transition","TransitionEnd")},Ih={},c_={};Gn&&(c_=document.createElement("div").style,"AnimationEvent"in window||(delete fs.animationend.animation,delete fs.animationiteration.animation,delete fs.animationstart.animation),"TransitionEvent"in window||delete fs.transitionend.transition);function Rr(n){if(Ih[n])return Ih[n];if(!fs[n])return n;var a=fs[n],s;for(s in a)if(a.hasOwnProperty(s)&&s in c_)return Ih[n]=a[s];return n}var h_=Rr("animationend"),f_=Rr("animationiteration"),d_=Rr("animationstart"),rv=Rr("transitionrun"),sv=Rr("transitionstart"),ov=Rr("transitioncancel"),m_=Rr("transitionend"),__=new Map,kh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kh.push("scrollEnd");function fi(n,a){__.set(n,a),Oi(a,[n])}var vu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Yn=[],ds=0,Oh=0;function wu(){for(var n=ds,a=Oh=ds=0;a<n;){var s=Yn[a];Yn[a++]=null;var l=Yn[a];Yn[a++]=null;var f=Yn[a];Yn[a++]=null;var d=Yn[a];if(Yn[a++]=null,l!==null&&f!==null){var T=l.pending;T===null?f.next=f:(f.next=T.next,T.next=f),l.pending=f}d!==0&&p_(s,f,d)}}function bu(n,a,s,l){Yn[ds++]=n,Yn[ds++]=a,Yn[ds++]=s,Yn[ds++]=l,Oh|=l,n.lanes|=l,n=n.alternate,n!==null&&(n.lanes|=l)}function Dh(n,a,s,l){return bu(n,a,s,l),Au(n)}function Ir(n,a){return bu(n,null,null,a),Au(n)}function p_(n,a,s){n.lanes|=s;var l=n.alternate;l!==null&&(l.lanes|=s);for(var f=!1,d=n.return;d!==null;)d.childLanes|=s,l=d.alternate,l!==null&&(l.childLanes|=s),d.tag===22&&(n=d.stateNode,n===null||n._visibility&1||(f=!0)),n=d,d=d.return;return n.tag===3?(d=n.stateNode,f&&a!==null&&(f=31-At(s),n=d.hiddenUpdates,l=n[f],l===null?n[f]=[a]:l.push(a),a.lane=s|536870912),d):null}function Au(n){if(50<sl)throw sl=0,Uf=null,Error(r(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var ms={};function lv(n,a,s,l){this.tag=n,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(n,a,s,l){return new lv(n,a,s,l)}function Nh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $i(n,a){var s=n.alternate;return s===null?(s=Cn(n.tag,a,n.key,n.mode),s.elementType=n.elementType,s.type=n.type,s.stateNode=n.stateNode,s.alternate=n,n.alternate=s):(s.pendingProps=a,s.type=n.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=n.flags&65011712,s.childLanes=n.childLanes,s.lanes=n.lanes,s.child=n.child,s.memoizedProps=n.memoizedProps,s.memoizedState=n.memoizedState,s.updateQueue=n.updateQueue,a=n.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},s.sibling=n.sibling,s.index=n.index,s.ref=n.ref,s.refCleanup=n.refCleanup,s}function g_(n,a){n.flags&=65011714;var s=n.alternate;return s===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,a=s.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function Su(n,a,s,l,f,d){var T=0;if(l=n,typeof n=="function")Nh(n)&&(T=1);else if(typeof n=="string")T=dw(n,s,fe.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case D:return n=Cn(31,s,a,f),n.elementType=D,n.lanes=d,n;case V:return kr(s.children,f,d,a);case H:T=8,f|=24;break;case Q:return n=Cn(12,s,a,f|2),n.elementType=Q,n.lanes=d,n;case ot:return n=Cn(13,s,a,f),n.elementType=ot,n.lanes=d,n;case ze:return n=Cn(19,s,a,f),n.elementType=ze,n.lanes=d,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case le:T=10;break e;case $:T=9;break e;case ce:T=11;break e;case O:T=14;break e;case R:T=16,l=null;break e}T=29,s=Error(r(130,n===null?"null":typeof n,"")),l=null}return a=Cn(T,s,a,f),a.elementType=n,a.type=l,a.lanes=d,a}function kr(n,a,s,l){return n=Cn(7,n,l,a),n.lanes=s,n}function Ch(n,a,s){return n=Cn(6,n,null,a),n.lanes=s,n}function y_(n){var a=Cn(18,null,null,0);return a.stateNode=n,a}function Mh(n,a,s){return a=Cn(4,n.children!==null?n.children:[],n.key,a),a.lanes=s,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var T_=new WeakMap;function jn(n,a){if(typeof n=="object"&&n!==null){var s=T_.get(n);return s!==void 0?s:(a={value:n,source:a,stack:_o(a)},T_.set(n,a),a)}return{value:n,source:a,stack:_o(a)}}var _s=[],ps=0,Ru=null,zo=0,Fn=[],Wn=0,Ia=null,Pi=1,zi="";function Ji(n,a){_s[ps++]=zo,_s[ps++]=Ru,Ru=n,zo=a}function E_(n,a,s){Fn[Wn++]=Pi,Fn[Wn++]=zi,Fn[Wn++]=Ia,Ia=n;var l=Pi;n=zi;var f=32-At(l)-1;l&=~(1<<f),s+=1;var d=32-At(a)+f;if(30<d){var T=f-f%5;d=(l&(1<<T)-1).toString(32),l>>=T,f-=T,Pi=1<<32-At(a)+f|s<<f|l,zi=d+n}else Pi=1<<d|s<<f|l,zi=n}function Vh(n){n.return!==null&&(Ji(n,1),E_(n,1,0))}function Lh(n){for(;n===Ru;)Ru=_s[--ps],_s[ps]=null,zo=_s[--ps],_s[ps]=null;for(;n===Ia;)Ia=Fn[--Wn],Fn[Wn]=null,zi=Fn[--Wn],Fn[Wn]=null,Pi=Fn[--Wn],Fn[Wn]=null}function v_(n,a){Fn[Wn++]=Pi,Fn[Wn++]=zi,Fn[Wn++]=Ia,Pi=a.id,zi=a.overflow,Ia=n}var Jt=null,ht=null,Ue=!1,ka=null,Xn=!1,Hh=Error(r(519));function Oa(n){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Uo(jn(a,n)),Hh}function w_(n){var a=n.stateNode,s=n.type,l=n.memoizedProps;switch(a[Nt]=n,a[Ft]=l,s){case"dialog":Ve("cancel",a),Ve("close",a);break;case"iframe":case"object":case"embed":Ve("load",a);break;case"video":case"audio":for(s=0;s<ll.length;s++)Ve(ll[s],a);break;case"source":Ve("error",a);break;case"img":case"image":case"link":Ve("error",a),Ve("load",a);break;case"details":Ve("toggle",a);break;case"input":Ve("invalid",a),ru(a,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Ve("invalid",a);break;case"textarea":Ve("invalid",a),Ea(a,l.value,l.defaultValue,l.children)}s=l.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||a.textContent===""+s||l.suppressHydrationWarning===!0||zg(a.textContent,s)?(l.popover!=null&&(Ve("beforetoggle",a),Ve("toggle",a)),l.onScroll!=null&&Ve("scroll",a),l.onScrollEnd!=null&&Ve("scrollend",a),l.onClick!=null&&(a.onclick=oi),a=!0):a=!1,a||Oa(n,!0)}function b_(n){for(Jt=n.return;Jt;)switch(Jt.tag){case 5:case 31:case 13:Xn=!1;return;case 27:case 3:Xn=!0;return;default:Jt=Jt.return}}function gs(n){if(n!==Jt)return!1;if(!Ue)return b_(n),Ue=!0,!1;var a=n.tag,s;if((s=a!==3&&a!==27)&&((s=a===5)&&(s=n.type,s=!(s!=="form"&&s!=="button")||td(n.type,n.memoizedProps)),s=!s),s&&ht&&Oa(n),b_(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));ht=Xg(n)}else if(a===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));ht=Xg(n)}else a===27?(a=ht,qa(n.type)?(n=sd,sd=null,ht=n):ht=a):ht=Jt?Qn(n.stateNode.nextSibling):null;return!0}function Or(){ht=Jt=null,Ue=!1}function xh(){var n=ka;return n!==null&&(bn===null?bn=n:bn.push.apply(bn,n),ka=null),n}function Uo(n){ka===null?ka=[n]:ka.push(n)}var Ph=L(null),Dr=null,ea=null;function Da(n,a,s){se(Ph,a._currentValue),a._currentValue=s}function ta(n){n._currentValue=Ph.current,te(Ph)}function zh(n,a,s){for(;n!==null;){var l=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,l!==null&&(l.childLanes|=a)):l!==null&&(l.childLanes&a)!==a&&(l.childLanes|=a),n===s)break;n=n.return}}function Uh(n,a,s,l){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var d=f.dependencies;if(d!==null){var T=f.child;d=d.firstContext;e:for(;d!==null;){var b=d;d=f;for(var k=0;k<a.length;k++)if(b.context===a[k]){d.lanes|=s,b=d.alternate,b!==null&&(b.lanes|=s),zh(d.return,s,n),l||(T=null);break e}d=b.next}}else if(f.tag===18){if(T=f.return,T===null)throw Error(r(341));T.lanes|=s,d=T.alternate,d!==null&&(d.lanes|=s),zh(T,s,n),T=null}else T=f.child;if(T!==null)T.return=f;else for(T=f;T!==null;){if(T===n){T=null;break}if(f=T.sibling,f!==null){f.return=T.return,T=f;break}T=T.return}f=T}}function ys(n,a,s,l){n=null;for(var f=a,d=!1;f!==null;){if(!d){if((f.flags&524288)!==0)d=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var T=f.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var b=f.type;Nn(f.pendingProps.value,T.value)||(n!==null?n.push(b):n=[b])}}else if(f===Be.current){if(T=f.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(dl):n=[dl])}f=f.return}n!==null&&Uh(a,n,s,l),a.flags|=262144}function Iu(n){for(n=n.firstContext;n!==null;){if(!Nn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Nr(n){Dr=n,ea=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function en(n){return A_(Dr,n)}function ku(n,a){return Dr===null&&Nr(n),A_(n,a)}function A_(n,a){var s=a._currentValue;if(a={context:a,memoizedValue:s,next:null},ea===null){if(n===null)throw Error(r(308));ea=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else ea=ea.next=a;return s}var uv=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(s,l){n.push(l)}};this.abort=function(){a.aborted=!0,n.forEach(function(s){return s()})}},cv=t.unstable_scheduleCallback,hv=t.unstable_NormalPriority,Vt={$$typeof:le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bh(){return{controller:new uv,data:new Map,refCount:0}}function Bo(n){n.refCount--,n.refCount===0&&cv(hv,function(){n.controller.abort()})}var Go=null,Gh=0,Ts=0,Es=null;function fv(n,a){if(Go===null){var s=Go=[];Gh=0,Ts=Ff(),Es={status:"pending",value:void 0,then:function(l){s.push(l)}}}return Gh++,a.then(S_,S_),a}function S_(){if(--Gh===0&&Go!==null){Es!==null&&(Es.status="fulfilled");var n=Go;Go=null,Ts=0,Es=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function dv(n,a){var s=[],l={status:"pending",value:null,reason:null,then:function(f){s.push(f)}};return n.then(function(){l.status="fulfilled",l.value=a;for(var f=0;f<s.length;f++)(0,s[f])(a)},function(f){for(l.status="rejected",l.reason=f,f=0;f<s.length;f++)(0,s[f])(void 0)}),l}var R_=K.S;K.S=function(n,a){ug=_n(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&fv(n,a),R_!==null&&R_(n,a)};var Cr=L(null);function qh(){var n=Cr.current;return n!==null?n:lt.pooledCache}function Ou(n,a){a===null?se(Cr,Cr.current):se(Cr,a.pool)}function I_(){var n=qh();return n===null?null:{parent:Vt._currentValue,pool:n}}var vs=Error(r(460)),Yh=Error(r(474)),Du=Error(r(542)),Nu={then:function(){}};function k_(n){return n=n.status,n==="fulfilled"||n==="rejected"}function O_(n,a,s){switch(s=n[s],s===void 0?n.push(a):s!==a&&(a.then(oi,oi),a=s),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,N_(n),n;default:if(typeof a.status=="string")a.then(oi,oi);else{if(n=lt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=a,n.status="pending",n.then(function(l){if(a.status==="pending"){var f=a;f.status="fulfilled",f.value=l}},function(l){if(a.status==="pending"){var f=a;f.status="rejected",f.reason=l}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,N_(n),n}throw Vr=a,vs}}function Mr(n){try{var a=n._init;return a(n._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(Vr=s,vs):s}}var Vr=null;function D_(){if(Vr===null)throw Error(r(459));var n=Vr;return Vr=null,n}function N_(n){if(n===vs||n===Du)throw Error(r(483))}var ws=null,qo=0;function Cu(n){var a=qo;return qo+=1,ws===null&&(ws=[]),O_(ws,n,a)}function Yo(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function Mu(n,a){throw a.$$typeof===w?Error(r(525)):(n=Object.prototype.toString.call(a),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function C_(n){function a(z,N){if(n){var G=z.deletions;G===null?(z.deletions=[N],z.flags|=16):G.push(N)}}function s(z,N){if(!n)return null;for(;N!==null;)a(z,N),N=N.sibling;return null}function l(z){for(var N=new Map;z!==null;)z.key!==null?N.set(z.key,z):N.set(z.index,z),z=z.sibling;return N}function f(z,N){return z=$i(z,N),z.index=0,z.sibling=null,z}function d(z,N,G){return z.index=G,n?(G=z.alternate,G!==null?(G=G.index,G<N?(z.flags|=67108866,N):G):(z.flags|=67108866,N)):(z.flags|=1048576,N)}function T(z){return n&&z.alternate===null&&(z.flags|=67108866),z}function b(z,N,G,Z){return N===null||N.tag!==6?(N=Ch(G,z.mode,Z),N.return=z,N):(N=f(N,G),N.return=z,N)}function k(z,N,G,Z){var pe=G.type;return pe===V?X(z,N,G.props.children,Z,G.key):N!==null&&(N.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===R&&Mr(pe)===N.type)?(N=f(N,G.props),Yo(N,G),N.return=z,N):(N=Su(G.type,G.key,G.props,null,z.mode,Z),Yo(N,G),N.return=z,N)}function q(z,N,G,Z){return N===null||N.tag!==4||N.stateNode.containerInfo!==G.containerInfo||N.stateNode.implementation!==G.implementation?(N=Mh(G,z.mode,Z),N.return=z,N):(N=f(N,G.children||[]),N.return=z,N)}function X(z,N,G,Z,pe){return N===null||N.tag!==7?(N=kr(G,z.mode,Z,pe),N.return=z,N):(N=f(N,G),N.return=z,N)}function J(z,N,G){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=Ch(""+N,z.mode,G),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case S:return G=Su(N.type,N.key,N.props,null,z.mode,G),Yo(G,N),G.return=z,G;case x:return N=Mh(N,z.mode,G),N.return=z,N;case R:return N=Mr(N),J(z,N,G)}if(Bt(N)||U(N))return N=kr(N,z.mode,G,null),N.return=z,N;if(typeof N.then=="function")return J(z,Cu(N),G);if(N.$$typeof===le)return J(z,ku(z,N),G);Mu(z,N)}return null}function Y(z,N,G,Z){var pe=N!==null?N.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return pe!==null?null:b(z,N,""+G,Z);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case S:return G.key===pe?k(z,N,G,Z):null;case x:return G.key===pe?q(z,N,G,Z):null;case R:return G=Mr(G),Y(z,N,G,Z)}if(Bt(G)||U(G))return pe!==null?null:X(z,N,G,Z,null);if(typeof G.then=="function")return Y(z,N,Cu(G),Z);if(G.$$typeof===le)return Y(z,N,ku(z,G),Z);Mu(z,G)}return null}function F(z,N,G,Z,pe){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return z=z.get(G)||null,b(N,z,""+Z,pe);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case S:return z=z.get(Z.key===null?G:Z.key)||null,k(N,z,Z,pe);case x:return z=z.get(Z.key===null?G:Z.key)||null,q(N,z,Z,pe);case R:return Z=Mr(Z),F(z,N,G,Z,pe)}if(Bt(Z)||U(Z))return z=z.get(G)||null,X(N,z,Z,pe,null);if(typeof Z.then=="function")return F(z,N,G,Cu(Z),pe);if(Z.$$typeof===le)return F(z,N,G,ku(N,Z),pe);Mu(N,Z)}return null}function de(z,N,G,Z){for(var pe=null,We=null,_e=N,Ce=N=0,He=null;_e!==null&&Ce<G.length;Ce++){_e.index>Ce?(He=_e,_e=null):He=_e.sibling;var Xe=Y(z,_e,G[Ce],Z);if(Xe===null){_e===null&&(_e=He);break}n&&_e&&Xe.alternate===null&&a(z,_e),N=d(Xe,N,Ce),We===null?pe=Xe:We.sibling=Xe,We=Xe,_e=He}if(Ce===G.length)return s(z,_e),Ue&&Ji(z,Ce),pe;if(_e===null){for(;Ce<G.length;Ce++)_e=J(z,G[Ce],Z),_e!==null&&(N=d(_e,N,Ce),We===null?pe=_e:We.sibling=_e,We=_e);return Ue&&Ji(z,Ce),pe}for(_e=l(_e);Ce<G.length;Ce++)He=F(_e,z,Ce,G[Ce],Z),He!==null&&(n&&He.alternate!==null&&_e.delete(He.key===null?Ce:He.key),N=d(He,N,Ce),We===null?pe=He:We.sibling=He,We=He);return n&&_e.forEach(function(Xa){return a(z,Xa)}),Ue&&Ji(z,Ce),pe}function Ee(z,N,G,Z){if(G==null)throw Error(r(151));for(var pe=null,We=null,_e=N,Ce=N=0,He=null,Xe=G.next();_e!==null&&!Xe.done;Ce++,Xe=G.next()){_e.index>Ce?(He=_e,_e=null):He=_e.sibling;var Xa=Y(z,_e,Xe.value,Z);if(Xa===null){_e===null&&(_e=He);break}n&&_e&&Xa.alternate===null&&a(z,_e),N=d(Xa,N,Ce),We===null?pe=Xa:We.sibling=Xa,We=Xa,_e=He}if(Xe.done)return s(z,_e),Ue&&Ji(z,Ce),pe;if(_e===null){for(;!Xe.done;Ce++,Xe=G.next())Xe=J(z,Xe.value,Z),Xe!==null&&(N=d(Xe,N,Ce),We===null?pe=Xe:We.sibling=Xe,We=Xe);return Ue&&Ji(z,Ce),pe}for(_e=l(_e);!Xe.done;Ce++,Xe=G.next())Xe=F(_e,z,Ce,Xe.value,Z),Xe!==null&&(n&&Xe.alternate!==null&&_e.delete(Xe.key===null?Ce:Xe.key),N=d(Xe,N,Ce),We===null?pe=Xe:We.sibling=Xe,We=Xe);return n&&_e.forEach(function(Aw){return a(z,Aw)}),Ue&&Ji(z,Ce),pe}function st(z,N,G,Z){if(typeof G=="object"&&G!==null&&G.type===V&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case S:e:{for(var pe=G.key;N!==null;){if(N.key===pe){if(pe=G.type,pe===V){if(N.tag===7){s(z,N.sibling),Z=f(N,G.props.children),Z.return=z,z=Z;break e}}else if(N.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===R&&Mr(pe)===N.type){s(z,N.sibling),Z=f(N,G.props),Yo(Z,G),Z.return=z,z=Z;break e}s(z,N);break}else a(z,N);N=N.sibling}G.type===V?(Z=kr(G.props.children,z.mode,Z,G.key),Z.return=z,z=Z):(Z=Su(G.type,G.key,G.props,null,z.mode,Z),Yo(Z,G),Z.return=z,z=Z)}return T(z);case x:e:{for(pe=G.key;N!==null;){if(N.key===pe)if(N.tag===4&&N.stateNode.containerInfo===G.containerInfo&&N.stateNode.implementation===G.implementation){s(z,N.sibling),Z=f(N,G.children||[]),Z.return=z,z=Z;break e}else{s(z,N);break}else a(z,N);N=N.sibling}Z=Mh(G,z.mode,Z),Z.return=z,z=Z}return T(z);case R:return G=Mr(G),st(z,N,G,Z)}if(Bt(G))return de(z,N,G,Z);if(U(G)){if(pe=U(G),typeof pe!="function")throw Error(r(150));return G=pe.call(G),Ee(z,N,G,Z)}if(typeof G.then=="function")return st(z,N,Cu(G),Z);if(G.$$typeof===le)return st(z,N,ku(z,G),Z);Mu(z,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,N!==null&&N.tag===6?(s(z,N.sibling),Z=f(N,G),Z.return=z,z=Z):(s(z,N),Z=Ch(G,z.mode,Z),Z.return=z,z=Z),T(z)):s(z,N)}return function(z,N,G,Z){try{qo=0;var pe=st(z,N,G,Z);return ws=null,pe}catch(_e){if(_e===vs||_e===Du)throw _e;var We=Cn(29,_e,null,z.mode);return We.lanes=Z,We.return=z,We}}}var Lr=C_(!0),M_=C_(!1),Na=!1;function jh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Fh(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ca(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ma(n,a,s){var l=n.updateQueue;if(l===null)return null;if(l=l.shared,(Ze&2)!==0){var f=l.pending;return f===null?a.next=a:(a.next=f.next,f.next=a),l.pending=a,a=Au(n),p_(n,null,s),a}return bu(n,l,a,s),Au(n)}function jo(n,a,s){if(a=a.updateQueue,a!==null&&(a=a.shared,(s&4194048)!==0)){var l=a.lanes;l&=n.pendingLanes,s|=l,a.lanes=s,yo(n,s)}}function Wh(n,a){var s=n.updateQueue,l=n.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var f=null,d=null;if(s=s.firstBaseUpdate,s!==null){do{var T={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};d===null?f=d=T:d=d.next=T,s=s.next}while(s!==null);d===null?f=d=a:d=d.next=a}else f=d=a;s={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:d,shared:l.shared,callbacks:l.callbacks},n.updateQueue=s;return}n=s.lastBaseUpdate,n===null?s.firstBaseUpdate=a:n.next=a,s.lastBaseUpdate=a}var Xh=!1;function Fo(){if(Xh){var n=Es;if(n!==null)throw n}}function Wo(n,a,s,l){Xh=!1;var f=n.updateQueue;Na=!1;var d=f.firstBaseUpdate,T=f.lastBaseUpdate,b=f.shared.pending;if(b!==null){f.shared.pending=null;var k=b,q=k.next;k.next=null,T===null?d=q:T.next=q,T=k;var X=n.alternate;X!==null&&(X=X.updateQueue,b=X.lastBaseUpdate,b!==T&&(b===null?X.firstBaseUpdate=q:b.next=q,X.lastBaseUpdate=k))}if(d!==null){var J=f.baseState;T=0,X=q=k=null,b=d;do{var Y=b.lane&-536870913,F=Y!==b.lane;if(F?(Le&Y)===Y:(l&Y)===Y){Y!==0&&Y===Ts&&(Xh=!0),X!==null&&(X=X.next={lane:0,tag:b.tag,payload:b.payload,callback:null,next:null});e:{var de=n,Ee=b;Y=a;var st=s;switch(Ee.tag){case 1:if(de=Ee.payload,typeof de=="function"){J=de.call(st,J,Y);break e}J=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=Ee.payload,Y=typeof de=="function"?de.call(st,J,Y):de,Y==null)break e;J=v({},J,Y);break e;case 2:Na=!0}}Y=b.callback,Y!==null&&(n.flags|=64,F&&(n.flags|=8192),F=f.callbacks,F===null?f.callbacks=[Y]:F.push(Y))}else F={lane:Y,tag:b.tag,payload:b.payload,callback:b.callback,next:null},X===null?(q=X=F,k=J):X=X.next=F,T|=Y;if(b=b.next,b===null){if(b=f.shared.pending,b===null)break;F=b,b=F.next,F.next=null,f.lastBaseUpdate=F,f.shared.pending=null}}while(!0);X===null&&(k=J),f.baseState=k,f.firstBaseUpdate=q,f.lastBaseUpdate=X,d===null&&(f.shared.lanes=0),Pa|=T,n.lanes=T,n.memoizedState=J}}function V_(n,a){if(typeof n!="function")throw Error(r(191,n));n.call(a)}function L_(n,a){var s=n.callbacks;if(s!==null)for(n.callbacks=null,n=0;n<s.length;n++)V_(s[n],a)}var bs=L(null),Vu=L(0);function H_(n,a){n=ca,se(Vu,n),se(bs,a),ca=n|a.baseLanes}function Kh(){se(Vu,ca),se(bs,bs.current)}function Qh(){ca=Vu.current,te(bs),te(Vu)}var Mn=L(null),Kn=null;function Va(n){var a=n.alternate;se(Rt,Rt.current&1),se(Mn,n),Kn===null&&(a===null||bs.current!==null||a.memoizedState!==null)&&(Kn=n)}function Zh(n){se(Rt,Rt.current),se(Mn,n),Kn===null&&(Kn=n)}function x_(n){n.tag===22?(se(Rt,Rt.current),se(Mn,n),Kn===null&&(Kn=n)):La()}function La(){se(Rt,Rt.current),se(Mn,Mn.current)}function Vn(n){te(Mn),Kn===n&&(Kn=null),te(Rt)}var Rt=L(0);function Lu(n){for(var a=n;a!==null;){if(a.tag===13){var s=a.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||ad(s)||rd(s)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var na=0,Oe=null,at=null,Lt=null,Hu=!1,As=!1,Hr=!1,xu=0,Xo=0,Ss=null,mv=0;function vt(){throw Error(r(321))}function $h(n,a){if(a===null)return!1;for(var s=0;s<a.length&&s<n.length;s++)if(!Nn(n[s],a[s]))return!1;return!0}function Jh(n,a,s,l,f,d){return na=d,Oe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,K.H=n===null||n.memoizedState===null?Ep:_f,Hr=!1,d=s(l,f),Hr=!1,As&&(d=z_(a,s,l,f)),P_(n),d}function P_(n){K.H=Zo;var a=at!==null&&at.next!==null;if(na=0,Lt=at=Oe=null,Hu=!1,Xo=0,Ss=null,a)throw Error(r(300));n===null||Ht||(n=n.dependencies,n!==null&&Iu(n)&&(Ht=!0))}function z_(n,a,s,l){Oe=n;var f=0;do{if(As&&(Ss=null),Xo=0,As=!1,25<=f)throw Error(r(301));if(f+=1,Lt=at=null,n.updateQueue!=null){var d=n.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}K.H=vp,d=a(s,l)}while(As);return d}function _v(){var n=K.H,a=n.useState()[0];return a=typeof a.then=="function"?Ko(a):a,n=n.useState()[0],(at!==null?at.memoizedState:null)!==n&&(Oe.flags|=1024),a}function ef(){var n=xu!==0;return xu=0,n}function tf(n,a,s){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~s}function nf(n){if(Hu){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Hu=!1}na=0,Lt=at=Oe=null,As=!1,Xo=xu=0,Ss=null}function gn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?Oe.memoizedState=Lt=n:Lt=Lt.next=n,Lt}function It(){if(at===null){var n=Oe.alternate;n=n!==null?n.memoizedState:null}else n=at.next;var a=Lt===null?Oe.memoizedState:Lt.next;if(a!==null)Lt=a,at=n;else{if(n===null)throw Oe.alternate===null?Error(r(467)):Error(r(310));at=n,n={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},Lt===null?Oe.memoizedState=Lt=n:Lt=Lt.next=n}return Lt}function Pu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ko(n){var a=Xo;return Xo+=1,Ss===null&&(Ss=[]),n=O_(Ss,n,a),a=Oe,(Lt===null?a.memoizedState:Lt.next)===null&&(a=a.alternate,K.H=a===null||a.memoizedState===null?Ep:_f),n}function zu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Ko(n);if(n.$$typeof===le)return en(n)}throw Error(r(438,String(n)))}function af(n){var a=null,s=Oe.updateQueue;if(s!==null&&(a=s.memoCache),a==null){var l=Oe.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(a={data:l.data.map(function(f){return f.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),s===null&&(s=Pu(),Oe.updateQueue=s),s.memoCache=a,s=a.data[a.index],s===void 0)for(s=a.data[a.index]=Array(n),l=0;l<n;l++)s[l]=P;return a.index++,s}function ia(n,a){return typeof a=="function"?a(n):a}function Uu(n){var a=It();return rf(a,at,n)}function rf(n,a,s){var l=n.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=s;var f=n.baseQueue,d=l.pending;if(d!==null){if(f!==null){var T=f.next;f.next=d.next,d.next=T}a.baseQueue=f=d,l.pending=null}if(d=n.baseState,f===null)n.memoizedState=d;else{a=f.next;var b=T=null,k=null,q=a,X=!1;do{var J=q.lane&-536870913;if(J!==q.lane?(Le&J)===J:(na&J)===J){var Y=q.revertLane;if(Y===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),J===Ts&&(X=!0);else if((na&Y)===Y){q=q.next,Y===Ts&&(X=!0);continue}else J={lane:0,revertLane:q.revertLane,gesture:null,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null},k===null?(b=k=J,T=d):k=k.next=J,Oe.lanes|=Y,Pa|=Y;J=q.action,Hr&&s(d,J),d=q.hasEagerState?q.eagerState:s(d,J)}else Y={lane:J,revertLane:q.revertLane,gesture:q.gesture,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null},k===null?(b=k=Y,T=d):k=k.next=Y,Oe.lanes|=J,Pa|=J;q=q.next}while(q!==null&&q!==a);if(k===null?T=d:k.next=b,!Nn(d,n.memoizedState)&&(Ht=!0,X&&(s=Es,s!==null)))throw s;n.memoizedState=d,n.baseState=T,n.baseQueue=k,l.lastRenderedState=d}return f===null&&(l.lanes=0),[n.memoizedState,l.dispatch]}function sf(n){var a=It(),s=a.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=n;var l=s.dispatch,f=s.pending,d=a.memoizedState;if(f!==null){s.pending=null;var T=f=f.next;do d=n(d,T.action),T=T.next;while(T!==f);Nn(d,a.memoizedState)||(Ht=!0),a.memoizedState=d,a.baseQueue===null&&(a.baseState=d),s.lastRenderedState=d}return[d,l]}function U_(n,a,s){var l=Oe,f=It(),d=Ue;if(d){if(s===void 0)throw Error(r(407));s=s()}else s=a();var T=!Nn((at||f).memoizedState,s);if(T&&(f.memoizedState=s,Ht=!0),f=f.queue,uf(q_.bind(null,l,f,n),[n]),f.getSnapshot!==a||T||Lt!==null&&Lt.memoizedState.tag&1){if(l.flags|=2048,Rs(9,{destroy:void 0},G_.bind(null,l,f,s,a),null),lt===null)throw Error(r(349));d||(na&127)!==0||B_(l,a,s)}return s}function B_(n,a,s){n.flags|=16384,n={getSnapshot:a,value:s},a=Oe.updateQueue,a===null?(a=Pu(),Oe.updateQueue=a,a.stores=[n]):(s=a.stores,s===null?a.stores=[n]:s.push(n))}function G_(n,a,s,l){a.value=s,a.getSnapshot=l,Y_(a)&&j_(n)}function q_(n,a,s){return s(function(){Y_(a)&&j_(n)})}function Y_(n){var a=n.getSnapshot;n=n.value;try{var s=a();return!Nn(n,s)}catch{return!0}}function j_(n){var a=Ir(n,2);a!==null&&An(a,n,2)}function of(n){var a=gn();if(typeof n=="function"){var s=n;if(n=s(),Hr){zn(!0);try{s()}finally{zn(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:n},a}function F_(n,a,s,l){return n.baseState=s,rf(n,at,typeof l=="function"?l:ia)}function pv(n,a,s,l,f){if(qu(n))throw Error(r(485));if(n=a.action,n!==null){var d={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){d.listeners.push(T)}};K.T!==null?s(!0):d.isTransition=!1,l(d),s=a.pending,s===null?(d.next=a.pending=d,W_(a,d)):(d.next=s.next,a.pending=s.next=d)}}function W_(n,a){var s=a.action,l=a.payload,f=n.state;if(a.isTransition){var d=K.T,T={};K.T=T;try{var b=s(f,l),k=K.S;k!==null&&k(T,b),X_(n,a,b)}catch(q){lf(n,a,q)}finally{d!==null&&T.types!==null&&(d.types=T.types),K.T=d}}else try{d=s(f,l),X_(n,a,d)}catch(q){lf(n,a,q)}}function X_(n,a,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(l){K_(n,a,l)},function(l){return lf(n,a,l)}):K_(n,a,s)}function K_(n,a,s){a.status="fulfilled",a.value=s,Q_(a),n.state=s,a=n.pending,a!==null&&(s=a.next,s===a?n.pending=null:(s=s.next,a.next=s,W_(n,s)))}function lf(n,a,s){var l=n.pending;if(n.pending=null,l!==null){l=l.next;do a.status="rejected",a.reason=s,Q_(a),a=a.next;while(a!==l)}n.action=null}function Q_(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function Z_(n,a){return a}function $_(n,a){if(Ue){var s=lt.formState;if(s!==null){e:{var l=Oe;if(Ue){if(ht){t:{for(var f=ht,d=Xn;f.nodeType!==8;){if(!d){f=null;break t}if(f=Qn(f.nextSibling),f===null){f=null;break t}}d=f.data,f=d==="F!"||d==="F"?f:null}if(f){ht=Qn(f.nextSibling),l=f.data==="F!";break e}}Oa(l)}l=!1}l&&(a=s[0])}}return s=gn(),s.memoizedState=s.baseState=a,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Z_,lastRenderedState:a},s.queue=l,s=gp.bind(null,Oe,l),l.dispatch=s,l=of(!1),d=mf.bind(null,Oe,!1,l.queue),l=gn(),f={state:a,dispatch:null,action:n,pending:null},l.queue=f,s=pv.bind(null,Oe,f,d,s),f.dispatch=s,l.memoizedState=n,[a,s,!1]}function J_(n){var a=It();return ep(a,at,n)}function ep(n,a,s){if(a=rf(n,a,Z_)[0],n=Uu(ia)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var l=Ko(a)}catch(T){throw T===vs?Du:T}else l=a;a=It();var f=a.queue,d=f.dispatch;return s!==a.memoizedState&&(Oe.flags|=2048,Rs(9,{destroy:void 0},gv.bind(null,f,s),null)),[l,d,n]}function gv(n,a){n.action=a}function tp(n){var a=It(),s=at;if(s!==null)return ep(a,s,n);It(),a=a.memoizedState,s=It();var l=s.queue.dispatch;return s.memoizedState=n,[a,l,!1]}function Rs(n,a,s,l){return n={tag:n,create:s,deps:l,inst:a,next:null},a=Oe.updateQueue,a===null&&(a=Pu(),Oe.updateQueue=a),s=a.lastEffect,s===null?a.lastEffect=n.next=n:(l=s.next,s.next=n,n.next=l,a.lastEffect=n),n}function np(){return It().memoizedState}function Bu(n,a,s,l){var f=gn();Oe.flags|=n,f.memoizedState=Rs(1|a,{destroy:void 0},s,l===void 0?null:l)}function Gu(n,a,s,l){var f=It();l=l===void 0?null:l;var d=f.memoizedState.inst;at!==null&&l!==null&&$h(l,at.memoizedState.deps)?f.memoizedState=Rs(a,d,s,l):(Oe.flags|=n,f.memoizedState=Rs(1|a,d,s,l))}function ip(n,a){Bu(8390656,8,n,a)}function uf(n,a){Gu(2048,8,n,a)}function yv(n){Oe.flags|=4;var a=Oe.updateQueue;if(a===null)a=Pu(),Oe.updateQueue=a,a.events=[n];else{var s=a.events;s===null?a.events=[n]:s.push(n)}}function ap(n){var a=It().memoizedState;return yv({ref:a,nextImpl:n}),function(){if((Ze&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function rp(n,a){return Gu(4,2,n,a)}function sp(n,a){return Gu(4,4,n,a)}function op(n,a){if(typeof a=="function"){n=n();var s=a(n);return function(){typeof s=="function"?s():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function lp(n,a,s){s=s!=null?s.concat([n]):null,Gu(4,4,op.bind(null,a,n),s)}function cf(){}function up(n,a){var s=It();a=a===void 0?null:a;var l=s.memoizedState;return a!==null&&$h(a,l[1])?l[0]:(s.memoizedState=[n,a],n)}function cp(n,a){var s=It();a=a===void 0?null:a;var l=s.memoizedState;if(a!==null&&$h(a,l[1]))return l[0];if(l=n(),Hr){zn(!0);try{n()}finally{zn(!1)}}return s.memoizedState=[l,a],l}function hf(n,a,s){return s===void 0||(na&1073741824)!==0&&(Le&261930)===0?n.memoizedState=a:(n.memoizedState=s,n=hg(),Oe.lanes|=n,Pa|=n,s)}function hp(n,a,s,l){return Nn(s,a)?s:bs.current!==null?(n=hf(n,s,l),Nn(n,a)||(Ht=!0),n):(na&42)===0||(na&1073741824)!==0&&(Le&261930)===0?(Ht=!0,n.memoizedState=s):(n=hg(),Oe.lanes|=n,Pa|=n,a)}function fp(n,a,s,l,f){var d=re.p;re.p=d!==0&&8>d?d:8;var T=K.T,b={};K.T=b,mf(n,!1,a,s);try{var k=f(),q=K.S;if(q!==null&&q(b,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var X=dv(k,l);Qo(n,a,X,xn(n))}else Qo(n,a,l,xn(n))}catch(J){Qo(n,a,{then:function(){},status:"rejected",reason:J},xn())}finally{re.p=d,T!==null&&b.types!==null&&(T.types=b.types),K.T=T}}function Tv(){}function ff(n,a,s,l){if(n.tag!==5)throw Error(r(476));var f=dp(n).queue;fp(n,f,a,ye,s===null?Tv:function(){return mp(n),s(l)})}function dp(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:ye},next:null};var s={};return a.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:s},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function mp(n){var a=dp(n);a.next===null&&(a=n.alternate.memoizedState),Qo(n,a.next.queue,{},xn())}function df(){return en(dl)}function _p(){return It().memoizedState}function pp(){return It().memoizedState}function Ev(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var s=xn();n=Ca(s);var l=Ma(a,n,s);l!==null&&(An(l,a,s),jo(l,a,s)),a={cache:Bh()},n.payload=a;return}a=a.return}}function vv(n,a,s){var l=xn();s={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},qu(n)?yp(a,s):(s=Dh(n,a,s,l),s!==null&&(An(s,n,l),Tp(s,a,l)))}function gp(n,a,s){var l=xn();Qo(n,a,s,l)}function Qo(n,a,s,l){var f={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(qu(n))yp(a,f);else{var d=n.alternate;if(n.lanes===0&&(d===null||d.lanes===0)&&(d=a.lastRenderedReducer,d!==null))try{var T=a.lastRenderedState,b=d(T,s);if(f.hasEagerState=!0,f.eagerState=b,Nn(b,T))return bu(n,a,f,0),lt===null&&wu(),!1}catch{}if(s=Dh(n,a,f,l),s!==null)return An(s,n,l),Tp(s,a,l),!0}return!1}function mf(n,a,s,l){if(l={lane:2,revertLane:Ff(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},qu(n)){if(a)throw Error(r(479))}else a=Dh(n,s,l,2),a!==null&&An(a,n,2)}function qu(n){var a=n.alternate;return n===Oe||a!==null&&a===Oe}function yp(n,a){As=Hu=!0;var s=n.pending;s===null?a.next=a:(a.next=s.next,s.next=a),n.pending=a}function Tp(n,a,s){if((s&4194048)!==0){var l=a.lanes;l&=n.pendingLanes,s|=l,a.lanes=s,yo(n,s)}}var Zo={readContext:en,use:zu,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useLayoutEffect:vt,useInsertionEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useSyncExternalStore:vt,useId:vt,useHostTransitionStatus:vt,useFormState:vt,useActionState:vt,useOptimistic:vt,useMemoCache:vt,useCacheRefresh:vt};Zo.useEffectEvent=vt;var Ep={readContext:en,use:zu,useCallback:function(n,a){return gn().memoizedState=[n,a===void 0?null:a],n},useContext:en,useEffect:ip,useImperativeHandle:function(n,a,s){s=s!=null?s.concat([n]):null,Bu(4194308,4,op.bind(null,a,n),s)},useLayoutEffect:function(n,a){return Bu(4194308,4,n,a)},useInsertionEffect:function(n,a){Bu(4,2,n,a)},useMemo:function(n,a){var s=gn();a=a===void 0?null:a;var l=n();if(Hr){zn(!0);try{n()}finally{zn(!1)}}return s.memoizedState=[l,a],l},useReducer:function(n,a,s){var l=gn();if(s!==void 0){var f=s(a);if(Hr){zn(!0);try{s(a)}finally{zn(!1)}}}else f=a;return l.memoizedState=l.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},l.queue=n,n=n.dispatch=vv.bind(null,Oe,n),[l.memoizedState,n]},useRef:function(n){var a=gn();return n={current:n},a.memoizedState=n},useState:function(n){n=of(n);var a=n.queue,s=gp.bind(null,Oe,a);return a.dispatch=s,[n.memoizedState,s]},useDebugValue:cf,useDeferredValue:function(n,a){var s=gn();return hf(s,n,a)},useTransition:function(){var n=of(!1);return n=fp.bind(null,Oe,n.queue,!0,!1),gn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,s){var l=Oe,f=gn();if(Ue){if(s===void 0)throw Error(r(407));s=s()}else{if(s=a(),lt===null)throw Error(r(349));(Le&127)!==0||B_(l,a,s)}f.memoizedState=s;var d={value:s,getSnapshot:a};return f.queue=d,ip(q_.bind(null,l,d,n),[n]),l.flags|=2048,Rs(9,{destroy:void 0},G_.bind(null,l,d,s,a),null),s},useId:function(){var n=gn(),a=lt.identifierPrefix;if(Ue){var s=zi,l=Pi;s=(l&~(1<<32-At(l)-1)).toString(32)+s,a="_"+a+"R_"+s,s=xu++,0<s&&(a+="H"+s.toString(32)),a+="_"}else s=mv++,a="_"+a+"r_"+s.toString(32)+"_";return n.memoizedState=a},useHostTransitionStatus:df,useFormState:$_,useActionState:$_,useOptimistic:function(n){var a=gn();a.memoizedState=a.baseState=n;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=s,a=mf.bind(null,Oe,!0,s),s.dispatch=a,[n,a]},useMemoCache:af,useCacheRefresh:function(){return gn().memoizedState=Ev.bind(null,Oe)},useEffectEvent:function(n){var a=gn(),s={impl:n};return a.memoizedState=s,function(){if((Ze&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}},_f={readContext:en,use:zu,useCallback:up,useContext:en,useEffect:uf,useImperativeHandle:lp,useInsertionEffect:rp,useLayoutEffect:sp,useMemo:cp,useReducer:Uu,useRef:np,useState:function(){return Uu(ia)},useDebugValue:cf,useDeferredValue:function(n,a){var s=It();return hp(s,at.memoizedState,n,a)},useTransition:function(){var n=Uu(ia)[0],a=It().memoizedState;return[typeof n=="boolean"?n:Ko(n),a]},useSyncExternalStore:U_,useId:_p,useHostTransitionStatus:df,useFormState:J_,useActionState:J_,useOptimistic:function(n,a){var s=It();return F_(s,at,n,a)},useMemoCache:af,useCacheRefresh:pp};_f.useEffectEvent=ap;var vp={readContext:en,use:zu,useCallback:up,useContext:en,useEffect:uf,useImperativeHandle:lp,useInsertionEffect:rp,useLayoutEffect:sp,useMemo:cp,useReducer:sf,useRef:np,useState:function(){return sf(ia)},useDebugValue:cf,useDeferredValue:function(n,a){var s=It();return at===null?hf(s,n,a):hp(s,at.memoizedState,n,a)},useTransition:function(){var n=sf(ia)[0],a=It().memoizedState;return[typeof n=="boolean"?n:Ko(n),a]},useSyncExternalStore:U_,useId:_p,useHostTransitionStatus:df,useFormState:tp,useActionState:tp,useOptimistic:function(n,a){var s=It();return at!==null?F_(s,at,n,a):(s.baseState=n,[n,s.queue.dispatch])},useMemoCache:af,useCacheRefresh:pp};vp.useEffectEvent=ap;function pf(n,a,s,l){a=n.memoizedState,s=s(l,a),s=s==null?a:v({},a,s),n.memoizedState=s,n.lanes===0&&(n.updateQueue.baseState=s)}var gf={enqueueSetState:function(n,a,s){n=n._reactInternals;var l=xn(),f=Ca(l);f.payload=a,s!=null&&(f.callback=s),a=Ma(n,f,l),a!==null&&(An(a,n,l),jo(a,n,l))},enqueueReplaceState:function(n,a,s){n=n._reactInternals;var l=xn(),f=Ca(l);f.tag=1,f.payload=a,s!=null&&(f.callback=s),a=Ma(n,f,l),a!==null&&(An(a,n,l),jo(a,n,l))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var s=xn(),l=Ca(s);l.tag=2,a!=null&&(l.callback=a),a=Ma(n,l,s),a!==null&&(An(a,n,s),jo(a,n,s))}};function wp(n,a,s,l,f,d,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(l,d,T):a.prototype&&a.prototype.isPureReactComponent?!xo(s,l)||!xo(f,d):!0}function bp(n,a,s,l){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(s,l),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(s,l),a.state!==n&&gf.enqueueReplaceState(a,a.state,null)}function xr(n,a){var s=a;if("ref"in a){s={};for(var l in a)l!=="ref"&&(s[l]=a[l])}if(n=n.defaultProps){s===a&&(s=v({},s));for(var f in n)s[f]===void 0&&(s[f]=n[f])}return s}function Ap(n){vu(n)}function Sp(n){console.error(n)}function Rp(n){vu(n)}function Yu(n,a){try{var s=n.onUncaughtError;s(a.value,{componentStack:a.stack})}catch(l){setTimeout(function(){throw l})}}function Ip(n,a,s){try{var l=n.onCaughtError;l(s.value,{componentStack:s.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function yf(n,a,s){return s=Ca(s),s.tag=3,s.payload={element:null},s.callback=function(){Yu(n,a)},s}function kp(n){return n=Ca(n),n.tag=3,n}function Op(n,a,s,l){var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var d=l.value;n.payload=function(){return f(d)},n.callback=function(){Ip(a,s,l)}}var T=s.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){Ip(a,s,l),typeof f!="function"&&(za===null?za=new Set([this]):za.add(this));var b=l.stack;this.componentDidCatch(l.value,{componentStack:b!==null?b:""})})}function wv(n,a,s,l,f){if(s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(a=s.alternate,a!==null&&ys(a,s,f,!0),s=Mn.current,s!==null){switch(s.tag){case 31:case 13:return Kn===null?nc():s.alternate===null&&wt===0&&(wt=3),s.flags&=-257,s.flags|=65536,s.lanes=f,l===Nu?s.flags|=16384:(a=s.updateQueue,a===null?s.updateQueue=new Set([l]):a.add(l),qf(n,l,f)),!1;case 22:return s.flags|=65536,l===Nu?s.flags|=16384:(a=s.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([l])},s.updateQueue=a):(s=a.retryQueue,s===null?a.retryQueue=new Set([l]):s.add(l)),qf(n,l,f)),!1}throw Error(r(435,s.tag))}return qf(n,l,f),nc(),!1}if(Ue)return a=Mn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=f,l!==Hh&&(n=Error(r(422),{cause:l}),Uo(jn(n,s)))):(l!==Hh&&(a=Error(r(423),{cause:l}),Uo(jn(a,s))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,l=jn(l,s),f=yf(n.stateNode,l,f),Wh(n,f),wt!==4&&(wt=2)),!1;var d=Error(r(520),{cause:l});if(d=jn(d,s),rl===null?rl=[d]:rl.push(d),wt!==4&&(wt=2),a===null)return!0;l=jn(l,s),s=a;do{switch(s.tag){case 3:return s.flags|=65536,n=f&-f,s.lanes|=n,n=yf(s.stateNode,l,n),Wh(s,n),!1;case 1:if(a=s.type,d=s.stateNode,(s.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(za===null||!za.has(d))))return s.flags|=65536,f&=-f,s.lanes|=f,f=kp(f),Op(f,n,s,l),Wh(s,f),!1}s=s.return}while(s!==null);return!1}var Tf=Error(r(461)),Ht=!1;function tn(n,a,s,l){a.child=n===null?M_(a,null,s,l):Lr(a,n.child,s,l)}function Dp(n,a,s,l,f){s=s.render;var d=a.ref;if("ref"in l){var T={};for(var b in l)b!=="ref"&&(T[b]=l[b])}else T=l;return Nr(a),l=Jh(n,a,s,T,d,f),b=ef(),n!==null&&!Ht?(tf(n,a,f),aa(n,a,f)):(Ue&&b&&Vh(a),a.flags|=1,tn(n,a,l,f),a.child)}function Np(n,a,s,l,f){if(n===null){var d=s.type;return typeof d=="function"&&!Nh(d)&&d.defaultProps===void 0&&s.compare===null?(a.tag=15,a.type=d,Cp(n,a,d,l,f)):(n=Su(s.type,null,l,a,a.mode,f),n.ref=a.ref,n.return=a,a.child=n)}if(d=n.child,!If(n,f)){var T=d.memoizedProps;if(s=s.compare,s=s!==null?s:xo,s(T,l)&&n.ref===a.ref)return aa(n,a,f)}return a.flags|=1,n=$i(d,l),n.ref=a.ref,n.return=a,a.child=n}function Cp(n,a,s,l,f){if(n!==null){var d=n.memoizedProps;if(xo(d,l)&&n.ref===a.ref)if(Ht=!1,a.pendingProps=l=d,If(n,f))(n.flags&131072)!==0&&(Ht=!0);else return a.lanes=n.lanes,aa(n,a,f)}return Ef(n,a,s,l,f)}function Mp(n,a,s,l){var f=l.children,d=n!==null?n.memoizedState:null;if(n===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((a.flags&128)!==0){if(d=d!==null?d.baseLanes|s:s,n!==null){for(l=a.child=n.child,f=0;l!==null;)f=f|l.lanes|l.childLanes,l=l.sibling;l=f&~d}else l=0,a.child=null;return Vp(n,a,d,s,l)}if((s&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&Ou(a,d!==null?d.cachePool:null),d!==null?H_(a,d):Kh(),x_(a);else return l=a.lanes=536870912,Vp(n,a,d!==null?d.baseLanes|s:s,s,l)}else d!==null?(Ou(a,d.cachePool),H_(a,d),La(),a.memoizedState=null):(n!==null&&Ou(a,null),Kh(),La());return tn(n,a,f,s),a.child}function $o(n,a){return n!==null&&n.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Vp(n,a,s,l,f){var d=qh();return d=d===null?null:{parent:Vt._currentValue,pool:d},a.memoizedState={baseLanes:s,cachePool:d},n!==null&&Ou(a,null),Kh(),x_(a),n!==null&&ys(n,a,l,!0),a.childLanes=f,null}function ju(n,a){return a=Wu({mode:a.mode,children:a.children},n.mode),a.ref=n.ref,n.child=a,a.return=n,a}function Lp(n,a,s){return Lr(a,n.child,null,s),n=ju(a,a.pendingProps),n.flags|=2,Vn(a),a.memoizedState=null,n}function bv(n,a,s){var l=a.pendingProps,f=(a.flags&128)!==0;if(a.flags&=-129,n===null){if(Ue){if(l.mode==="hidden")return n=ju(a,l),a.lanes=536870912,$o(null,n);if(Zh(a),(n=ht)?(n=Wg(n,Xn),n=n!==null&&n.data==="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:Ia!==null?{id:Pi,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},s=y_(n),s.return=a,a.child=s,Jt=a,ht=null)):n=null,n===null)throw Oa(a);return a.lanes=536870912,null}return ju(a,l)}var d=n.memoizedState;if(d!==null){var T=d.dehydrated;if(Zh(a),f)if(a.flags&256)a.flags&=-257,a=Lp(n,a,s);else if(a.memoizedState!==null)a.child=n.child,a.flags|=128,a=null;else throw Error(r(558));else if(Ht||ys(n,a,s,!1),f=(s&n.childLanes)!==0,Ht||f){if(l=lt,l!==null&&(T=To(l,s),T!==0&&T!==d.retryLane))throw d.retryLane=T,Ir(n,T),An(l,n,T),Tf;nc(),a=Lp(n,a,s)}else n=d.treeContext,ht=Qn(T.nextSibling),Jt=a,Ue=!0,ka=null,Xn=!1,n!==null&&v_(a,n),a=ju(a,l),a.flags|=4096;return a}return n=$i(n.child,{mode:l.mode,children:l.children}),n.ref=a.ref,a.child=n,n.return=a,n}function Fu(n,a){var s=a.ref;if(s===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(r(284));(n===null||n.ref!==s)&&(a.flags|=4194816)}}function Ef(n,a,s,l,f){return Nr(a),s=Jh(n,a,s,l,void 0,f),l=ef(),n!==null&&!Ht?(tf(n,a,f),aa(n,a,f)):(Ue&&l&&Vh(a),a.flags|=1,tn(n,a,s,f),a.child)}function Hp(n,a,s,l,f,d){return Nr(a),a.updateQueue=null,s=z_(a,l,s,f),P_(n),l=ef(),n!==null&&!Ht?(tf(n,a,d),aa(n,a,d)):(Ue&&l&&Vh(a),a.flags|=1,tn(n,a,s,d),a.child)}function xp(n,a,s,l,f){if(Nr(a),a.stateNode===null){var d=ms,T=s.contextType;typeof T=="object"&&T!==null&&(d=en(T)),d=new s(l,d),a.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=gf,a.stateNode=d,d._reactInternals=a,d=a.stateNode,d.props=l,d.state=a.memoizedState,d.refs={},jh(a),T=s.contextType,d.context=typeof T=="object"&&T!==null?en(T):ms,d.state=a.memoizedState,T=s.getDerivedStateFromProps,typeof T=="function"&&(pf(a,s,T,l),d.state=a.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(T=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),T!==d.state&&gf.enqueueReplaceState(d,d.state,null),Wo(a,l,d,f),Fo(),d.state=a.memoizedState),typeof d.componentDidMount=="function"&&(a.flags|=4194308),l=!0}else if(n===null){d=a.stateNode;var b=a.memoizedProps,k=xr(s,b);d.props=k;var q=d.context,X=s.contextType;T=ms,typeof X=="object"&&X!==null&&(T=en(X));var J=s.getDerivedStateFromProps;X=typeof J=="function"||typeof d.getSnapshotBeforeUpdate=="function",b=a.pendingProps!==b,X||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(b||q!==T)&&bp(a,d,l,T),Na=!1;var Y=a.memoizedState;d.state=Y,Wo(a,l,d,f),Fo(),q=a.memoizedState,b||Y!==q||Na?(typeof J=="function"&&(pf(a,s,J,l),q=a.memoizedState),(k=Na||wp(a,s,k,l,Y,q,T))?(X||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(a.flags|=4194308)):(typeof d.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=l,a.memoizedState=q),d.props=l,d.state=q,d.context=T,l=k):(typeof d.componentDidMount=="function"&&(a.flags|=4194308),l=!1)}else{d=a.stateNode,Fh(n,a),T=a.memoizedProps,X=xr(s,T),d.props=X,J=a.pendingProps,Y=d.context,q=s.contextType,k=ms,typeof q=="object"&&q!==null&&(k=en(q)),b=s.getDerivedStateFromProps,(q=typeof b=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(T!==J||Y!==k)&&bp(a,d,l,k),Na=!1,Y=a.memoizedState,d.state=Y,Wo(a,l,d,f),Fo();var F=a.memoizedState;T!==J||Y!==F||Na||n!==null&&n.dependencies!==null&&Iu(n.dependencies)?(typeof b=="function"&&(pf(a,s,b,l),F=a.memoizedState),(X=Na||wp(a,s,X,l,Y,F,k)||n!==null&&n.dependencies!==null&&Iu(n.dependencies))?(q||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(l,F,k),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(l,F,k)),typeof d.componentDidUpdate=="function"&&(a.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof d.componentDidUpdate!="function"||T===n.memoizedProps&&Y===n.memoizedState||(a.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&Y===n.memoizedState||(a.flags|=1024),a.memoizedProps=l,a.memoizedState=F),d.props=l,d.state=F,d.context=k,l=X):(typeof d.componentDidUpdate!="function"||T===n.memoizedProps&&Y===n.memoizedState||(a.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&Y===n.memoizedState||(a.flags|=1024),l=!1)}return d=l,Fu(n,a),l=(a.flags&128)!==0,d||l?(d=a.stateNode,s=l&&typeof s.getDerivedStateFromError!="function"?null:d.render(),a.flags|=1,n!==null&&l?(a.child=Lr(a,n.child,null,f),a.child=Lr(a,null,s,f)):tn(n,a,s,f),a.memoizedState=d.state,n=a.child):n=aa(n,a,f),n}function Pp(n,a,s,l){return Or(),a.flags|=256,tn(n,a,s,l),a.child}var vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wf(n){return{baseLanes:n,cachePool:I_()}}function bf(n,a,s){return n=n!==null?n.childLanes&~s:0,a&&(n|=Hn),n}function zp(n,a,s){var l=a.pendingProps,f=!1,d=(a.flags&128)!==0,T;if((T=d)||(T=n!==null&&n.memoizedState===null?!1:(Rt.current&2)!==0),T&&(f=!0,a.flags&=-129),T=(a.flags&32)!==0,a.flags&=-33,n===null){if(Ue){if(f?Va(a):La(),(n=ht)?(n=Wg(n,Xn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:Ia!==null?{id:Pi,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},s=y_(n),s.return=a,a.child=s,Jt=a,ht=null)):n=null,n===null)throw Oa(a);return rd(n)?a.lanes=32:a.lanes=536870912,null}var b=l.children;return l=l.fallback,f?(La(),f=a.mode,b=Wu({mode:"hidden",children:b},f),l=kr(l,f,s,null),b.return=a,l.return=a,b.sibling=l,a.child=b,l=a.child,l.memoizedState=wf(s),l.childLanes=bf(n,T,s),a.memoizedState=vf,$o(null,l)):(Va(a),Af(a,b))}var k=n.memoizedState;if(k!==null&&(b=k.dehydrated,b!==null)){if(d)a.flags&256?(Va(a),a.flags&=-257,a=Sf(n,a,s)):a.memoizedState!==null?(La(),a.child=n.child,a.flags|=128,a=null):(La(),b=l.fallback,f=a.mode,l=Wu({mode:"visible",children:l.children},f),b=kr(b,f,s,null),b.flags|=2,l.return=a,b.return=a,l.sibling=b,a.child=l,Lr(a,n.child,null,s),l=a.child,l.memoizedState=wf(s),l.childLanes=bf(n,T,s),a.memoizedState=vf,a=$o(null,l));else if(Va(a),rd(b)){if(T=b.nextSibling&&b.nextSibling.dataset,T)var q=T.dgst;T=q,l=Error(r(419)),l.stack="",l.digest=T,Uo({value:l,source:null,stack:null}),a=Sf(n,a,s)}else if(Ht||ys(n,a,s,!1),T=(s&n.childLanes)!==0,Ht||T){if(T=lt,T!==null&&(l=To(T,s),l!==0&&l!==k.retryLane))throw k.retryLane=l,Ir(n,l),An(T,n,l),Tf;ad(b)||nc(),a=Sf(n,a,s)}else ad(b)?(a.flags|=192,a.child=n.child,a=null):(n=k.treeContext,ht=Qn(b.nextSibling),Jt=a,Ue=!0,ka=null,Xn=!1,n!==null&&v_(a,n),a=Af(a,l.children),a.flags|=4096);return a}return f?(La(),b=l.fallback,f=a.mode,k=n.child,q=k.sibling,l=$i(k,{mode:"hidden",children:l.children}),l.subtreeFlags=k.subtreeFlags&65011712,q!==null?b=$i(q,b):(b=kr(b,f,s,null),b.flags|=2),b.return=a,l.return=a,l.sibling=b,a.child=l,$o(null,l),l=a.child,b=n.child.memoizedState,b===null?b=wf(s):(f=b.cachePool,f!==null?(k=Vt._currentValue,f=f.parent!==k?{parent:k,pool:k}:f):f=I_(),b={baseLanes:b.baseLanes|s,cachePool:f}),l.memoizedState=b,l.childLanes=bf(n,T,s),a.memoizedState=vf,$o(n.child,l)):(Va(a),s=n.child,n=s.sibling,s=$i(s,{mode:"visible",children:l.children}),s.return=a,s.sibling=null,n!==null&&(T=a.deletions,T===null?(a.deletions=[n],a.flags|=16):T.push(n)),a.child=s,a.memoizedState=null,s)}function Af(n,a){return a=Wu({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function Wu(n,a){return n=Cn(22,n,null,a),n.lanes=0,n}function Sf(n,a,s){return Lr(a,n.child,null,s),n=Af(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function Up(n,a,s){n.lanes|=a;var l=n.alternate;l!==null&&(l.lanes|=a),zh(n.return,a,s)}function Rf(n,a,s,l,f,d){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:f,treeForkCount:d}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=l,T.tail=s,T.tailMode=f,T.treeForkCount=d)}function Bp(n,a,s){var l=a.pendingProps,f=l.revealOrder,d=l.tail;l=l.children;var T=Rt.current,b=(T&2)!==0;if(b?(T=T&1|2,a.flags|=128):T&=1,se(Rt,T),tn(n,a,l,s),l=Ue?zo:0,!b&&n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Up(n,s,a);else if(n.tag===19)Up(n,s,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(s=a.child,f=null;s!==null;)n=s.alternate,n!==null&&Lu(n)===null&&(f=s),s=s.sibling;s=f,s===null?(f=a.child,a.child=null):(f=s.sibling,s.sibling=null),Rf(a,!1,f,s,d,l);break;case"backwards":case"unstable_legacy-backwards":for(s=null,f=a.child,a.child=null;f!==null;){if(n=f.alternate,n!==null&&Lu(n)===null){a.child=f;break}n=f.sibling,f.sibling=s,s=f,f=n}Rf(a,!0,s,null,d,l);break;case"together":Rf(a,!1,null,null,void 0,l);break;default:a.memoizedState=null}return a.child}function aa(n,a,s){if(n!==null&&(a.dependencies=n.dependencies),Pa|=a.lanes,(s&a.childLanes)===0)if(n!==null){if(ys(n,a,s,!1),(s&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(r(153));if(a.child!==null){for(n=a.child,s=$i(n,n.pendingProps),a.child=s,s.return=a;n.sibling!==null;)n=n.sibling,s=s.sibling=$i(n,n.pendingProps),s.return=a;s.sibling=null}return a.child}function If(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&Iu(n)))}function Av(n,a,s){switch(a.tag){case 3:Gt(a,a.stateNode.containerInfo),Da(a,Vt,n.memoizedState.cache),Or();break;case 27:case 5:ur(a);break;case 4:Gt(a,a.stateNode.containerInfo);break;case 10:Da(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Zh(a),null;break;case 13:var l=a.memoizedState;if(l!==null)return l.dehydrated!==null?(Va(a),a.flags|=128,null):(s&a.child.childLanes)!==0?zp(n,a,s):(Va(a),n=aa(n,a,s),n!==null?n.sibling:null);Va(a);break;case 19:var f=(n.flags&128)!==0;if(l=(s&a.childLanes)!==0,l||(ys(n,a,s,!1),l=(s&a.childLanes)!==0),f){if(l)return Bp(n,a,s);a.flags|=128}if(f=a.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),se(Rt,Rt.current),l)break;return null;case 22:return a.lanes=0,Mp(n,a,s,a.pendingProps);case 24:Da(a,Vt,n.memoizedState.cache)}return aa(n,a,s)}function Gp(n,a,s){if(n!==null)if(n.memoizedProps!==a.pendingProps)Ht=!0;else{if(!If(n,s)&&(a.flags&128)===0)return Ht=!1,Av(n,a,s);Ht=(n.flags&131072)!==0}else Ht=!1,Ue&&(a.flags&1048576)!==0&&E_(a,zo,a.index);switch(a.lanes=0,a.tag){case 16:e:{var l=a.pendingProps;if(n=Mr(a.elementType),a.type=n,typeof n=="function")Nh(n)?(l=xr(n,l),a.tag=1,a=xp(null,a,n,l,s)):(a.tag=0,a=Ef(null,a,n,l,s));else{if(n!=null){var f=n.$$typeof;if(f===ce){a.tag=11,a=Dp(null,a,n,l,s);break e}else if(f===O){a.tag=14,a=Np(null,a,n,l,s);break e}}throw a=_t(n)||n,Error(r(306,a,""))}}return a;case 0:return Ef(n,a,a.type,a.pendingProps,s);case 1:return l=a.type,f=xr(l,a.pendingProps),xp(n,a,l,f,s);case 3:e:{if(Gt(a,a.stateNode.containerInfo),n===null)throw Error(r(387));l=a.pendingProps;var d=a.memoizedState;f=d.element,Fh(n,a),Wo(a,l,null,s);var T=a.memoizedState;if(l=T.cache,Da(a,Vt,l),l!==d.cache&&Uh(a,[Vt],s,!0),Fo(),l=T.element,d.isDehydrated)if(d={element:l,isDehydrated:!1,cache:T.cache},a.updateQueue.baseState=d,a.memoizedState=d,a.flags&256){a=Pp(n,a,l,s);break e}else if(l!==f){f=jn(Error(r(424)),a),Uo(f),a=Pp(n,a,l,s);break e}else for(n=a.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,ht=Qn(n.firstChild),Jt=a,Ue=!0,ka=null,Xn=!0,s=M_(a,null,l,s),a.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Or(),l===f){a=aa(n,a,s);break e}tn(n,a,l,s)}a=a.child}return a;case 26:return Fu(n,a),n===null?(s=Jg(a.type,null,a.pendingProps,null))?a.memoizedState=s:Ue||(s=a.type,n=a.pendingProps,l=uc(Ne.current).createElement(s),l[Nt]=a,l[Ft]=n,nn(l,s,n),Ct(l),a.stateNode=l):a.memoizedState=Jg(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return ur(a),n===null&&Ue&&(l=a.stateNode=Qg(a.type,a.pendingProps,Ne.current),Jt=a,Xn=!0,f=ht,qa(a.type)?(sd=f,ht=Qn(l.firstChild)):ht=f),tn(n,a,a.pendingProps.children,s),Fu(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&Ue&&((f=l=ht)&&(l=ew(l,a.type,a.pendingProps,Xn),l!==null?(a.stateNode=l,Jt=a,ht=Qn(l.firstChild),Xn=!1,f=!0):f=!1),f||Oa(a)),ur(a),f=a.type,d=a.pendingProps,T=n!==null?n.memoizedProps:null,l=d.children,td(f,d)?l=null:T!==null&&td(f,T)&&(a.flags|=32),a.memoizedState!==null&&(f=Jh(n,a,_v,null,null,s),dl._currentValue=f),Fu(n,a),tn(n,a,l,s),a.child;case 6:return n===null&&Ue&&((n=s=ht)&&(s=tw(s,a.pendingProps,Xn),s!==null?(a.stateNode=s,Jt=a,ht=null,n=!0):n=!1),n||Oa(a)),null;case 13:return zp(n,a,s);case 4:return Gt(a,a.stateNode.containerInfo),l=a.pendingProps,n===null?a.child=Lr(a,null,l,s):tn(n,a,l,s),a.child;case 11:return Dp(n,a,a.type,a.pendingProps,s);case 7:return tn(n,a,a.pendingProps,s),a.child;case 8:return tn(n,a,a.pendingProps.children,s),a.child;case 12:return tn(n,a,a.pendingProps.children,s),a.child;case 10:return l=a.pendingProps,Da(a,a.type,l.value),tn(n,a,l.children,s),a.child;case 9:return f=a.type._context,l=a.pendingProps.children,Nr(a),f=en(f),l=l(f),a.flags|=1,tn(n,a,l,s),a.child;case 14:return Np(n,a,a.type,a.pendingProps,s);case 15:return Cp(n,a,a.type,a.pendingProps,s);case 19:return Bp(n,a,s);case 31:return bv(n,a,s);case 22:return Mp(n,a,s,a.pendingProps);case 24:return Nr(a),l=en(Vt),n===null?(f=qh(),f===null&&(f=lt,d=Bh(),f.pooledCache=d,d.refCount++,d!==null&&(f.pooledCacheLanes|=s),f=d),a.memoizedState={parent:l,cache:f},jh(a),Da(a,Vt,f)):((n.lanes&s)!==0&&(Fh(n,a),Wo(a,null,null,s),Fo()),f=n.memoizedState,d=a.memoizedState,f.parent!==l?(f={parent:l,cache:l},a.memoizedState=f,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=f),Da(a,Vt,l)):(l=d.cache,Da(a,Vt,l),l!==f.cache&&Uh(a,[Vt],s,!0))),tn(n,a,a.pendingProps.children,s),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function ra(n){n.flags|=4}function kf(n,a,s,l,f){if((a=(n.mode&32)!==0)&&(a=!1),a){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(_g())n.flags|=8192;else throw Vr=Nu,Yh}else n.flags&=-16777217}function qp(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!ay(a))if(_g())n.flags|=8192;else throw Vr=Nu,Yh}function Xu(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?eu():536870912,n.lanes|=a,Ds|=a)}function Jo(n,a){if(!Ue)switch(n.tailMode){case"hidden":a=n.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?n.tail=null:s.sibling=null;break;case"collapsed":s=n.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:l.sibling=null}}function ft(n){var a=n.alternate!==null&&n.alternate.child===n.child,s=0,l=0;if(a)for(var f=n.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags&65011712,l|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=l,n.childLanes=s,a}function Sv(n,a,s){var l=a.pendingProps;switch(Lh(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(a),null;case 1:return ft(a),null;case 3:return s=a.stateNode,l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),ta(Vt),pt(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(gs(a)?ra(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,xh())),ft(a),null;case 26:var f=a.type,d=a.memoizedState;return n===null?(ra(a),d!==null?(ft(a),qp(a,d)):(ft(a),kf(a,f,null,l,s))):d?d!==n.memoizedState?(ra(a),ft(a),qp(a,d)):(ft(a),a.flags&=-16777217):(n=n.memoizedProps,n!==l&&ra(a),ft(a),kf(a,f,n,l,s)),null;case 27:if(Kr(a),s=Ne.current,f=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==l&&ra(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return ft(a),null}n=fe.current,gs(a)?w_(a):(n=Qg(f,l,s),a.stateNode=n,ra(a))}return ft(a),null;case 5:if(Kr(a),f=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==l&&ra(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return ft(a),null}if(d=fe.current,gs(a))w_(a);else{var T=uc(Ne.current);switch(d){case 1:d=T.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:d=T.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":d=T.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":d=T.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":d=T.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof l.is=="string"?T.createElement("select",{is:l.is}):T.createElement("select"),l.multiple?d.multiple=!0:l.size&&(d.size=l.size);break;default:d=typeof l.is=="string"?T.createElement(f,{is:l.is}):T.createElement(f)}}d[Nt]=a,d[Ft]=l;e:for(T=a.child;T!==null;){if(T.tag===5||T.tag===6)d.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===a)break e;for(;T.sibling===null;){if(T.return===null||T.return===a)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}a.stateNode=d;e:switch(nn(d,f,l),f){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&ra(a)}}return ft(a),kf(a,a.type,n===null?null:n.memoizedProps,a.pendingProps,s),null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==l&&ra(a);else{if(typeof l!="string"&&a.stateNode===null)throw Error(r(166));if(n=Ne.current,gs(a)){if(n=a.stateNode,s=a.memoizedProps,l=null,f=Jt,f!==null)switch(f.tag){case 27:case 5:l=f.memoizedProps}n[Nt]=a,n=!!(n.nodeValue===s||l!==null&&l.suppressHydrationWarning===!0||zg(n.nodeValue,s)),n||Oa(a,!0)}else n=uc(n).createTextNode(l),n[Nt]=a,a.stateNode=n}return ft(a),null;case 31:if(s=a.memoizedState,n===null||n.memoizedState!==null){if(l=gs(a),s!==null){if(n===null){if(!l)throw Error(r(318));if(n=a.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Nt]=a}else Or(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ft(a),n=!1}else s=xh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=s),n=!0;if(!n)return a.flags&256?(Vn(a),a):(Vn(a),null);if((a.flags&128)!==0)throw Error(r(558))}return ft(a),null;case 13:if(l=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=gs(a),l!==null&&l.dehydrated!==null){if(n===null){if(!f)throw Error(r(318));if(f=a.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Nt]=a}else Or(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ft(a),f=!1}else f=xh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return a.flags&256?(Vn(a),a):(Vn(a),null)}return Vn(a),(a.flags&128)!==0?(a.lanes=s,a):(s=l!==null,n=n!==null&&n.memoizedState!==null,s&&(l=a.child,f=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(f=l.alternate.memoizedState.cachePool.pool),d=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),d!==f&&(l.flags|=2048)),s!==n&&s&&(a.child.flags|=8192),Xu(a,a.updateQueue),ft(a),null);case 4:return pt(),n===null&&Qf(a.stateNode.containerInfo),ft(a),null;case 10:return ta(a.type),ft(a),null;case 19:if(te(Rt),l=a.memoizedState,l===null)return ft(a),null;if(f=(a.flags&128)!==0,d=l.rendering,d===null)if(f)Jo(l,!1);else{if(wt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(d=Lu(n),d!==null){for(a.flags|=128,Jo(l,!1),n=d.updateQueue,a.updateQueue=n,Xu(a,n),a.subtreeFlags=0,n=s,s=a.child;s!==null;)g_(s,n),s=s.sibling;return se(Rt,Rt.current&1|2),Ue&&Ji(a,l.treeForkCount),a.child}n=n.sibling}l.tail!==null&&_n()>Ju&&(a.flags|=128,f=!0,Jo(l,!1),a.lanes=4194304)}else{if(!f)if(n=Lu(d),n!==null){if(a.flags|=128,f=!0,n=n.updateQueue,a.updateQueue=n,Xu(a,n),Jo(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!Ue)return ft(a),null}else 2*_n()-l.renderingStartTime>Ju&&s!==536870912&&(a.flags|=128,f=!0,Jo(l,!1),a.lanes=4194304);l.isBackwards?(d.sibling=a.child,a.child=d):(n=l.last,n!==null?n.sibling=d:a.child=d,l.last=d)}return l.tail!==null?(n=l.tail,l.rendering=n,l.tail=n.sibling,l.renderingStartTime=_n(),n.sibling=null,s=Rt.current,se(Rt,f?s&1|2:s&1),Ue&&Ji(a,l.treeForkCount),n):(ft(a),null);case 22:case 23:return Vn(a),Qh(),l=a.memoizedState!==null,n!==null?n.memoizedState!==null!==l&&(a.flags|=8192):l&&(a.flags|=8192),l?(s&536870912)!==0&&(a.flags&128)===0&&(ft(a),a.subtreeFlags&6&&(a.flags|=8192)):ft(a),s=a.updateQueue,s!==null&&Xu(a,s.retryQueue),s=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(s=n.memoizedState.cachePool.pool),l=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),l!==s&&(a.flags|=2048),n!==null&&te(Cr),null;case 24:return s=null,n!==null&&(s=n.memoizedState.cache),a.memoizedState.cache!==s&&(a.flags|=2048),ta(Vt),ft(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function Rv(n,a){switch(Lh(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return ta(Vt),pt(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return Kr(a),null;case 31:if(a.memoizedState!==null){if(Vn(a),a.alternate===null)throw Error(r(340));Or()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 13:if(Vn(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(r(340));Or()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return te(Rt),null;case 4:return pt(),null;case 10:return ta(a.type),null;case 22:case 23:return Vn(a),Qh(),n!==null&&te(Cr),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return ta(Vt),null;case 25:return null;default:return null}}function Yp(n,a){switch(Lh(a),a.tag){case 3:ta(Vt),pt();break;case 26:case 27:case 5:Kr(a);break;case 4:pt();break;case 31:a.memoizedState!==null&&Vn(a);break;case 13:Vn(a);break;case 19:te(Rt);break;case 10:ta(a.type);break;case 22:case 23:Vn(a),Qh(),n!==null&&te(Cr);break;case 24:ta(Vt)}}function el(n,a){try{var s=a.updateQueue,l=s!==null?s.lastEffect:null;if(l!==null){var f=l.next;s=f;do{if((s.tag&n)===n){l=void 0;var d=s.create,T=s.inst;l=d(),T.destroy=l}s=s.next}while(s!==f)}}catch(b){nt(a,a.return,b)}}function Ha(n,a,s){try{var l=a.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var d=f.next;l=d;do{if((l.tag&n)===n){var T=l.inst,b=T.destroy;if(b!==void 0){T.destroy=void 0,f=a;var k=s,q=b;try{q()}catch(X){nt(f,k,X)}}}l=l.next}while(l!==d)}}catch(X){nt(a,a.return,X)}}function jp(n){var a=n.updateQueue;if(a!==null){var s=n.stateNode;try{L_(a,s)}catch(l){nt(n,n.return,l)}}}function Fp(n,a,s){s.props=xr(n.type,n.memoizedProps),s.state=n.memoizedState;try{s.componentWillUnmount()}catch(l){nt(n,a,l)}}function tl(n,a){try{var s=n.ref;if(s!==null){switch(n.tag){case 26:case 27:case 5:var l=n.stateNode;break;case 30:l=n.stateNode;break;default:l=n.stateNode}typeof s=="function"?n.refCleanup=s(l):s.current=l}}catch(f){nt(n,a,f)}}function Ui(n,a){var s=n.ref,l=n.refCleanup;if(s!==null)if(typeof l=="function")try{l()}catch(f){nt(n,a,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(f){nt(n,a,f)}else s.current=null}function Wp(n){var a=n.type,s=n.memoizedProps,l=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":s.autoFocus&&l.focus();break e;case"img":s.src?l.src=s.src:s.srcSet&&(l.srcset=s.srcSet)}}catch(f){nt(n,n.return,f)}}function Of(n,a,s){try{var l=n.stateNode;Xv(l,n.type,s,a),l[Ft]=a}catch(f){nt(n,n.return,f)}}function Xp(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&qa(n.type)||n.tag===4}function Df(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Xp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&qa(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Nf(n,a,s){var l=n.tag;if(l===5||l===6)n=n.stateNode,a?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(n,a):(a=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.appendChild(n),s=s._reactRootContainer,s!=null||a.onclick!==null||(a.onclick=oi));else if(l!==4&&(l===27&&qa(n.type)&&(s=n.stateNode,a=null),n=n.child,n!==null))for(Nf(n,a,s),n=n.sibling;n!==null;)Nf(n,a,s),n=n.sibling}function Ku(n,a,s){var l=n.tag;if(l===5||l===6)n=n.stateNode,a?s.insertBefore(n,a):s.appendChild(n);else if(l!==4&&(l===27&&qa(n.type)&&(s=n.stateNode),n=n.child,n!==null))for(Ku(n,a,s),n=n.sibling;n!==null;)Ku(n,a,s),n=n.sibling}function Kp(n){var a=n.stateNode,s=n.memoizedProps;try{for(var l=n.type,f=a.attributes;f.length;)a.removeAttributeNode(f[0]);nn(a,l,s),a[Nt]=n,a[Ft]=s}catch(d){nt(n,n.return,d)}}var sa=!1,xt=!1,Cf=!1,Qp=typeof WeakSet=="function"?WeakSet:Set,Xt=null;function Iv(n,a){if(n=n.containerInfo,Jf=pc,n=l_(n),Ah(n)){if("selectionStart"in n)var s={start:n.selectionStart,end:n.selectionEnd};else e:{s=(s=n.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var f=l.anchorOffset,d=l.focusNode;l=l.focusOffset;try{s.nodeType,d.nodeType}catch{s=null;break e}var T=0,b=-1,k=-1,q=0,X=0,J=n,Y=null;t:for(;;){for(var F;J!==s||f!==0&&J.nodeType!==3||(b=T+f),J!==d||l!==0&&J.nodeType!==3||(k=T+l),J.nodeType===3&&(T+=J.nodeValue.length),(F=J.firstChild)!==null;)Y=J,J=F;for(;;){if(J===n)break t;if(Y===s&&++q===f&&(b=T),Y===d&&++X===l&&(k=T),(F=J.nextSibling)!==null)break;J=Y,Y=J.parentNode}J=F}s=b===-1||k===-1?null:{start:b,end:k}}else s=null}s=s||{start:0,end:0}}else s=null;for(ed={focusedElem:n,selectionRange:s},pc=!1,Xt=a;Xt!==null;)if(a=Xt,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Xt=n;else for(;Xt!==null;){switch(a=Xt,d=a.alternate,n=a.flags,a.tag){case 0:if((n&4)!==0&&(n=a.updateQueue,n=n!==null?n.events:null,n!==null))for(s=0;s<n.length;s++)f=n[s],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&d!==null){n=void 0,s=a,f=d.memoizedProps,d=d.memoizedState,l=s.stateNode;try{var de=xr(s.type,f);n=l.getSnapshotBeforeUpdate(de,d),l.__reactInternalSnapshotBeforeUpdate=n}catch(Ee){nt(s,s.return,Ee)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,s=n.nodeType,s===9)id(n);else if(s===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":id(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=a.sibling,n!==null){n.return=a.return,Xt=n;break}Xt=a.return}}function Zp(n,a,s){var l=s.flags;switch(s.tag){case 0:case 11:case 15:la(n,s),l&4&&el(5,s);break;case 1:if(la(n,s),l&4)if(n=s.stateNode,a===null)try{n.componentDidMount()}catch(T){nt(s,s.return,T)}else{var f=xr(s.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(f,a,n.__reactInternalSnapshotBeforeUpdate)}catch(T){nt(s,s.return,T)}}l&64&&jp(s),l&512&&tl(s,s.return);break;case 3:if(la(n,s),l&64&&(n=s.updateQueue,n!==null)){if(a=null,s.child!==null)switch(s.child.tag){case 27:case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}try{L_(n,a)}catch(T){nt(s,s.return,T)}}break;case 27:a===null&&l&4&&Kp(s);case 26:case 5:la(n,s),a===null&&l&4&&Wp(s),l&512&&tl(s,s.return);break;case 12:la(n,s);break;case 31:la(n,s),l&4&&eg(n,s);break;case 13:la(n,s),l&4&&tg(n,s),l&64&&(n=s.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(s=Hv.bind(null,s),nw(n,s))));break;case 22:if(l=s.memoizedState!==null||sa,!l){a=a!==null&&a.memoizedState!==null||xt,f=sa;var d=xt;sa=l,(xt=a)&&!d?ua(n,s,(s.subtreeFlags&8772)!==0):la(n,s),sa=f,xt=d}break;case 30:break;default:la(n,s)}}function $p(n){var a=n.alternate;a!==null&&(n.alternate=null,$p(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&es(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var yt=null,En=!1;function oa(n,a,s){for(s=s.child;s!==null;)Jp(n,a,s),s=s.sibling}function Jp(n,a,s){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(ii,s)}catch{}switch(s.tag){case 26:xt||Ui(s,a),oa(n,a,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:xt||Ui(s,a);var l=yt,f=En;qa(s.type)&&(yt=s.stateNode,En=!1),oa(n,a,s),cl(s.stateNode),yt=l,En=f;break;case 5:xt||Ui(s,a);case 6:if(l=yt,f=En,yt=null,oa(n,a,s),yt=l,En=f,yt!==null)if(En)try{(yt.nodeType===9?yt.body:yt.nodeName==="HTML"?yt.ownerDocument.body:yt).removeChild(s.stateNode)}catch(d){nt(s,a,d)}else try{yt.removeChild(s.stateNode)}catch(d){nt(s,a,d)}break;case 18:yt!==null&&(En?(n=yt,jg(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,s.stateNode),Ps(n)):jg(yt,s.stateNode));break;case 4:l=yt,f=En,yt=s.stateNode.containerInfo,En=!0,oa(n,a,s),yt=l,En=f;break;case 0:case 11:case 14:case 15:Ha(2,s,a),xt||Ha(4,s,a),oa(n,a,s);break;case 1:xt||(Ui(s,a),l=s.stateNode,typeof l.componentWillUnmount=="function"&&Fp(s,a,l)),oa(n,a,s);break;case 21:oa(n,a,s);break;case 22:xt=(l=xt)||s.memoizedState!==null,oa(n,a,s),xt=l;break;default:oa(n,a,s)}}function eg(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Ps(n)}catch(s){nt(a,a.return,s)}}}function tg(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Ps(n)}catch(s){nt(a,a.return,s)}}function kv(n){switch(n.tag){case 31:case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new Qp),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new Qp),a;default:throw Error(r(435,n.tag))}}function Qu(n,a){var s=kv(n);a.forEach(function(l){if(!s.has(l)){s.add(l);var f=xv.bind(null,n,l);l.then(f,f)}})}function vn(n,a){var s=a.deletions;if(s!==null)for(var l=0;l<s.length;l++){var f=s[l],d=n,T=a,b=T;e:for(;b!==null;){switch(b.tag){case 27:if(qa(b.type)){yt=b.stateNode,En=!1;break e}break;case 5:yt=b.stateNode,En=!1;break e;case 3:case 4:yt=b.stateNode.containerInfo,En=!0;break e}b=b.return}if(yt===null)throw Error(r(160));Jp(d,T,f),yt=null,En=!1,d=f.alternate,d!==null&&(d.return=null),f.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)ng(a,n),a=a.sibling}var di=null;function ng(n,a){var s=n.alternate,l=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:vn(a,n),wn(n),l&4&&(Ha(3,n,n.return),el(3,n),Ha(5,n,n.return));break;case 1:vn(a,n),wn(n),l&512&&(xt||s===null||Ui(s,s.return)),l&64&&sa&&(n=n.updateQueue,n!==null&&(l=n.callbacks,l!==null&&(s=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=s===null?l:s.concat(l))));break;case 26:var f=di;if(vn(a,n),wn(n),l&512&&(xt||s===null||Ui(s,s.return)),l&4){var d=s!==null?s.memoizedState:null;if(l=n.memoizedState,s===null)if(l===null)if(n.stateNode===null){e:{l=n.type,s=n.memoizedProps,f=f.ownerDocument||f;t:switch(l){case"title":d=f.getElementsByTagName("title")[0],(!d||d[Ri]||d[Nt]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=f.createElement(l),f.head.insertBefore(d,f.querySelector("head > title"))),nn(d,l,s),d[Nt]=n,Ct(d),l=d;break e;case"link":var T=ny("link","href",f).get(l+(s.href||""));if(T){for(var b=0;b<T.length;b++)if(d=T[b],d.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&d.getAttribute("rel")===(s.rel==null?null:s.rel)&&d.getAttribute("title")===(s.title==null?null:s.title)&&d.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){T.splice(b,1);break t}}d=f.createElement(l),nn(d,l,s),f.head.appendChild(d);break;case"meta":if(T=ny("meta","content",f).get(l+(s.content||""))){for(b=0;b<T.length;b++)if(d=T[b],d.getAttribute("content")===(s.content==null?null:""+s.content)&&d.getAttribute("name")===(s.name==null?null:s.name)&&d.getAttribute("property")===(s.property==null?null:s.property)&&d.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&d.getAttribute("charset")===(s.charSet==null?null:s.charSet)){T.splice(b,1);break t}}d=f.createElement(l),nn(d,l,s),f.head.appendChild(d);break;default:throw Error(r(468,l))}d[Nt]=n,Ct(d),l=d}n.stateNode=l}else iy(f,n.type,n.stateNode);else n.stateNode=ty(f,l,n.memoizedProps);else d!==l?(d===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):d.count--,l===null?iy(f,n.type,n.stateNode):ty(f,l,n.memoizedProps)):l===null&&n.stateNode!==null&&Of(n,n.memoizedProps,s.memoizedProps)}break;case 27:vn(a,n),wn(n),l&512&&(xt||s===null||Ui(s,s.return)),s!==null&&l&4&&Of(n,n.memoizedProps,s.memoizedProps);break;case 5:if(vn(a,n),wn(n),l&512&&(xt||s===null||Ui(s,s.return)),n.flags&32){f=n.stateNode;try{Tn(f,"")}catch(de){nt(n,n.return,de)}}l&4&&n.stateNode!=null&&(f=n.memoizedProps,Of(n,f,s!==null?s.memoizedProps:f)),l&1024&&(Cf=!0);break;case 6:if(vn(a,n),wn(n),l&4){if(n.stateNode===null)throw Error(r(162));l=n.memoizedProps,s=n.stateNode;try{s.nodeValue=l}catch(de){nt(n,n.return,de)}}break;case 3:if(fc=null,f=di,di=cc(a.containerInfo),vn(a,n),di=f,wn(n),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Ps(a.containerInfo)}catch(de){nt(n,n.return,de)}Cf&&(Cf=!1,ig(n));break;case 4:l=di,di=cc(n.stateNode.containerInfo),vn(a,n),wn(n),di=l;break;case 12:vn(a,n),wn(n);break;case 31:vn(a,n),wn(n),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,Qu(n,l)));break;case 13:vn(a,n),wn(n),n.child.flags&8192&&n.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&($u=_n()),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,Qu(n,l)));break;case 22:f=n.memoizedState!==null;var k=s!==null&&s.memoizedState!==null,q=sa,X=xt;if(sa=q||f,xt=X||k,vn(a,n),xt=X,sa=q,wn(n),l&8192)e:for(a=n.stateNode,a._visibility=f?a._visibility&-2:a._visibility|1,f&&(s===null||k||sa||xt||Pr(n)),s=null,a=n;;){if(a.tag===5||a.tag===26){if(s===null){k=s=a;try{if(d=k.stateNode,f)T=d.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{b=k.stateNode;var J=k.memoizedProps.style,Y=J!=null&&J.hasOwnProperty("display")?J.display:null;b.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(de){nt(k,k.return,de)}}}else if(a.tag===6){if(s===null){k=a;try{k.stateNode.nodeValue=f?"":k.memoizedProps}catch(de){nt(k,k.return,de)}}}else if(a.tag===18){if(s===null){k=a;try{var F=k.stateNode;f?Fg(F,!0):Fg(k.stateNode,!1)}catch(de){nt(k,k.return,de)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;s===a&&(s=null),a=a.return}s===a&&(s=null),a.sibling.return=a.return,a=a.sibling}l&4&&(l=n.updateQueue,l!==null&&(s=l.retryQueue,s!==null&&(l.retryQueue=null,Qu(n,s))));break;case 19:vn(a,n),wn(n),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,Qu(n,l)));break;case 30:break;case 21:break;default:vn(a,n),wn(n)}}function wn(n){var a=n.flags;if(a&2){try{for(var s,l=n.return;l!==null;){if(Xp(l)){s=l;break}l=l.return}if(s==null)throw Error(r(160));switch(s.tag){case 27:var f=s.stateNode,d=Df(n);Ku(n,d,f);break;case 5:var T=s.stateNode;s.flags&32&&(Tn(T,""),s.flags&=-33);var b=Df(n);Ku(n,b,T);break;case 3:case 4:var k=s.stateNode.containerInfo,q=Df(n);Nf(n,q,k);break;default:throw Error(r(161))}}catch(X){nt(n,n.return,X)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function ig(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;ig(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function la(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Zp(n,a.alternate,a),a=a.sibling}function Pr(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:Ha(4,a,a.return),Pr(a);break;case 1:Ui(a,a.return);var s=a.stateNode;typeof s.componentWillUnmount=="function"&&Fp(a,a.return,s),Pr(a);break;case 27:cl(a.stateNode);case 26:case 5:Ui(a,a.return),Pr(a);break;case 22:a.memoizedState===null&&Pr(a);break;case 30:Pr(a);break;default:Pr(a)}n=n.sibling}}function ua(n,a,s){for(s=s&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var l=a.alternate,f=n,d=a,T=d.flags;switch(d.tag){case 0:case 11:case 15:ua(f,d,s),el(4,d);break;case 1:if(ua(f,d,s),l=d,f=l.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(q){nt(l,l.return,q)}if(l=d,f=l.updateQueue,f!==null){var b=l.stateNode;try{var k=f.shared.hiddenCallbacks;if(k!==null)for(f.shared.hiddenCallbacks=null,f=0;f<k.length;f++)V_(k[f],b)}catch(q){nt(l,l.return,q)}}s&&T&64&&jp(d),tl(d,d.return);break;case 27:Kp(d);case 26:case 5:ua(f,d,s),s&&l===null&&T&4&&Wp(d),tl(d,d.return);break;case 12:ua(f,d,s);break;case 31:ua(f,d,s),s&&T&4&&eg(f,d);break;case 13:ua(f,d,s),s&&T&4&&tg(f,d);break;case 22:d.memoizedState===null&&ua(f,d,s),tl(d,d.return);break;case 30:break;default:ua(f,d,s)}a=a.sibling}}function Mf(n,a){var s=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(s=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==s&&(n!=null&&n.refCount++,s!=null&&Bo(s))}function Vf(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Bo(n))}function mi(n,a,s,l){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ag(n,a,s,l),a=a.sibling}function ag(n,a,s,l){var f=a.flags;switch(a.tag){case 0:case 11:case 15:mi(n,a,s,l),f&2048&&el(9,a);break;case 1:mi(n,a,s,l);break;case 3:mi(n,a,s,l),f&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Bo(n)));break;case 12:if(f&2048){mi(n,a,s,l),n=a.stateNode;try{var d=a.memoizedProps,T=d.id,b=d.onPostCommit;typeof b=="function"&&b(T,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(k){nt(a,a.return,k)}}else mi(n,a,s,l);break;case 31:mi(n,a,s,l);break;case 13:mi(n,a,s,l);break;case 23:break;case 22:d=a.stateNode,T=a.alternate,a.memoizedState!==null?d._visibility&2?mi(n,a,s,l):nl(n,a):d._visibility&2?mi(n,a,s,l):(d._visibility|=2,Is(n,a,s,l,(a.subtreeFlags&10256)!==0||!1)),f&2048&&Mf(T,a);break;case 24:mi(n,a,s,l),f&2048&&Vf(a.alternate,a);break;default:mi(n,a,s,l)}}function Is(n,a,s,l,f){for(f=f&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var d=n,T=a,b=s,k=l,q=T.flags;switch(T.tag){case 0:case 11:case 15:Is(d,T,b,k,f),el(8,T);break;case 23:break;case 22:var X=T.stateNode;T.memoizedState!==null?X._visibility&2?Is(d,T,b,k,f):nl(d,T):(X._visibility|=2,Is(d,T,b,k,f)),f&&q&2048&&Mf(T.alternate,T);break;case 24:Is(d,T,b,k,f),f&&q&2048&&Vf(T.alternate,T);break;default:Is(d,T,b,k,f)}a=a.sibling}}function nl(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var s=n,l=a,f=l.flags;switch(l.tag){case 22:nl(s,l),f&2048&&Mf(l.alternate,l);break;case 24:nl(s,l),f&2048&&Vf(l.alternate,l);break;default:nl(s,l)}a=a.sibling}}var il=8192;function ks(n,a,s){if(n.subtreeFlags&il)for(n=n.child;n!==null;)rg(n,a,s),n=n.sibling}function rg(n,a,s){switch(n.tag){case 26:ks(n,a,s),n.flags&il&&n.memoizedState!==null&&mw(s,di,n.memoizedState,n.memoizedProps);break;case 5:ks(n,a,s);break;case 3:case 4:var l=di;di=cc(n.stateNode.containerInfo),ks(n,a,s),di=l;break;case 22:n.memoizedState===null&&(l=n.alternate,l!==null&&l.memoizedState!==null?(l=il,il=16777216,ks(n,a,s),il=l):ks(n,a,s));break;default:ks(n,a,s)}}function sg(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function al(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];Xt=l,lg(l,n)}sg(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)og(n),n=n.sibling}function og(n){switch(n.tag){case 0:case 11:case 15:al(n),n.flags&2048&&Ha(9,n,n.return);break;case 3:al(n);break;case 12:al(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,Zu(n)):al(n);break;default:al(n)}}function Zu(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];Xt=l,lg(l,n)}sg(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:Ha(8,a,a.return),Zu(a);break;case 22:s=a.stateNode,s._visibility&2&&(s._visibility&=-3,Zu(a));break;default:Zu(a)}n=n.sibling}}function lg(n,a){for(;Xt!==null;){var s=Xt;switch(s.tag){case 0:case 11:case 15:Ha(8,s,a);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var l=s.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Bo(s.memoizedState.cache)}if(l=s.child,l!==null)l.return=s,Xt=l;else e:for(s=n;Xt!==null;){l=Xt;var f=l.sibling,d=l.return;if($p(l),l===s){Xt=null;break e}if(f!==null){f.return=d,Xt=f;break e}Xt=d}}}var Ov={getCacheForType:function(n){var a=en(Vt),s=a.data.get(n);return s===void 0&&(s=n(),a.data.set(n,s)),s},cacheSignal:function(){return en(Vt).controller.signal}},Dv=typeof WeakMap=="function"?WeakMap:Map,Ze=0,lt=null,Me=null,Le=0,tt=0,Ln=null,xa=!1,Os=!1,Lf=!1,ca=0,wt=0,Pa=0,zr=0,Hf=0,Hn=0,Ds=0,rl=null,bn=null,xf=!1,$u=0,ug=0,Ju=1/0,ec=null,za=null,Yt=0,Ua=null,Ns=null,ha=0,Pf=0,zf=null,cg=null,sl=0,Uf=null;function xn(){return(Ze&2)!==0&&Le!==0?Le&-Le:K.T!==null?Ff():tu()}function hg(){if(Hn===0)if((Le&536870912)===0||Ue){var n=fr;fr<<=1,(fr&3932160)===0&&(fr=262144),Hn=n}else Hn=536870912;return n=Mn.current,n!==null&&(n.flags|=32),Hn}function An(n,a,s){(n===lt&&(tt===2||tt===9)||n.cancelPendingCommit!==null)&&(Cs(n,0),Ba(n,Le,Hn,!1)),dr(n,s),((Ze&2)===0||n!==lt)&&(n===lt&&((Ze&2)===0&&(zr|=s),wt===4&&Ba(n,Le,Hn,!1)),Bi(n))}function fg(n,a,s){if((Ze&6)!==0)throw Error(r(327));var l=!s&&(a&127)===0&&(a&n.expiredLanes)===0||ai(n,a),f=l?Mv(n,a):Gf(n,a,!0),d=l;do{if(f===0){Os&&!l&&Ba(n,a,0,!1);break}else{if(s=n.current.alternate,d&&!Nv(s)){f=Gf(n,a,!1),d=!1;continue}if(f===2){if(d=a,n.errorRecoveryDisabledLanes&d)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){a=T;e:{var b=n;f=rl;var k=b.current.memoizedState.isDehydrated;if(k&&(Cs(b,T).flags|=256),T=Gf(b,T,!1),T!==2){if(Lf&&!k){b.errorRecoveryDisabledLanes|=d,zr|=d,f=4;break e}d=bn,bn=f,d!==null&&(bn===null?bn=d:bn.push.apply(bn,d))}f=T}if(d=!1,f!==2)continue}}if(f===1){Cs(n,0),Ba(n,a,0,!0);break}e:{switch(l=n,d=f,d){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:Ba(l,a,Hn,!xa);break e;case 2:bn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(f=$u+300-_n(),10<f)){if(Ba(l,a,Hn,!xa),bi(l,0,!0)!==0)break e;ha=a,l.timeoutHandle=qg(dg.bind(null,l,s,bn,ec,xf,a,Hn,zr,Ds,xa,d,"Throttled",-0,0),f);break e}dg(l,s,bn,ec,xf,a,Hn,zr,Ds,xa,d,null,-0,0)}}break}while(!0);Bi(n)}function dg(n,a,s,l,f,d,T,b,k,q,X,J,Y,F){if(n.timeoutHandle=-1,J=a.subtreeFlags,J&8192||(J&16785408)===16785408){J={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:oi},rg(a,d,J);var de=(d&62914560)===d?$u-_n():(d&4194048)===d?ug-_n():0;if(de=_w(J,de),de!==null){ha=d,n.cancelPendingCommit=de(vg.bind(null,n,a,d,s,l,f,T,b,k,X,J,null,Y,F)),Ba(n,d,T,!q);return}}vg(n,a,d,s,l,f,T,b,k)}function Nv(n){for(var a=n;;){var s=a.tag;if((s===0||s===11||s===15)&&a.flags&16384&&(s=a.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var l=0;l<s.length;l++){var f=s[l],d=f.getSnapshot;f=f.value;try{if(!Nn(d(),f))return!1}catch{return!1}}if(s=a.child,a.subtreeFlags&16384&&s!==null)s.return=a,a=s;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ba(n,a,s,l){a&=~Hf,a&=~zr,n.suspendedLanes|=a,n.pingedLanes&=~a,l&&(n.warmLanes|=a),l=n.expirationTimes;for(var f=a;0<f;){var d=31-At(f),T=1<<d;l[d]=-1,f&=~T}s!==0&&mr(n,s,a)}function tc(){return(Ze&6)===0?(ol(0),!1):!0}function Bf(){if(Me!==null){if(tt===0)var n=Me.return;else n=Me,ea=Dr=null,nf(n),ws=null,qo=0,n=Me;for(;n!==null;)Yp(n.alternate,n),n=n.return;Me=null}}function Cs(n,a){var s=n.timeoutHandle;s!==-1&&(n.timeoutHandle=-1,Zv(s)),s=n.cancelPendingCommit,s!==null&&(n.cancelPendingCommit=null,s()),ha=0,Bf(),lt=n,Me=s=$i(n.current,null),Le=a,tt=0,Ln=null,xa=!1,Os=ai(n,a),Lf=!1,Ds=Hn=Hf=zr=Pa=wt=0,bn=rl=null,xf=!1,(a&8)!==0&&(a|=a&32);var l=n.entangledLanes;if(l!==0)for(n=n.entanglements,l&=a;0<l;){var f=31-At(l),d=1<<f;a|=n[f],l&=~d}return ca=a,wu(),s}function mg(n,a){Oe=null,K.H=Zo,a===vs||a===Du?(a=D_(),tt=3):a===Yh?(a=D_(),tt=4):tt=a===Tf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ln=a,Me===null&&(wt=1,Yu(n,jn(a,n.current)))}function _g(){var n=Mn.current;return n===null?!0:(Le&4194048)===Le?Kn===null:(Le&62914560)===Le||(Le&536870912)!==0?n===Kn:!1}function pg(){var n=K.H;return K.H=Zo,n===null?Zo:n}function gg(){var n=K.A;return K.A=Ov,n}function nc(){wt=4,xa||(Le&4194048)!==Le&&Mn.current!==null||(Os=!0),(Pa&134217727)===0&&(zr&134217727)===0||lt===null||Ba(lt,Le,Hn,!1)}function Gf(n,a,s){var l=Ze;Ze|=2;var f=pg(),d=gg();(lt!==n||Le!==a)&&(ec=null,Cs(n,a)),a=!1;var T=wt;e:do try{if(tt!==0&&Me!==null){var b=Me,k=Ln;switch(tt){case 8:Bf(),T=6;break e;case 3:case 2:case 9:case 6:Mn.current===null&&(a=!0);var q=tt;if(tt=0,Ln=null,Ms(n,b,k,q),s&&Os){T=0;break e}break;default:q=tt,tt=0,Ln=null,Ms(n,b,k,q)}}Cv(),T=wt;break}catch(X){mg(n,X)}while(!0);return a&&n.shellSuspendCounter++,ea=Dr=null,Ze=l,K.H=f,K.A=d,Me===null&&(lt=null,Le=0,wu()),T}function Cv(){for(;Me!==null;)yg(Me)}function Mv(n,a){var s=Ze;Ze|=2;var l=pg(),f=gg();lt!==n||Le!==a?(ec=null,Ju=_n()+500,Cs(n,a)):Os=ai(n,a);e:do try{if(tt!==0&&Me!==null){a=Me;var d=Ln;t:switch(tt){case 1:tt=0,Ln=null,Ms(n,a,d,1);break;case 2:case 9:if(k_(d)){tt=0,Ln=null,Tg(a);break}a=function(){tt!==2&&tt!==9||lt!==n||(tt=7),Bi(n)},d.then(a,a);break e;case 3:tt=7;break e;case 4:tt=5;break e;case 7:k_(d)?(tt=0,Ln=null,Tg(a)):(tt=0,Ln=null,Ms(n,a,d,7));break;case 5:var T=null;switch(Me.tag){case 26:T=Me.memoizedState;case 5:case 27:var b=Me;if(T?ay(T):b.stateNode.complete){tt=0,Ln=null;var k=b.sibling;if(k!==null)Me=k;else{var q=b.return;q!==null?(Me=q,ic(q)):Me=null}break t}}tt=0,Ln=null,Ms(n,a,d,5);break;case 6:tt=0,Ln=null,Ms(n,a,d,6);break;case 8:Bf(),wt=6;break e;default:throw Error(r(462))}}Vv();break}catch(X){mg(n,X)}while(!0);return ea=Dr=null,K.H=l,K.A=f,Ze=s,Me!==null?0:(lt=null,Le=0,wu(),wt)}function Vv(){for(;Me!==null&&!gh();)yg(Me)}function yg(n){var a=Gp(n.alternate,n,ca);n.memoizedProps=n.pendingProps,a===null?ic(n):Me=a}function Tg(n){var a=n,s=a.alternate;switch(a.tag){case 15:case 0:a=Hp(s,a,a.pendingProps,a.type,void 0,Le);break;case 11:a=Hp(s,a,a.pendingProps,a.type.render,a.ref,Le);break;case 5:nf(a);default:Yp(s,a),a=Me=g_(a,ca),a=Gp(s,a,ca)}n.memoizedProps=n.pendingProps,a===null?ic(n):Me=a}function Ms(n,a,s,l){ea=Dr=null,nf(a),ws=null,qo=0;var f=a.return;try{if(wv(n,f,a,s,Le)){wt=1,Yu(n,jn(s,n.current)),Me=null;return}}catch(d){if(f!==null)throw Me=f,d;wt=1,Yu(n,jn(s,n.current)),Me=null;return}a.flags&32768?(Ue||l===1?n=!0:Os||(Le&536870912)!==0?n=!1:(xa=n=!0,(l===2||l===9||l===3||l===6)&&(l=Mn.current,l!==null&&l.tag===13&&(l.flags|=16384))),Eg(a,n)):ic(a)}function ic(n){var a=n;do{if((a.flags&32768)!==0){Eg(a,xa);return}n=a.return;var s=Sv(a.alternate,a,ca);if(s!==null){Me=s;return}if(a=a.sibling,a!==null){Me=a;return}Me=a=n}while(a!==null);wt===0&&(wt=5)}function Eg(n,a){do{var s=Rv(n.alternate,n);if(s!==null){s.flags&=32767,Me=s;return}if(s=n.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!a&&(n=n.sibling,n!==null)){Me=n;return}Me=n=s}while(n!==null);wt=6,Me=null}function vg(n,a,s,l,f,d,T,b,k){n.cancelPendingCommit=null;do ac();while(Yt!==0);if((Ze&6)!==0)throw Error(r(327));if(a!==null){if(a===n.current)throw Error(r(177));if(d=a.lanes|a.childLanes,d|=Oh,Eh(n,s,d,T,b,k),n===lt&&(Me=lt=null,Le=0),Ns=a,Ua=n,ha=s,Pf=d,zf=f,cg=l,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Pv(ga,function(){return Rg(),null})):(n.callbackNode=null,n.callbackPriority=0),l=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||l){l=K.T,K.T=null,f=re.p,re.p=2,T=Ze,Ze|=4;try{Iv(n,a,s)}finally{Ze=T,re.p=f,K.T=l}}Yt=1,wg(),bg(),Ag()}}function wg(){if(Yt===1){Yt=0;var n=Ua,a=Ns,s=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||s){s=K.T,K.T=null;var l=re.p;re.p=2;var f=Ze;Ze|=4;try{ng(a,n);var d=ed,T=l_(n.containerInfo),b=d.focusedElem,k=d.selectionRange;if(T!==b&&b&&b.ownerDocument&&o_(b.ownerDocument.documentElement,b)){if(k!==null&&Ah(b)){var q=k.start,X=k.end;if(X===void 0&&(X=q),"selectionStart"in b)b.selectionStart=q,b.selectionEnd=Math.min(X,b.value.length);else{var J=b.ownerDocument||document,Y=J&&J.defaultView||window;if(Y.getSelection){var F=Y.getSelection(),de=b.textContent.length,Ee=Math.min(k.start,de),st=k.end===void 0?Ee:Math.min(k.end,de);!F.extend&&Ee>st&&(T=st,st=Ee,Ee=T);var z=s_(b,Ee),N=s_(b,st);if(z&&N&&(F.rangeCount!==1||F.anchorNode!==z.node||F.anchorOffset!==z.offset||F.focusNode!==N.node||F.focusOffset!==N.offset)){var G=J.createRange();G.setStart(z.node,z.offset),F.removeAllRanges(),Ee>st?(F.addRange(G),F.extend(N.node,N.offset)):(G.setEnd(N.node,N.offset),F.addRange(G))}}}}for(J=[],F=b;F=F.parentNode;)F.nodeType===1&&J.push({element:F,left:F.scrollLeft,top:F.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<J.length;b++){var Z=J[b];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}pc=!!Jf,ed=Jf=null}finally{Ze=f,re.p=l,K.T=s}}n.current=a,Yt=2}}function bg(){if(Yt===2){Yt=0;var n=Ua,a=Ns,s=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||s){s=K.T,K.T=null;var l=re.p;re.p=2;var f=Ze;Ze|=4;try{Zp(n,a.alternate,a)}finally{Ze=f,re.p=l,K.T=s}}Yt=3}}function Ag(){if(Yt===4||Yt===3){Yt=0,Xl();var n=Ua,a=Ns,s=ha,l=cg;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Yt=5:(Yt=0,Ns=Ua=null,Sg(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(za=null),Xi(s),a=a.stateNode,Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(ii,a,void 0,(a.current.flags&128)===128)}catch{}if(l!==null){a=K.T,f=re.p,re.p=2,K.T=null;try{for(var d=n.onRecoverableError,T=0;T<l.length;T++){var b=l[T];d(b.value,{componentStack:b.stack})}}finally{K.T=a,re.p=f}}(ha&3)!==0&&ac(),Bi(n),f=n.pendingLanes,(s&261930)!==0&&(f&42)!==0?n===Uf?sl++:(sl=0,Uf=n):sl=0,ol(0)}}function Sg(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,Bo(a)))}function ac(){return wg(),bg(),Ag(),Rg()}function Rg(){if(Yt!==5)return!1;var n=Ua,a=Pf;Pf=0;var s=Xi(ha),l=K.T,f=re.p;try{re.p=32>s?32:s,K.T=null,s=zf,zf=null;var d=Ua,T=ha;if(Yt=0,Ns=Ua=null,ha=0,(Ze&6)!==0)throw Error(r(331));var b=Ze;if(Ze|=4,og(d.current),ag(d,d.current,T,s),Ze=b,ol(0,!1),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(ii,d)}catch{}return!0}finally{re.p=f,K.T=l,Sg(n,a)}}function Ig(n,a,s){a=jn(s,a),a=yf(n.stateNode,a,2),n=Ma(n,a,2),n!==null&&(dr(n,2),Bi(n))}function nt(n,a,s){if(n.tag===3)Ig(n,n,s);else for(;a!==null;){if(a.tag===3){Ig(a,n,s);break}else if(a.tag===1){var l=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(za===null||!za.has(l))){n=jn(s,n),s=kp(2),l=Ma(a,s,2),l!==null&&(Op(s,l,a,n),dr(l,2),Bi(l));break}}a=a.return}}function qf(n,a,s){var l=n.pingCache;if(l===null){l=n.pingCache=new Dv;var f=new Set;l.set(a,f)}else f=l.get(a),f===void 0&&(f=new Set,l.set(a,f));f.has(s)||(Lf=!0,f.add(s),n=Lv.bind(null,n,a,s),a.then(n,n))}function Lv(n,a,s){var l=n.pingCache;l!==null&&l.delete(a),n.pingedLanes|=n.suspendedLanes&s,n.warmLanes&=~s,lt===n&&(Le&s)===s&&(wt===4||wt===3&&(Le&62914560)===Le&&300>_n()-$u?(Ze&2)===0&&Cs(n,0):Hf|=s,Ds===Le&&(Ds=0)),Bi(n)}function kg(n,a){a===0&&(a=eu()),n=Ir(n,a),n!==null&&(dr(n,a),Bi(n))}function Hv(n){var a=n.memoizedState,s=0;a!==null&&(s=a.retryLane),kg(n,s)}function xv(n,a){var s=0;switch(n.tag){case 31:case 13:var l=n.stateNode,f=n.memoizedState;f!==null&&(s=f.retryLane);break;case 19:l=n.stateNode;break;case 22:l=n.stateNode._retryCache;break;default:throw Error(r(314))}l!==null&&l.delete(a),kg(n,s)}function Pv(n,a){return qt(n,a)}var rc=null,Vs=null,Yf=!1,sc=!1,jf=!1,Ga=0;function Bi(n){n!==Vs&&n.next===null&&(Vs===null?rc=Vs=n:Vs=Vs.next=n),sc=!0,Yf||(Yf=!0,Uv())}function ol(n,a){if(!jf&&sc){jf=!0;do for(var s=!1,l=rc;l!==null;){if(n!==0){var f=l.pendingLanes;if(f===0)var d=0;else{var T=l.suspendedLanes,b=l.pingedLanes;d=(1<<31-At(42|n)+1)-1,d&=f&~(T&~b),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(s=!0,Cg(l,d))}else d=Le,d=bi(l,l===lt?d:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(d&3)===0||ai(l,d)||(s=!0,Cg(l,d));l=l.next}while(s);jf=!1}}function zv(){Og()}function Og(){sc=Yf=!1;var n=0;Ga!==0&&Qv()&&(n=Ga);for(var a=_n(),s=null,l=rc;l!==null;){var f=l.next,d=Dg(l,a);d===0?(l.next=null,s===null?rc=f:s.next=f,f===null&&(Vs=s)):(s=l,(n!==0||(d&3)!==0)&&(sc=!0)),l=f}Yt!==0&&Yt!==5||ol(n),Ga!==0&&(Ga=0)}function Dg(n,a){for(var s=n.suspendedLanes,l=n.pingedLanes,f=n.expirationTimes,d=n.pendingLanes&-62914561;0<d;){var T=31-At(d),b=1<<T,k=f[T];k===-1?((b&s)===0||(b&l)!==0)&&(f[T]=Th(b,a)):k<=a&&(n.expiredLanes|=b),d&=~b}if(a=lt,s=Le,s=bi(n,n===a?s:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),l=n.callbackNode,s===0||n===a&&(tt===2||tt===9)||n.cancelPendingCommit!==null)return l!==null&&l!==null&&pa(l),n.callbackNode=null,n.callbackPriority=0;if((s&3)===0||ai(n,s)){if(a=s&-s,a===n.callbackPriority)return a;switch(l!==null&&pa(l),Xi(s)){case 2:case 8:s=go;break;case 32:s=ga;break;case 268435456:s=Kl;break;default:s=ga}return l=Ng.bind(null,n),s=qt(s,l),n.callbackPriority=a,n.callbackNode=s,a}return l!==null&&l!==null&&pa(l),n.callbackPriority=2,n.callbackNode=null,2}function Ng(n,a){if(Yt!==0&&Yt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var s=n.callbackNode;if(ac()&&n.callbackNode!==s)return null;var l=Le;return l=bi(n,n===lt?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),l===0?null:(fg(n,l,a),Dg(n,_n()),n.callbackNode!=null&&n.callbackNode===s?Ng.bind(null,n):null)}function Cg(n,a){if(ac())return null;fg(n,a,!0)}function Uv(){$v(function(){(Ze&6)!==0?qt(po,zv):Og()})}function Ff(){if(Ga===0){var n=Ts;n===0&&(n=vi,vi<<=1,(vi&261888)===0&&(vi=256)),Ga=n}return Ga}function Mg(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:as(""+n)}function Vg(n,a){var s=a.ownerDocument.createElement("input");return s.name=a.name,s.value=a.value,n.id&&s.setAttribute("form",n.id),a.parentNode.insertBefore(s,a),n=new FormData(n),s.parentNode.removeChild(s),n}function Bv(n,a,s,l,f){if(a==="submit"&&s&&s.stateNode===f){var d=Mg((f[Ft]||null).action),T=l.submitter;T&&(a=(a=T[Ft]||null)?Mg(a.formAction):T.getAttribute("formAction"),a!==null&&(d=a,T=null));var b=new Vi("action","action",null,l,f);n.push({event:b,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Ga!==0){var k=T?Vg(f,T):new FormData(f);ff(s,{pending:!0,data:k,method:f.method,action:d},null,k)}}else typeof d=="function"&&(b.preventDefault(),k=T?Vg(f,T):new FormData(f),ff(s,{pending:!0,data:k,method:f.method,action:d},d,k))},currentTarget:f}]})}}for(var Wf=0;Wf<kh.length;Wf++){var Xf=kh[Wf],Gv=Xf.toLowerCase(),qv=Xf[0].toUpperCase()+Xf.slice(1);fi(Gv,"on"+qv)}fi(h_,"onAnimationEnd"),fi(f_,"onAnimationIteration"),fi(d_,"onAnimationStart"),fi("dblclick","onDoubleClick"),fi("focusin","onFocus"),fi("focusout","onBlur"),fi(rv,"onTransitionRun"),fi(sv,"onTransitionStart"),fi(ov,"onTransitionCancel"),fi(m_,"onTransitionEnd"),Di("onMouseEnter",["mouseout","mouseover"]),Di("onMouseLeave",["mouseout","mouseover"]),Di("onPointerEnter",["pointerout","pointerover"]),Di("onPointerLeave",["pointerout","pointerover"]),Oi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ll));function Lg(n,a){a=(a&4)!==0;for(var s=0;s<n.length;s++){var l=n[s],f=l.event;l=l.listeners;e:{var d=void 0;if(a)for(var T=l.length-1;0<=T;T--){var b=l[T],k=b.instance,q=b.currentTarget;if(b=b.listener,k!==d&&f.isPropagationStopped())break e;d=b,f.currentTarget=q;try{d(f)}catch(X){vu(X)}f.currentTarget=null,d=k}else for(T=0;T<l.length;T++){if(b=l[T],k=b.instance,q=b.currentTarget,b=b.listener,k!==d&&f.isPropagationStopped())break e;d=b,f.currentTarget=q;try{d(f)}catch(X){vu(X)}f.currentTarget=null,d=k}}}}function Ve(n,a){var s=a[Jr];s===void 0&&(s=a[Jr]=new Set);var l=n+"__bubble";s.has(l)||(Hg(a,n,2,!1),s.add(l))}function Kf(n,a,s){var l=0;a&&(l|=4),Hg(s,n,l,a)}var oc="_reactListening"+Math.random().toString(36).slice(2);function Qf(n){if(!n[oc]){n[oc]=!0,Eo.forEach(function(s){s!=="selectionchange"&&(Yv.has(s)||Kf(s,!1,n),Kf(s,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[oc]||(a[oc]=!0,Kf("selectionchange",!1,a))}}function Hg(n,a,s,l){switch(hy(a)){case 2:var f=yw;break;case 8:f=Tw;break;default:f=hd}s=f.bind(null,a,s,n),f=void 0,!Tr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(f=!0),l?f!==void 0?n.addEventListener(a,s,{capture:!0,passive:f}):n.addEventListener(a,s,!0):f!==void 0?n.addEventListener(a,s,{passive:f}):n.addEventListener(a,s,!1)}function Zf(n,a,s,l,f){var d=l;if((a&1)===0&&(a&2)===0&&l!==null)e:for(;;){if(l===null)return;var T=l.tag;if(T===3||T===4){var b=l.stateNode.containerInfo;if(b===f)break;if(T===4)for(T=l.return;T!==null;){var k=T.tag;if((k===3||k===4)&&T.stateNode.containerInfo===f)return;T=T.return}for(;b!==null;){if(T=Ii(b),T===null)return;if(k=T.tag,k===5||k===6||k===26||k===27){l=d=T;continue e}b=b.parentNode}}l=l.return}ba(function(){var q=d,X=Bn(s),J=[];e:{var Y=__.get(n);if(Y!==void 0){var F=Vi,de=n;switch(n){case"keypress":if(vr(s)===0)break e;case"keydown":case"keyup":F=yu;break;case"focusin":de="focus",F=br;break;case"focusout":de="blur",F=br;break;case"beforeblur":case"afterblur":F=br;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=Mo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=uu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=g;break;case h_:case f_:case d_:F=hu;break;case m_:F=A;break;case"scroll":case"scrollend":F=Co;break;case"wheel":F=j;break;case"copy":case"cut":case"paste":F=fu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=Zi;break;case"toggle":case"beforetoggle":F=ke}var Ee=(a&4)!==0,st=!Ee&&(n==="scroll"||n==="scrollend"),z=Ee?Y!==null?Y+"Capture":null:Y;Ee=[];for(var N=q,G;N!==null;){var Z=N;if(G=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||G===null||z===null||(Z=li(N,z),Z!=null&&Ee.push(ul(N,Z,G))),st)break;N=N.return}0<Ee.length&&(Y=new F(Y,de,null,s,X),J.push({event:Y,listeners:Ee}))}}if((a&7)===0){e:{if(Y=n==="mouseover"||n==="pointerover",F=n==="mouseout"||n==="pointerout",Y&&s!==Oo&&(de=s.relatedTarget||s.fromElement)&&(Ii(de)||de[Si]))break e;if((F||Y)&&(Y=X.window===X?X:(Y=X.ownerDocument)?Y.defaultView||Y.parentWindow:window,F?(de=s.relatedTarget||s.toElement,F=q,de=de?Ii(de):null,de!==null&&(st=u(de),Ee=de.tag,de!==st||Ee!==5&&Ee!==27&&Ee!==6)&&(de=null)):(F=null,de=q),F!==de)){if(Ee=Mo,Z="onMouseLeave",z="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(Ee=Zi,Z="onPointerLeave",z="onPointerEnter",N="pointer"),st=F==null?Y:On(F),G=de==null?Y:On(de),Y=new Ee(Z,N+"leave",F,s,X),Y.target=st,Y.relatedTarget=G,Z=null,Ii(X)===q&&(Ee=new Ee(z,N+"enter",de,s,X),Ee.target=G,Ee.relatedTarget=st,Z=Ee),st=Z,F&&de)t:{for(Ee=jv,z=F,N=de,G=0,Z=z;Z;Z=Ee(Z))G++;Z=0;for(var pe=N;pe;pe=Ee(pe))Z++;for(;0<G-Z;)z=Ee(z),G--;for(;0<Z-G;)N=Ee(N),Z--;for(;G--;){if(z===N||N!==null&&z===N.alternate){Ee=z;break t}z=Ee(z),N=Ee(N)}Ee=null}else Ee=null;F!==null&&xg(J,Y,F,Ee,!1),de!==null&&st!==null&&xg(J,st,de,Ee,!0)}}e:{if(Y=q?On(q):window,F=Y.nodeName&&Y.nodeName.toLowerCase(),F==="select"||F==="input"&&Y.type==="file")var We=e_;else if($m(Y))if(t_)We=nv;else{We=ev;var _e=JE}else F=Y.nodeName,!F||F.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?q&&is(q.elementType)&&(We=e_):We=tv;if(We&&(We=We(n,q))){Jm(J,We,s,X);break e}_e&&_e(n,Y,q),n==="focusout"&&q&&Y.type==="number"&&q.memoizedProps.value!=null&&Ro(Y,"number",Y.value)}switch(_e=q?On(q):window,n){case"focusin":($m(_e)||_e.contentEditable==="true")&&(hs=_e,Sh=q,Po=null);break;case"focusout":Po=Sh=hs=null;break;case"mousedown":Rh=!0;break;case"contextmenu":case"mouseup":case"dragend":Rh=!1,u_(J,s,X);break;case"selectionchange":if(av)break;case"keydown":case"keyup":u_(J,s,X)}var Ce;if(Qe)e:{switch(n){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else cs?Ar(n,s)&&(He="onCompositionEnd"):n==="keydown"&&s.keyCode===229&&(He="onCompositionStart");He&&(xi&&s.locale!=="ko"&&(cs||He!=="onCompositionStart"?He==="onCompositionEnd"&&cs&&(Ce=No()):(Mi=X,Do="value"in Mi?Mi.value:Mi.textContent,cs=!0)),_e=lc(q,He),0<_e.length&&(He=new Hi(He,n,null,s,X),J.push({event:He,listeners:_e}),Ce?He.data=Ce:(Ce=us(s),Ce!==null&&(He.data=Ce)))),(Ce=qn?KE(n,s):QE(n,s))&&(He=lc(q,"onBeforeInput"),0<He.length&&(_e=new Hi("onBeforeInput","beforeinput",null,s,X),J.push({event:_e,listeners:He}),_e.data=Ce)),Bv(J,n,q,s,X)}Lg(J,a)})}function ul(n,a,s){return{instance:n,listener:a,currentTarget:s}}function lc(n,a){for(var s=a+"Capture",l=[];n!==null;){var f=n,d=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||d===null||(f=li(n,s),f!=null&&l.unshift(ul(n,f,d)),f=li(n,a),f!=null&&l.push(ul(n,f,d))),n.tag===3)return l;n=n.return}return[]}function jv(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function xg(n,a,s,l,f){for(var d=a._reactName,T=[];s!==null&&s!==l;){var b=s,k=b.alternate,q=b.stateNode;if(b=b.tag,k!==null&&k===l)break;b!==5&&b!==26&&b!==27||q===null||(k=q,f?(q=li(s,d),q!=null&&T.unshift(ul(s,q,k))):f||(q=li(s,d),q!=null&&T.push(ul(s,q,k)))),s=s.return}T.length!==0&&n.push({event:a,listeners:T})}var Fv=/\r\n?/g,Wv=/\u0000|\uFFFD/g;function Pg(n){return(typeof n=="string"?n:""+n).replace(Fv,`
`).replace(Wv,"")}function zg(n,a){return a=Pg(a),Pg(n)===a}function rt(n,a,s,l,f,d){switch(s){case"children":typeof l=="string"?a==="body"||a==="textarea"&&l===""||Tn(n,l):(typeof l=="number"||typeof l=="bigint")&&a!=="body"&&Tn(n,""+l);break;case"className":Dn(n,"class",l);break;case"tabIndex":Dn(n,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Dn(n,s,l);break;case"style":ko(n,l,d);break;case"data":if(a!=="object"){Dn(n,"data",l);break}case"src":case"href":if(l===""&&(a!=="a"||s!=="href")){n.removeAttribute(s);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){n.removeAttribute(s);break}l=as(""+l),n.setAttribute(s,l);break;case"action":case"formAction":if(typeof l=="function"){n.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(s==="formAction"?(a!=="input"&&rt(n,a,"name",f.name,f,null),rt(n,a,"formEncType",f.formEncType,f,null),rt(n,a,"formMethod",f.formMethod,f,null),rt(n,a,"formTarget",f.formTarget,f,null)):(rt(n,a,"encType",f.encType,f,null),rt(n,a,"method",f.method,f,null),rt(n,a,"target",f.target,f,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){n.removeAttribute(s);break}l=as(""+l),n.setAttribute(s,l);break;case"onClick":l!=null&&(n.onclick=oi);break;case"onScroll":l!=null&&Ve("scroll",n);break;case"onScrollEnd":l!=null&&Ve("scrollend",n);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(s=l.__html,s!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=s}}break;case"multiple":n.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":n.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){n.removeAttribute("xlink:href");break}s=as(""+l),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(s,""+l):n.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(s,""):n.removeAttribute(s);break;case"capture":case"download":l===!0?n.setAttribute(s,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(s,l):n.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?n.setAttribute(s,l):n.removeAttribute(s);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?n.removeAttribute(s):n.setAttribute(s,l);break;case"popover":Ve("beforetoggle",n),Ve("toggle",n),ts(n,"popover",l);break;case"xlinkActuate":Mt(n,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Mt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Mt(n,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Mt(n,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Mt(n,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Mt(n,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Mt(n,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Mt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Mt(n,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":ts(n,"is",l);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=lu.get(s)||s,ts(n,s,l))}}function $f(n,a,s,l,f,d){switch(s){case"style":ko(n,l,d);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(s=l.__html,s!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=s}}break;case"children":typeof l=="string"?Tn(n,l):(typeof l=="number"||typeof l=="bigint")&&Tn(n,""+l);break;case"onScroll":l!=null&&Ve("scroll",n);break;case"onScrollEnd":l!=null&&Ve("scrollend",n);break;case"onClick":l!=null&&(n.onclick=oi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vo.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(f=s.endsWith("Capture"),a=s.slice(2,f?s.length-7:void 0),d=n[Ft]||null,d=d!=null?d[s]:null,typeof d=="function"&&n.removeEventListener(a,d,f),typeof l=="function")){typeof d!="function"&&d!==null&&(s in n?n[s]=null:n.hasAttribute(s)&&n.removeAttribute(s)),n.addEventListener(a,l,f);break e}s in n?n[s]=l:l===!0?n.setAttribute(s,""):ts(n,s,l)}}}function nn(n,a,s){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",n),Ve("load",n);var l=!1,f=!1,d;for(d in s)if(s.hasOwnProperty(d)){var T=s[d];if(T!=null)switch(d){case"src":l=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:rt(n,a,d,T,s,null)}}f&&rt(n,a,"srcSet",s.srcSet,s,null),l&&rt(n,a,"src",s.src,s,null);return;case"input":Ve("invalid",n);var b=d=T=f=null,k=null,q=null;for(l in s)if(s.hasOwnProperty(l)){var X=s[l];if(X!=null)switch(l){case"name":f=X;break;case"type":T=X;break;case"checked":k=X;break;case"defaultChecked":q=X;break;case"value":d=X;break;case"defaultValue":b=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,a));break;default:rt(n,a,l,X,s,null)}}ru(n,d,b,k,q,T,f,!1);return;case"select":Ve("invalid",n),l=T=d=null;for(f in s)if(s.hasOwnProperty(f)&&(b=s[f],b!=null))switch(f){case"value":d=b;break;case"defaultValue":T=b;break;case"multiple":l=b;default:rt(n,a,f,b,s,null)}a=d,s=T,n.multiple=!!l,a!=null?Ta(n,!!l,a,!1):s!=null&&Ta(n,!!l,s,!0);return;case"textarea":Ve("invalid",n),d=f=l=null;for(T in s)if(s.hasOwnProperty(T)&&(b=s[T],b!=null))switch(T){case"value":l=b;break;case"defaultValue":f=b;break;case"children":d=b;break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:rt(n,a,T,b,s,null)}Ea(n,l,f,d);return;case"option":for(k in s)s.hasOwnProperty(k)&&(l=s[k],l!=null)&&(k==="selected"?n.selected=l&&typeof l!="function"&&typeof l!="symbol":rt(n,a,k,l,s,null));return;case"dialog":Ve("beforetoggle",n),Ve("toggle",n),Ve("cancel",n),Ve("close",n);break;case"iframe":case"object":Ve("load",n);break;case"video":case"audio":for(l=0;l<ll.length;l++)Ve(ll[l],n);break;case"image":Ve("error",n),Ve("load",n);break;case"details":Ve("toggle",n);break;case"embed":case"source":case"link":Ve("error",n),Ve("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(q in s)if(s.hasOwnProperty(q)&&(l=s[q],l!=null))switch(q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:rt(n,a,q,l,s,null)}return;default:if(is(a)){for(X in s)s.hasOwnProperty(X)&&(l=s[X],l!==void 0&&$f(n,a,X,l,s,void 0));return}}for(b in s)s.hasOwnProperty(b)&&(l=s[b],l!=null&&rt(n,a,b,l,s,null))}function Xv(n,a,s,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,d=null,T=null,b=null,k=null,q=null,X=null;for(F in s){var J=s[F];if(s.hasOwnProperty(F)&&J!=null)switch(F){case"checked":break;case"value":break;case"defaultValue":k=J;default:l.hasOwnProperty(F)||rt(n,a,F,null,l,J)}}for(var Y in l){var F=l[Y];if(J=s[Y],l.hasOwnProperty(Y)&&(F!=null||J!=null))switch(Y){case"type":d=F;break;case"name":f=F;break;case"checked":q=F;break;case"defaultChecked":X=F;break;case"value":T=F;break;case"defaultValue":b=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(137,a));break;default:F!==J&&rt(n,a,Y,F,l,J)}}ns(n,T,b,k,q,X,d,f);return;case"select":F=T=b=Y=null;for(d in s)if(k=s[d],s.hasOwnProperty(d)&&k!=null)switch(d){case"value":break;case"multiple":F=k;default:l.hasOwnProperty(d)||rt(n,a,d,null,l,k)}for(f in l)if(d=l[f],k=s[f],l.hasOwnProperty(f)&&(d!=null||k!=null))switch(f){case"value":Y=d;break;case"defaultValue":b=d;break;case"multiple":T=d;default:d!==k&&rt(n,a,f,d,l,k)}a=b,s=T,l=F,Y!=null?Ta(n,!!s,Y,!1):!!l!=!!s&&(a!=null?Ta(n,!!s,a,!0):Ta(n,!!s,s?[]:"",!1));return;case"textarea":F=Y=null;for(b in s)if(f=s[b],s.hasOwnProperty(b)&&f!=null&&!l.hasOwnProperty(b))switch(b){case"value":break;case"children":break;default:rt(n,a,b,null,l,f)}for(T in l)if(f=l[T],d=s[T],l.hasOwnProperty(T)&&(f!=null||d!=null))switch(T){case"value":Y=f;break;case"defaultValue":F=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==d&&rt(n,a,T,f,l,d)}su(n,Y,F);return;case"option":for(var de in s)Y=s[de],s.hasOwnProperty(de)&&Y!=null&&!l.hasOwnProperty(de)&&(de==="selected"?n.selected=!1:rt(n,a,de,null,l,Y));for(k in l)Y=l[k],F=s[k],l.hasOwnProperty(k)&&Y!==F&&(Y!=null||F!=null)&&(k==="selected"?n.selected=Y&&typeof Y!="function"&&typeof Y!="symbol":rt(n,a,k,Y,l,F));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ee in s)Y=s[Ee],s.hasOwnProperty(Ee)&&Y!=null&&!l.hasOwnProperty(Ee)&&rt(n,a,Ee,null,l,Y);for(q in l)if(Y=l[q],F=s[q],l.hasOwnProperty(q)&&Y!==F&&(Y!=null||F!=null))switch(q){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(r(137,a));break;default:rt(n,a,q,Y,l,F)}return;default:if(is(a)){for(var st in s)Y=s[st],s.hasOwnProperty(st)&&Y!==void 0&&!l.hasOwnProperty(st)&&$f(n,a,st,void 0,l,Y);for(X in l)Y=l[X],F=s[X],!l.hasOwnProperty(X)||Y===F||Y===void 0&&F===void 0||$f(n,a,X,Y,l,F);return}}for(var z in s)Y=s[z],s.hasOwnProperty(z)&&Y!=null&&!l.hasOwnProperty(z)&&rt(n,a,z,null,l,Y);for(J in l)Y=l[J],F=s[J],!l.hasOwnProperty(J)||Y===F||Y==null&&F==null||rt(n,a,J,Y,l,F)}function Ug(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kv(){if(typeof performance.getEntriesByType=="function"){for(var n=0,a=0,s=performance.getEntriesByType("resource"),l=0;l<s.length;l++){var f=s[l],d=f.transferSize,T=f.initiatorType,b=f.duration;if(d&&b&&Ug(T)){for(T=0,b=f.responseEnd,l+=1;l<s.length;l++){var k=s[l],q=k.startTime;if(q>b)break;var X=k.transferSize,J=k.initiatorType;X&&Ug(J)&&(k=k.responseEnd,T+=X*(k<b?1:(b-q)/(k-q)))}if(--l,a+=8*(d+T)/(f.duration/1e3),n++,10<n)break}}if(0<n)return a/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Jf=null,ed=null;function uc(n){return n.nodeType===9?n:n.ownerDocument}function Bg(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gg(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function td(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var nd=null;function Qv(){var n=window.event;return n&&n.type==="popstate"?n===nd?!1:(nd=n,!0):(nd=null,!1)}var qg=typeof setTimeout=="function"?setTimeout:void 0,Zv=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,$v=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(n){return Yg.resolve(null).then(n).catch(Jv)}:qg;function Jv(n){setTimeout(function(){throw n})}function qa(n){return n==="head"}function jg(n,a){var s=a,l=0;do{var f=s.nextSibling;if(n.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"||s==="/&"){if(l===0){n.removeChild(f),Ps(a);return}l--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")l++;else if(s==="html")cl(n.ownerDocument.documentElement);else if(s==="head"){s=n.ownerDocument.head,cl(s);for(var d=s.firstChild;d;){var T=d.nextSibling,b=d.nodeName;d[Ri]||b==="SCRIPT"||b==="STYLE"||b==="LINK"&&d.rel.toLowerCase()==="stylesheet"||s.removeChild(d),d=T}}else s==="body"&&cl(n.ownerDocument.body);s=f}while(s);Ps(a)}function Fg(n,a){var s=n;n=0;do{var l=s.nextSibling;if(s.nodeType===1?a?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(a?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(n===0)break;n--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||n++;s=l}while(s)}function id(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var s=a;switch(a=a.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":id(s),es(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}n.removeChild(s)}}function ew(n,a,s,l){for(;n.nodeType===1;){var f=s;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!l&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(l){if(!n[Ri])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(d=n.getAttribute("rel"),d==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(d!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(d=n.getAttribute("src"),(d!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&d&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var d=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===d)return n}else return n;if(n=Qn(n.nextSibling),n===null)break}return null}function tw(n,a,s){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=Qn(n.nextSibling),n===null))return null;return n}function Wg(n,a){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!a||(n=Qn(n.nextSibling),n===null))return null;return n}function ad(n){return n.data==="$?"||n.data==="$~"}function rd(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function nw(n,a){var s=n.ownerDocument;if(n.data==="$~")n._reactRetry=a;else if(n.data!=="$?"||s.readyState!=="loading")a();else{var l=function(){a(),s.removeEventListener("DOMContentLoaded",l)};s.addEventListener("DOMContentLoaded",l),n._reactRetry=l}}function Qn(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return n}var sd=null;function Xg(n){n=n.nextSibling;for(var a=0;n;){if(n.nodeType===8){var s=n.data;if(s==="/$"||s==="/&"){if(a===0)return Qn(n.nextSibling);a--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||a++}n=n.nextSibling}return null}function Kg(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var s=n.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(a===0)return n;a--}else s!=="/$"&&s!=="/&"||a++}n=n.previousSibling}return null}function Qg(n,a,s){switch(a=uc(s),n){case"html":if(n=a.documentElement,!n)throw Error(r(452));return n;case"head":if(n=a.head,!n)throw Error(r(453));return n;case"body":if(n=a.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function cl(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);es(n)}var Zn=new Map,Zg=new Set;function cc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var fa=re.d;re.d={f:iw,r:aw,D:rw,C:sw,L:ow,m:lw,X:cw,S:uw,M:hw};function iw(){var n=fa.f(),a=tc();return n||a}function aw(n){var a=Un(n);a!==null&&a.tag===5&&a.type==="form"?mp(a):fa.r(n)}var Ls=typeof document>"u"?null:document;function $g(n,a,s){var l=Ls;if(l&&typeof a=="string"&&a){var f=yn(a);f='link[rel="'+n+'"][href="'+f+'"]',typeof s=="string"&&(f+='[crossorigin="'+s+'"]'),Zg.has(f)||(Zg.add(f),n={rel:n,crossOrigin:s,href:a},l.querySelector(f)===null&&(a=l.createElement("link"),nn(a,"link",n),Ct(a),l.head.appendChild(a)))}}function rw(n){fa.D(n),$g("dns-prefetch",n,null)}function sw(n,a){fa.C(n,a),$g("preconnect",n,a)}function ow(n,a,s){fa.L(n,a,s);var l=Ls;if(l&&n&&a){var f='link[rel="preload"][as="'+yn(a)+'"]';a==="image"&&s&&s.imageSrcSet?(f+='[imagesrcset="'+yn(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(f+='[imagesizes="'+yn(s.imageSizes)+'"]')):f+='[href="'+yn(n)+'"]';var d=f;switch(a){case"style":d=Hs(n);break;case"script":d=xs(n)}Zn.has(d)||(n=v({rel:"preload",href:a==="image"&&s&&s.imageSrcSet?void 0:n,as:a},s),Zn.set(d,n),l.querySelector(f)!==null||a==="style"&&l.querySelector(hl(d))||a==="script"&&l.querySelector(fl(d))||(a=l.createElement("link"),nn(a,"link",n),Ct(a),l.head.appendChild(a)))}}function lw(n,a){fa.m(n,a);var s=Ls;if(s&&n){var l=a&&typeof a.as=="string"?a.as:"script",f='link[rel="modulepreload"][as="'+yn(l)+'"][href="'+yn(n)+'"]',d=f;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=xs(n)}if(!Zn.has(d)&&(n=v({rel:"modulepreload",href:n},a),Zn.set(d,n),s.querySelector(f)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(fl(d)))return}l=s.createElement("link"),nn(l,"link",n),Ct(l),s.head.appendChild(l)}}}function uw(n,a,s){fa.S(n,a,s);var l=Ls;if(l&&n){var f=ki(l).hoistableStyles,d=Hs(n);a=a||"default";var T=f.get(d);if(!T){var b={loading:0,preload:null};if(T=l.querySelector(hl(d)))b.loading=5;else{n=v({rel:"stylesheet",href:n,"data-precedence":a},s),(s=Zn.get(d))&&od(n,s);var k=T=l.createElement("link");Ct(k),nn(k,"link",n),k._p=new Promise(function(q,X){k.onload=q,k.onerror=X}),k.addEventListener("load",function(){b.loading|=1}),k.addEventListener("error",function(){b.loading|=2}),b.loading|=4,hc(T,a,l)}T={type:"stylesheet",instance:T,count:1,state:b},f.set(d,T)}}}function cw(n,a){fa.X(n,a);var s=Ls;if(s&&n){var l=ki(s).hoistableScripts,f=xs(n),d=l.get(f);d||(d=s.querySelector(fl(f)),d||(n=v({src:n,async:!0},a),(a=Zn.get(f))&&ld(n,a),d=s.createElement("script"),Ct(d),nn(d,"link",n),s.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},l.set(f,d))}}function hw(n,a){fa.M(n,a);var s=Ls;if(s&&n){var l=ki(s).hoistableScripts,f=xs(n),d=l.get(f);d||(d=s.querySelector(fl(f)),d||(n=v({src:n,async:!0,type:"module"},a),(a=Zn.get(f))&&ld(n,a),d=s.createElement("script"),Ct(d),nn(d,"link",n),s.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},l.set(f,d))}}function Jg(n,a,s,l){var f=(f=Ne.current)?cc(f):null;if(!f)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(a=Hs(s.href),s=ki(f).hoistableStyles,l=s.get(a),l||(l={type:"style",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){n=Hs(s.href);var d=ki(f).hoistableStyles,T=d.get(n);if(T||(f=f.ownerDocument||f,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(n,T),(d=f.querySelector(hl(n)))&&!d._p&&(T.instance=d,T.state.loading=5),Zn.has(n)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Zn.set(n,s),d||fw(f,n,s,T.state))),a&&l===null)throw Error(r(528,""));return T}if(a&&l!==null)throw Error(r(529,""));return null;case"script":return a=s.async,s=s.src,typeof s=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=xs(s),s=ki(f).hoistableScripts,l=s.get(a),l||(l={type:"script",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function Hs(n){return'href="'+yn(n)+'"'}function hl(n){return'link[rel="stylesheet"]['+n+"]"}function ey(n){return v({},n,{"data-precedence":n.precedence,precedence:null})}function fw(n,a,s,l){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=n.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),nn(a,"link",s),Ct(a),n.head.appendChild(a))}function xs(n){return'[src="'+yn(n)+'"]'}function fl(n){return"script[async]"+n}function ty(n,a,s){if(a.count++,a.instance===null)switch(a.type){case"style":var l=n.querySelector('style[data-href~="'+yn(s.href)+'"]');if(l)return a.instance=l,Ct(l),l;var f=v({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return l=(n.ownerDocument||n).createElement("style"),Ct(l),nn(l,"style",f),hc(l,s.precedence,n),a.instance=l;case"stylesheet":f=Hs(s.href);var d=n.querySelector(hl(f));if(d)return a.state.loading|=4,a.instance=d,Ct(d),d;l=ey(s),(f=Zn.get(f))&&od(l,f),d=(n.ownerDocument||n).createElement("link"),Ct(d);var T=d;return T._p=new Promise(function(b,k){T.onload=b,T.onerror=k}),nn(d,"link",l),a.state.loading|=4,hc(d,s.precedence,n),a.instance=d;case"script":return d=xs(s.src),(f=n.querySelector(fl(d)))?(a.instance=f,Ct(f),f):(l=s,(f=Zn.get(d))&&(l=v({},s),ld(l,f)),n=n.ownerDocument||n,f=n.createElement("script"),Ct(f),nn(f,"link",l),n.head.appendChild(f),a.instance=f);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(l=a.instance,a.state.loading|=4,hc(l,s.precedence,n));return a.instance}function hc(n,a,s){for(var l=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=l.length?l[l.length-1]:null,d=f,T=0;T<l.length;T++){var b=l[T];if(b.dataset.precedence===a)d=b;else if(d!==f)break}d?d.parentNode.insertBefore(n,d.nextSibling):(a=s.nodeType===9?s.head:s,a.insertBefore(n,a.firstChild))}function od(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function ld(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var fc=null;function ny(n,a,s){if(fc===null){var l=new Map,f=fc=new Map;f.set(s,l)}else f=fc,l=f.get(s),l||(l=new Map,f.set(s,l));if(l.has(n))return l;for(l.set(n,null),s=s.getElementsByTagName(n),f=0;f<s.length;f++){var d=s[f];if(!(d[Ri]||d[Nt]||n==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var T=d.getAttribute(a)||"";T=n+T;var b=l.get(T);b?b.push(d):l.set(T,[d])}}return l}function iy(n,a,s){n=n.ownerDocument||n,n.head.insertBefore(s,a==="title"?n.querySelector("head > title"):null)}function dw(n,a,s){if(s===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(n=a.disabled,typeof a.precedence=="string"&&n==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function ay(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function mw(n,a,s,l){if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var f=Hs(l.href),d=a.querySelector(hl(f));if(d){a=d._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(n.count++,n=dc.bind(n),a.then(n,n)),s.state.loading|=4,s.instance=d,Ct(d);return}d=a.ownerDocument||a,l=ey(l),(f=Zn.get(f))&&od(l,f),d=d.createElement("link"),Ct(d);var T=d;T._p=new Promise(function(b,k){T.onload=b,T.onerror=k}),nn(d,"link",l),s.instance=d}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(n.count++,s=dc.bind(n),a.addEventListener("load",s),a.addEventListener("error",s))}}var ud=0;function _w(n,a){return n.stylesheets&&n.count===0&&_c(n,n.stylesheets),0<n.count||0<n.imgCount?function(s){var l=setTimeout(function(){if(n.stylesheets&&_c(n,n.stylesheets),n.unsuspend){var d=n.unsuspend;n.unsuspend=null,d()}},6e4+a);0<n.imgBytes&&ud===0&&(ud=62500*Kv());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&_c(n,n.stylesheets),n.unsuspend)){var d=n.unsuspend;n.unsuspend=null,d()}},(n.imgBytes>ud?50:800)+a);return n.unsuspend=s,function(){n.unsuspend=null,clearTimeout(l),clearTimeout(f)}}:null}function dc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_c(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var mc=null;function _c(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,mc=new Map,a.forEach(pw,n),mc=null,dc.call(n))}function pw(n,a){if(!(a.state.loading&4)){var s=mc.get(n);if(s)var l=s.get(null);else{s=new Map,mc.set(n,s);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<f.length;d++){var T=f[d];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(s.set(T.dataset.precedence,T),l=T)}l&&s.set(null,l)}f=a.instance,T=f.getAttribute("data-precedence"),d=s.get(T)||l,d===l&&s.set(null,f),s.set(T,f),this.count++,l=dc.bind(this),f.addEventListener("load",l),f.addEventListener("error",l),d?d.parentNode.insertBefore(f,d.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),a.state.loading|=4}}var dl={$$typeof:le,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function gw(n,a,s,l,f,d,T,b,k){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ai(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ai(0),this.hiddenUpdates=Ai(null),this.identifierPrefix=l,this.onUncaughtError=f,this.onCaughtError=d,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function ry(n,a,s,l,f,d,T,b,k,q,X,J){return n=new gw(n,a,s,T,k,q,X,J,b),a=1,d===!0&&(a|=24),d=Cn(3,null,null,a),n.current=d,d.stateNode=n,a=Bh(),a.refCount++,n.pooledCache=a,a.refCount++,d.memoizedState={element:l,isDehydrated:s,cache:a},jh(d),n}function sy(n){return n?(n=ms,n):ms}function oy(n,a,s,l,f,d){f=sy(f),l.context===null?l.context=f:l.pendingContext=f,l=Ca(a),l.payload={element:s},d=d===void 0?null:d,d!==null&&(l.callback=d),s=Ma(n,l,a),s!==null&&(An(s,n,a),jo(s,n,a))}function ly(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var s=n.retryLane;n.retryLane=s!==0&&s<a?s:a}}function cd(n,a){ly(n,a),(n=n.alternate)&&ly(n,a)}function uy(n){if(n.tag===13||n.tag===31){var a=Ir(n,67108864);a!==null&&An(a,n,67108864),cd(n,67108864)}}function cy(n){if(n.tag===13||n.tag===31){var a=xn();a=_r(a);var s=Ir(n,a);s!==null&&An(s,n,a),cd(n,a)}}var pc=!0;function yw(n,a,s,l){var f=K.T;K.T=null;var d=re.p;try{re.p=2,hd(n,a,s,l)}finally{re.p=d,K.T=f}}function Tw(n,a,s,l){var f=K.T;K.T=null;var d=re.p;try{re.p=8,hd(n,a,s,l)}finally{re.p=d,K.T=f}}function hd(n,a,s,l){if(pc){var f=fd(l);if(f===null)Zf(n,a,l,gc,s),fy(n,l);else if(vw(f,n,a,s,l))l.stopPropagation();else if(fy(n,l),a&4&&-1<Ew.indexOf(n)){for(;f!==null;){var d=Un(f);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var T=wi(d.pendingLanes);if(T!==0){var b=d;for(b.pendingLanes|=2,b.entangledLanes|=2;T;){var k=1<<31-At(T);b.entanglements[1]|=k,T&=~k}Bi(d),(Ze&6)===0&&(Ju=_n()+500,ol(0))}}break;case 31:case 13:b=Ir(d,2),b!==null&&An(b,d,2),tc(),cd(d,2)}if(d=fd(l),d===null&&Zf(n,a,l,gc,s),d===f)break;f=d}f!==null&&l.stopPropagation()}else Zf(n,a,l,null,s)}}function fd(n){return n=Bn(n),dd(n)}var gc=null;function dd(n){if(gc=null,n=Ii(n),n!==null){var a=u(n);if(a===null)n=null;else{var s=a.tag;if(s===13){if(n=h(a),n!==null)return n;n=null}else if(s===31){if(n=m(a),n!==null)return n;n=null}else if(s===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return gc=n,null}function hy(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hr()){case po:return 2;case go:return 8;case ga:case yh:return 32;case Kl:return 268435456;default:return 32}default:return 32}}var md=!1,Ya=null,ja=null,Fa=null,ml=new Map,_l=new Map,Wa=[],Ew="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fy(n,a){switch(n){case"focusin":case"focusout":Ya=null;break;case"dragenter":case"dragleave":ja=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":ml.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":_l.delete(a.pointerId)}}function pl(n,a,s,l,f,d){return n===null||n.nativeEvent!==d?(n={blockedOn:a,domEventName:s,eventSystemFlags:l,nativeEvent:d,targetContainers:[f]},a!==null&&(a=Un(a),a!==null&&uy(a)),n):(n.eventSystemFlags|=l,a=n.targetContainers,f!==null&&a.indexOf(f)===-1&&a.push(f),n)}function vw(n,a,s,l,f){switch(a){case"focusin":return Ya=pl(Ya,n,a,s,l,f),!0;case"dragenter":return ja=pl(ja,n,a,s,l,f),!0;case"mouseover":return Fa=pl(Fa,n,a,s,l,f),!0;case"pointerover":var d=f.pointerId;return ml.set(d,pl(ml.get(d)||null,n,a,s,l,f)),!0;case"gotpointercapture":return d=f.pointerId,_l.set(d,pl(_l.get(d)||null,n,a,s,l,f)),!0}return!1}function dy(n){var a=Ii(n.target);if(a!==null){var s=u(a);if(s!==null){if(a=s.tag,a===13){if(a=h(s),a!==null){n.blockedOn=a,ri(n.priority,function(){cy(s)});return}}else if(a===31){if(a=m(s),a!==null){n.blockedOn=a,ri(n.priority,function(){cy(s)});return}}else if(a===3&&s.stateNode.current.memoizedState.isDehydrated){n.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}n.blockedOn=null}function yc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var s=fd(n.nativeEvent);if(s===null){s=n.nativeEvent;var l=new s.constructor(s.type,s);Oo=l,s.target.dispatchEvent(l),Oo=null}else return a=Un(s),a!==null&&uy(a),n.blockedOn=s,!1;a.shift()}return!0}function my(n,a,s){yc(n)&&s.delete(a)}function ww(){md=!1,Ya!==null&&yc(Ya)&&(Ya=null),ja!==null&&yc(ja)&&(ja=null),Fa!==null&&yc(Fa)&&(Fa=null),ml.forEach(my),_l.forEach(my)}function Tc(n,a){n.blockedOn===a&&(n.blockedOn=null,md||(md=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ww)))}var Ec=null;function _y(n){Ec!==n&&(Ec=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Ec===n&&(Ec=null);for(var a=0;a<n.length;a+=3){var s=n[a],l=n[a+1],f=n[a+2];if(typeof l!="function"){if(dd(l||s)===null)continue;break}var d=Un(s);d!==null&&(n.splice(a,3),a-=3,ff(d,{pending:!0,data:f,method:s.method,action:l},l,f))}}))}function Ps(n){function a(k){return Tc(k,n)}Ya!==null&&Tc(Ya,n),ja!==null&&Tc(ja,n),Fa!==null&&Tc(Fa,n),ml.forEach(a),_l.forEach(a);for(var s=0;s<Wa.length;s++){var l=Wa[s];l.blockedOn===n&&(l.blockedOn=null)}for(;0<Wa.length&&(s=Wa[0],s.blockedOn===null);)dy(s),s.blockedOn===null&&Wa.shift();if(s=(n.ownerDocument||n).$$reactFormReplay,s!=null)for(l=0;l<s.length;l+=3){var f=s[l],d=s[l+1],T=f[Ft]||null;if(typeof d=="function")T||_y(s);else if(T){var b=null;if(d&&d.hasAttribute("formAction")){if(f=d,T=d[Ft]||null)b=T.formAction;else if(dd(f)!==null)continue}else b=T.action;typeof b=="function"?s[l+1]=b:(s.splice(l,3),l-=3),_y(s)}}}function py(){function n(d){d.canIntercept&&d.info==="react-transition"&&d.intercept({handler:function(){return new Promise(function(T){return f=T})},focusReset:"manual",scroll:"manual"})}function a(){f!==null&&(f(),f=null),l||setTimeout(s,20)}function s(){if(!l&&!navigation.transition){var d=navigation.currentEntry;d&&d.url!=null&&navigation.navigate(d.url,{state:d.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(s,100),function(){l=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),f!==null&&(f(),f=null)}}}function _d(n){this._internalRoot=n}vc.prototype.render=_d.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(r(409));var s=a.current,l=xn();oy(s,l,n,a,null,null)},vc.prototype.unmount=_d.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;oy(n.current,2,null,n,null,null),tc(),a[Si]=null}};function vc(n){this._internalRoot=n}vc.prototype.unstable_scheduleHydration=function(n){if(n){var a=tu();n={blockedOn:null,target:n,priority:a};for(var s=0;s<Wa.length&&a!==0&&a<Wa[s].priority;s++);Wa.splice(s,0,n),s===0&&dy(n)}};var gy=e.version;if(gy!=="19.2.4")throw Error(r(527,gy,"19.2.4"));re.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=p(a),n=n!==null?y(n):null,n=n===null?null:n.stateNode,n};var bw={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wc.isDisabled&&wc.supportsFiber)try{ii=wc.inject(bw),Zt=wc}catch{}}return yl.createRoot=function(n,a){if(!o(n))throw Error(r(299));var s=!1,l="",f=Ap,d=Sp,T=Rp;return a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(d=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError)),a=ry(n,1,!1,null,null,s,l,null,f,d,T,py),n[Si]=a.current,Qf(n),new _d(a)},yl.hydrateRoot=function(n,a,s){if(!o(n))throw Error(r(299));var l=!1,f="",d=Ap,T=Sp,b=Rp,k=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(d=s.onUncaughtError),s.onCaughtError!==void 0&&(T=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError),s.formState!==void 0&&(k=s.formState)),a=ry(n,1,!0,a,s??null,l,f,k,d,T,b,py),a.context=sy(null),s=a.current,l=xn(),l=_r(l),f=Ca(l),f.callback=null,Ma(s,f,l),s=l,a.current.lanes=s,dr(a,s),Bi(a),n[Si]=a.current,Qf(n),new vc(a)},yl.version="19.2.4",yl}var Iy;function Mw(){if(Iy)return gd.exports;Iy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),gd.exports=Cw(),gd.exports}var Vw=Mw(),oe=om();const Lw=[{text:"",type:"normal"},{text:"",type:"title"},{text:"|       THE SECRET OF SNOWPEAK RESORT:       |",type:"title"},{text:"|       A Zork-Style Text Adventure.         |",type:"title"},{text:"",type:"title"},{text:"",type:"normal"},{text:'You arrive at Snowpeak Resort on a cold winter morning, ready for your first ski vacation. The brochure promised "world-class slopes and luxury accommodations." The reality... is somewhat different.',type:"normal"},{text:"",type:"normal"},{text:"The resort is nearly abandoned. The ski lift is broken. Most of the shops are boarded up. But three fellow beginner skiers are here with you, each as bewildered as the last. And there are whispers of a secret hidden somewhere on this mountain -- a treasure left behind by the resort's eccentric founder, Tobias Snowpeak.",type:"normal"},{text:"",type:"normal"},{text:"Maybe this trip won't be so boring after all...",type:"normal"},{text:"",type:"normal"},{text:'Type "help" for a list of commands, or "look" to examine your surroundings.',type:"system"},{text:"",type:"normal"}],Hw=[{text:"",type:"normal"},{text:"    CONGRATULATIONS!    ",type:"victory"},{text:"",type:"normal"},{text:"You have discovered THE SECRET OF SNOWPEAK RESORT!",type:"victory"},{text:"",type:"normal"},{text:"With the help of your fellow beginner skiers -- even the angry one -- you uncovered the hidden treasure of Tobias Snowpeak. The Golden Ski Trophy is yours!",type:"victory"},{text:"",type:"normal"},{text:"Thank you for playing!",type:"victory"}],xw="1.8.0",Pw=[{text:"--- AVAILABLE COMMANDS ---",type:"system"},{text:"",type:"normal"},{text:"Movement:    north (n), south (s), east (e), west (w), up (u), down (d)",type:"system"},{text:"Look:        look / look at <thing> -- examine your surroundings or an object",type:"system"},{text:"Take:        take <item> -- pick up an item",type:"system"},{text:"Drop:        drop <item> -- drop an item from your inventory",type:"system"},{text:"Use:         use <item> -- use an item (context-sensitive)",type:"system"},{text:"Talk:        talk to <character> -- speak with someone",type:"system"},{text:"Give:        give <item> to <character> -- offer an item to someone",type:"system"},{text:"Inventory:   inventory (i) -- check what you're carrying",type:"system"},{text:"Read:        read <item> -- read a readable item",type:"system"},{text:"Scores:      scores -- view the high score leaderboard",type:"system"},{text:"Quit:        quit / restart -- return to mode selection",type:"system"},{text:"Help:        help -- show this message",type:"system"},{text:"",type:"normal"},{text:`The Secret of Snowpeak Resort v${xw}`,type:"system"},{text:"",type:"normal"}],zw=()=>{};var ky={};const $T=function(t){const e=[];let i=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[i++]=o:o<2048?(e[i++]=o>>6|192,e[i++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[i++]=o>>18|240,e[i++]=o>>12&63|128,e[i++]=o>>6&63|128,e[i++]=o&63|128):(e[i++]=o>>12|224,e[i++]=o>>6&63|128,e[i++]=o&63|128)}return e},Uw=function(t){const e=[];let i=0,r=0;for(;i<t.length;){const o=t[i++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const u=t[i++];e[r++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=t[i++],h=t[i++],m=t[i++],_=((o&7)<<18|(u&63)<<12|(h&63)<<6|m&63)-65536;e[r++]=String.fromCharCode(55296+(_>>10)),e[r++]=String.fromCharCode(56320+(_&1023))}else{const u=t[i++],h=t[i++];e[r++]=String.fromCharCode((o&15)<<12|(u&63)<<6|h&63)}}return e.join("")},JT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<t.length;o+=3){const u=t[o],h=o+1<t.length,m=h?t[o+1]:0,_=o+2<t.length,p=_?t[o+2]:0,y=u>>2,v=(u&3)<<4|m>>4;let w=(m&15)<<2|p>>6,S=p&63;_||(S=64,h||(w=64)),r.push(i[y],i[v],i[w],i[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($T(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Uw(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const i=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<t.length;){const u=i[t.charAt(o++)],m=o<t.length?i[t.charAt(o)]:0;++o;const p=o<t.length?i[t.charAt(o)]:64;++o;const v=o<t.length?i[t.charAt(o)]:64;if(++o,u==null||m==null||p==null||v==null)throw new Bw;const w=u<<2|m>>4;if(r.push(w),p!==64){const S=m<<4&240|p>>2;if(r.push(S),v!==64){const x=p<<6&192|v;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Bw extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Gw=function(t){const e=$T(t);return JT.encodeByteArray(e,!0)},xc=function(t){return Gw(t).replace(/\./g,"")},qw=function(t){try{return JT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Yw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const jw=()=>Yw().__FIREBASE_DEFAULTS__,Fw=()=>{if(typeof process>"u"||typeof ky>"u")return;const t=ky.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ww=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qw(t[1]);return e&&JSON.parse(e)},lm=()=>{try{return zw()||jw()||Fw()||Ww()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Xw=t=>lm()?.emulatorHosts?.[t],Kw=t=>{const e=Xw(t);if(!e)return;const i=e.lastIndexOf(":");if(i<=0||i+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(i+1),10);return e[0]==="["?[e.substring(1,i-1),r]:[e.substring(0,i),r]},e0=()=>lm()?.config;class Qw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}wrapCallback(e){return(i,r)=>{i?this.reject(i):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(i):e(i,r))}}}function um(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Zw(t){return(await fetch(t,{credentials:"include"})).ok}function $w(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},r=e||"demo-project",o=t.iat||0,u=t.sub||t.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...t};return[xc(JSON.stringify(i)),xc(JSON.stringify(h)),""].join(".")}const bl={};function Jw(){const t={prod:[],emulator:[]};for(const e of Object.keys(bl))bl[e]?t.emulator.push(e):t.prod.push(e);return t}function eb(t){let e=document.getElementById(t),i=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),i=!0),{created:i,element:e}}let Oy=!1;function tb(t,e){if(typeof window>"u"||typeof document>"u"||!um(window.location.host)||bl[t]===e||bl[t]||Oy)return;bl[t]=e;function i(w){return`__firebase__banner__${w}`}const r="__firebase__banner",u=Jw().prod.length>0;function h(){const w=document.getElementById(r);w&&w.remove()}function m(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function _(w,S){w.setAttribute("width","24"),w.setAttribute("id",S),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function p(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{Oy=!0,h()},w}function y(w,S){w.setAttribute("id",S),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function v(){const w=eb(r),S=i("text"),x=document.getElementById(S)||document.createElement("span"),V=i("learnmore"),H=document.getElementById(V)||document.createElement("a"),Q=i("preprendIcon"),$=document.getElementById(Q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const le=w.element;m(le),y(H,V);const ce=p();_($,Q),le.append($,x,H,ce),document.body.appendChild(le)}u?(x.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function nb(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ib(){const t=lm()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ab(){return!ib()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rb(){try{return typeof indexedDB=="object"}catch{return!1}}function sb(){return new Promise((t,e)=>{try{let i=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),i||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=()=>{i=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(i){e(i)}})}const ob="FirebaseError";class ao extends Error{constructor(e,i,r){super(i),this.code=e,this.customData=r,this.name=ob,Object.setPrototypeOf(this,ao.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t0.prototype.create)}}class t0{constructor(e,i,r){this.service=e,this.serviceName=i,this.errors=r}create(e,...i){const r=i[0]||{},o=`${this.service}/${e}`,u=this.errors[e],h=u?lb(u,r):"Error",m=`${this.serviceName}: ${h} (${o}).`;return new ao(o,m,r)}}function lb(t,e){return t.replace(ub,(i,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const ub=/\{\$([^}]+)}/g;function Pc(t,e){if(t===e)return!0;const i=Object.keys(t),r=Object.keys(e);for(const o of i){if(!r.includes(o))return!1;const u=t[o],h=e[o];if(Dy(u)&&Dy(h)){if(!Pc(u,h))return!1}else if(u!==h)return!1}for(const o of r)if(!i.includes(o))return!1;return!0}function Dy(t){return t!==null&&typeof t=="object"}function Zs(t){return t&&t._delegate?t._delegate:t}class Dl{constructor(e,i,r){this.name=e,this.instanceFactory=i,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ur="[DEFAULT]";class cb{constructor(e,i){this.name=e,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const i=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(i)){const r=new Qw;if(this.instancesDeferred.set(i,r),this.isInitialized(i)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:i});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(e){const i=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fb(e))try{this.getOrInitializeService({instanceIdentifier:Ur})}catch{}for(const[i,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);try{const u=this.getOrInitializeService({instanceIdentifier:o});r.resolve(u)}catch{}}}}clearInstance(e=Ur){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...e.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ur){return this.instances.has(e)}getOptions(e=Ur){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:i={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:i});for(const[u,h]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(u);r===m&&h.resolve(o)}return o}onInit(e,i){const r=this.normalizeInstanceIdentifier(i),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);const u=this.instances.get(r);return u&&e(u,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,i){const r=this.onInitCallbacks.get(i);if(r)for(const o of r)try{o(e,i)}catch{}}getOrInitializeService({instanceIdentifier:e,options:i={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:hb(e),options:i}),this.instances.set(e,r),this.instancesOptions.set(e,i),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ur){return this.component?this.component.multipleInstances?e:Ur:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hb(t){return t===Ur?void 0:t}function fb(t){return t.instantiationMode==="EAGER"}class db{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const i=this.getProvider(e.name);if(i.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);i.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const i=new cb(e,this);return this.providers.set(e,i),i}getProviders(){return Array.from(this.providers.values())}}var qe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(qe||(qe={}));const mb={debug:qe.DEBUG,verbose:qe.VERBOSE,info:qe.INFO,warn:qe.WARN,error:qe.ERROR,silent:qe.SILENT},_b=qe.INFO,pb={[qe.DEBUG]:"log",[qe.VERBOSE]:"log",[qe.INFO]:"info",[qe.WARN]:"warn",[qe.ERROR]:"error"},gb=(t,e,...i)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),o=pb[e];if(o)console[o](`[${r}]  ${t.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class n0{constructor(e){this.name=e,this._logLevel=_b,this._logHandler=gb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qe.DEBUG,...e),this._logHandler(this,qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qe.VERBOSE,...e),this._logHandler(this,qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qe.INFO,...e),this._logHandler(this,qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qe.WARN,...e),this._logHandler(this,qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qe.ERROR,...e),this._logHandler(this,qe.ERROR,...e)}}const yb=(t,e)=>e.some(i=>t instanceof i);let Ny,Cy;function Tb(){return Ny||(Ny=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Eb(){return Cy||(Cy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const i0=new WeakMap,xd=new WeakMap,a0=new WeakMap,wd=new WeakMap,cm=new WeakMap;function vb(t){const e=new Promise((i,r)=>{const o=()=>{t.removeEventListener("success",u),t.removeEventListener("error",h)},u=()=>{i(Za(t.result)),o()},h=()=>{r(t.error),o()};t.addEventListener("success",u),t.addEventListener("error",h)});return e.then(i=>{i instanceof IDBCursor&&i0.set(i,t)}).catch(()=>{}),cm.set(e,t),e}function wb(t){if(xd.has(t))return;const e=new Promise((i,r)=>{const o=()=>{t.removeEventListener("complete",u),t.removeEventListener("error",h),t.removeEventListener("abort",h)},u=()=>{i(),o()},h=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",u),t.addEventListener("error",h),t.addEventListener("abort",h)});xd.set(t,e)}let Pd={get(t,e,i){if(t instanceof IDBTransaction){if(e==="done")return xd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||a0.get(t);if(e==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return Za(t[e])},set(t,e,i){return t[e]=i,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bb(t){Pd=t(Pd)}function Ab(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...i){const r=t.call(bd(this),e,...i);return a0.set(r,e.sort?e.sort():[e]),Za(r)}:Eb().includes(t)?function(...e){return t.apply(bd(this),e),Za(i0.get(this))}:function(...e){return Za(t.apply(bd(this),e))}}function Sb(t){return typeof t=="function"?Ab(t):(t instanceof IDBTransaction&&wb(t),yb(t,Tb())?new Proxy(t,Pd):t)}function Za(t){if(t instanceof IDBRequest)return vb(t);if(wd.has(t))return wd.get(t);const e=Sb(t);return e!==t&&(wd.set(t,e),cm.set(e,t)),e}const bd=t=>cm.get(t);function Rb(t,e,{blocked:i,upgrade:r,blocking:o,terminated:u}={}){const h=indexedDB.open(t,e),m=Za(h);return r&&h.addEventListener("upgradeneeded",_=>{r(Za(h.result),_.oldVersion,_.newVersion,Za(h.transaction),_)}),i&&h.addEventListener("blocked",_=>i(_.oldVersion,_.newVersion,_)),m.then(_=>{u&&_.addEventListener("close",()=>u()),o&&_.addEventListener("versionchange",p=>o(p.oldVersion,p.newVersion,p))}).catch(()=>{}),m}const Ib=["get","getKey","getAll","getAllKeys","count"],kb=["put","add","delete","clear"],Ad=new Map;function My(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ad.get(e))return Ad.get(e);const i=e.replace(/FromIndex$/,""),r=e!==i,o=kb.includes(i);if(!(i in(r?IDBIndex:IDBObjectStore).prototype)||!(o||Ib.includes(i)))return;const u=async function(h,...m){const _=this.transaction(h,o?"readwrite":"readonly");let p=_.store;return r&&(p=p.index(m.shift())),(await Promise.all([p[i](...m),o&&_.done]))[0]};return Ad.set(e,u),u}bb(t=>({...t,get:(e,i,r)=>My(e,i)||t.get(e,i,r),has:(e,i)=>!!My(e,i)||t.has(e,i)}));class Ob{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(Db(i)){const r=i.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(i=>i).join(" ")}}function Db(t){return t.getComponent()?.type==="VERSION"}const zd="@firebase/app",Vy="0.14.8";const da=new n0("@firebase/app"),Nb="@firebase/app-compat",Cb="@firebase/analytics-compat",Mb="@firebase/analytics",Vb="@firebase/app-check-compat",Lb="@firebase/app-check",Hb="@firebase/auth",xb="@firebase/auth-compat",Pb="@firebase/database",zb="@firebase/data-connect",Ub="@firebase/database-compat",Bb="@firebase/functions",Gb="@firebase/functions-compat",qb="@firebase/installations",Yb="@firebase/installations-compat",jb="@firebase/messaging",Fb="@firebase/messaging-compat",Wb="@firebase/performance",Xb="@firebase/performance-compat",Kb="@firebase/remote-config",Qb="@firebase/remote-config-compat",Zb="@firebase/storage",$b="@firebase/storage-compat",Jb="@firebase/firestore",eA="@firebase/ai",tA="@firebase/firestore-compat",nA="firebase",iA="12.9.0";const Ud="[DEFAULT]",aA={[zd]:"fire-core",[Nb]:"fire-core-compat",[Mb]:"fire-analytics",[Cb]:"fire-analytics-compat",[Lb]:"fire-app-check",[Vb]:"fire-app-check-compat",[Hb]:"fire-auth",[xb]:"fire-auth-compat",[Pb]:"fire-rtdb",[zb]:"fire-data-connect",[Ub]:"fire-rtdb-compat",[Bb]:"fire-fn",[Gb]:"fire-fn-compat",[qb]:"fire-iid",[Yb]:"fire-iid-compat",[jb]:"fire-fcm",[Fb]:"fire-fcm-compat",[Wb]:"fire-perf",[Xb]:"fire-perf-compat",[Kb]:"fire-rc",[Qb]:"fire-rc-compat",[Zb]:"fire-gcs",[$b]:"fire-gcs-compat",[Jb]:"fire-fst",[tA]:"fire-fst-compat",[eA]:"fire-vertex","fire-js":"fire-js",[nA]:"fire-js-all"};const zc=new Map,rA=new Map,Bd=new Map;function Ly(t,e){try{t.container.addComponent(e)}catch(i){da.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,i)}}function Uc(t){const e=t.name;if(Bd.has(e))return da.debug(`There were multiple attempts to register component ${e}.`),!1;Bd.set(e,t);for(const i of zc.values())Ly(i,t);for(const i of rA.values())Ly(i,t);return!0}function sA(t,e){const i=t.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),t.container.getProvider(e)}function oA(t){return t==null?!1:t.settings!==void 0}const lA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$a=new t0("app","Firebase",lA);class uA{constructor(e,i,r){this._isDeleted=!1,this._options={...e},this._config={...i},this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $a.create("app-deleted",{appName:this._name})}}const cA=iA;function r0(t,e={}){let i=t;typeof e!="object"&&(e={name:e});const r={name:Ud,automaticDataCollectionEnabled:!0,...e},o=r.name;if(typeof o!="string"||!o)throw $a.create("bad-app-name",{appName:String(o)});if(i||(i=e0()),!i)throw $a.create("no-options");const u=zc.get(o);if(u){if(Pc(i,u.options)&&Pc(r,u.config))return u;throw $a.create("duplicate-app",{appName:o})}const h=new db(o);for(const _ of Bd.values())h.addComponent(_);const m=new uA(i,r,h);return zc.set(o,m),m}function hA(t=Ud){const e=zc.get(t);if(!e&&t===Ud&&e0())return r0();if(!e)throw $a.create("no-app",{appName:t});return e}function Ys(t,e,i){let r=aA[t]??t;i&&(r+=`-${i}`);const o=r.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const h=[`Unable to register library "${r}" with version "${e}":`];o&&h.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),da.warn(h.join(" "));return}Uc(new Dl(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const fA="firebase-heartbeat-database",dA=1,Nl="firebase-heartbeat-store";let Sd=null;function s0(){return Sd||(Sd=Rb(fA,dA,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Nl)}catch(i){console.warn(i)}}}}).catch(t=>{throw $a.create("idb-open",{originalErrorMessage:t.message})})),Sd}async function mA(t){try{const i=(await s0()).transaction(Nl),r=await i.objectStore(Nl).get(o0(t));return await i.done,r}catch(e){if(e instanceof ao)da.warn(e.message);else{const i=$a.create("idb-get",{originalErrorMessage:e?.message});da.warn(i.message)}}}async function Hy(t,e){try{const r=(await s0()).transaction(Nl,"readwrite");await r.objectStore(Nl).put(e,o0(t)),await r.done}catch(i){if(i instanceof ao)da.warn(i.message);else{const r=$a.create("idb-set",{originalErrorMessage:i?.message});da.warn(r.message)}}}function o0(t){return`${t.name}!${t.options.appId}`}const _A=1024,pA=30;class gA{constructor(e){this.container=e,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new TA(i),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=xy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>pA){const o=EA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){da.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xy(),{heartbeatsToSend:i,unsentEntries:r}=yA(this._heartbeatsCache.heartbeats),o=xc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return da.warn(e),""}}}function xy(){return new Date().toISOString().substring(0,10)}function yA(t,e=_A){const i=[];let r=t.slice();for(const o of t){const u=i.find(h=>h.agent===o.agent);if(u){if(u.dates.push(o.date),Py(i)>e){u.dates.pop();break}}else if(i.push({agent:o.agent,dates:[o.date]}),Py(i)>e){i.pop();break}r=r.slice(1)}return{heartbeatsToSend:i,unsentEntries:r}}class TA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rb()?sb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const i=await mA(this.app);return i?.heartbeats?i:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Hy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Hy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Py(t){return xc(JSON.stringify({version:2,heartbeats:t})).length}function EA(t){if(t.length===0)return-1;let e=0,i=t[0].date;for(let r=1;r<t.length;r++)t[r].date<i&&(i=t[r].date,e=r);return e}function vA(t){Uc(new Dl("platform-logger",e=>new Ob(e),"PRIVATE")),Uc(new Dl("heartbeat",e=>new gA(e),"PRIVATE")),Ys(zd,Vy,t),Ys(zd,Vy,"esm2020"),Ys("fire-js","")}vA("");var wA="firebase",bA="12.9.0";Ys(wA,bA,"app");var zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ja,l0;(function(){var t;function e(O,R){function D(){}D.prototype=R.prototype,O.F=R.prototype,O.prototype=new D,O.prototype.constructor=O,O.D=function(P,M,U){for(var I=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)I[_t-2]=arguments[_t];return R.prototype[M].apply(P,I)}}function i(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,i),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(O,R,D){D||(D=0);const P=Array(16);if(typeof R=="string")for(var M=0;M<16;++M)P[M]=R.charCodeAt(D++)|R.charCodeAt(D++)<<8|R.charCodeAt(D++)<<16|R.charCodeAt(D++)<<24;else for(M=0;M<16;++M)P[M]=R[D++]|R[D++]<<8|R[D++]<<16|R[D++]<<24;R=O.g[0],D=O.g[1],M=O.g[2];let U=O.g[3],I;I=R+(U^D&(M^U))+P[0]+3614090360&4294967295,R=D+(I<<7&4294967295|I>>>25),I=U+(M^R&(D^M))+P[1]+3905402710&4294967295,U=R+(I<<12&4294967295|I>>>20),I=M+(D^U&(R^D))+P[2]+606105819&4294967295,M=U+(I<<17&4294967295|I>>>15),I=D+(R^M&(U^R))+P[3]+3250441966&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(U^D&(M^U))+P[4]+4118548399&4294967295,R=D+(I<<7&4294967295|I>>>25),I=U+(M^R&(D^M))+P[5]+1200080426&4294967295,U=R+(I<<12&4294967295|I>>>20),I=M+(D^U&(R^D))+P[6]+2821735955&4294967295,M=U+(I<<17&4294967295|I>>>15),I=D+(R^M&(U^R))+P[7]+4249261313&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(U^D&(M^U))+P[8]+1770035416&4294967295,R=D+(I<<7&4294967295|I>>>25),I=U+(M^R&(D^M))+P[9]+2336552879&4294967295,U=R+(I<<12&4294967295|I>>>20),I=M+(D^U&(R^D))+P[10]+4294925233&4294967295,M=U+(I<<17&4294967295|I>>>15),I=D+(R^M&(U^R))+P[11]+2304563134&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(U^D&(M^U))+P[12]+1804603682&4294967295,R=D+(I<<7&4294967295|I>>>25),I=U+(M^R&(D^M))+P[13]+4254626195&4294967295,U=R+(I<<12&4294967295|I>>>20),I=M+(D^U&(R^D))+P[14]+2792965006&4294967295,M=U+(I<<17&4294967295|I>>>15),I=D+(R^M&(U^R))+P[15]+1236535329&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(M^U&(D^M))+P[1]+4129170786&4294967295,R=D+(I<<5&4294967295|I>>>27),I=U+(D^M&(R^D))+P[6]+3225465664&4294967295,U=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(U^R))+P[11]+643717713&4294967295,M=U+(I<<14&4294967295|I>>>18),I=D+(U^R&(M^U))+P[0]+3921069994&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(M^U&(D^M))+P[5]+3593408605&4294967295,R=D+(I<<5&4294967295|I>>>27),I=U+(D^M&(R^D))+P[10]+38016083&4294967295,U=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(U^R))+P[15]+3634488961&4294967295,M=U+(I<<14&4294967295|I>>>18),I=D+(U^R&(M^U))+P[4]+3889429448&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(M^U&(D^M))+P[9]+568446438&4294967295,R=D+(I<<5&4294967295|I>>>27),I=U+(D^M&(R^D))+P[14]+3275163606&4294967295,U=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(U^R))+P[3]+4107603335&4294967295,M=U+(I<<14&4294967295|I>>>18),I=D+(U^R&(M^U))+P[8]+1163531501&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(M^U&(D^M))+P[13]+2850285829&4294967295,R=D+(I<<5&4294967295|I>>>27),I=U+(D^M&(R^D))+P[2]+4243563512&4294967295,U=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(U^R))+P[7]+1735328473&4294967295,M=U+(I<<14&4294967295|I>>>18),I=D+(U^R&(M^U))+P[12]+2368359562&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(D^M^U)+P[5]+4294588738&4294967295,R=D+(I<<4&4294967295|I>>>28),I=U+(R^D^M)+P[8]+2272392833&4294967295,U=R+(I<<11&4294967295|I>>>21),I=M+(U^R^D)+P[11]+1839030562&4294967295,M=U+(I<<16&4294967295|I>>>16),I=D+(M^U^R)+P[14]+4259657740&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(D^M^U)+P[1]+2763975236&4294967295,R=D+(I<<4&4294967295|I>>>28),I=U+(R^D^M)+P[4]+1272893353&4294967295,U=R+(I<<11&4294967295|I>>>21),I=M+(U^R^D)+P[7]+4139469664&4294967295,M=U+(I<<16&4294967295|I>>>16),I=D+(M^U^R)+P[10]+3200236656&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(D^M^U)+P[13]+681279174&4294967295,R=D+(I<<4&4294967295|I>>>28),I=U+(R^D^M)+P[0]+3936430074&4294967295,U=R+(I<<11&4294967295|I>>>21),I=M+(U^R^D)+P[3]+3572445317&4294967295,M=U+(I<<16&4294967295|I>>>16),I=D+(M^U^R)+P[6]+76029189&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(D^M^U)+P[9]+3654602809&4294967295,R=D+(I<<4&4294967295|I>>>28),I=U+(R^D^M)+P[12]+3873151461&4294967295,U=R+(I<<11&4294967295|I>>>21),I=M+(U^R^D)+P[15]+530742520&4294967295,M=U+(I<<16&4294967295|I>>>16),I=D+(M^U^R)+P[2]+3299628645&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(M^(D|~U))+P[0]+4096336452&4294967295,R=D+(I<<6&4294967295|I>>>26),I=U+(D^(R|~M))+P[7]+1126891415&4294967295,U=R+(I<<10&4294967295|I>>>22),I=M+(R^(U|~D))+P[14]+2878612391&4294967295,M=U+(I<<15&4294967295|I>>>17),I=D+(U^(M|~R))+P[5]+4237533241&4294967295,D=M+(I<<21&4294967295|I>>>11),I=R+(M^(D|~U))+P[12]+1700485571&4294967295,R=D+(I<<6&4294967295|I>>>26),I=U+(D^(R|~M))+P[3]+2399980690&4294967295,U=R+(I<<10&4294967295|I>>>22),I=M+(R^(U|~D))+P[10]+4293915773&4294967295,M=U+(I<<15&4294967295|I>>>17),I=D+(U^(M|~R))+P[1]+2240044497&4294967295,D=M+(I<<21&4294967295|I>>>11),I=R+(M^(D|~U))+P[8]+1873313359&4294967295,R=D+(I<<6&4294967295|I>>>26),I=U+(D^(R|~M))+P[15]+4264355552&4294967295,U=R+(I<<10&4294967295|I>>>22),I=M+(R^(U|~D))+P[6]+2734768916&4294967295,M=U+(I<<15&4294967295|I>>>17),I=D+(U^(M|~R))+P[13]+1309151649&4294967295,D=M+(I<<21&4294967295|I>>>11),I=R+(M^(D|~U))+P[4]+4149444226&4294967295,R=D+(I<<6&4294967295|I>>>26),I=U+(D^(R|~M))+P[11]+3174756917&4294967295,U=R+(I<<10&4294967295|I>>>22),I=M+(R^(U|~D))+P[2]+718787259&4294967295,M=U+(I<<15&4294967295|I>>>17),I=D+(U^(M|~R))+P[9]+3951481745&4294967295,O.g[0]=O.g[0]+R&4294967295,O.g[1]=O.g[1]+(M+(I<<21&4294967295|I>>>11))&4294967295,O.g[2]=O.g[2]+M&4294967295,O.g[3]=O.g[3]+U&4294967295}r.prototype.v=function(O,R){R===void 0&&(R=O.length);const D=R-this.blockSize,P=this.C;let M=this.h,U=0;for(;U<R;){if(M==0)for(;U<=D;)o(this,O,U),U+=this.blockSize;if(typeof O=="string"){for(;U<R;)if(P[M++]=O.charCodeAt(U++),M==this.blockSize){o(this,P),M=0;break}}else for(;U<R;)if(P[M++]=O[U++],M==this.blockSize){o(this,P),M=0;break}}this.h=M,this.o+=R},r.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var R=1;R<O.length-8;++R)O[R]=0;R=this.o*8;for(var D=O.length-8;D<O.length;++D)O[D]=R&255,R/=256;for(this.v(O),O=Array(16),R=0,D=0;D<4;++D)for(let P=0;P<32;P+=8)O[R++]=this.g[D]>>>P&255;return O};function u(O,R){var D=m;return Object.prototype.hasOwnProperty.call(D,O)?D[O]:D[O]=R(O)}function h(O,R){this.h=R;const D=[];let P=!0;for(let M=O.length-1;M>=0;M--){const U=O[M]|0;P&&U==R||(D[M]=U,P=!1)}this.g=D}var m={};function _(O){return-128<=O&&O<128?u(O,function(R){return new h([R|0],R<0?-1:0)}):new h([O|0],O<0?-1:0)}function p(O){if(isNaN(O)||!isFinite(O))return v;if(O<0)return H(p(-O));const R=[];let D=1;for(let P=0;O>=D;P++)R[P]=O/D|0,D*=4294967296;return new h(R,0)}function y(O,R){if(O.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(O.charAt(0)=="-")return H(y(O.substring(1),R));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=p(Math.pow(R,8));let P=v;for(let U=0;U<O.length;U+=8){var M=Math.min(8,O.length-U);const I=parseInt(O.substring(U,U+M),R);M<8?(M=p(Math.pow(R,M)),P=P.j(M).add(p(I))):(P=P.j(D),P=P.add(p(I)))}return P}var v=_(0),w=_(1),S=_(16777216);t=h.prototype,t.m=function(){if(V(this))return-H(this).m();let O=0,R=1;for(let D=0;D<this.g.length;D++){const P=this.i(D);O+=(P>=0?P:4294967296+P)*R,R*=4294967296}return O},t.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(x(this))return"0";if(V(this))return"-"+H(this).toString(O);const R=p(Math.pow(O,6));var D=this;let P="";for(;;){const M=ce(D,R).g;D=Q(D,M.j(R));let U=((D.g.length>0?D.g[0]:D.h)>>>0).toString(O);if(D=M,x(D))return U+P;for(;U.length<6;)U="0"+U;P=U+P}},t.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function x(O){if(O.h!=0)return!1;for(let R=0;R<O.g.length;R++)if(O.g[R]!=0)return!1;return!0}function V(O){return O.h==-1}t.l=function(O){return O=Q(this,O),V(O)?-1:x(O)?0:1};function H(O){const R=O.g.length,D=[];for(let P=0;P<R;P++)D[P]=~O.g[P];return new h(D,~O.h).add(w)}t.abs=function(){return V(this)?H(this):this},t.add=function(O){const R=Math.max(this.g.length,O.g.length),D=[];let P=0;for(let M=0;M<=R;M++){let U=P+(this.i(M)&65535)+(O.i(M)&65535),I=(U>>>16)+(this.i(M)>>>16)+(O.i(M)>>>16);P=I>>>16,U&=65535,I&=65535,D[M]=I<<16|U}return new h(D,D[D.length-1]&-2147483648?-1:0)};function Q(O,R){return O.add(H(R))}t.j=function(O){if(x(this)||x(O))return v;if(V(this))return V(O)?H(this).j(H(O)):H(H(this).j(O));if(V(O))return H(this.j(H(O)));if(this.l(S)<0&&O.l(S)<0)return p(this.m()*O.m());const R=this.g.length+O.g.length,D=[];for(var P=0;P<2*R;P++)D[P]=0;for(P=0;P<this.g.length;P++)for(let M=0;M<O.g.length;M++){const U=this.i(P)>>>16,I=this.i(P)&65535,_t=O.i(M)>>>16,Bt=O.i(M)&65535;D[2*P+2*M]+=I*Bt,$(D,2*P+2*M),D[2*P+2*M+1]+=U*Bt,$(D,2*P+2*M+1),D[2*P+2*M+1]+=I*_t,$(D,2*P+2*M+1),D[2*P+2*M+2]+=U*_t,$(D,2*P+2*M+2)}for(O=0;O<R;O++)D[O]=D[2*O+1]<<16|D[2*O];for(O=R;O<2*R;O++)D[O]=0;return new h(D,0)};function $(O,R){for(;(O[R]&65535)!=O[R];)O[R+1]+=O[R]>>>16,O[R]&=65535,R++}function le(O,R){this.g=O,this.h=R}function ce(O,R){if(x(R))throw Error("division by zero");if(x(O))return new le(v,v);if(V(O))return R=ce(H(O),R),new le(H(R.g),H(R.h));if(V(R))return R=ce(O,H(R)),new le(H(R.g),R.h);if(O.g.length>30){if(V(O)||V(R))throw Error("slowDivide_ only works with positive integers.");for(var D=w,P=R;P.l(O)<=0;)D=ot(D),P=ot(P);var M=ze(D,1),U=ze(P,1);for(P=ze(P,2),D=ze(D,2);!x(P);){var I=U.add(P);I.l(O)<=0&&(M=M.add(D),U=I),P=ze(P,1),D=ze(D,1)}return R=Q(O,M.j(R)),new le(M,R)}for(M=v;O.l(R)>=0;){for(D=Math.max(1,Math.floor(O.m()/R.m())),P=Math.ceil(Math.log(D)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),U=p(D),I=U.j(R);V(I)||I.l(O)>0;)D-=P,U=p(D),I=U.j(R);x(U)&&(U=w),M=M.add(U),O=Q(O,I)}return new le(M,O)}t.B=function(O){return ce(this,O).h},t.and=function(O){const R=Math.max(this.g.length,O.g.length),D=[];for(let P=0;P<R;P++)D[P]=this.i(P)&O.i(P);return new h(D,this.h&O.h)},t.or=function(O){const R=Math.max(this.g.length,O.g.length),D=[];for(let P=0;P<R;P++)D[P]=this.i(P)|O.i(P);return new h(D,this.h|O.h)},t.xor=function(O){const R=Math.max(this.g.length,O.g.length),D=[];for(let P=0;P<R;P++)D[P]=this.i(P)^O.i(P);return new h(D,this.h^O.h)};function ot(O){const R=O.g.length+1,D=[];for(let P=0;P<R;P++)D[P]=O.i(P)<<1|O.i(P-1)>>>31;return new h(D,O.h)}function ze(O,R){const D=R>>5;R%=32;const P=O.g.length-D,M=[];for(let U=0;U<P;U++)M[U]=R>0?O.i(U+D)>>>R|O.i(U+D+1)<<32-R:O.i(U+D);return new h(M,O.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,l0=r,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=p,h.fromString=y,Ja=h}).apply(typeof zy<"u"?zy:typeof self<"u"?self:typeof window<"u"?window:{});var bc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var u0,El,c0,Nc,Gd,h0,f0,d0;(function(){var t,e=Object.defineProperty;function i(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof bc=="object"&&bc];for(var g=0;g<c.length;++g){var E=c[g];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=i(this);function o(c,g){if(g)e:{var E=r;c=c.split(".");for(var A=0;A<c.length-1;A++){var B=c[A];if(!(B in E))break e;E=E[B]}c=c[c.length-1],A=E[c],g=g(A),g!=A&&g!=null&&e(E,c,{configurable:!0,writable:!0,value:g})}}o("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(c){return c||function(g){var E=[],A;for(A in g)Object.prototype.hasOwnProperty.call(g,A)&&E.push([A,g[A]]);return E}});var u=u||{},h=this||self;function m(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function _(c,g,E){return c.call.apply(c.bind,arguments)}function p(c,g,E){return p=_,p.apply(null,arguments)}function y(c,g){var E=Array.prototype.slice.call(arguments,1);return function(){var A=E.slice();return A.push.apply(A,arguments),c.apply(this,A)}}function v(c,g){function E(){}E.prototype=g.prototype,c.Z=g.prototype,c.prototype=new E,c.prototype.constructor=c,c.Ob=function(A,B,j){for(var ae=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)ae[ke-2]=arguments[ke];return g.prototype[B].apply(A,ae)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function S(c){const g=c.length;if(g>0){const E=Array(g);for(let A=0;A<g;A++)E[A]=c[A];return E}return[]}function x(c,g){for(let A=1;A<arguments.length;A++){const B=arguments[A];var E=typeof B;if(E=E!="object"?E:B?Array.isArray(B)?"array":E:"null",E=="array"||E=="object"&&typeof B.length=="number"){E=c.length||0;const j=B.length||0;c.length=E+j;for(let ae=0;ae<j;ae++)c[E+ae]=B[ae]}else c.push(B)}}class V{constructor(g,E){this.i=g,this.j=E,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function H(c){h.setTimeout(()=>{throw c},0)}function Q(){var c=O;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class ${constructor(){this.h=this.g=null}add(g,E){const A=le.get();A.set(g,E),this.h?this.h.next=A:this.g=A,this.h=A}}var le=new V(()=>new ce,c=>c.reset());class ce{constructor(){this.next=this.g=this.h=null}set(g,E){this.h=g,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ot,ze=!1,O=new $,R=()=>{const c=Promise.resolve(void 0);ot=()=>{c.then(D)}};function D(){for(var c;c=Q();){try{c.h.call(c.g)}catch(E){H(E)}var g=le;g.j(c),g.h<100&&(g.h++,c.next=g.g,g.g=c)}ze=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const E=()=>{};h.addEventListener("test",E,g),h.removeEventListener("test",E,g)}catch{}return c})();function I(c){return/^[\s\xa0]*$/.test(c)}function _t(c,g){M.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,g)}v(_t,M),_t.prototype.init=function(c,g){const E=this.type=c.type,A=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget,g||(E=="mouseover"?g=c.fromElement:E=="mouseout"&&(g=c.toElement)),this.relatedTarget=g,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&_t.Z.h.call(this)},_t.prototype.h=function(){_t.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Bt="closure_listenable_"+(Math.random()*1e6|0),K=0;function re(c,g,E,A,B){this.listener=c,this.proxy=null,this.src=g,this.type=E,this.capture=!!A,this.ha=B,this.key=++K,this.da=this.fa=!1}function ye(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function je(c,g,E){for(const A in c)g.call(E,c[A],A,c)}function Je(c,g){for(const E in c)g.call(void 0,c[E],E,c)}function L(c){const g={};for(const E in c)g[E]=c[E];return g}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function se(c,g){let E,A;for(let B=1;B<arguments.length;B++){A=arguments[B];for(E in A)c[E]=A[E];for(let j=0;j<te.length;j++)E=te[j],Object.prototype.hasOwnProperty.call(A,E)&&(c[E]=A[E])}}function fe(c){this.src=c,this.g={},this.h=0}fe.prototype.add=function(c,g,E,A,B){const j=c.toString();c=this.g[j],c||(c=this.g[j]=[],this.h++);const ae=Ne(c,g,A,B);return ae>-1?(g=c[ae],E||(g.fa=!1)):(g=new re(g,this.src,j,!!A,B),g.fa=E,c.push(g)),g};function be(c,g){const E=g.type;if(E in c.g){var A=c.g[E],B=Array.prototype.indexOf.call(A,g,void 0),j;(j=B>=0)&&Array.prototype.splice.call(A,B,1),j&&(ye(g),c.g[E].length==0&&(delete c.g[E],c.h--))}}function Ne(c,g,E,A){for(let B=0;B<c.length;++B){const j=c[B];if(!j.da&&j.listener==g&&j.capture==!!E&&j.ha==A)return B}return-1}var Be="closure_lm_"+(Math.random()*1e6|0),Gt={};function pt(c,g,E,A,B){if(Array.isArray(g)){for(let j=0;j<g.length;j++)pt(c,g[j],E,A,B);return null}return E=_o(E),c&&c[Bt]?c.J(g,E,m(A)?!!A.capture:!1,B):ur(c,g,E,!1,A,B)}function ur(c,g,E,A,B,j){if(!g)throw Error("Invalid event type");const ae=m(B)?!!B.capture:!!B;let ke=cr(c);if(ke||(c[Be]=ke=new fe(c)),E=ke.add(g,E,A,ae,j),E.proxy)return E;if(A=Kr(),E.proxy=A,A.src=c,A.listener=E,c.addEventListener)U||(B=ae),B===void 0&&(B=!1),c.addEventListener(g.toString(),A,B);else if(c.attachEvent)c.attachEvent(Ei(g.toString()),A);else if(c.addListener&&c.removeListener)c.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Kr(){function c(E){return g.call(c.src,c.listener,E)}const g=fo;return c}function Qr(c,g,E,A,B){if(Array.isArray(g))for(var j=0;j<g.length;j++)Qr(c,g[j],E,A,B);else A=m(A)?!!A.capture:!!A,E=_o(E),c&&c[Bt]?(c=c.i,j=String(g).toString(),j in c.g&&(g=c.g[j],E=Ne(g,E,A,B),E>-1&&(ye(g[E]),Array.prototype.splice.call(g,E,1),g.length==0&&(delete c.g[j],c.h--)))):c&&(c=cr(c))&&(g=c.g[g.toString()],c=-1,g&&(c=Ne(g,E,A,B)),(E=c>-1?g[c]:null)&&Zr(E))}function Zr(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Bt])be(g.i,c);else{var E=c.type,A=c.proxy;g.removeEventListener?g.removeEventListener(E,A,c.capture):g.detachEvent?g.detachEvent(Ei(E),A):g.addListener&&g.removeListener&&g.removeListener(A),(E=cr(g))?(be(E,c),E.h==0&&(E.src=null,g[Be]=null)):ye(c)}}}function Ei(c){return c in Gt?Gt[c]:Gt[c]="on"+c}function fo(c,g){if(c.da)c=!0;else{g=new _t(g,this);const E=c.listener,A=c.ha||c.src;c.fa&&Zr(c),c=E.call(A,g)}return c}function cr(c){return c=c[Be],c instanceof fe?c:null}var mo="__closure_events_fn_"+(Math.random()*1e9>>>0);function _o(c){return typeof c=="function"?c:(c[mo]||(c[mo]=function(g){return c.handleEvent(g)}),c[mo])}function Ot(){P.call(this),this.i=new fe(this),this.M=this,this.G=null}v(Ot,P),Ot.prototype[Bt]=!0,Ot.prototype.removeEventListener=function(c,g,E,A){Qr(this,c,g,E,A)};function qt(c,g){var E,A=c.G;if(A)for(E=[];A;A=A.G)E.push(A);if(c=c.M,A=g.type||g,typeof g=="string")g=new M(g,c);else if(g instanceof M)g.target=g.target||c;else{var B=g;g=new M(A,c),se(g,B)}B=!0;let j,ae;if(E)for(ae=E.length-1;ae>=0;ae--)j=g.g=E[ae],B=pa(j,A,!0,g)&&B;if(j=g.g=c,B=pa(j,A,!0,g)&&B,B=pa(j,A,!1,g)&&B,E)for(ae=0;ae<E.length;ae++)j=g.g=E[ae],B=pa(j,A,!1,g)&&B}Ot.prototype.N=function(){if(Ot.Z.N.call(this),this.i){var c=this.i;for(const g in c.g){const E=c.g[g];for(let A=0;A<E.length;A++)ye(E[A]);delete c.g[g],c.h--}}this.G=null},Ot.prototype.J=function(c,g,E,A){return this.i.add(String(c),g,!1,E,A)},Ot.prototype.K=function(c,g,E,A){return this.i.add(String(c),g,!0,E,A)};function pa(c,g,E,A){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();let B=!0;for(let j=0;j<g.length;++j){const ae=g[j];if(ae&&!ae.da&&ae.capture==E){const ke=ae.listener,St=ae.ha||ae.src;ae.fa&&be(c.i,ae),B=ke.call(St,A)!==!1&&B}}return B&&!A.defaultPrevented}function gh(c,g){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:h.setTimeout(c,g||0)}function Xl(c){c.g=gh(()=>{c.g=null,c.i&&(c.i=!1,Xl(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class _n extends P{constructor(g,E){super(),this.m=g,this.l=E,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Xl(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hr(c){P.call(this),this.h=c,this.g={}}v(hr,P);var po=[];function go(c){je(c.g,function(g,E){this.g.hasOwnProperty(E)&&Zr(g)},c),c.g={}}hr.prototype.N=function(){hr.Z.N.call(this),go(this)},hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ga=h.JSON.stringify,yh=h.JSON.parse,Kl=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function Ql(){}function Zl(){}var ii={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Zt(){M.call(this,"d")}v(Zt,M);function zn(){M.call(this,"c")}v(zn,M);var At={},$l=null;function $r(){return $l=$l||new Ot}At.Ia="serverreachability";function Jl(c){M.call(this,At.Ia,c)}v(Jl,M);function vi(c){const g=$r();qt(g,new Jl(g))}At.STAT_EVENT="statevent";function fr(c,g){M.call(this,At.STAT_EVENT,c),this.stat=g}v(fr,M);function Dt(c){const g=$r();qt(g,new fr(g,c))}At.Ja="timingevent";function wi(c,g){M.call(this,At.Ja,c),this.size=g}v(wi,M);function bi(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},g)}function ai(){this.g=!0}ai.prototype.ua=function(){this.g=!1};function Th(c,g,E,A,B,j){c.info(function(){if(c.g)if(j){var ae="",ke=j.split("&");for(let Qe=0;Qe<ke.length;Qe++){var St=ke[Qe].split("=");if(St.length>1){const gt=St[0];St=St[1];const qn=gt.split("_");ae=qn.length>=2&&qn[1]=="type"?ae+(gt+"="+St+"&"):ae+(gt+"=redacted&")}}}else ae=null;else ae=j;return"XMLHTTP REQ ("+A+") [attempt "+B+"]: "+g+`
`+E+`
`+ae})}function eu(c,g,E,A,B,j,ae){c.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+B+"]: "+g+`
`+E+`
`+j+" "+ae})}function Ai(c,g,E,A){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+Eh(c,E)+(A?" "+A:"")})}function dr(c,g){c.info(function(){return"TIMEOUT: "+g})}ai.prototype.info=function(){};function Eh(c,g){if(!c.g)return g;if(!g)return null;try{const j=JSON.parse(g);if(j){for(c=0;c<j.length;c++)if(Array.isArray(j[c])){var E=j[c];if(!(E.length<2)){var A=E[1];if(Array.isArray(A)&&!(A.length<1)){var B=A[0];if(B!="noop"&&B!="stop"&&B!="close")for(let ae=1;ae<A.length;ae++)A[ae]=""}}}}return ga(j)}catch{return g}}var mr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yo={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},To;function _r(){}v(_r,Ql),_r.prototype.g=function(){return new XMLHttpRequest},To=new _r;function Xi(c){return encodeURIComponent(String(c))}function tu(c){var g=1;c=c.split(":");const E=[];for(;g>0&&c.length;)E.push(c.shift()),g--;return c.length&&E.push(c.join(":")),E}function ri(c,g,E,A){this.j=c,this.i=g,this.l=E,this.S=A||1,this.V=new hr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new si}function si(){this.i=null,this.g="",this.h=!1}var Nt={},Ft={};function Si(c,g,E){c.M=1,c.A=pr(Mt(g)),c.u=E,c.R=!0,Jr(c,null)}function Jr(c,g){c.F=Date.now(),Ri(c),c.B=Mt(c.A);var E=c.B,A=c.S;Array.isArray(A)||(A=[String(A)]),is(E.i,"t",A),c.C=0,E=c.j.L,c.h=new si,c.g=pu(c.j,E?g:null,!c.u),c.P>0&&(c.O=new _n(p(c.Y,c,c.g),c.P)),g=c.V,E=c.g,A=c.ba;var B="readystatechange";Array.isArray(B)||(B&&(po[0]=B.toString()),B=po);for(let j=0;j<B.length;j++){const ae=pt(E,B[j],A||g.handleEvent,!1,g.h||g);if(!ae)break;g.g[ae.key]=ae}g=c.J?L(c.J):{},c.u?(c.v||(c.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,g)):(c.v="GET",c.g.ea(c.B,c.v,null,g)),vi(),Th(c.i,c.v,c.B,c.l,c.S,c.u)}ri.prototype.ba=function(c){c=c.target;const g=this.O;g&&ui(c)==3?g.j():this.Y(c)},ri.prototype.Y=function(c){try{if(c==this.g)e:{const ke=ui(this.g),St=this.g.ya(),Qe=this.g.ca();if(!(ke<3)&&(ke!=3||this.g&&(this.h.h||this.g.la()||$t(this.g)))){this.K||ke!=4||St==7||(St==8||Qe<=0?vi(3):vi(2)),Ii(this);var g=this.g.ca();this.X=g;var E=vh(this);if(this.o=g==200,eu(this.i,this.v,this.B,this.l,this.S,ke,g),this.o){if(this.U&&!this.L){t:{if(this.g){var A,B=this.g;if((A=B.g?B.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(A)){var j=A;break t}}j=null}if(c=j)Ai(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ki(this,c);else{this.o=!1,this.m=3,Dt(12),On(this),Un(this);break e}}if(this.R){c=!0;let gt;for(;!this.K&&this.C<E.length;)if(gt=iu(this,E),gt==Ft){ke==4&&(this.m=4,Dt(14),c=!1),Ai(this.i,this.l,null,"[Incomplete Response]");break}else if(gt==Nt){this.m=4,Dt(15),Ai(this.i,this.l,E,"[Invalid Chunk]"),c=!1;break}else Ai(this.i,this.l,gt,null),ki(this,gt);if(nu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||E.length!=0||this.h.h||(this.m=1,Dt(16),c=!1),this.o=this.o&&c,!c)Ai(this.i,this.l,E,"[Invalid Chunked Response]"),On(this),Un(this);else if(E.length>0&&!this.W){this.W=!0;var ae=this.j;ae.g==this&&ae.aa&&!ae.P&&(ae.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),Vo(ae),ae.P=!0,Dt(11))}}else Ai(this.i,this.l,E,null),ki(this,E);ke==4&&On(this),this.o&&!this.K&&(ke==4?fu(this.j,this):(this.o=!1,Ri(this)))}else Qi(this.g),g==400&&E.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),On(this),Un(this)}}}catch{}};function vh(c){if(!nu(c))return c.g.la();const g=$t(c.g);if(g==="")return"";let E="";const A=g.length,B=ui(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return On(c),Un(c),"";c.h.i=new h.TextDecoder}for(let j=0;j<A;j++)c.h.h=!0,E+=c.h.i.decode(g[j],{stream:!(B&&j==A-1)});return g.length=0,c.h.g+=E,c.C=0,c.h.g}function nu(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function iu(c,g){var E=c.C,A=g.indexOf(`
`,E);return A==-1?Ft:(E=Number(g.substring(E,A)),isNaN(E)?Nt:(A+=1,A+E>g.length?Ft:(g=g.slice(A,A+E),c.C=A+E,g)))}ri.prototype.cancel=function(){this.K=!0,On(this)};function Ri(c){c.T=Date.now()+c.H,es(c,c.H)}function es(c,g){if(c.D!=null)throw Error("WatchDog timer not null");c.D=bi(p(c.aa,c),g)}function Ii(c){c.D&&(h.clearTimeout(c.D),c.D=null)}ri.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(dr(this.i,this.B),this.M!=2&&(vi(),Dt(17)),On(this),this.m=2,Un(this)):es(this,this.T-c)};function Un(c){c.j.I==0||c.K||fu(c.j,c)}function On(c){Ii(c);var g=c.O;g&&typeof g.dispose=="function"&&g.dispose(),c.O=null,go(c.V),c.g&&(g=c.g,c.g=null,g.abort(),g.dispose())}function ki(c,g){try{var E=c.j;if(E.I!=0&&(E.g==c||Di(E.h,c))){if(!c.L&&Di(E.h,c)&&E.I==3){try{var A=E.Ba.g.parse(g)}catch{A=null}if(Array.isArray(A)&&A.length==3){var B=A;if(B[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<c.F)ls(E),Sa(E);else break e;br(E),Dt(18)}}else E.xa=B[1],0<E.xa-E.K&&B[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=bi(p(E.Va,E),6e3));Oi(E.h)<=1&&E.ta&&(E.ta=void 0)}else Hi(E,11)}else if((c.L||E.g==c)&&ls(E),!I(g))for(B=E.Ba.g.parse(g),g=0;g<B.length;g++){let Qe=B[g];const gt=Qe[0];if(!(gt<=E.K))if(E.K=gt,Qe=Qe[1],E.I==2)if(Qe[0]=="c"){E.M=Qe[1],E.ba=Qe[2];const qn=Qe[3];qn!=null&&(E.ka=qn,E.j.info("VER="+E.ka));const xi=Qe[4];xi!=null&&(E.za=xi,E.j.info("SVER="+E.za));const ci=Qe[5];ci!=null&&typeof ci=="number"&&ci>0&&(A=1.5*ci,E.O=A,E.j.info("backChannelRequestTimeoutMs_="+A)),A=E;const hi=c.g;if(hi){const Ar=hi.g?hi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ar){var j=A.h;j.g||Ar.indexOf("spdy")==-1&&Ar.indexOf("quic")==-1&&Ar.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(wo(j,j.h),j.h=null))}if(A.G){const us=hi.g?hi.g.getResponseHeader("X-HTTP-Session-Id"):null;us&&(A.wa=us,et(A.J,A.G,us))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-c.F,E.j.info("Handshake RTT: "+E.T+"ms")),A=E;var ae=c;if(A.na=_u(A,A.L?A.ba:null,A.W),ae.L){bo(A.h,ae);var ke=ae,St=A.O;St&&(ke.H=St),ke.D&&(Ii(ke),Ri(ke)),A.g=ae}else cu(A);E.i.length>0&&Li(E)}else Qe[0]!="stop"&&Qe[0]!="close"||Hi(E,7);else E.I==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?Hi(E,7):Co(E):Qe[0]!="noop"&&E.l&&E.l.qa(Qe),E.A=0)}}vi(4)}catch{}}var Ct=class{constructor(c,g){this.g=c,this.map=g}};function Eo(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function vo(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Oi(c){return c.h?1:c.g?c.g.size:0}function Di(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function wo(c,g){c.g?c.g.add(g):c.h=g}function bo(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}Eo.prototype.cancel=function(){if(this.i=Ao(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Ao(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const E of c.g.values())g=g.concat(E.G);return g}return S(c.i)}var au=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ts(c,g){if(c){c=c.split("&");for(let E=0;E<c.length;E++){const A=c[E].indexOf("=");let B,j=null;A>=0?(B=c[E].substring(0,A),j=c[E].substring(A+1)):B=c[E],g(B,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Dn(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;c instanceof Dn?(this.l=c.l,Wt(this,c.j),this.o=c.o,this.g=c.g,ya(this,c.u),this.h=c.h,So(this,lu(c.i)),this.m=c.m):c&&(g=String(c).match(au))?(this.l=!1,Wt(this,g[1]||"",!0),this.o=Ni(g[2]||""),this.g=Ni(g[3]||"",!0),ya(this,g[4]),this.h=Ni(g[5]||"",!0),So(this,g[6]||"",!0),this.m=Ni(g[7]||"")):(this.l=!1,this.i=new Ea(null,this.l))}Dn.prototype.toString=function(){const c=[];var g=this.j;g&&c.push(gr(g,ns,!0),":");var E=this.g;return(E||g=="file")&&(c.push("//"),(g=this.o)&&c.push(gr(g,ns,!0),"@"),c.push(Xi(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&c.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&c.push("/"),c.push(gr(E,E.charAt(0)=="/"?Ro:ru,!0))),(E=this.i.toString())&&c.push("?",E),(E=this.m)&&c.push("#",gr(E,su)),c.join("")},Dn.prototype.resolve=function(c){const g=Mt(this);let E=!!c.j;E?Wt(g,c.j):E=!!c.o,E?g.o=c.o:E=!!c.g,E?g.g=c.g:E=c.u!=null;var A=c.h;if(E)ya(g,c.u);else if(E=!!c.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var B=g.h.lastIndexOf("/");B!=-1&&(A=g.h.slice(0,B+1)+A)}if(B=A,B==".."||B==".")A="";else if(B.indexOf("./")!=-1||B.indexOf("/.")!=-1){A=B.lastIndexOf("/",0)==0,B=B.split("/");const j=[];for(let ae=0;ae<B.length;){const ke=B[ae++];ke=="."?A&&ae==B.length&&j.push(""):ke==".."?((j.length>1||j.length==1&&j[0]!="")&&j.pop(),A&&ae==B.length&&j.push("")):(j.push(ke),A=!0)}A=j.join("/")}else A=B}return E?g.h=A:E=c.i.toString()!=="",E?So(g,lu(c.i)):E=!!c.m,E&&(g.m=c.m),g};function Mt(c){return new Dn(c)}function Wt(c,g,E){c.j=E?Ni(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function ya(c,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);c.u=g}else c.u=null}function So(c,g,E){g instanceof Ea?(c.i=g,as(c.i,c.l)):(E||(g=gr(g,Ta)),c.i=new Ea(g,c.l))}function et(c,g,E){c.i.set(g,E)}function pr(c){return et(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ni(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function gr(c,g,E){return typeof c=="string"?(c=encodeURI(c).replace(g,yn),E&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function yn(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ns=/[#\/\?@]/g,ru=/[#\?:]/g,Ro=/[#\?]/g,Ta=/[#\?@]/g,su=/#/g;function Ea(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function Tn(c){c.g||(c.g=new Map,c.h=0,c.i&&ts(c.i,function(g,E){c.add(decodeURIComponent(g.replace(/\+/g," ")),E)}))}t=Ea.prototype,t.add=function(c,g){Tn(this),this.i=null,c=va(this,c);let E=this.g.get(c);return E||this.g.set(c,E=[]),E.push(g),this.h+=1,this};function ou(c,g){Tn(c),g=va(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function Io(c,g){return Tn(c),g=va(c,g),c.g.has(g)}t.forEach=function(c,g){Tn(this),this.g.forEach(function(E,A){E.forEach(function(B){c.call(g,B,A,this)},this)},this)};function ko(c,g){Tn(c);let E=[];if(typeof g=="string")Io(c,g)&&(E=E.concat(c.g.get(va(c,g))));else for(c=Array.from(c.g.values()),g=0;g<c.length;g++)E=E.concat(c[g]);return E}t.set=function(c,g){return Tn(this),this.i=null,c=va(this,c),Io(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},t.get=function(c,g){return c?(c=ko(this,c),c.length>0?String(c[0]):g):g};function is(c,g,E){ou(c,g),E.length>0&&(c.i=null,c.g.set(va(c,g),S(E)),c.h+=E.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(let A=0;A<g.length;A++){var E=g[A];const B=Xi(E);E=ko(this,E);for(let j=0;j<E.length;j++){let ae=B;E[j]!==""&&(ae+="="+Xi(E[j])),c.push(ae)}}return this.i=c.join("&")};function lu(c){const g=new Ea;return g.i=c.i,c.g&&(g.g=new Map(c.g),g.h=c.h),g}function va(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function as(c,g){g&&!c.j&&(Tn(c),c.i=null,c.g.forEach(function(E,A){const B=A.toLowerCase();A!=B&&(ou(this,A),is(this,B,E))},c)),c.j=g}function oi(c,g){const E=new ai;if(h.Image){const A=new Image;A.onload=y(Bn,E,"TestLoadImage: loaded",!0,g,A),A.onerror=y(Bn,E,"TestLoadImage: error",!1,g,A),A.onabort=y(Bn,E,"TestLoadImage: abort",!1,g,A),A.ontimeout=y(Bn,E,"TestLoadImage: timeout",!1,g,A),h.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=c}else g(!1)}function Oo(c,g){const E=new ai,A=new AbortController,B=setTimeout(()=>{A.abort(),Bn(E,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:A.signal}).then(j=>{clearTimeout(B),j.ok?Bn(E,"TestPingServer: ok",!0,g):Bn(E,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(B),Bn(E,"TestPingServer: error",!1,g)})}function Bn(c,g,E,A,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),A(E)}catch{}}function wa(){this.g=new Kl}function Ci(c){this.i=c.Sb||null,this.h=c.ab||!1}v(Ci,Ql),Ci.prototype.g=function(){return new yr(this.i,this.h)};function yr(c,g){Ot.call(this),this.H=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(yr,Ot),t=yr.prototype,t.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=g,this.readyState=1,li(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(g.body=c),(this.H||h).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ba(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,li(this)),this.g&&(this.readyState=3,li(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;rs(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function rs(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?ba(this):li(this),this.readyState==3&&rs(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,ba(this))},t.Na=function(c){this.g&&(this.response=c,ba(this))},t.ga=function(){this.g&&ba(this)};function ba(c){c.readyState=4,c.l=null,c.j=null,c.B=null,li(c)}t.setRequestHeader=function(c,g){this.A.append(c,g)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var E=g.next();!E.done;)E=E.value,c.push(E[0]+": "+E[1]),E=g.next();return c.join(`\r
`)};function li(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(yr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Gn(c){let g="";return je(c,function(E,A){g+=A,g+=":",g+=E,g+=`\r
`}),g}function Tr(c,g,E){e:{for(A in E){var A=!1;break e}A=!0}A||(E=Gn(E),typeof c=="string"?E!=null&&Xi(E):et(c,g,E))}function it(c){Ot.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(it,Ot);var Mi=/^https?$/i,Do=["POST","PUT"];t=it.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,g,E,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():To.g(),this.g.onreadystatechange=w(p(this.Ca,this));try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(j){Er(this,j);return}if(c=E||"",E=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var B in A)E.set(B,A[B]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const j of A.keys())E.set(j,A.get(j));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(E.keys()).find(j=>j.toLowerCase()=="content-type"),B=h.FormData&&c instanceof h.FormData,!(Array.prototype.indexOf.call(Do,g,void 0)>=0)||A||B||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,ae]of E)this.g.setRequestHeader(j,ae);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(j){Er(this,j)}};function Er(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.o=5,No(c),Ki(c)}function No(c){c.A||(c.A=!0,qt(c,"complete"),qt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,qt(this,"complete"),qt(this,"abort"),Ki(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ki(this,!0)),it.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?vr(this):this.Xa())},t.Xa=function(){vr(this)};function vr(c){if(c.h&&typeof u<"u"){if(c.v&&ui(c)==4)setTimeout(c.Ca.bind(c),0);else if(qt(c,"readystatechange"),ui(c)==4){c.h=!1;try{const j=c.ca();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var E;if(!(E=g)){var A;if(A=j===0){let ae=String(c.D).match(au)[1]||null;!ae&&h.self&&h.self.location&&(ae=h.self.location.protocol.slice(0,-1)),A=!Mi.test(ae?ae.toLowerCase():"")}E=A}if(E)qt(c,"complete"),qt(c,"success");else{c.o=6;try{var B=ui(c)>2?c.g.statusText:""}catch{B=""}c.l=B+" ["+c.ca()+"]",No(c)}}finally{Ki(c)}}}}function Ki(c,g){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const E=c.g;c.g=null,g||qt(c,"ready");try{E.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ui(c){return c.g?c.g.readyState:0}t.ca=function(){try{return ui(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),yh(g)}};function $t(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Qi(c){const g={};c=(c.g&&ui(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<c.length;A++){if(I(c[A]))continue;var E=tu(c[A]);const B=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const j=g[B]||[];g[B]=j,j.push(E)}Je(g,function(A){return A.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vi(c,g,E){return E&&E.internalChannelParams&&E.internalChannelParams[c]||g}function Aa(c){this.za=0,this.i=[],this.j=new ai,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vi("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vi("baseRetryDelayMs",5e3,c),this.Za=Vi("retryDelaySeedMs",1e4,c),this.Ta=Vi("forwardChannelMaxRetries",2,c),this.va=Vi("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Eo(c&&c.concurrentRequestLimit),this.Ba=new wa,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Aa.prototype,t.ka=8,t.I=1,t.connect=function(c,g,E,A){Dt(0),this.W=c,this.H=g||{},E&&A!==void 0&&(this.H.OSID=E,this.H.OAID=A),this.F=this.X,this.J=_u(this,null,this.W),Li(this)};function Co(c){if(ss(c),c.I==3){var g=c.V++,E=Mt(c.J);if(et(E,"SID",c.M),et(E,"RID",g),et(E,"TYPE","terminate"),wr(c,E),g=new ri(c,c.j,g),g.M=2,g.A=pr(Mt(E)),E=!1,h.navigator&&h.navigator.sendBeacon)try{E=h.navigator.sendBeacon(g.A.toString(),"")}catch{}!E&&h.Image&&(new Image().src=g.A,E=!0),E||(g.g=pu(g.j,null),g.g.ea(g.A)),g.F=Date.now(),Ri(g)}mu(c)}function Sa(c){c.g&&(Vo(c),c.g.cancel(),c.g=null)}function ss(c){Sa(c),c.v&&(h.clearTimeout(c.v),c.v=null),ls(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&h.clearTimeout(c.m),c.m=null)}function Li(c){if(!vo(c.h)&&!c.m){c.m=!0;var g=c.Ea;ot||R(),ze||(ot(),ze=!0),O.add(g,c),c.D=0}}function os(c,g){return Oi(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=g.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=bi(p(c.Ea,c,g),du(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const B=new ri(this,this.j,c);let j=this.o;if(this.U&&(j?(j=L(j),se(j,this.U)):j=this.U),this.u!==null||this.R||(B.J=j,j=null),this.S)e:{for(var g=0,E=0;E<this.i.length;E++){t:{var A=this.i[E];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(g+=A,g>4096){g=E;break e}if(g===4096||E===this.i.length-1){g=E+1;break e}}g=1e3}else g=1e3;g=uu(this,B,g),E=Mt(this.J),et(E,"RID",c),et(E,"CVER",22),this.G&&et(E,"X-HTTP-Session-Id",this.G),wr(this,E),j&&(this.R?g="headers="+Xi(Gn(j))+"&"+g:this.u&&Tr(E,this.u,j)),wo(this.h,B),this.Ra&&et(E,"TYPE","init"),this.S?(et(E,"$req",g),et(E,"SID","null"),B.U=!0,Si(B,E,null)):Si(B,E,g),this.I=2}}else this.I==3&&(c?Mo(this,c):this.i.length==0||vo(this.h)||Mo(this))};function Mo(c,g){var E;g?E=g.l:E=c.V++;const A=Mt(c.J);et(A,"SID",c.M),et(A,"RID",E),et(A,"AID",c.K),wr(c,A),c.u&&c.o&&Tr(A,c.u,c.o),E=new ri(c,c.j,E,c.D+1),c.u===null&&(E.J=c.o),g&&(c.i=g.G.concat(c.i)),g=uu(c,E,1e3),E.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),wo(c.h,E),Si(E,A,g)}function wr(c,g){c.H&&je(c.H,function(E,A){et(g,A,E)}),c.l&&je({},function(E,A){et(g,A,E)})}function uu(c,g,E){E=Math.min(c.i.length,E);const A=c.l?p(c.l.Ka,c.l,c):null;e:{var B=c.i;let ke=-1;for(;;){const St=["count="+E];ke==-1?E>0?(ke=B[0].g,St.push("ofs="+ke)):ke=0:St.push("ofs="+ke);let Qe=!0;for(let gt=0;gt<E;gt++){var j=B[gt].g;const qn=B[gt].map;if(j-=ke,j<0)ke=Math.max(0,B[gt].g-100),Qe=!1;else try{j="req"+j+"_"||"";try{var ae=qn instanceof Map?qn:Object.entries(qn);for(const[xi,ci]of ae){let hi=ci;m(ci)&&(hi=ga(ci)),St.push(j+xi+"="+encodeURIComponent(hi))}}catch(xi){throw St.push(j+"type="+encodeURIComponent("_badmap")),xi}}catch{A&&A(qn)}}if(Qe){ae=St.join("&");break e}}ae=void 0}return c=c.i.splice(0,E),g.G=c,ae}function cu(c){if(!c.g&&!c.v){c.Y=1;var g=c.Da;ot||R(),ze||(ot(),ze=!0),O.add(g,c),c.A=0}}function br(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=bi(p(c.Da,c),du(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,hu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=bi(p(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),Sa(this),hu(this))};function Vo(c){c.B!=null&&(h.clearTimeout(c.B),c.B=null)}function hu(c){c.g=new ri(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var g=Mt(c.na);et(g,"RID","rpc"),et(g,"SID",c.M),et(g,"AID",c.K),et(g,"CI",c.F?"0":"1"),!c.F&&c.ia&&et(g,"TO",c.ia),et(g,"TYPE","xmlhttp"),wr(c,g),c.u&&c.o&&Tr(g,c.u,c.o),c.O&&(c.g.H=c.O);var E=c.g;c=c.ba,E.M=1,E.A=pr(Mt(g)),E.u=null,E.R=!0,Jr(E,c)}t.Va=function(){this.C!=null&&(this.C=null,Sa(this),br(this),Dt(19))};function ls(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function fu(c,g){var E=null;if(c.g==g){ls(c),Vo(c),c.g=null;var A=2}else if(Di(c.h,g))E=g.G,bo(c.h,g),A=1;else return;if(c.I!=0){if(g.o)if(A==1){E=g.u?g.u.length:0,g=Date.now()-g.F;var B=c.D;A=$r(),qt(A,new wi(A,E)),Li(c)}else cu(c);else if(B=g.m,B==3||B==0&&g.X>0||!(A==1&&os(c,g)||A==2&&br(c)))switch(E&&E.length>0&&(g=c.h,g.i=g.i.concat(E)),B){case 1:Hi(c,5);break;case 4:Hi(c,10);break;case 3:Hi(c,6);break;default:Hi(c,2)}}}function du(c,g){let E=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(E*=2),E*g}function Hi(c,g){if(c.j.info("Error code "+g),g==2){var E=p(c.bb,c),A=c.Ua;const B=!A;A=new Dn(A||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Wt(A,"https"),pr(A),B?oi(A.toString(),E):Oo(A.toString(),E)}else Dt(2);c.I=0,c.l&&c.l.pa(g),mu(c),ss(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function mu(c){if(c.I=0,c.ja=[],c.l){const g=Ao(c.h);(g.length!=0||c.i.length!=0)&&(x(c.ja,g),x(c.ja,c.i),c.h.i.length=0,S(c.i),c.i.length=0),c.l.oa()}}function _u(c,g,E){var A=E instanceof Dn?Mt(E):new Dn(E);if(A.g!="")g&&(A.g=g+"."+A.g),ya(A,A.u);else{var B=h.location;A=B.protocol,g=g?g+"."+B.hostname:B.hostname,B=+B.port;const j=new Dn(null);A&&Wt(j,A),g&&(j.g=g),B&&ya(j,B),E&&(j.h=E),A=j}return E=c.G,g=c.wa,E&&g&&et(A,E,g),et(A,"VER",c.ka),wr(c,A),A}function pu(c,g,E){if(g&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Aa&&!c.ma?new it(new Ci({ab:E})):new it(c.ma),g.Fa(c.L),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gu(){}t=gu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ra(){}Ra.prototype.g=function(c,g){return new pn(c,g)};function pn(c,g){Ot.call(this),this.g=new Aa(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(c?c["X-WebChannel-Client-Profile"]=g.sa:c={"X-WebChannel-Client-Profile":g.sa}),this.g.U=c,(c=g&&g.Qb)&&!I(c)&&(this.g.u=c),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!I(g)&&(this.g.G=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new Zi(this)}v(pn,Ot),pn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){Co(this.g)},pn.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var E={};E.__data__=c,c=E}else this.v&&(E={},E.__data__=ga(c),c=E);g.i.push(new Ct(g.Ya++,c)),g.I==3&&Li(g)},pn.prototype.N=function(){this.g.l=null,delete this.j,Co(this.g),delete this.g,pn.Z.N.call(this)};function yu(c){Zt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const E in g){c=E;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}v(yu,Zt);function Tu(){zn.call(this),this.status=1}v(Tu,zn);function Zi(c){this.g=c}v(Zi,gu),Zi.prototype.ra=function(){qt(this.g,"a")},Zi.prototype.qa=function(c){qt(this.g,new yu(c))},Zi.prototype.pa=function(c){qt(this.g,new Tu)},Zi.prototype.oa=function(){qt(this.g,"b")},Ra.prototype.createWebChannel=Ra.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,d0=function(){return new Ra},f0=function(){return $r()},h0=At,Gd={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},mr.NO_ERROR=0,mr.TIMEOUT=8,mr.HTTP_ERROR=6,Nc=mr,yo.COMPLETE="complete",c0=yo,Zl.EventType=ii,ii.OPEN="a",ii.CLOSE="b",ii.ERROR="c",ii.MESSAGE="d",Ot.prototype.listen=Ot.prototype.J,El=Zl,it.prototype.listenOnce=it.prototype.K,it.prototype.getLastError=it.prototype.Ha,it.prototype.getLastErrorCode=it.prototype.ya,it.prototype.getStatus=it.prototype.ca,it.prototype.getResponseJson=it.prototype.La,it.prototype.getResponseText=it.prototype.la,it.prototype.send=it.prototype.ea,it.prototype.setWithCredentials=it.prototype.Fa,u0=it}).apply(typeof bc<"u"?bc:typeof self<"u"?self:typeof window<"u"?window:{});class dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");let ro="12.9.0";function AA(t){ro=t}const Gr=new n0("@firebase/firestore");function Us(){return Gr.logLevel}function he(t,...e){if(Gr.logLevel<=qe.DEBUG){const i=e.map(hm);Gr.debug(`Firestore (${ro}): ${t}`,...i)}}function ma(t,...e){if(Gr.logLevel<=qe.ERROR){const i=e.map(hm);Gr.error(`Firestore (${ro}): ${t}`,...i)}}function qr(t,...e){if(Gr.logLevel<=qe.WARN){const i=e.map(hm);Gr.warn(`Firestore (${ro}): ${t}`,...i)}}function hm(t){if(typeof t=="string")return t;try{return(function(i){return JSON.stringify(i)})(t)}catch{return t}}function we(t,e,i){let r="Unexpected state";typeof e=="string"?r=e:i=e,m0(t,r,i)}function m0(t,e,i){let r=`FIRESTORE (${ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(i!==void 0)try{r+=" CONTEXT: "+JSON.stringify(i)}catch{r+=" CONTEXT: "+i}throw ma(r),new Error(r)}function $e(t,e,i,r){let o="Unexpected state";typeof i=="string"?o=i:r=i,t||m0(e,o,r)}function Ie(t,e){return t}const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends ao{constructor(e,i){super(e,i),this.code=e,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class er{constructor(){this.promise=new Promise(((e,i)=>{this.resolve=e,this.reject=i}))}}class _0{constructor(e,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,i){e.enqueueRetryable((()=>i(dn.UNAUTHENTICATED)))}shutdown(){}}class RA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,i){this.changeListener=i,e.enqueueRetryable((()=>i(this.token.user)))}shutdown(){this.changeListener=null}}class IA{constructor(e){this.t=e,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,i){$e(this.o===void 0,42304);let r=this.i;const o=_=>this.i!==r?(r=this.i,i(_)):Promise.resolve();let u=new er;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new er,e.enqueueRetryable((()=>o(this.currentUser)))};const h=()=>{const _=u;e.enqueueRetryable((async()=>{await _.promise,await o(this.currentUser)}))},m=_=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=_,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((_=>m(_))),setTimeout((()=>{if(!this.auth){const _=this.t.getImmediate({optional:!0});_?m(_):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new er)}}),0),h()}getToken(){const e=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then((r=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string",31837,{l:r}),new _0(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string",2055,{h:e}),new dn(e)}}class kA{constructor(e,i,r){this.P=e,this.T=i,this.I=r,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class OA{constructor(e,i,r){this.P=e,this.T=i,this.I=r}getToken(){return Promise.resolve(new kA(this.P,this.T,this.I))}start(e,i){e.enqueueRetryable((()=>i(dn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Uy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DA{constructor(e,i){this.V=i,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,oA(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,i){$e(this.o===void 0,3512);const r=u=>{u.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,he("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?i(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>r(u)))};const o=u=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>o(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?o(u):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Uy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((i=>i?($e(typeof i.token=="string",44558,{tokenResult:i}),this.m=i.token,new Uy(i.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function NA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),i=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(i);else for(let r=0;r<t;r++)i[r]=Math.floor(256*Math.random());return i}class fm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=NA(40);for(let u=0;u<o.length;++u)r.length<20&&o[u]<i&&(r+=e.charAt(o[u]%62))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function qd(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){const o=t.charAt(r),u=e.charAt(r);if(o!==u)return Rd(o)===Rd(u)?xe(o,u):Rd(o)?1:-1}return xe(t.length,e.length)}const CA=55296,MA=57343;function Rd(t){const e=t.charCodeAt(0);return e>=CA&&e<=MA}function $s(t,e,i){return t.length===e.length&&t.every(((r,o)=>i(r,e[o])))}const By="__name__";class Gi{constructor(e,i,r){i===void 0?i=0:i>e.length&&we(637,{offset:i,range:e.length}),r===void 0?r=e.length-i:r>e.length-i&&we(1746,{length:r,range:e.length-i}),this.segments=e,this.offset=i,this.len=r}get length(){return this.len}isEqual(e){return Gi.comparator(this,e)===0}child(e){const i=this.segments.slice(this.offset,this.limit());return e instanceof Gi?e.forEach((r=>{i.push(r)})):i.push(e),this.construct(i)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}forEach(e){for(let i=this.offset,r=this.limit();i<r;i++)e(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,i){const r=Math.min(e.length,i.length);for(let o=0;o<r;o++){const u=Gi.compareSegments(e.get(o),i.get(o));if(u!==0)return u}return xe(e.length,i.length)}static compareSegments(e,i){const r=Gi.isNumericId(e),o=Gi.isNumericId(i);return r&&!o?-1:!r&&o?1:r&&o?Gi.extractNumericId(e).compare(Gi.extractNumericId(i)):qd(e,i)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ja.fromString(e.substring(4,e.length-2))}}class ct extends Gi{construct(e,i,r){return new ct(e,i,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const i=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(ee.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);i.push(...r.split("/").filter((o=>o.length>0)))}return new ct(i)}static emptyPath(){return new ct([])}}const VA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ln extends Gi{construct(e,i,r){return new ln(e,i,r)}static isValidIdentifier(e){return VA.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ln.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===By}static keyField(){return new ln([By])}static fromServerFormat(e){const i=[];let r="",o=0;const u=()=>{if(r.length===0)throw new ue(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(r),r=""};let h=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new ue(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const _=e[o+1];if(_!=="\\"&&_!=="."&&_!=="`")throw new ue(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=_,o+=2}else m==="`"?(h=!h,o++):m!=="."||h?(r+=m,o++):(u(),o++)}if(u(),h)throw new ue(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ln(i)}static emptyPath(){return new ln([])}}class ge{constructor(e){this.path=e}static fromPath(e){return new ge(ct.fromString(e))}static fromName(e){return new ge(ct.fromString(e).popFirst(5))}static empty(){return new ge(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,i){return ct.comparator(e.path,i.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new ct(e.slice()))}}function p0(t,e,i){if(!i)throw new ue(ee.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function LA(t,e,i,r){if(e===!0&&r===!0)throw new ue(ee.INVALID_ARGUMENT,`${t} and ${i} cannot be used together.`)}function Gy(t){if(!ge.isDocumentKey(t))throw new ue(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function qy(t){if(ge.isDocumentKey(t))throw new ue(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function g0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Jc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":we(12329,{type:typeof t})}function Cl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ue(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=Jc(t);throw new ue(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${i}`)}}return t}function HA(t,e){if(e<=0)throw new ue(ee.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}function Ut(t,e){const i={typeString:t};return e&&(i.value=e),i}function ql(t,e){if(!g0(t))throw new ue(ee.INVALID_ARGUMENT,"JSON must be an object");let i;for(const r in e)if(e[r]){const o=e[r].typeString,u="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){i=`JSON missing required field: '${r}'`;break}const h=t[r];if(o&&typeof h!==o){i=`JSON field '${r}' must be a ${o}.`;break}if(u!==void 0&&h!==u.value){i=`Expected '${r}' field to equal '${u.value}'`;break}}if(i)throw new ue(ee.INVALID_ARGUMENT,i);return!0}const Yy=-62135596800,jy=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const i=Math.floor(e/1e3),r=Math.floor((e-1e3*i)*jy);return new mt(i,r)}constructor(e,i){if(this.seconds=e,this.nanoseconds=i,i<0)throw new ue(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new ue(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(e<Yy)throw new ue(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jy}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ql(e,mt._jsonSchema))return new mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Yy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:Ut("string",mt._jsonSchemaVersion),seconds:Ut("number"),nanoseconds:Ut("number")};class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new mt(0,0))}static max(){return new Ae(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ml=-1;function xA(t,e){const i=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,o=Ae.fromTimestamp(r===1e9?new mt(i+1,0):new mt(i,r));return new nr(o,ge.empty(),e)}function PA(t){return new nr(t.readTime,t.key,Ml)}class nr{constructor(e,i,r){this.readTime=e,this.documentKey=i,this.largestBatchId=r}static min(){return new nr(Ae.min(),ge.empty(),Ml)}static max(){return new nr(Ae.max(),ge.empty(),Ml)}}function zA(t,e){let i=t.readTime.compareTo(e.readTime);return i!==0?i:(i=ge.comparator(t.documentKey,e.documentKey),i!==0?i:xe(t.largestBatchId,e.largestBatchId))}const UA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function so(t){if(t.code!==ee.FAILED_PRECONDITION||t.message!==UA)throw t;he("LocalStore","Unexpectedly lost primary lease")}class ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)}),(i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)}))}catch(e){return this.next(void 0,e)}next(e,i){return this.callbackAttached&&we(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(e,this.result):new ne(((r,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(r,o)},this.catchCallback=u=>{this.wrapFailure(i,u).next(r,o)}}))}toPromise(){return new Promise(((e,i)=>{this.next(e,i)}))}wrapUserFunction(e){try{const i=e();return i instanceof ne?i:ne.resolve(i)}catch(i){return ne.reject(i)}}wrapSuccess(e,i){return e?this.wrapUserFunction((()=>e(i))):ne.resolve(i)}wrapFailure(e,i){return e?this.wrapUserFunction((()=>e(i))):ne.reject(i)}static resolve(e){return new ne(((i,r)=>{i(e)}))}static reject(e){return new ne(((i,r)=>{r(e)}))}static waitFor(e){return new ne(((i,r)=>{let o=0,u=0,h=!1;e.forEach((m=>{++o,m.next((()=>{++u,h&&u===o&&i()}),(_=>r(_)))})),h=!0,u===o&&i()}))}static or(e){let i=ne.resolve(!1);for(const r of e)i=i.next((o=>o?ne.resolve(o):r()));return i}static forEach(e,i){const r=[];return e.forEach(((o,u)=>{r.push(i.call(this,o,u))})),this.waitFor(r)}static mapArray(e,i){return new ne(((r,o)=>{const u=e.length,h=new Array(u);let m=0;for(let _=0;_<u;_++){const p=_;i(e[p]).next((y=>{h[p]=y,++m,m===u&&r(h)}),(y=>o(y)))}}))}static doWhile(e,i){return new ne(((r,o)=>{const u=()=>{e()===!0?i().next((()=>{u()}),o):r()};u()}))}}function GA(t){const e=t.match(/Android ([\d.]+)/i),i=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(i)}function oo(t){return t.name==="IndexedDbTransactionError"}class eh{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}eh.ce=-1;const dm=-1;function th(t){return t==null}function Bc(t){return t===0&&1/t==-1/0}function qA(t){return typeof t=="number"&&Number.isInteger(t)&&!Bc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const y0="";function YA(t){let e="";for(let i=0;i<t.length;i++)e.length>0&&(e=Fy(e)),e=jA(t.get(i),e);return Fy(e)}function jA(t,e){let i=e;const r=t.length;for(let o=0;o<r;o++){const u=t.charAt(o);switch(u){case"\0":i+="";break;case y0:i+="";break;default:i+=u}}return i}function Fy(t){return t+y0+""}function Wy(t){let e=0;for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&e++;return e}function jr(t,e){for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&e(i,t[i])}function T0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Et{constructor(e,i){this.comparator=e,this.root=i||an.EMPTY}insert(e,i){return new Et(this.comparator,this.root.insert(e,i,this.comparator).copy(null,null,an.BLACK,null,null))}remove(e){return new Et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,an.BLACK,null,null))}get(e){let i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return i.value;r<0?i=i.left:r>0&&(i=i.right)}return null}indexOf(e){let i=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return i+r.left.size;o<0?r=r.left:(i+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((i,r)=>(e(i,r),!1)))}toString(){const e=[];return this.inorderTraversal(((i,r)=>(e.push(`${i}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ac(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ac(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ac(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ac(this.root,e,this.comparator,!0)}}class Ac{constructor(e,i,r,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=i?r(e.key,i):1,i&&o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const i={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class an{constructor(e,i,r,o,u){this.key=e,this.value=i,this.color=r??an.RED,this.left=o??an.EMPTY,this.right=u??an.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,i,r,o,u){return new an(e??this.key,i??this.value,r??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,r){let o=this;const u=r(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,i,r),null):u===0?o.copy(null,i,null,null,null):o.copy(null,null,null,null,o.right.insert(e,i,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return an.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,i){let r,o=this;if(i(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,i),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),i(e,o.key)===0){if(o.right.isEmpty())return an.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,i))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,an.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,an.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw we(43730,{key:this.key,value:this.value});if(this.right.isRed())throw we(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw we(27949);return e+(this.isRed()?0:1)}}an.EMPTY=null,an.RED=!0,an.BLACK=!1;an.EMPTY=new class{constructor(){this.size=0}get key(){throw we(57766)}get value(){throw we(16141)}get color(){throw we(16727)}get left(){throw we(29726)}get right(){throw we(36894)}copy(e,i,r,o,u){return this}insert(e,i,r){return new an(e,i)}remove(e,i){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class jt{constructor(e){this.comparator=e,this.data=new Et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((i,r)=>(e(i),!1)))}forEachInRange(e,i){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;i(o.key)}}forEachWhile(e,i){let r;for(r=i!==void 0?this.data.getIteratorFrom(i):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const i=this.data.getIteratorFrom(e);return i.hasNext()?i.getNext().key:null}getIterator(){return new Xy(this.data.getIterator())}getIteratorFrom(e){return new Xy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let i=this;return i.size<e.size&&(i=e,e=this),e.forEach((r=>{i=i.add(r)})),i}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const i=this.data.getIterator(),r=e.data.getIterator();for(;i.hasNext();){const o=i.getNext().key,u=r.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((i=>{e.push(i)})),e}toString(){const e=[];return this.forEach((i=>e.push(i))),"SortedSet("+e.toString()+")"}copy(e){const i=new jt(this.comparator);return i.data=e,i}}class Xy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class pi{constructor(e){this.fields=e,e.sort(ln.comparator)}static empty(){return new pi([])}unionWith(e){let i=new jt(ln.comparator);for(const r of this.fields)i=i.add(r);for(const r of e)i=i.add(r);return new pi(i.toArray())}covers(e){for(const i of this.fields)if(i.isPrefixOf(e))return!0;return!1}isEqual(e){return $s(this.fields,e.fields,((i,r)=>i.isEqual(r)))}}class E0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class cn{constructor(e){this.binaryString=e}static fromBase64String(e){const i=(function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new E0("Invalid base64 string: "+u):u}})(e);return new cn(i)}static fromUint8Array(e){const i=(function(o){let u="";for(let h=0;h<o.length;++h)u+=String.fromCharCode(o[h]);return u})(e);return new cn(i)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(i){return btoa(i)})(this.binaryString)}toUint8Array(){return(function(i){const r=new Uint8Array(i.length);for(let o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cn.EMPTY_BYTE_STRING=new cn("");const FA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ir(t){if($e(!!t,39018),typeof t=="string"){let e=0;const i=FA.exec(t);if($e(!!i,46558,{timestamp:t}),i[1]){let o=i[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:kt(t.seconds),nanos:kt(t.nanos)}}function kt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ar(t){return typeof t=="string"?cn.fromBase64String(t):cn.fromUint8Array(t)}const v0="server_timestamp",w0="__type__",b0="__previous_value__",A0="__local_write_time__";function mm(t){return(t?.mapValue?.fields||{})[w0]?.stringValue===v0}function nh(t){const e=t.mapValue.fields[b0];return mm(e)?nh(e):e}function Vl(t){const e=ir(t.mapValue.fields[A0].timestampValue);return new mt(e.seconds,e.nanos)}class WA{constructor(e,i,r,o,u,h,m,_,p,y,v){this.databaseId=e,this.appId=i,this.persistenceKey=r,this.host=o,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=m,this.longPollingOptions=_,this.useFetchStreams=p,this.isUsingEmulator=y,this.apiKey=v}}const Gc="(default)";class Ll{constructor(e,i){this.projectId=e,this.database=i||Gc}static empty(){return new Ll("","")}get isDefaultDatabase(){return this.database===Gc}isEqual(e){return e instanceof Ll&&e.projectId===this.projectId&&e.database===this.database}}function XA(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ue(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ll(t.options.projectId,e)}const S0="__type__",KA="__max__",Sc={mapValue:{}},R0="__vector__",qc="value";function rr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?mm(t)?4:ZA(t)?9007199254740991:QA(t)?10:11:we(28295,{value:t})}function Wi(t,e){if(t===e)return!0;const i=rr(t);if(i!==rr(e))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vl(t).isEqual(Vl(e));case 3:return(function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const h=ir(o.timestampValue),m=ir(u.timestampValue);return h.seconds===m.seconds&&h.nanos===m.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(o,u){return ar(o.bytesValue).isEqual(ar(u.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(o,u){return kt(o.geoPointValue.latitude)===kt(u.geoPointValue.latitude)&&kt(o.geoPointValue.longitude)===kt(u.geoPointValue.longitude)})(t,e);case 2:return(function(o,u){if("integerValue"in o&&"integerValue"in u)return kt(o.integerValue)===kt(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const h=kt(o.doubleValue),m=kt(u.doubleValue);return h===m?Bc(h)===Bc(m):isNaN(h)&&isNaN(m)}return!1})(t,e);case 9:return $s(t.arrayValue.values||[],e.arrayValue.values||[],Wi);case 10:case 11:return(function(o,u){const h=o.mapValue.fields||{},m=u.mapValue.fields||{};if(Wy(h)!==Wy(m))return!1;for(const _ in h)if(h.hasOwnProperty(_)&&(m[_]===void 0||!Wi(h[_],m[_])))return!1;return!0})(t,e);default:return we(52216,{left:t})}}function Hl(t,e){return(t.values||[]).find((i=>Wi(i,e)))!==void 0}function Js(t,e){if(t===e)return 0;const i=rr(t),r=rr(e);if(i!==r)return xe(i,r);switch(i){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return(function(u,h){const m=kt(u.integerValue||u.doubleValue),_=kt(h.integerValue||h.doubleValue);return m<_?-1:m>_?1:m===_?0:isNaN(m)?isNaN(_)?0:-1:1})(t,e);case 3:return Ky(t.timestampValue,e.timestampValue);case 4:return Ky(Vl(t),Vl(e));case 5:return qd(t.stringValue,e.stringValue);case 6:return(function(u,h){const m=ar(u),_=ar(h);return m.compareTo(_)})(t.bytesValue,e.bytesValue);case 7:return(function(u,h){const m=u.split("/"),_=h.split("/");for(let p=0;p<m.length&&p<_.length;p++){const y=xe(m[p],_[p]);if(y!==0)return y}return xe(m.length,_.length)})(t.referenceValue,e.referenceValue);case 8:return(function(u,h){const m=xe(kt(u.latitude),kt(h.latitude));return m!==0?m:xe(kt(u.longitude),kt(h.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return Qy(t.arrayValue,e.arrayValue);case 10:return(function(u,h){const m=u.fields||{},_=h.fields||{},p=m[qc]?.arrayValue,y=_[qc]?.arrayValue,v=xe(p?.values?.length||0,y?.values?.length||0);return v!==0?v:Qy(p,y)})(t.mapValue,e.mapValue);case 11:return(function(u,h){if(u===Sc.mapValue&&h===Sc.mapValue)return 0;if(u===Sc.mapValue)return 1;if(h===Sc.mapValue)return-1;const m=u.fields||{},_=Object.keys(m),p=h.fields||{},y=Object.keys(p);_.sort(),y.sort();for(let v=0;v<_.length&&v<y.length;++v){const w=qd(_[v],y[v]);if(w!==0)return w;const S=Js(m[_[v]],p[y[v]]);if(S!==0)return S}return xe(_.length,y.length)})(t.mapValue,e.mapValue);default:throw we(23264,{he:i})}}function Ky(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const i=ir(t),r=ir(e),o=xe(i.seconds,r.seconds);return o!==0?o:xe(i.nanos,r.nanos)}function Qy(t,e){const i=t.values||[],r=e.values||[];for(let o=0;o<i.length&&o<r.length;++o){const u=Js(i[o],r[o]);if(u)return u}return xe(i.length,r.length)}function eo(t){return Yd(t)}function Yd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(i){const r=ir(i);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(i){return ar(i).toBase64()})(t.bytesValue):"referenceValue"in t?(function(i){return ge.fromName(i).toString()})(t.referenceValue):"geoPointValue"in t?(function(i){return`geo(${i.latitude},${i.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(i){let r="[",o=!0;for(const u of i.values||[])o?o=!1:r+=",",r+=Yd(u);return r+"]"})(t.arrayValue):"mapValue"in t?(function(i){const r=Object.keys(i.fields||{}).sort();let o="{",u=!0;for(const h of r)u?u=!1:o+=",",o+=`${h}:${Yd(i.fields[h])}`;return o+"}"})(t.mapValue):we(61005,{value:t})}function Cc(t){switch(rr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nh(t);return e?16+Cc(e):16;case 5:return 2*t.stringValue.length;case 6:return ar(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,u)=>o+Cc(u)),0)})(t.arrayValue);case 10:case 11:return(function(r){let o=0;return jr(r.fields,((u,h)=>{o+=u.length+Cc(h)})),o})(t.mapValue);default:throw we(13486,{value:t})}}function Zy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function jd(t){return!!t&&"integerValue"in t}function _m(t){return!!t&&"arrayValue"in t}function $y(t){return!!t&&"nullValue"in t}function Jy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Mc(t){return!!t&&"mapValue"in t}function QA(t){return(t?.mapValue?.fields||{})[S0]?.stringValue===R0}function Al(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return jr(t.mapValue.fields,((i,r)=>e.mapValue.fields[i]=Al(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let i=0;i<(t.arrayValue.values||[]).length;++i)e.arrayValue.values[i]=Al(t.arrayValue.values[i]);return e}return{...t}}function ZA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===KA}class ei{constructor(e){this.value=e}static empty(){return new ei({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let i=this.value;for(let r=0;r<e.length-1;++r)if(i=(i.mapValue.fields||{})[e.get(r)],!Mc(i))return null;return i=(i.mapValue.fields||{})[e.lastSegment()],i||null}}set(e,i){this.getFieldsMap(e.popLast())[e.lastSegment()]=Al(i)}setAll(e){let i=ln.emptyPath(),r={},o=[];e.forEach(((h,m)=>{if(!i.isImmediateParentOf(m)){const _=this.getFieldsMap(i);this.applyChanges(_,r,o),r={},o=[],i=m.popLast()}h?r[m.lastSegment()]=Al(h):o.push(m.lastSegment())}));const u=this.getFieldsMap(i);this.applyChanges(u,r,o)}delete(e){const i=this.field(e.popLast());Mc(i)&&i.mapValue.fields&&delete i.mapValue.fields[e.lastSegment()]}isEqual(e){return Wi(this.value,e.value)}getFieldsMap(e){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=i.mapValue.fields[e.get(r)];Mc(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},i.mapValue.fields[e.get(r)]=o),i=o}return i.mapValue.fields}applyChanges(e,i,r){jr(i,((o,u)=>e[o]=u));for(const o of r)delete e[o]}clone(){return new ei(Al(this.value))}}function I0(t){const e=[];return jr(t.fields,((i,r)=>{const o=new ln([i]);if(Mc(r)){const u=I0(r.mapValue).fields;if(u.length===0)e.push(o);else for(const h of u)e.push(o.child(h))}else e.push(o)})),new pi(e)}class mn{constructor(e,i,r,o,u,h,m){this.key=e,this.documentType=i,this.version=r,this.readTime=o,this.createTime=u,this.data=h,this.documentState=m}static newInvalidDocument(e){return new mn(e,0,Ae.min(),Ae.min(),Ae.min(),ei.empty(),0)}static newFoundDocument(e,i,r,o){return new mn(e,1,i,Ae.min(),r,o,0)}static newNoDocument(e,i){return new mn(e,2,i,Ae.min(),Ae.min(),ei.empty(),0)}static newUnknownDocument(e,i){return new mn(e,3,i,Ae.min(),Ae.min(),ei.empty(),2)}convertToFoundDocument(e,i){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ei.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ei.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Yc{constructor(e,i){this.position=e,this.inclusive=i}}function eT(t,e,i){let r=0;for(let o=0;o<t.position.length;o++){const u=e[o],h=t.position[o];if(u.field.isKeyField()?r=ge.comparator(ge.fromName(h.referenceValue),i.key):r=Js(h,i.data.field(u.field)),u.dir==="desc"&&(r*=-1),r!==0)break}return r}function tT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let i=0;i<t.position.length;i++)if(!Wi(t.position[i],e.position[i]))return!1;return!0}class xl{constructor(e,i="asc"){this.field=e,this.dir=i}}function $A(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class k0{}class zt extends k0{constructor(e,i,r){super(),this.field=e,this.op=i,this.value=r}static create(e,i,r){return e.isKeyField()?i==="in"||i==="not-in"?this.createKeyFieldInFilter(e,i,r):new eS(e,i,r):i==="array-contains"?new iS(e,r):i==="in"?new aS(e,r):i==="not-in"?new rS(e,r):i==="array-contains-any"?new sS(e,r):new zt(e,i,r)}static createKeyFieldInFilter(e,i,r){return i==="in"?new tS(e,r):new nS(e,r)}matches(e){const i=e.data.field(this.field);return this.op==="!="?i!==null&&i.nullValue===void 0&&this.matchesComparison(Js(i,this.value)):i!==null&&rr(this.value)===rr(i)&&this.matchesComparison(Js(i,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ti extends k0{constructor(e,i){super(),this.filters=e,this.op=i,this.Pe=null}static create(e,i){return new Ti(e,i)}matches(e){return O0(this)?this.filters.find((i=>!i.matches(e)))===void 0:this.filters.find((i=>i.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,i)=>e.concat(i.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function O0(t){return t.op==="and"}function D0(t){return JA(t)&&O0(t)}function JA(t){for(const e of t.filters)if(e instanceof Ti)return!1;return!0}function Fd(t){if(t instanceof zt)return t.field.canonicalString()+t.op.toString()+eo(t.value);if(D0(t))return t.filters.map((e=>Fd(e))).join(",");{const e=t.filters.map((i=>Fd(i))).join(",");return`${t.op}(${e})`}}function N0(t,e){return t instanceof zt?(function(r,o){return o instanceof zt&&r.op===o.op&&r.field.isEqual(o.field)&&Wi(r.value,o.value)})(t,e):t instanceof Ti?(function(r,o){return o instanceof Ti&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((u,h,m)=>u&&N0(h,o.filters[m])),!0):!1})(t,e):void we(19439)}function C0(t){return t instanceof zt?(function(i){return`${i.field.canonicalString()} ${i.op} ${eo(i.value)}`})(t):t instanceof Ti?(function(i){return i.op.toString()+" {"+i.getFilters().map(C0).join(" ,")+"}"})(t):"Filter"}class eS extends zt{constructor(e,i,r){super(e,i,r),this.key=ge.fromName(r.referenceValue)}matches(e){const i=ge.comparator(e.key,this.key);return this.matchesComparison(i)}}class tS extends zt{constructor(e,i){super(e,"in",i),this.keys=M0("in",i)}matches(e){return this.keys.some((i=>i.isEqual(e.key)))}}class nS extends zt{constructor(e,i){super(e,"not-in",i),this.keys=M0("not-in",i)}matches(e){return!this.keys.some((i=>i.isEqual(e.key)))}}function M0(t,e){return(e.arrayValue?.values||[]).map((i=>ge.fromName(i.referenceValue)))}class iS extends zt{constructor(e,i){super(e,"array-contains",i)}matches(e){const i=e.data.field(this.field);return _m(i)&&Hl(i.arrayValue,this.value)}}class aS extends zt{constructor(e,i){super(e,"in",i)}matches(e){const i=e.data.field(this.field);return i!==null&&Hl(this.value.arrayValue,i)}}class rS extends zt{constructor(e,i){super(e,"not-in",i)}matches(e){if(Hl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=e.data.field(this.field);return i!==null&&i.nullValue===void 0&&!Hl(this.value.arrayValue,i)}}class sS extends zt{constructor(e,i){super(e,"array-contains-any",i)}matches(e){const i=e.data.field(this.field);return!(!_m(i)||!i.arrayValue.values)&&i.arrayValue.values.some((r=>Hl(this.value.arrayValue,r)))}}class oS{constructor(e,i=null,r=[],o=[],u=null,h=null,m=null){this.path=e,this.collectionGroup=i,this.orderBy=r,this.filters=o,this.limit=u,this.startAt=h,this.endAt=m,this.Te=null}}function nT(t,e=null,i=[],r=[],o=null,u=null,h=null){return new oS(t,e,i,r,o,u,h)}function pm(t){const e=Ie(t);if(e.Te===null){let i=e.path.canonicalString();e.collectionGroup!==null&&(i+="|cg:"+e.collectionGroup),i+="|f:",i+=e.filters.map((r=>Fd(r))).join(","),i+="|ob:",i+=e.orderBy.map((r=>(function(u){return u.field.canonicalString()+u.dir})(r))).join(","),th(e.limit)||(i+="|l:",i+=e.limit),e.startAt&&(i+="|lb:",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map((r=>eo(r))).join(",")),e.endAt&&(i+="|ub:",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map((r=>eo(r))).join(",")),e.Te=i}return e.Te}function gm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!$A(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(!N0(t.filters[i],e.filters[i]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!tT(t.startAt,e.startAt)&&tT(t.endAt,e.endAt)}function Wd(t){return ge.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class lo{constructor(e,i=null,r=[],o=[],u=null,h="F",m=null,_=null){this.path=e,this.collectionGroup=i,this.explicitOrderBy=r,this.filters=o,this.limit=u,this.limitType=h,this.startAt=m,this.endAt=_,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function lS(t,e,i,r,o,u,h,m){return new lo(t,e,i,r,o,u,h,m)}function V0(t){return new lo(t)}function iT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uS(t){return ge.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function L0(t){return t.collectionGroup!==null}function Sl(t){const e=Ie(t);if(e.Ie===null){e.Ie=[];const i=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),i.add(u.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let m=new jt(ln.comparator);return h.filters.forEach((_=>{_.getFlattenedFilters().forEach((p=>{p.isInequality()&&(m=m.add(p.field))}))})),m})(e).forEach((u=>{i.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new xl(u,r))})),i.has(ln.keyField().canonicalString())||e.Ie.push(new xl(ln.keyField(),r))}return e.Ie}function qi(t){const e=Ie(t);return e.Ee||(e.Ee=cS(e,Sl(t))),e.Ee}function cS(t,e){if(t.limitType==="F")return nT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((o=>{const u=o.dir==="desc"?"asc":"desc";return new xl(o.field,u)}));const i=t.endAt?new Yc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Yc(t.startAt.position,t.startAt.inclusive):null;return nT(t.path,t.collectionGroup,e,t.filters,t.limit,i,r)}}function Xd(t,e){const i=t.filters.concat([e]);return new lo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),i,t.limit,t.limitType,t.startAt,t.endAt)}function hS(t,e){const i=t.explicitOrderBy.concat([e]);return new lo(t.path,t.collectionGroup,i,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function jc(t,e,i){return new lo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,i,t.startAt,t.endAt)}function ih(t,e){return gm(qi(t),qi(e))&&t.limitType===e.limitType}function H0(t){return`${pm(qi(t))}|lt:${t.limitType}`}function Bs(t){return`Query(target=${(function(i){let r=i.path.canonicalString();return i.collectionGroup!==null&&(r+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(r+=`, filters: [${i.filters.map((o=>C0(o))).join(", ")}]`),th(i.limit)||(r+=", limit: "+i.limit),i.orderBy.length>0&&(r+=`, orderBy: [${i.orderBy.map((o=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(o))).join(", ")}]`),i.startAt&&(r+=", startAt: ",r+=i.startAt.inclusive?"b:":"a:",r+=i.startAt.position.map((o=>eo(o))).join(",")),i.endAt&&(r+=", endAt: ",r+=i.endAt.inclusive?"a:":"b:",r+=i.endAt.position.map((o=>eo(o))).join(",")),`Target(${r})`})(qi(t))}; limitType=${t.limitType})`}function ah(t,e){return e.isFoundDocument()&&(function(r,o){const u=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(u):ge.isDocumentKey(r.path)?r.path.isEqual(u):r.path.isImmediateParentOf(u)})(t,e)&&(function(r,o){for(const u of Sl(r))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0})(t,e)&&(function(r,o){for(const u of r.filters)if(!u.matches(o))return!1;return!0})(t,e)&&(function(r,o){return!(r.startAt&&!(function(h,m,_){const p=eT(h,m,_);return h.inclusive?p<=0:p<0})(r.startAt,Sl(r),o)||r.endAt&&!(function(h,m,_){const p=eT(h,m,_);return h.inclusive?p>=0:p>0})(r.endAt,Sl(r),o))})(t,e)}function fS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function x0(t){return(e,i)=>{let r=!1;for(const o of Sl(t)){const u=dS(o,e,i);if(u!==0)return u;r=r||o.field.isKeyField()}return 0}}function dS(t,e,i){const r=t.field.isKeyField()?ge.comparator(e.key,i.key):(function(u,h,m){const _=h.data.field(u),p=m.data.field(u);return _!==null&&p!==null?Js(_,p):we(42886)})(t.field,e,i);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return we(19790,{direction:t.dir})}}class Fr{constructor(e,i){this.mapKeyFn=e,this.equalsFn=i,this.inner={},this.innerSize=0}get(e){const i=this.mapKeyFn(e),r=this.inner[i];if(r!==void 0){for(const[o,u]of r)if(this.equalsFn(o,e))return u}}has(e){return this.get(e)!==void 0}set(e,i){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,i]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,i]);o.push([e,i]),this.innerSize++}delete(e){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[i]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){jr(this.inner,((i,r)=>{for(const[o,u]of r)e(o,u)}))}isEmpty(){return T0(this.inner)}size(){return this.innerSize}}const mS=new Et(ge.comparator);function _a(){return mS}const P0=new Et(ge.comparator);function vl(...t){let e=P0;for(const i of t)e=e.insert(i.key,i);return e}function z0(t){let e=P0;return t.forEach(((i,r)=>e=e.insert(i,r.overlayedDocument))),e}function Br(){return Rl()}function U0(){return Rl()}function Rl(){return new Fr((t=>t.toString()),((t,e)=>t.isEqual(e)))}const _S=new Et(ge.comparator),pS=new jt(ge.comparator);function Pe(...t){let e=pS;for(const i of t)e=e.add(i);return e}const gS=new jt(xe);function yS(){return gS}function ym(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bc(e)?"-0":e}}function B0(t){return{integerValue:""+t}}function TS(t,e){return qA(e)?B0(e):ym(t,e)}class rh{constructor(){this._=void 0}}function ES(t,e,i){return t instanceof Fc?(function(o,u){const h={fields:{[w0]:{stringValue:v0},[A0]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&mm(u)&&(u=nh(u)),u&&(h.fields[b0]=u),{mapValue:h}})(i,e):t instanceof Pl?q0(t,e):t instanceof zl?Y0(t,e):(function(o,u){const h=G0(o,u),m=aT(h)+aT(o.Ae);return jd(h)&&jd(o.Ae)?B0(m):ym(o.serializer,m)})(t,e)}function vS(t,e,i){return t instanceof Pl?q0(t,e):t instanceof zl?Y0(t,e):i}function G0(t,e){return t instanceof Wc?(function(r){return jd(r)||(function(u){return!!u&&"doubleValue"in u})(r)})(e)?e:{integerValue:0}:null}class Fc extends rh{}class Pl extends rh{constructor(e){super(),this.elements=e}}function q0(t,e){const i=j0(e);for(const r of t.elements)i.some((o=>Wi(o,r)))||i.push(r);return{arrayValue:{values:i}}}class zl extends rh{constructor(e){super(),this.elements=e}}function Y0(t,e){let i=j0(e);for(const r of t.elements)i=i.filter((o=>!Wi(o,r)));return{arrayValue:{values:i}}}class Wc extends rh{constructor(e,i){super(),this.serializer=e,this.Ae=i}}function aT(t){return kt(t.integerValue||t.doubleValue)}function j0(t){return _m(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function wS(t,e){return t.field.isEqual(e.field)&&(function(r,o){return r instanceof Pl&&o instanceof Pl||r instanceof zl&&o instanceof zl?$s(r.elements,o.elements,Wi):r instanceof Wc&&o instanceof Wc?Wi(r.Ae,o.Ae):r instanceof Fc&&o instanceof Fc})(t.transform,e.transform)}class bS{constructor(e,i){this.version=e,this.transformResults=i}}class Yi{constructor(e,i){this.updateTime=e,this.exists=i}static none(){return new Yi}static exists(e){return new Yi(void 0,e)}static updateTime(e){return new Yi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class sh{}function F0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Tm(t.key,Yi.none()):new Yl(t.key,t.data,Yi.none());{const i=t.data,r=ei.empty();let o=new jt(ln.comparator);for(let u of e.fields)if(!o.has(u)){let h=i.field(u);h===null&&u.length>1&&(u=u.popLast(),h=i.field(u)),h===null?r.delete(u):r.set(u,h),o=o.add(u)}return new Wr(t.key,r,new pi(o.toArray()),Yi.none())}}function AS(t,e,i){t instanceof Yl?(function(o,u,h){const m=o.value.clone(),_=sT(o.fieldTransforms,u,h.transformResults);m.setAll(_),u.convertToFoundDocument(h.version,m).setHasCommittedMutations()})(t,e,i):t instanceof Wr?(function(o,u,h){if(!Vc(o.precondition,u))return void u.convertToUnknownDocument(h.version);const m=sT(o.fieldTransforms,u,h.transformResults),_=u.data;_.setAll(W0(o)),_.setAll(m),u.convertToFoundDocument(h.version,_).setHasCommittedMutations()})(t,e,i):(function(o,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,i)}function Il(t,e,i,r){return t instanceof Yl?(function(u,h,m,_){if(!Vc(u.precondition,h))return m;const p=u.value.clone(),y=oT(u.fieldTransforms,_,h);return p.setAll(y),h.convertToFoundDocument(h.version,p).setHasLocalMutations(),null})(t,e,i,r):t instanceof Wr?(function(u,h,m,_){if(!Vc(u.precondition,h))return m;const p=oT(u.fieldTransforms,_,h),y=h.data;return y.setAll(W0(u)),y.setAll(p),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),m===null?null:m.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((v=>v.field)))})(t,e,i,r):(function(u,h,m){return Vc(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):m})(t,e,i)}function SS(t,e){let i=null;for(const r of t.fieldTransforms){const o=e.data.field(r.field),u=G0(r.transform,o||null);u!=null&&(i===null&&(i=ei.empty()),i.set(r.field,u))}return i||null}function rT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&$s(r,o,((u,h)=>wS(u,h)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Yl extends sh{constructor(e,i,r,o=[]){super(),this.key=e,this.value=i,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Wr extends sh{constructor(e,i,r,o,u=[]){super(),this.key=e,this.data=i,this.fieldMask=r,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function W0(t){const e=new Map;return t.fieldMask.fields.forEach((i=>{if(!i.isEmpty()){const r=t.data.field(i);e.set(i,r)}})),e}function sT(t,e,i){const r=new Map;$e(t.length===i.length,32656,{Ve:i.length,de:t.length});for(let o=0;o<i.length;o++){const u=t[o],h=u.transform,m=e.data.field(u.field);r.set(u.field,vS(h,m,i[o]))}return r}function oT(t,e,i){const r=new Map;for(const o of t){const u=o.transform,h=i.data.field(o.field);r.set(o.field,ES(u,h,e))}return r}class Tm extends sh{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RS extends sh{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class IS{constructor(e,i,r,o){this.batchId=e,this.localWriteTime=i,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,i){const r=i.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&AS(u,e,r[o])}}applyToLocalView(e,i){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(i=Il(r,e,i,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(i=Il(r,e,i,this.localWriteTime));return i}applyToLocalDocumentSet(e,i){const r=U0();return this.mutations.forEach((o=>{const u=e.get(o.key),h=u.overlayedDocument;let m=this.applyToLocalView(h,u.mutatedFields);m=i.has(o.key)?null:m;const _=F0(h,m);_!==null&&r.set(o.key,_),h.isValidDocument()||h.convertToNoDocument(Ae.min())})),r}keys(){return this.mutations.reduce(((e,i)=>e.add(i.key)),Pe())}isEqual(e){return this.batchId===e.batchId&&$s(this.mutations,e.mutations,((i,r)=>rT(i,r)))&&$s(this.baseMutations,e.baseMutations,((i,r)=>rT(i,r)))}}class Em{constructor(e,i,r,o){this.batch=e,this.commitVersion=i,this.mutationResults=r,this.docVersions=o}static from(e,i,r){$e(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let o=(function(){return _S})();const u=e.mutations;for(let h=0;h<u.length;h++)o=o.insert(u[h].key,r[h].version);return new Em(e,i,r,o)}}class kS{constructor(e,i){this.largestBatchId=e,this.mutation=i}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class OS{constructor(e,i){this.count=e,this.unchangedNames=i}}var Pt,Ge;function DS(t){switch(t){case ee.OK:return we(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return we(15467,{code:t})}}function X0(t){if(t===void 0)return ma("GRPC error has no .code"),ee.UNKNOWN;switch(t){case Pt.OK:return ee.OK;case Pt.CANCELLED:return ee.CANCELLED;case Pt.UNKNOWN:return ee.UNKNOWN;case Pt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case Pt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case Pt.INTERNAL:return ee.INTERNAL;case Pt.UNAVAILABLE:return ee.UNAVAILABLE;case Pt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case Pt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case Pt.NOT_FOUND:return ee.NOT_FOUND;case Pt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case Pt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case Pt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case Pt.ABORTED:return ee.ABORTED;case Pt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case Pt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case Pt.DATA_LOSS:return ee.DATA_LOSS;default:return we(39323,{code:t})}}(Ge=Pt||(Pt={}))[Ge.OK=0]="OK",Ge[Ge.CANCELLED=1]="CANCELLED",Ge[Ge.UNKNOWN=2]="UNKNOWN",Ge[Ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ge[Ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ge[Ge.NOT_FOUND=5]="NOT_FOUND",Ge[Ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ge[Ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ge[Ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ge[Ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ge[Ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ge[Ge.ABORTED=10]="ABORTED",Ge[Ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ge[Ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ge[Ge.INTERNAL=13]="INTERNAL",Ge[Ge.UNAVAILABLE=14]="UNAVAILABLE",Ge[Ge.DATA_LOSS=15]="DATA_LOSS";function NS(){return new TextEncoder}const CS=new Ja([4294967295,4294967295],0);function lT(t){const e=NS().encode(t),i=new l0;return i.update(e),new Uint8Array(i.digest())}function uT(t){const e=new DataView(t.buffer),i=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ja([i,r],0),new Ja([o,u],0)]}class vm{constructor(e,i,r){if(this.bitmap=e,this.padding=i,this.hashCount=r,i<0||i>=8)throw new wl(`Invalid padding: ${i}`);if(r<0)throw new wl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wl(`Invalid hash count: ${r}`);if(e.length===0&&i!==0)throw new wl(`Invalid padding when bitmap length is 0: ${i}`);this.ge=8*e.length-i,this.pe=Ja.fromNumber(this.ge)}ye(e,i,r){let o=e.add(i.multiply(Ja.fromNumber(r)));return o.compare(CS)===1&&(o=new Ja([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const i=lT(e),[r,o]=uT(i);for(let u=0;u<this.hashCount;u++){const h=this.ye(r,o,u);if(!this.we(h))return!1}return!0}static create(e,i,r){const o=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new vm(u,o,i);return r.forEach((m=>h.insert(m))),h}insert(e){if(this.ge===0)return;const i=lT(e),[r,o]=uT(i);for(let u=0;u<this.hashCount;u++){const h=this.ye(r,o,u);this.be(h)}}be(e){const i=Math.floor(e/8),r=e%8;this.bitmap[i]|=1<<r}}class wl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class oh{constructor(e,i,r,o,u){this.snapshotVersion=e,this.targetChanges=i,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,i,r){const o=new Map;return o.set(e,jl.createSynthesizedTargetChangeForCurrentChange(e,i,r)),new oh(Ae.min(),o,new Et(xe),_a(),Pe())}}class jl{constructor(e,i,r,o,u){this.resumeToken=e,this.current=i,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,i,r){return new jl(r,i,Pe(),Pe(),Pe())}}class Lc{constructor(e,i,r,o){this.Se=e,this.removedTargetIds=i,this.key=r,this.De=o}}class K0{constructor(e,i){this.targetId=e,this.Ce=i}}class Q0{constructor(e,i,r=cn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=i,this.resumeToken=r,this.cause=o}}class cT{constructor(){this.ve=0,this.Fe=hT(),this.Me=cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),i=Pe(),r=Pe();return this.Fe.forEach(((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:i=i.add(o);break;case 1:r=r.add(o);break;default:we(38017,{changeType:u})}})),new jl(this.Me,this.xe,e,i,r)}Ke(){this.Oe=!1,this.Fe=hT()}qe(e,i){this.Oe=!0,this.Fe=this.Fe.insert(e,i)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,$e(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class MS{constructor(e){this.Ge=e,this.ze=new Map,this.je=_a(),this.He=Rc(),this.Je=Rc(),this.Ze=new Et(xe)}Xe(e){for(const i of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(i,e.De):this.et(i,e.key,e.De);for(const i of e.removedTargetIds)this.et(i,e.key,e.De)}tt(e){this.forEachTarget(e,(i=>{const r=this.nt(i);switch(e.state){case 0:this.rt(i)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(i);break;case 3:this.rt(i)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(i)&&(this.it(i),r.Le(e.resumeToken));break;default:we(56790,{state:e.state})}}))}forEachTarget(e,i){e.targetIds.length>0?e.targetIds.forEach(i):this.ze.forEach(((r,o)=>{this.rt(o)&&i(o)}))}st(e){const i=e.targetId,r=e.Ce.count,o=this.ot(i);if(o){const u=o.target;if(Wd(u))if(r===0){const h=new ge(u.path);this.et(i,h,mn.newNoDocument(h,Ae.min()))}else $e(r===1,20013,{expectedCount:r});else{const h=this._t(i);if(h!==r){const m=this.ut(e),_=m?this.ct(m,e,h):1;if(_!==0){this.it(i);const p=_===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(i,p)}}}}}ut(e){const i=e.Ce.unchangedNames;if(!i||!i.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:u=0}=i;let h,m;try{h=ar(r).toUint8Array()}catch(_){if(_ instanceof E0)return qr("Decoding the base64 bloom filter in existence filter failed ("+_.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw _}try{m=new vm(h,o,u)}catch(_){return qr(_ instanceof wl?"BloomFilter error: ":"Applying bloom filter failed: ",_),null}return m.ge===0?null:m}ct(e,i,r){return i.Ce.count===r-this.Pt(e,i.targetId)?0:2}Pt(e,i){const r=this.Ge.getRemoteKeysForTarget(i);let o=0;return r.forEach((u=>{const h=this.Ge.ht(),m=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(m)||(this.et(i,u,null),o++)})),o}Tt(e){const i=new Map;this.ze.forEach(((u,h)=>{const m=this.ot(h);if(m){if(u.current&&Wd(m.target)){const _=new ge(m.target.path);this.It(_).has(h)||this.Et(h,_)||this.et(h,_,mn.newNoDocument(_,e))}u.Be&&(i.set(h,u.ke()),u.Ke())}}));let r=Pe();this.Je.forEach(((u,h)=>{let m=!0;h.forEachWhile((_=>{const p=this.ot(_);return!p||p.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(r=r.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const o=new oh(e,i,this.Ze,this.je,r);return this.je=_a(),this.He=Rc(),this.Je=Rc(),this.Ze=new Et(xe),o}Ye(e,i){if(!this.rt(e))return;const r=this.Et(e,i.key)?2:0;this.nt(e).qe(i.key,r),this.je=this.je.insert(i.key,i),this.He=this.He.insert(i.key,this.It(i.key).add(e)),this.Je=this.Je.insert(i.key,this.Rt(i.key).add(e))}et(e,i,r){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,i)?o.qe(i,1):o.Ue(i),this.Je=this.Je.insert(i,this.Rt(i).delete(e)),this.Je=this.Je.insert(i,this.Rt(i).add(e)),r&&(this.je=this.je.insert(i,r))}removeTarget(e){this.ze.delete(e)}_t(e){const i=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let i=this.ze.get(e);return i||(i=new cT,this.ze.set(e,i)),i}Rt(e){let i=this.Je.get(e);return i||(i=new jt(xe),this.Je=this.Je.insert(e,i)),i}It(e){let i=this.He.get(e);return i||(i=new jt(xe),this.He=this.He.insert(e,i)),i}rt(e){const i=this.ot(e)!==null;return i||he("WatchChangeAggregator","Detected inactive target",e),i}ot(e){const i=this.ze.get(e);return i&&i.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new cT),this.Ge.getRemoteKeysForTarget(e).forEach((i=>{this.et(e,i,null)}))}Et(e,i){return this.Ge.getRemoteKeysForTarget(e).has(i)}}function Rc(){return new Et(ge.comparator)}function hT(){return new Et(ge.comparator)}const VS={asc:"ASCENDING",desc:"DESCENDING"},LS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HS={and:"AND",or:"OR"};class xS{constructor(e,i){this.databaseId=e,this.useProto3Json=i}}function Kd(t,e){return t.useProto3Json||th(e)?e:{value:e}}function Xc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Z0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function PS(t,e){return Xc(t,e.toTimestamp())}function ji(t){return $e(!!t,49232),Ae.fromTimestamp((function(i){const r=ir(i);return new mt(r.seconds,r.nanos)})(t))}function wm(t,e){return Qd(t,e).canonicalString()}function Qd(t,e){const i=(function(o){return new ct(["projects",o.projectId,"databases",o.database])})(t).child("documents");return e===void 0?i:i.child(e)}function $0(t){const e=ct.fromString(t);return $e(iE(e),10190,{key:e.toString()}),e}function Zd(t,e){return wm(t.databaseId,e.path)}function Id(t,e){const i=$0(e);if(i.get(1)!==t.databaseId.projectId)throw new ue(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+t.databaseId.projectId);if(i.get(3)!==t.databaseId.database)throw new ue(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+t.databaseId.database);return new ge(eE(i))}function J0(t,e){return wm(t.databaseId,e)}function zS(t){const e=$0(t);return e.length===4?ct.emptyPath():eE(e)}function $d(t){return new ct(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eE(t){return $e(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fT(t,e,i){return{name:Zd(t,e),fields:i.value.mapValue.fields}}function US(t,e){let i;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:we(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],u=(function(p,y){return p.useProto3Json?($e(y===void 0||typeof y=="string",58123),cn.fromBase64String(y||"")):($e(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),cn.fromUint8Array(y||new Uint8Array))})(t,e.targetChange.resumeToken),h=e.targetChange.cause,m=h&&(function(p){const y=p.code===void 0?ee.UNKNOWN:X0(p.code);return new ue(y,p.message||"")})(h);i=new Q0(r,o,u,m||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=Id(t,r.document.name),u=ji(r.document.updateTime),h=r.document.createTime?ji(r.document.createTime):Ae.min(),m=new ei({mapValue:{fields:r.document.fields}}),_=mn.newFoundDocument(o,u,h,m),p=r.targetIds||[],y=r.removedTargetIds||[];i=new Lc(p,y,_.key,_)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=Id(t,r.document),u=r.readTime?ji(r.readTime):Ae.min(),h=mn.newNoDocument(o,u),m=r.removedTargetIds||[];i=new Lc([],m,h.key,h)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=Id(t,r.document),u=r.removedTargetIds||[];i=new Lc([],u,o,null)}else{if(!("filter"in e))return we(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:u}=r,h=new OS(o,u),m=r.targetId;i=new K0(m,h)}}return i}function BS(t,e){let i;if(e instanceof Yl)i={update:fT(t,e.key,e.value)};else if(e instanceof Tm)i={delete:Zd(t,e.key)};else if(e instanceof Wr)i={update:fT(t,e.key,e.data),updateMask:QS(e.fieldMask)};else{if(!(e instanceof RS))return we(16599,{dt:e.type});i={verify:Zd(t,e.key)}}return e.fieldTransforms.length>0&&(i.updateTransforms=e.fieldTransforms.map((r=>(function(u,h){const m=h.transform;if(m instanceof Fc)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Pl)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof zl)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Wc)return{fieldPath:h.field.canonicalString(),increment:m.Ae};throw we(20930,{transform:h.transform})})(0,r)))),e.precondition.isNone||(i.currentDocument=(function(o,u){return u.updateTime!==void 0?{updateTime:PS(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:we(27497)})(t,e.precondition)),i}function GS(t,e){return t&&t.length>0?($e(e!==void 0,14353),t.map((i=>(function(o,u){let h=o.updateTime?ji(o.updateTime):ji(u);return h.isEqual(Ae.min())&&(h=ji(u)),new bS(h,o.transformResults||[])})(i,e)))):[]}function qS(t,e){return{documents:[J0(t,e.path)]}}function YS(t,e){const i={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,i.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),i.structuredQuery.from=[{collectionId:r.lastSegment()}]),i.parent=J0(t,o);const u=(function(p){if(p.length!==0)return nE(Ti.create(p,"and"))})(e.filters);u&&(i.structuredQuery.where=u);const h=(function(p){if(p.length!==0)return p.map((y=>(function(w){return{field:Gs(w.field),direction:WS(w.dir)}})(y)))})(e.orderBy);h&&(i.structuredQuery.orderBy=h);const m=Kd(t,e.limit);return m!==null&&(i.structuredQuery.limit=m),e.startAt&&(i.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(i.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:i,parent:o}}function jS(t){let e=zS(t.parent);const i=t.structuredQuery,r=i.from?i.from.length:0;let o=null;if(r>0){$e(r===1,65062);const y=i.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let u=[];i.where&&(u=(function(v){const w=tE(v);return w instanceof Ti&&D0(w)?w.getFilters():[w]})(i.where));let h=[];i.orderBy&&(h=(function(v){return v.map((w=>(function(x){return new xl(qs(x.field),(function(H){switch(H){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(w)))})(i.orderBy));let m=null;i.limit&&(m=(function(v){let w;return w=typeof v=="object"?v.value:v,th(w)?null:w})(i.limit));let _=null;i.startAt&&(_=(function(v){const w=!!v.before,S=v.values||[];return new Yc(S,w)})(i.startAt));let p=null;return i.endAt&&(p=(function(v){const w=!v.before,S=v.values||[];return new Yc(S,w)})(i.endAt)),lS(e,o,h,u,m,"F",_,p)}function FS(t,e){const i=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we(28987,{purpose:o})}})(e.purpose);return i==null?null:{"goog-listen-tags":i}}function tE(t){return t.unaryFilter!==void 0?(function(i){switch(i.unaryFilter.op){case"IS_NAN":const r=qs(i.unaryFilter.field);return zt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=qs(i.unaryFilter.field);return zt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=qs(i.unaryFilter.field);return zt.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=qs(i.unaryFilter.field);return zt.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return we(61313);default:return we(60726)}})(t):t.fieldFilter!==void 0?(function(i){return zt.create(qs(i.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return we(58110);default:return we(50506)}})(i.fieldFilter.op),i.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(i){return Ti.create(i.compositeFilter.filters.map((r=>tE(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return we(1026)}})(i.compositeFilter.op))})(t):we(30097,{filter:t})}function WS(t){return VS[t]}function XS(t){return LS[t]}function KS(t){return HS[t]}function Gs(t){return{fieldPath:t.canonicalString()}}function qs(t){return ln.fromServerFormat(t.fieldPath)}function nE(t){return t instanceof zt?(function(i){if(i.op==="=="){if(Jy(i.value))return{unaryFilter:{field:Gs(i.field),op:"IS_NAN"}};if($y(i.value))return{unaryFilter:{field:Gs(i.field),op:"IS_NULL"}}}else if(i.op==="!="){if(Jy(i.value))return{unaryFilter:{field:Gs(i.field),op:"IS_NOT_NAN"}};if($y(i.value))return{unaryFilter:{field:Gs(i.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gs(i.field),op:XS(i.op),value:i.value}}})(t):t instanceof Ti?(function(i){const r=i.getFilters().map((o=>nE(o)));return r.length===1?r[0]:{compositeFilter:{op:KS(i.op),filters:r}}})(t):we(54877,{filter:t})}function QS(t){const e=[];return t.fields.forEach((i=>e.push(i.canonicalString()))),{fieldPaths:e}}function iE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function aE(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}class Qa{constructor(e,i,r,o,u=Ae.min(),h=Ae.min(),m=cn.EMPTY_BYTE_STRING,_=null){this.target=e,this.targetId=i,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=m,this.expectedCount=_}withSequenceNumber(e){return new Qa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,i){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ZS{constructor(e){this.yt=e}}function $S(t){const e=jS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?jc(e,e.limit,"L"):e}class JS{constructor(){this.Sn=new e1}addToCollectionParentIndex(e,i){return this.Sn.add(i),ne.resolve()}getCollectionParents(e,i){return ne.resolve(this.Sn.getEntries(i))}addFieldIndex(e,i){return ne.resolve()}deleteFieldIndex(e,i){return ne.resolve()}deleteAllFieldIndexes(e){return ne.resolve()}createTargetIndexes(e,i){return ne.resolve()}getDocumentsMatchingTarget(e,i){return ne.resolve(null)}getIndexType(e,i){return ne.resolve(0)}getFieldIndexes(e,i){return ne.resolve([])}getNextCollectionGroupToUpdate(e){return ne.resolve(null)}getMinOffset(e,i){return ne.resolve(nr.min())}getMinOffsetFromCollectionGroup(e,i){return ne.resolve(nr.min())}updateCollectionGroup(e,i,r){return ne.resolve()}updateIndexEntries(e,i){return ne.resolve()}}class e1{constructor(){this.index={}}add(e){const i=e.lastSegment(),r=e.popLast(),o=this.index[i]||new jt(ct.comparator),u=!o.has(r);return this.index[i]=o.add(r),u}has(e){const i=e.lastSegment(),r=e.popLast(),o=this.index[i];return o&&o.has(r)}getEntries(e){return(this.index[e]||new jt(ct.comparator)).toArray()}}const dT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rE=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,i,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=i,this.maximumSequenceNumbersToCollect=r}}Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(rE,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);class to{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new to(0)}static ar(){return new to(-1)}}const mT="LruGarbageCollector",t1=1048576;function _T([t,e],[i,r]){const o=xe(t,i);return o===0?xe(e,r):o}class n1{constructor(e){this.Pr=e,this.buffer=new jt(_T),this.Tr=0}Ir(){return++this.Tr}Er(e){const i=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(i);else{const r=this.buffer.last();_T(i,r)<0&&(this.buffer=this.buffer.delete(r).add(i))}}get maxValue(){return this.buffer.last()[0]}}class i1{constructor(e,i,r){this.garbageCollector=e,this.asyncQueue=i,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){he(mT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(i){oo(i)?he(mT,"Ignoring IndexedDB error during garbage collection: ",i):await so(i)}await this.Ar(3e5)}))}}class a1{constructor(e,i){this.Vr=e,this.params=i}calculateTargetCount(e,i){return this.Vr.dr(e).next((r=>Math.floor(i/100*r)))}nthSequenceNumber(e,i){if(i===0)return ne.resolve(eh.ce);const r=new n1(i);return this.Vr.forEachTarget(e,(o=>r.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>r.Er(o))))).next((()=>r.maxValue))}removeTargets(e,i,r){return this.Vr.removeTargets(e,i,r)}removeOrphanedDocuments(e,i){return this.Vr.removeOrphanedDocuments(e,i)}collect(e,i){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),ne.resolve(dT)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),dT):this.gr(e,i)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,i){let r,o,u,h,m,_,p;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,h=Date.now(),this.nthSequenceNumber(e,o)))).next((v=>(r=v,m=Date.now(),this.removeTargets(e,r,i)))).next((v=>(u=v,_=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(p=Date.now(),Us()<=qe.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-y}ms
	Determined least recently used ${o} in `+(m-h)+`ms
	Removed ${u} targets in `+(_-m)+`ms
	Removed ${v} documents in `+(p-_)+`ms
Total Duration: ${p-y}ms`),ne.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:v}))))}}function r1(t,e){return new a1(t,e)}class s1{constructor(){this.changes=new Fr((e=>e.toString()),((e,i)=>e.isEqual(i))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,i){this.assertNotApplied(),this.changes.set(e,mn.newInvalidDocument(e).setReadTime(i))}getEntry(e,i){this.assertNotApplied();const r=this.changes.get(i);return r!==void 0?ne.resolve(r):this.getFromCache(e,i)}getEntries(e,i){return this.getAllFromCache(e,i)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class o1{constructor(e,i){this.overlayedDocument=e,this.mutatedFields=i}}class l1{constructor(e,i,r,o){this.remoteDocumentCache=e,this.mutationQueue=i,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,i){let r=null;return this.documentOverlayCache.getOverlay(e,i).next((o=>(r=o,this.remoteDocumentCache.getEntry(e,i)))).next((o=>(r!==null&&Il(r.mutation,o,pi.empty(),mt.now()),o)))}getDocuments(e,i){return this.remoteDocumentCache.getEntries(e,i).next((r=>this.getLocalViewOfDocuments(e,r,Pe()).next((()=>r))))}getLocalViewOfDocuments(e,i,r=Pe()){const o=Br();return this.populateOverlays(e,o,i).next((()=>this.computeViews(e,i,o,r).next((u=>{let h=vl();return u.forEach(((m,_)=>{h=h.insert(m,_.overlayedDocument)})),h}))))}getOverlayedDocuments(e,i){const r=Br();return this.populateOverlays(e,r,i).next((()=>this.computeViews(e,i,r,Pe())))}populateOverlays(e,i,r){const o=[];return r.forEach((u=>{i.has(u)||o.push(u)})),this.documentOverlayCache.getOverlays(e,o).next((u=>{u.forEach(((h,m)=>{i.set(h,m)}))}))}computeViews(e,i,r,o){let u=_a();const h=Rl(),m=(function(){return Rl()})();return i.forEach(((_,p)=>{const y=r.get(p.key);o.has(p.key)&&(y===void 0||y.mutation instanceof Wr)?u=u.insert(p.key,p):y!==void 0?(h.set(p.key,y.mutation.getFieldMask()),Il(y.mutation,p,y.mutation.getFieldMask(),mt.now())):h.set(p.key,pi.empty())})),this.recalculateAndSaveOverlays(e,u).next((_=>(_.forEach(((p,y)=>h.set(p,y))),i.forEach(((p,y)=>m.set(p,new o1(y,h.get(p)??null)))),m)))}recalculateAndSaveOverlays(e,i){const r=Rl();let o=new Et(((h,m)=>h-m)),u=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,i).next((h=>{for(const m of h)m.keys().forEach((_=>{const p=i.get(_);if(p===null)return;let y=r.get(_)||pi.empty();y=m.applyToLocalView(p,y),r.set(_,y);const v=(o.get(m.batchId)||Pe()).add(_);o=o.insert(m.batchId,v)}))})).next((()=>{const h=[],m=o.getReverseIterator();for(;m.hasNext();){const _=m.getNext(),p=_.key,y=_.value,v=U0();y.forEach((w=>{if(!u.has(w)){const S=F0(i.get(w),r.get(w));S!==null&&v.set(w,S),u=u.add(w)}})),h.push(this.documentOverlayCache.saveOverlays(e,p,v))}return ne.waitFor(h)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,i){return this.remoteDocumentCache.getEntries(e,i).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,i,r,o){return uS(i)?this.getDocumentsMatchingDocumentQuery(e,i.path):L0(i)?this.getDocumentsMatchingCollectionGroupQuery(e,i,r,o):this.getDocumentsMatchingCollectionQuery(e,i,r,o)}getNextDocuments(e,i,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,i,r,o).next((u=>{const h=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,i,r.largestBatchId,o-u.size):ne.resolve(Br());let m=Ml,_=u;return h.next((p=>ne.forEach(p,((y,v)=>(m<v.largestBatchId&&(m=v.largestBatchId),u.get(y)?ne.resolve():this.remoteDocumentCache.getEntry(e,y).next((w=>{_=_.insert(y,w)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,_,p,Pe()))).next((y=>({batchId:m,changes:z0(y)})))))}))}getDocumentsMatchingDocumentQuery(e,i){return this.getDocument(e,new ge(i)).next((r=>{let o=vl();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(e,i,r,o){const u=i.collectionGroup;let h=vl();return this.indexManager.getCollectionParents(e,u).next((m=>ne.forEach(m,(_=>{const p=(function(v,w){return new lo(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(i,_.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,r,o).next((y=>{y.forEach(((v,w)=>{h=h.insert(v,w)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,i,r,o){let u;return this.documentOverlayCache.getOverlaysForCollection(e,i.path,r.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,i,r,u,o)))).next((h=>{u.forEach(((_,p)=>{const y=p.getKey();h.get(y)===null&&(h=h.insert(y,mn.newInvalidDocument(y)))}));let m=vl();return h.forEach(((_,p)=>{const y=u.get(_);y!==void 0&&Il(y.mutation,p,pi.empty(),mt.now()),ah(i,p)&&(m=m.insert(_,p))})),m}))}}class u1{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,i){return ne.resolve(this.Nr.get(i))}saveBundleMetadata(e,i){return this.Nr.set(i.id,(function(o){return{id:o.id,version:o.version,createTime:ji(o.createTime)}})(i)),ne.resolve()}getNamedQuery(e,i){return ne.resolve(this.Br.get(i))}saveNamedQuery(e,i){return this.Br.set(i.name,(function(o){return{name:o.name,query:$S(o.bundledQuery),readTime:ji(o.readTime)}})(i)),ne.resolve()}}class c1{constructor(){this.overlays=new Et(ge.comparator),this.Lr=new Map}getOverlay(e,i){return ne.resolve(this.overlays.get(i))}getOverlays(e,i){const r=Br();return ne.forEach(i,(o=>this.getOverlay(e,o).next((u=>{u!==null&&r.set(o,u)})))).next((()=>r))}saveOverlays(e,i,r){return r.forEach(((o,u)=>{this.bt(e,i,u)})),ne.resolve()}removeOverlaysForBatchId(e,i,r){const o=this.Lr.get(r);return o!==void 0&&(o.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(r)),ne.resolve()}getOverlaysForCollection(e,i,r){const o=Br(),u=i.length+1,h=new ge(i.child("")),m=this.overlays.getIteratorFrom(h);for(;m.hasNext();){const _=m.getNext().value,p=_.getKey();if(!i.isPrefixOf(p.path))break;p.path.length===u&&_.largestBatchId>r&&o.set(_.getKey(),_)}return ne.resolve(o)}getOverlaysForCollectionGroup(e,i,r,o){let u=new Et(((p,y)=>p-y));const h=this.overlays.getIterator();for(;h.hasNext();){const p=h.getNext().value;if(p.getKey().getCollectionGroup()===i&&p.largestBatchId>r){let y=u.get(p.largestBatchId);y===null&&(y=Br(),u=u.insert(p.largestBatchId,y)),y.set(p.getKey(),p)}}const m=Br(),_=u.getIterator();for(;_.hasNext()&&(_.getNext().value.forEach(((p,y)=>m.set(p,y))),!(m.size()>=o)););return ne.resolve(m)}bt(e,i,r){const o=this.overlays.get(r.key);if(o!==null){const h=this.Lr.get(o.largestBatchId).delete(r.key);this.Lr.set(o.largestBatchId,h)}this.overlays=this.overlays.insert(r.key,new kS(i,r));let u=this.Lr.get(i);u===void 0&&(u=Pe(),this.Lr.set(i,u)),this.Lr.set(i,u.add(r.key))}}class h1{constructor(){this.sessionToken=cn.EMPTY_BYTE_STRING}getSessionToken(e){return ne.resolve(this.sessionToken)}setSessionToken(e,i){return this.sessionToken=i,ne.resolve()}}class bm{constructor(){this.kr=new jt(Kt.Kr),this.qr=new jt(Kt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,i){const r=new Kt(e,i);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,i){e.forEach((r=>this.addReference(r,i)))}removeReference(e,i){this.Wr(new Kt(e,i))}Qr(e,i){e.forEach((r=>this.removeReference(r,i)))}Gr(e){const i=new ge(new ct([])),r=new Kt(i,e),o=new Kt(i,e+1),u=[];return this.qr.forEachInRange([r,o],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const i=new ge(new ct([])),r=new Kt(i,e),o=new Kt(i,e+1);let u=Pe();return this.qr.forEachInRange([r,o],(h=>{u=u.add(h.key)})),u}containsKey(e){const i=new Kt(e,0),r=this.kr.firstAfterOrEqual(i);return r!==null&&e.isEqual(r.key)}}class Kt{constructor(e,i){this.key=e,this.Hr=i}static Kr(e,i){return ge.comparator(e.key,i.key)||xe(e.Hr,i.Hr)}static Ur(e,i){return xe(e.Hr,i.Hr)||ge.comparator(e.key,i.key)}}class f1{constructor(e,i){this.indexManager=e,this.referenceDelegate=i,this.mutationQueue=[],this.Yn=1,this.Jr=new jt(Kt.Kr)}checkEmpty(e){return ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,i,r,o){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new IS(u,i,r,o);this.mutationQueue.push(h);for(const m of o)this.Jr=this.Jr.add(new Kt(m.key,u)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return ne.resolve(h)}lookupMutationBatch(e,i){return ne.resolve(this.Zr(i))}getNextMutationBatchAfterBatchId(e,i){const r=i+1,o=this.Xr(r),u=o<0?0:o;return ne.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return ne.resolve(this.mutationQueue.length===0?dm:this.Yn-1)}getAllMutationBatches(e){return ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,i){const r=new Kt(i,0),o=new Kt(i,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([r,o],(h=>{const m=this.Zr(h.Hr);u.push(m)})),ne.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,i){let r=new jt(xe);return i.forEach((o=>{const u=new Kt(o,0),h=new Kt(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(m=>{r=r.add(m.Hr)}))})),ne.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,i){const r=i.path,o=r.length+1;let u=r;ge.isDocumentKey(u)||(u=u.child(""));const h=new Kt(new ge(u),0);let m=new jt(xe);return this.Jr.forEachWhile((_=>{const p=_.key.path;return!!r.isPrefixOf(p)&&(p.length===o&&(m=m.add(_.Hr)),!0)}),h),ne.resolve(this.Yr(m))}Yr(e){const i=[];return e.forEach((r=>{const o=this.Zr(r);o!==null&&i.push(o)})),i}removeMutationBatch(e,i){$e(this.ei(i.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return ne.forEach(i.mutations,(o=>{const u=new Kt(o.key,i.batchId);return r=r.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,i){const r=new Kt(i,0),o=this.Jr.firstAfterOrEqual(r);return ne.resolve(i.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ne.resolve()}ei(e,i){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const i=this.Xr(e);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}}class d1{constructor(e){this.ti=e,this.docs=(function(){return new Et(ge.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,i){const r=i.key,o=this.docs.get(r),u=o?o.size:0,h=this.ti(i);return this.docs=this.docs.insert(r,{document:i.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const i=this.docs.get(e);i&&(this.docs=this.docs.remove(e),this.size-=i.size)}getEntry(e,i){const r=this.docs.get(i);return ne.resolve(r?r.document.mutableCopy():mn.newInvalidDocument(i))}getEntries(e,i){let r=_a();return i.forEach((o=>{const u=this.docs.get(o);r=r.insert(o,u?u.document.mutableCopy():mn.newInvalidDocument(o))})),ne.resolve(r)}getDocumentsMatchingQuery(e,i,r,o){let u=_a();const h=i.path,m=new ge(h.child("__id-9223372036854775808__")),_=this.docs.getIteratorFrom(m);for(;_.hasNext();){const{key:p,value:{document:y}}=_.getNext();if(!h.isPrefixOf(p.path))break;p.path.length>h.length+1||zA(PA(y),r)<=0||(o.has(y.key)||ah(i,y))&&(u=u.insert(y.key,y.mutableCopy()))}return ne.resolve(u)}getAllFromCollectionGroup(e,i,r,o){we(9500)}ni(e,i){return ne.forEach(this.docs,(r=>i(r)))}newChangeBuffer(e){return new m1(this)}getSize(e){return ne.resolve(this.size)}}class m1 extends s1{constructor(e){super(),this.Mr=e}applyChanges(e){const i=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?i.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(r)})),ne.waitFor(i)}getFromCache(e,i){return this.Mr.getEntry(e,i)}getAllFromCache(e,i){return this.Mr.getEntries(e,i)}}class _1{constructor(e){this.persistence=e,this.ri=new Fr((i=>pm(i)),gm),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.ii=0,this.si=new bm,this.targetCount=0,this.oi=to._r()}forEachTarget(e,i){return this.ri.forEach(((r,o)=>i(o))),ne.resolve()}getLastRemoteSnapshotVersion(e){return ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ne.resolve(this.highestTargetId)}setTargetsMetadata(e,i,r){return r&&(this.lastRemoteSnapshotVersion=r),i>this.ii&&(this.ii=i),ne.resolve()}lr(e){this.ri.set(e.target,e);const i=e.targetId;i>this.highestTargetId&&(this.oi=new to(i),this.highestTargetId=i),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,i){return this.lr(i),this.targetCount+=1,ne.resolve()}updateTargetData(e,i){return this.lr(i),ne.resolve()}removeTargetData(e,i){return this.ri.delete(i.target),this.si.Gr(i.targetId),this.targetCount-=1,ne.resolve()}removeTargets(e,i,r){let o=0;const u=[];return this.ri.forEach(((h,m)=>{m.sequenceNumber<=i&&r.get(m.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)})),ne.waitFor(u).next((()=>o))}getTargetCount(e){return ne.resolve(this.targetCount)}getTargetData(e,i){const r=this.ri.get(i)||null;return ne.resolve(r)}addMatchingKeys(e,i,r){return this.si.$r(i,r),ne.resolve()}removeMatchingKeys(e,i,r){this.si.Qr(i,r);const o=this.persistence.referenceDelegate,u=[];return o&&i.forEach((h=>{u.push(o.markPotentiallyOrphaned(e,h))})),ne.waitFor(u)}removeMatchingKeysForTargetId(e,i){return this.si.Gr(i),ne.resolve()}getMatchingKeysForTargetId(e,i){const r=this.si.jr(i);return ne.resolve(r)}containsKey(e,i){return ne.resolve(this.si.containsKey(i))}}class sE{constructor(e,i){this._i={},this.overlays={},this.ai=new eh(0),this.ui=!1,this.ui=!0,this.ci=new h1,this.referenceDelegate=e(this),this.li=new _1(this),this.indexManager=new JS,this.remoteDocumentCache=(function(o){return new d1(o)})((r=>this.referenceDelegate.hi(r))),this.serializer=new ZS(i),this.Pi=new u1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let i=this.overlays[e.toKey()];return i||(i=new c1,this.overlays[e.toKey()]=i),i}getMutationQueue(e,i){let r=this._i[e.toKey()];return r||(r=new f1(i,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,i,r){he("MemoryPersistence","Starting transaction:",e);const o=new p1(this.ai.next());return this.referenceDelegate.Ti(),r(o).next((u=>this.referenceDelegate.Ii(o).next((()=>u)))).toPromise().then((u=>(o.raiseOnCommittedEvent(),u)))}Ei(e,i){return ne.or(Object.values(this._i).map((r=>()=>r.containsKey(e,i))))}}class p1 extends BA{constructor(e){super(),this.currentSequenceNumber=e}}class Am{constructor(e){this.persistence=e,this.Ri=new bm,this.Ai=null}static Vi(e){return new Am(e)}get di(){if(this.Ai)return this.Ai;throw we(60996)}addReference(e,i,r){return this.Ri.addReference(r,i),this.di.delete(r.toString()),ne.resolve()}removeReference(e,i,r){return this.Ri.removeReference(r,i),this.di.add(r.toString()),ne.resolve()}markPotentiallyOrphaned(e,i){return this.di.add(i.toString()),ne.resolve()}removeTarget(e,i){this.Ri.Gr(i.targetId).forEach((o=>this.di.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,i.targetId).next((o=>{o.forEach((u=>this.di.add(u.toString())))})).next((()=>r.removeTargetData(e,i)))}Ti(){this.Ai=new Set}Ii(e){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ne.forEach(this.di,(r=>{const o=ge.fromPath(r);return this.mi(e,o).next((u=>{u||i.removeEntry(o,Ae.min())}))})).next((()=>(this.Ai=null,i.apply(e))))}updateLimboDocument(e,i){return this.mi(e,i).next((r=>{r?this.di.delete(i.toString()):this.di.add(i.toString())}))}hi(e){return 0}mi(e,i){return ne.or([()=>ne.resolve(this.Ri.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(e,i),()=>this.persistence.Ei(e,i)])}}class Kc{constructor(e,i){this.persistence=e,this.fi=new Fr((r=>YA(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=r1(this,i)}static Vi(e,i){return new Kc(e,i)}Ti(){}Ii(e){return ne.resolve()}forEachTarget(e,i){return this.persistence.getTargetCache().forEachTarget(e,i)}dr(e){const i=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>i.next((o=>r+o))))}pr(e){let i=0;return this.mr(e,(r=>{i++})).next((()=>i))}mr(e,i){return ne.forEach(this.fi,((r,o)=>this.wr(e,r,o).next((u=>u?ne.resolve():i(o)))))}removeTargets(e,i,r){return this.persistence.getTargetCache().removeTargets(e,i,r)}removeOrphanedDocuments(e,i){let r=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.ni(e,(h=>this.wr(e,h,i).next((m=>{m||(r++,u.removeEntry(h,Ae.min()))})))).next((()=>u.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,i){return this.fi.set(i,e.currentSequenceNumber),ne.resolve()}removeTarget(e,i){const r=i.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,i,r){return this.fi.set(r,e.currentSequenceNumber),ne.resolve()}removeReference(e,i,r){return this.fi.set(r,e.currentSequenceNumber),ne.resolve()}updateLimboDocument(e,i){return this.fi.set(i,e.currentSequenceNumber),ne.resolve()}hi(e){let i=e.key.toString().length;return e.isFoundDocument()&&(i+=Cc(e.data.value)),i}wr(e,i,r){return ne.or([()=>this.persistence.Ei(e,i),()=>this.persistence.getTargetCache().containsKey(e,i),()=>{const o=this.fi.get(i);return ne.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Sm{constructor(e,i,r,o){this.targetId=e,this.fromCache=i,this.Ts=r,this.Is=o}static Es(e,i){let r=Pe(),o=Pe();for(const u of i.docChanges)switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new Sm(e,i.fromCache,r,o)}}class g1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class y1{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return ab()?8:GA(nb())>0?6:4})()}initialize(e,i){this.fs=e,this.indexManager=i,this.Rs=!0}getDocumentsMatchingQuery(e,i,r,o){const u={result:null};return this.gs(e,i).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,i,o,r).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new g1;return this.ys(e,i,h).next((m=>{if(u.result=m,this.As)return this.ws(e,i,h,m.size)}))})).next((()=>u.result))}ws(e,i,r,o){return r.documentReadCount<this.Vs?(Us()<=qe.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",Bs(i),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ne.resolve()):(Us()<=qe.DEBUG&&he("QueryEngine","Query:",Bs(i),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ds*o?(Us()<=qe.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",Bs(i),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qi(i))):ne.resolve())}gs(e,i){if(iT(i))return ne.resolve(null);let r=qi(i);return this.indexManager.getIndexType(e,r).next((o=>o===0?null:(i.limit!==null&&o===1&&(i=jc(i,null,"F"),r=qi(i)),this.indexManager.getDocumentsMatchingTarget(e,r).next((u=>{const h=Pe(...u);return this.fs.getDocuments(e,h).next((m=>this.indexManager.getMinOffset(e,r).next((_=>{const p=this.bs(i,m);return this.Ss(i,p,h,_.readTime)?this.gs(e,jc(i,null,"F")):this.Ds(e,p,i,_)}))))})))))}ps(e,i,r,o){return iT(i)||o.isEqual(Ae.min())?ne.resolve(null):this.fs.getDocuments(e,r).next((u=>{const h=this.bs(i,u);return this.Ss(i,h,r,o)?ne.resolve(null):(Us()<=qe.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Bs(i)),this.Ds(e,h,i,xA(o,Ml)).next((m=>m)))}))}bs(e,i){let r=new jt(x0(e));return i.forEach(((o,u)=>{ah(e,u)&&(r=r.add(u))})),r}Ss(e,i,r,o){if(e.limit===null)return!1;if(r.size!==i.size)return!0;const u=e.limitType==="F"?i.last():i.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}ys(e,i,r){return Us()<=qe.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",Bs(i)),this.fs.getDocumentsMatchingQuery(e,i,nr.min(),r)}Ds(e,i,r,o){return this.fs.getDocumentsMatchingQuery(e,r,o).next((u=>(i.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const Rm="LocalStore",T1=3e8;class E1{constructor(e,i,r,o){this.persistence=e,this.Cs=i,this.serializer=o,this.vs=new Et(xe),this.Fs=new Fr((u=>pm(u)),gm),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new l1(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(i=>e.collect(i,this.vs)))}}function v1(t,e,i,r){return new E1(t,e,i,r)}async function oE(t,e){const i=Ie(t);return await i.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return i.mutationQueue.getAllMutationBatches(r).next((u=>(o=u,i.Os(e),i.mutationQueue.getAllMutationBatches(r)))).next((u=>{const h=[],m=[];let _=Pe();for(const p of o){h.push(p.batchId);for(const y of p.mutations)_=_.add(y.key)}for(const p of u){m.push(p.batchId);for(const y of p.mutations)_=_.add(y.key)}return i.localDocuments.getDocuments(r,_).next((p=>({Ns:p,removedBatchIds:h,addedBatchIds:m})))}))}))}function w1(t,e){const i=Ie(t);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const o=e.batch.keys(),u=i.xs.newChangeBuffer({trackRemovals:!0});return(function(m,_,p,y){const v=p.batch,w=v.keys();let S=ne.resolve();return w.forEach((x=>{S=S.next((()=>y.getEntry(_,x))).next((V=>{const H=p.docVersions.get(x);$e(H!==null,48541),V.version.compareTo(H)<0&&(v.applyToRemoteDocument(V,p),V.isValidDocument()&&(V.setReadTime(p.commitVersion),y.addEntry(V)))}))})),S.next((()=>m.mutationQueue.removeMutationBatch(_,v)))})(i,r,e,u).next((()=>u.apply(r))).next((()=>i.mutationQueue.performConsistencyCheck(r))).next((()=>i.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId))).next((()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(m){let _=Pe();for(let p=0;p<m.mutationResults.length;++p)m.mutationResults[p].transformResults.length>0&&(_=_.add(m.batch.mutations[p].key));return _})(e)))).next((()=>i.localDocuments.getDocuments(r,o)))}))}function lE(t){const e=Ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(i=>e.li.getLastRemoteSnapshotVersion(i)))}function b1(t,e){const i=Ie(t),r=e.snapshotVersion;let o=i.vs;return i.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=i.xs.newChangeBuffer({trackRemovals:!0});o=i.vs;const m=[];e.targetChanges.forEach(((y,v)=>{const w=o.get(v);if(!w)return;m.push(i.li.removeMatchingKeys(u,y.removedDocuments,v).next((()=>i.li.addMatchingKeys(u,y.addedDocuments,v))));let S=w.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(cn.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):y.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(y.resumeToken,r)),o=o.insert(v,S),(function(V,H,Q){return V.resumeToken.approximateByteSize()===0||H.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=T1?!0:Q.addedDocuments.size+Q.modifiedDocuments.size+Q.removedDocuments.size>0})(w,S,y)&&m.push(i.li.updateTargetData(u,S))}));let _=_a(),p=Pe();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&m.push(i.persistence.referenceDelegate.updateLimboDocument(u,y))})),m.push(A1(u,h,e.documentUpdates).next((y=>{_=y.Bs,p=y.Ls}))),!r.isEqual(Ae.min())){const y=i.li.getLastRemoteSnapshotVersion(u).next((v=>i.li.setTargetsMetadata(u,u.currentSequenceNumber,r)));m.push(y)}return ne.waitFor(m).next((()=>h.apply(u))).next((()=>i.localDocuments.getLocalViewOfDocuments(u,_,p))).next((()=>_))})).then((u=>(i.vs=o,u)))}function A1(t,e,i){let r=Pe(),o=Pe();return i.forEach((u=>r=r.add(u))),e.getEntries(t,r).next((u=>{let h=_a();return i.forEach(((m,_)=>{const p=u.get(m);_.isFoundDocument()!==p.isFoundDocument()&&(o=o.add(m)),_.isNoDocument()&&_.version.isEqual(Ae.min())?(e.removeEntry(m,_.readTime),h=h.insert(m,_)):!p.isValidDocument()||_.version.compareTo(p.version)>0||_.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(_),h=h.insert(m,_)):he(Rm,"Ignoring outdated watch update for ",m,". Current version:",p.version," Watch version:",_.version)})),{Bs:h,Ls:o}}))}function S1(t,e){const i=Ie(t);return i.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=dm),i.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function R1(t,e){const i=Ie(t);return i.persistence.runTransaction("Allocate target","readwrite",(r=>{let o;return i.li.getTargetData(r,e).next((u=>u?(o=u,ne.resolve(o)):i.li.allocateTargetId(r).next((h=>(o=new Qa(e,h,"TargetPurposeListen",r.currentSequenceNumber),i.li.addTargetData(r,o).next((()=>o)))))))})).then((r=>{const o=i.vs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(i.vs=i.vs.insert(r.targetId,r),i.Fs.set(e,r.targetId)),r}))}async function Jd(t,e,i){const r=Ie(t),o=r.vs.get(e),u=i?"readwrite":"readwrite-primary";try{i||await r.persistence.runTransaction("Release target",u,(h=>r.persistence.referenceDelegate.removeTarget(h,o)))}catch(h){if(!oo(h))throw h;he(Rm,`Failed to update sequence numbers for target ${e}: ${h}`)}r.vs=r.vs.remove(e),r.Fs.delete(o.target)}function pT(t,e,i){const r=Ie(t);let o=Ae.min(),u=Pe();return r.persistence.runTransaction("Execute query","readwrite",(h=>(function(_,p,y){const v=Ie(_),w=v.Fs.get(y);return w!==void 0?ne.resolve(v.vs.get(w)):v.li.getTargetData(p,y)})(r,h,qi(e)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(h,m.targetId).next((_=>{u=_}))})).next((()=>r.Cs.getDocumentsMatchingQuery(h,e,i?o:Ae.min(),i?u:Pe()))).next((m=>(I1(r,fS(e),m),{documents:m,ks:u})))))}function I1(t,e,i){let r=t.Ms.get(e)||Ae.min();i.forEach(((o,u)=>{u.readTime.compareTo(r)>0&&(r=u.readTime)})),t.Ms.set(e,r)}class gT{constructor(){this.activeTargetIds=yS()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class k1{constructor(){this.vo=new gT,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,i,r){}addLocalQueryTarget(e,i=!0){return i&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,i,r){this.Fo[e]=i}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new gT,Promise.resolve()}handleUserChange(e,i,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class O1{Mo(e){}shutdown(){}}const yT="ConnectivityMonitor";class TT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){he(yT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){he(yT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Ic=null;function em(){return Ic===null?Ic=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ic++,"0x"+Ic.toString(16)}const kd="RestConnection",D1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class N1{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=i+"://"+e.host,this.Uo=`projects/${r}/databases/${o}`,this.$o=this.databaseId.database===Gc?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Wo(e,i,r,o,u){const h=em(),m=this.Qo(e,i.toUriEncodedString());he(kd,`Sending RPC '${e}' ${h}:`,m,r);const _={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(_,o,u);const{host:p}=new URL(m),y=um(p);return this.zo(e,m,_,r,y).then((v=>(he(kd,`Received RPC '${e}' ${h}: `,v),v)),(v=>{throw qr(kd,`RPC '${e}' ${h} failed with error: `,v,"url: ",m,"request:",r),v}))}jo(e,i,r,o,u,h){return this.Wo(e,i,r,o,u)}Go(e,i,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ro})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,u)=>e[u]=o)),r&&r.headers.forEach(((o,u)=>e[u]=o))}Qo(e,i){const r=D1[e];let o=`${this.qo}/v1/${i}:${r}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class C1{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const fn="WebChannelConnection",Tl=(t,e,i)=>{t.listen(e,(r=>{try{i(r)}catch(o){setTimeout((()=>{throw o}),0)}}))};class js extends N1{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!js.c_){const e=f0();Tl(e,h0.STAT_EVENT,(i=>{i.stat===Gd.PROXY?he(fn,"STAT_EVENT: detected buffering proxy"):i.stat===Gd.NOPROXY&&he(fn,"STAT_EVENT: detected no buffering proxy")})),js.c_=!0}}zo(e,i,r,o,u){const h=em();return new Promise(((m,_)=>{const p=new u0;p.setWithCredentials(!0),p.listenOnce(c0.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Nc.NO_ERROR:const v=p.getResponseJson();he(fn,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(v)),m(v);break;case Nc.TIMEOUT:he(fn,`RPC '${e}' ${h} timed out`),_(new ue(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Nc.HTTP_ERROR:const w=p.getStatus();if(he(fn,`RPC '${e}' ${h} failed with status:`,w,"response text:",p.getResponseText()),w>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const x=S?.error;if(x&&x.status&&x.message){const V=(function(Q){const $=Q.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf($)>=0?$:ee.UNKNOWN})(x.status);_(new ue(V,x.message))}else _(new ue(ee.UNKNOWN,"Server responded with status "+p.getStatus()))}else _(new ue(ee.UNAVAILABLE,"Connection failed."));break;default:we(9055,{l_:e,streamId:h,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{he(fn,`RPC '${e}' ${h} completed.`)}}));const y=JSON.stringify(o);he(fn,`RPC '${e}' ${h} sending request:`,o),p.send(i,"POST",y,r,15)}))}T_(e,i,r){const o=em(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},_=this.longPollingOptions.timeoutSeconds;_!==void 0&&(m.longPollingTimeout=Math.round(1e3*_)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,i,r),m.encodeInitMessageHeaders=!0;const p=u.join("");he(fn,`Creating RPC '${e}' stream ${o}: ${p}`,m);const y=h.createWebChannel(p,m);this.I_(y);let v=!1,w=!1;const S=new C1({Ho:x=>{w?he(fn,`Not sending because RPC '${e}' stream ${o} is closed:`,x):(v||(he(fn,`Opening RPC '${e}' stream ${o} transport.`),y.open(),v=!0),he(fn,`RPC '${e}' stream ${o} sending:`,x),y.send(x))},Jo:()=>y.close()});return Tl(y,El.EventType.OPEN,(()=>{w||(he(fn,`RPC '${e}' stream ${o} transport opened.`),S.i_())})),Tl(y,El.EventType.CLOSE,(()=>{w||(w=!0,he(fn,`RPC '${e}' stream ${o} transport closed`),S.o_(),this.E_(y))})),Tl(y,El.EventType.ERROR,(x=>{w||(w=!0,qr(fn,`RPC '${e}' stream ${o} transport errored. Name:`,x.name,"Message:",x.message),S.o_(new ue(ee.UNAVAILABLE,"The operation could not be completed")))})),Tl(y,El.EventType.MESSAGE,(x=>{if(!w){const V=x.data[0];$e(!!V,16349);const H=V,Q=H?.error||H[0]?.error;if(Q){he(fn,`RPC '${e}' stream ${o} received error:`,Q);const $=Q.status;let le=(function(ze){const O=Pt[ze];if(O!==void 0)return X0(O)})($),ce=Q.message;$==="NOT_FOUND"&&ce.includes("database")&&ce.includes("does not exist")&&ce.includes(this.databaseId.database)&&qr(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),le===void 0&&(le=ee.INTERNAL,ce="Unknown error status: "+$+" with message "+Q.message),w=!0,S.o_(new ue(le,ce)),y.close()}else he(fn,`RPC '${e}' stream ${o} received:`,V),S.__(V)}})),js.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((i=>i===e))}Go(e,i,r){super.Go(e,i,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return d0()}}function M1(t){return new js(t)}function Od(){return typeof document<"u"?document:null}function lh(t){return new xS(t,!0)}js.c_=!1;class uE{constructor(e,i,r=1e3,o=1.5,u=6e4){this.Ci=e,this.timerId=i,this.R_=r,this.A_=o,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const i=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,i-r);o>0&&he("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${i} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const ET="PersistentStream";class cE{constructor(e,i,r,o,u,h,m,_){this.Ci=e,this.b_=r,this.S_=o,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=m,this.listener=_,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new uE(e,i)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,i){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():i&&i.code===ee.RESOURCE_EXHAUSTED?(ma(i.toString()),ma("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):i&&i.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(i)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),i=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===i&&this.G_(r,o)}),(r=>{e((()=>{const o=new ue(ee.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(e,i){const r=this.Q_(this.D_);this.stream=this.j_(e,i),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return he(ET,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return i=>{this.Ci.enqueueAndForget((()=>this.D_===e?i():(he(ET,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class V1 extends cE{constructor(e,i,r,o,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,r,o,h),this.serializer=u}j_(e,i){return this.connection.T_("Listen",e,i)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const i=US(this.serializer,e),r=(function(u){if(!("targetChange"in u))return Ae.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?Ae.min():h.readTime?ji(h.readTime):Ae.min()})(e);return this.listener.J_(i,r)}Z_(e){const i={};i.database=$d(this.serializer),i.addTarget=(function(u,h){let m;const _=h.target;if(m=Wd(_)?{documents:qS(u,_)}:{query:YS(u,_).ft},m.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){m.resumeToken=Z0(u,h.resumeToken);const p=Kd(u,h.expectedCount);p!==null&&(m.expectedCount=p)}else if(h.snapshotVersion.compareTo(Ae.min())>0){m.readTime=Xc(u,h.snapshotVersion.toTimestamp());const p=Kd(u,h.expectedCount);p!==null&&(m.expectedCount=p)}return m})(this.serializer,e);const r=FS(this.serializer,e);r&&(i.labels=r),this.K_(i)}X_(e){const i={};i.database=$d(this.serializer),i.removeTarget=e,this.K_(i)}}class L1 extends cE{constructor(e,i,r,o,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,r,o,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,i){return this.connection.T_("Write",e,i)}H_(e){return $e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const i=GS(e.writeResults,e.commitTime),r=ji(e.commitTime);return this.listener.na(r,i)}ra(){const e={};e.database=$d(this.serializer),this.K_(e)}ea(e){const i={streamToken:this.lastStreamToken,writes:e.map((r=>BS(this.serializer,r)))};this.K_(i)}}class H1{}class x1 extends H1{constructor(e,i,r,o){super(),this.authCredentials=e,this.appCheckCredentials=i,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new ue(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,Qd(i,r),o,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ue(ee.UNKNOWN,u.toString())}))}jo(e,i,r,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,m])=>this.connection.jo(e,Qd(i,r),o,h,m,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new ue(ee.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function P1(t,e,i,r){return new x1(t,e,i,r)}class z1{constructor(e,i){this.asyncQueue=e,this.onlineStateHandler=i,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const i=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ma(i),this.aa=!1):he("OnlineStateTracker",i)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Yr="RemoteStore";class U1{constructor(e,i,r,o,u){this.localStore=e,this.datastore=i,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{r.enqueueAndForget((async()=>{Xr(this)&&(he(Yr,"Restarting streams for network reachability change."),await(async function(_){const p=Ie(_);p.Ea.add(4),await Fl(p),p.Va.set("Unknown"),p.Ea.delete(4),await uh(p)})(this))}))})),this.Va=new z1(r,o)}}async function uh(t){if(Xr(t))for(const e of t.Ra)await e(!0)}async function Fl(t){for(const e of t.Ra)await e(!1)}function hE(t,e){const i=Ie(t);i.Ia.has(e.targetId)||(i.Ia.set(e.targetId,e),Dm(i)?Om(i):uo(i).O_()&&km(i,e))}function Im(t,e){const i=Ie(t),r=uo(i);i.Ia.delete(e),r.O_()&&fE(i,e),i.Ia.size===0&&(r.O_()?r.L_():Xr(i)&&i.Va.set("Unknown"))}function km(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const i=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(i)}uo(t).Z_(e)}function fE(t,e){t.da.$e(e),uo(t).X_(e)}function Om(t){t.da=new MS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),uo(t).start(),t.Va.ua()}function Dm(t){return Xr(t)&&!uo(t).x_()&&t.Ia.size>0}function Xr(t){return Ie(t).Ea.size===0}function dE(t){t.da=void 0}async function B1(t){t.Va.set("Online")}async function G1(t){t.Ia.forEach(((e,i)=>{km(t,e)}))}async function q1(t,e){dE(t),Dm(t)?(t.Va.ha(e),Om(t)):t.Va.set("Unknown")}async function Y1(t,e,i){if(t.Va.set("Online"),e instanceof Q0&&e.state===2&&e.cause)try{await(async function(o,u){const h=u.cause;for(const m of u.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,h),o.Ia.delete(m),o.da.removeTarget(m))})(t,e)}catch(r){he(Yr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qc(t,r)}else if(e instanceof Lc?t.da.Xe(e):e instanceof K0?t.da.st(e):t.da.tt(e),!i.isEqual(Ae.min()))try{const r=await lE(t.localStore);i.compareTo(r)>=0&&await(function(u,h){const m=u.da.Tt(h);return m.targetChanges.forEach(((_,p)=>{if(_.resumeToken.approximateByteSize()>0){const y=u.Ia.get(p);y&&u.Ia.set(p,y.withResumeToken(_.resumeToken,h))}})),m.targetMismatches.forEach(((_,p)=>{const y=u.Ia.get(_);if(!y)return;u.Ia.set(_,y.withResumeToken(cn.EMPTY_BYTE_STRING,y.snapshotVersion)),fE(u,_);const v=new Qa(y.target,_,p,y.sequenceNumber);km(u,v)})),u.remoteSyncer.applyRemoteEvent(m)})(t,i)}catch(r){he(Yr,"Failed to raise snapshot:",r),await Qc(t,r)}}async function Qc(t,e,i){if(!oo(e))throw e;t.Ea.add(1),await Fl(t),t.Va.set("Offline"),i||(i=()=>lE(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{he(Yr,"Retrying IndexedDB access"),await i(),t.Ea.delete(1),await uh(t)}))}function mE(t,e){return e().catch((i=>Qc(t,i,e)))}async function ch(t){const e=Ie(t),i=sr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:dm;for(;j1(e);)try{const o=await S1(e.localStore,r);if(o===null){e.Ta.length===0&&i.L_();break}r=o.batchId,F1(e,o)}catch(o){await Qc(e,o)}_E(e)&&pE(e)}function j1(t){return Xr(t)&&t.Ta.length<10}function F1(t,e){t.Ta.push(e);const i=sr(t);i.O_()&&i.Y_&&i.ea(e.mutations)}function _E(t){return Xr(t)&&!sr(t).x_()&&t.Ta.length>0}function pE(t){sr(t).start()}async function W1(t){sr(t).ra()}async function X1(t){const e=sr(t);for(const i of t.Ta)e.ea(i.mutations)}async function K1(t,e,i){const r=t.Ta.shift(),o=Em.from(r,e,i);await mE(t,(()=>t.remoteSyncer.applySuccessfulWrite(o))),await ch(t)}async function Q1(t,e){e&&sr(t).Y_&&await(async function(r,o){if((function(h){return DS(h)&&h!==ee.ABORTED})(o.code)){const u=r.Ta.shift();sr(r).B_(),await mE(r,(()=>r.remoteSyncer.rejectFailedWrite(u.batchId,o))),await ch(r)}})(t,e),_E(t)&&pE(t)}async function vT(t,e){const i=Ie(t);i.asyncQueue.verifyOperationInProgress(),he(Yr,"RemoteStore received new credentials");const r=Xr(i);i.Ea.add(3),await Fl(i),r&&i.Va.set("Unknown"),await i.remoteSyncer.handleCredentialChange(e),i.Ea.delete(3),await uh(i)}async function Z1(t,e){const i=Ie(t);e?(i.Ea.delete(2),await uh(i)):e||(i.Ea.add(2),await Fl(i),i.Va.set("Unknown"))}function uo(t){return t.ma||(t.ma=(function(i,r,o){const u=Ie(i);return u.sa(),new V1(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(t.datastore,t.asyncQueue,{Zo:B1.bind(null,t),Yo:G1.bind(null,t),t_:q1.bind(null,t),J_:Y1.bind(null,t)}),t.Ra.push((async e=>{e?(t.ma.B_(),Dm(t)?Om(t):t.Va.set("Unknown")):(await t.ma.stop(),dE(t))}))),t.ma}function sr(t){return t.fa||(t.fa=(function(i,r,o){const u=Ie(i);return u.sa(),new L1(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:W1.bind(null,t),t_:Q1.bind(null,t),ta:X1.bind(null,t),na:K1.bind(null,t)}),t.Ra.push((async e=>{e?(t.fa.B_(),await ch(t)):(await t.fa.stop(),t.Ta.length>0&&(he(Yr,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Nm{constructor(e,i,r,o,u){this.asyncQueue=e,this.timerId=i,this.targetTimeMs=r,this.op=o,this.removalCallback=u,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,i,r,o,u){const h=Date.now()+r,m=new Nm(e,i,h,o,u);return m.start(r),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cm(t,e){if(ma("AsyncQueue",`${e}: ${t}`),oo(t))return new ue(ee.UNAVAILABLE,`${e}: ${t}`);throw t}class Fs{static emptySet(e){return new Fs(e.comparator)}constructor(e){this.comparator=e?(i,r)=>e(i,r)||ge.comparator(i.key,r.key):(i,r)=>ge.comparator(i.key,r.key),this.keyedMap=vl(),this.sortedSet=new Et(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const i=this.keyedMap.get(e);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((i,r)=>(e(i),!1)))}add(e){const i=this.delete(e.key);return i.copy(i.keyedMap.insert(e.key,e),i.sortedSet.insert(e,null))}delete(e){const i=this.get(e);return i?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(i)):this}isEqual(e){if(!(e instanceof Fs)||this.size!==e.size)return!1;const i=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;i.hasNext();){const o=i.getNext().key,u=r.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((i=>{e.push(i.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,i){const r=new Fs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=i,r}}class wT{constructor(){this.ga=new Et(ge.comparator)}track(e){const i=e.doc.key,r=this.ga.get(i);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(i,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(i,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(i,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(i,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(i):e.type===1&&r.type===2?this.ga=this.ga.insert(i,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(i,{type:2,doc:e.doc}):we(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(i,e)}ya(){const e=[];return this.ga.inorderTraversal(((i,r)=>{e.push(r)})),e}}class no{constructor(e,i,r,o,u,h,m,_,p){this.query=e,this.docs=i,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=m,this.excludesMetadataChanges=_,this.hasCachedResults=p}static fromInitialDocuments(e,i,r,o,u){const h=[];return i.forEach((m=>{h.push({type:0,doc:m})})),new no(e,i,Fs.emptySet(i),h,r,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ih(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const i=this.docChanges,r=e.docChanges;if(i.length!==r.length)return!1;for(let o=0;o<i.length;o++)if(i[o].type!==r[o].type||!i[o].doc.isEqual(r[o].doc))return!1;return!0}}class $1{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class J1{constructor(){this.queries=bT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(i,r){const o=Ie(i),u=o.queries;o.queries=bT(),u.forEach(((h,m)=>{for(const _ of m.ba)_.onError(r)}))})(this,new ue(ee.ABORTED,"Firestore shutting down"))}}function bT(){return new Fr((t=>H0(t)),ih)}async function eR(t,e){const i=Ie(t);let r=3;const o=e.query;let u=i.queries.get(o);u?!u.Sa()&&e.Da()&&(r=2):(u=new $1,r=e.Da()?0:1);try{switch(r){case 0:u.wa=await i.onListen(o,!0);break;case 1:u.wa=await i.onListen(o,!1);break;case 2:await i.onFirstRemoteStoreListen(o)}}catch(h){const m=Cm(h,`Initialization of query '${Bs(e.query)}' failed`);return void e.onError(m)}i.queries.set(o,u),u.ba.push(e),e.va(i.onlineState),u.wa&&e.Fa(u.wa)&&Mm(i)}async function tR(t,e){const i=Ie(t),r=e.query;let o=3;const u=i.queries.get(r);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?o=e.Da()?0:1:!u.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return i.queries.delete(r),i.onUnlisten(r,!0);case 1:return i.queries.delete(r),i.onUnlisten(r,!1);case 2:return i.onLastRemoteStoreUnlisten(r);default:return}}function nR(t,e){const i=Ie(t);let r=!1;for(const o of e){const u=o.query,h=i.queries.get(u);if(h){for(const m of h.ba)m.Fa(o)&&(r=!0);h.wa=o}}r&&Mm(i)}function iR(t,e,i){const r=Ie(t),o=r.queries.get(e);if(o)for(const u of o.ba)u.onError(i);r.queries.delete(e)}function Mm(t){t.Ca.forEach((e=>{e.next()}))}var tm,AT;(AT=tm||(tm={})).Ma="default",AT.Cache="cache";class aR{constructor(e,i,r){this.query=e,this.xa=i,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new no(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let i=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),i=!0):this.La(e,this.onlineState)&&(this.ka(e),i=!0),this.Na=e,i}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let i=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),i=!0),i}La(e,i){if(!e.fromCache||!this.Da())return!0;const r=i!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||i==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const i=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!i)&&this.options.includeMetadataChanges===!0}ka(e){e=no.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tm.Cache}}class gE{constructor(e){this.key=e}}class yE{constructor(e){this.key=e}}class rR{constructor(e,i){this.query=e,this.Za=i,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Pe(),this.mutatedKeys=Pe(),this.eu=x0(e),this.tu=new Fs(this.eu)}get nu(){return this.Za}ru(e,i){const r=i?i.iu:new wT,o=i?i.tu:this.tu;let u=i?i.mutatedKeys:this.mutatedKeys,h=o,m=!1;const _=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,p=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((y,v)=>{const w=o.get(y),S=ah(this.query,v)?v:null,x=!!w&&this.mutatedKeys.has(w.key),V=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let H=!1;w&&S?w.data.isEqual(S.data)?x!==V&&(r.track({type:3,doc:S}),H=!0):this.su(w,S)||(r.track({type:2,doc:S}),H=!0,(_&&this.eu(S,_)>0||p&&this.eu(S,p)<0)&&(m=!0)):!w&&S?(r.track({type:0,doc:S}),H=!0):w&&!S&&(r.track({type:1,doc:w}),H=!0,(_||p)&&(m=!0)),H&&(S?(h=h.add(S),u=V?u.add(y):u.delete(y)):(h=h.delete(y),u=u.delete(y)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const y=this.query.limitType==="F"?h.last():h.first();h=h.delete(y.key),u=u.delete(y.key),r.track({type:1,doc:y})}return{tu:h,iu:r,Ss:m,mutatedKeys:u}}su(e,i){return e.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(e,i,r,o){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((y,v)=>(function(S,x){const V=H=>{switch(H){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we(20277,{Vt:H})}};return V(S)-V(x)})(y.type,v.type)||this.eu(y.doc,v.doc))),this.ou(r),o=o??!1;const m=i&&!o?this._u():[],_=this.Ya.size===0&&this.current&&!o?1:0,p=_!==this.Xa;return this.Xa=_,h.length!==0||p?{snapshot:new no(this.query,e.tu,u,h,e.mutatedKeys,_===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new wT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((i=>this.Za=this.Za.add(i))),e.modifiedDocuments.forEach((i=>{})),e.removedDocuments.forEach((i=>this.Za=this.Za.delete(i))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Pe(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const i=[];return e.forEach((r=>{this.Ya.has(r)||i.push(new yE(r))})),this.Ya.forEach((r=>{e.has(r)||i.push(new gE(r))})),i}cu(e){this.Za=e.ks,this.Ya=Pe();const i=this.ru(e.documents);return this.applyChanges(i,!0)}lu(){return no.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Vm="SyncEngine";class sR{constructor(e,i,r){this.query=e,this.targetId=i,this.view=r}}class oR{constructor(e){this.key=e,this.hu=!1}}class lR{constructor(e,i,r,o,u,h){this.localStore=e,this.remoteStore=i,this.eventManager=r,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Fr((m=>H0(m)),ih),this.Iu=new Map,this.Eu=new Set,this.Ru=new Et(ge.comparator),this.Au=new Map,this.Vu=new bm,this.du={},this.mu=new Map,this.fu=to.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function uR(t,e,i=!0){const r=AE(t);let o;const u=r.Tu.get(e);return u?(r.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.lu()):o=await TE(r,e,i,!0),o}async function cR(t,e){const i=AE(t);await TE(i,e,!0,!1)}async function TE(t,e,i,r){const o=await R1(t.localStore,qi(e)),u=o.targetId,h=t.sharedClientState.addLocalQueryTarget(u,i);let m;return r&&(m=await hR(t,e,u,h==="current",o.resumeToken)),t.isPrimaryClient&&i&&hE(t.remoteStore,o),m}async function hR(t,e,i,r,o){t.pu=(v,w,S)=>(async function(V,H,Q,$){let le=H.view.ru(Q);le.Ss&&(le=await pT(V.localStore,H.query,!1).then((({documents:O})=>H.view.ru(O,le))));const ce=$&&$.targetChanges.get(H.targetId),ot=$&&$.targetMismatches.get(H.targetId)!=null,ze=H.view.applyChanges(le,V.isPrimaryClient,ce,ot);return RT(V,H.targetId,ze.au),ze.snapshot})(t,v,w,S);const u=await pT(t.localStore,e,!0),h=new rR(e,u.ks),m=h.ru(u.documents),_=jl.createSynthesizedTargetChangeForCurrentChange(i,r&&t.onlineState!=="Offline",o),p=h.applyChanges(m,t.isPrimaryClient,_);RT(t,i,p.au);const y=new sR(e,i,h);return t.Tu.set(e,y),t.Iu.has(i)?t.Iu.get(i).push(e):t.Iu.set(i,[e]),p.snapshot}async function fR(t,e,i){const r=Ie(t),o=r.Tu.get(e),u=r.Iu.get(o.targetId);if(u.length>1)return r.Iu.set(o.targetId,u.filter((h=>!ih(h,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await Jd(r.localStore,o.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(o.targetId),i&&Im(r.remoteStore,o.targetId),nm(r,o.targetId)})).catch(so)):(nm(r,o.targetId),await Jd(r.localStore,o.targetId,!0))}async function dR(t,e){const i=Ie(t),r=i.Tu.get(e),o=i.Iu.get(r.targetId);i.isPrimaryClient&&o.length===1&&(i.sharedClientState.removeLocalQueryTarget(r.targetId),Im(i.remoteStore,r.targetId))}async function mR(t,e,i){const r=vR(t);try{const o=await(function(h,m){const _=Ie(h),p=mt.now(),y=m.reduce(((S,x)=>S.add(x.key)),Pe());let v,w;return _.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let x=_a(),V=Pe();return _.xs.getEntries(S,y).next((H=>{x=H,x.forEach(((Q,$)=>{$.isValidDocument()||(V=V.add(Q))}))})).next((()=>_.localDocuments.getOverlayedDocuments(S,x))).next((H=>{v=H;const Q=[];for(const $ of m){const le=SS($,v.get($.key).overlayedDocument);le!=null&&Q.push(new Wr($.key,le,I0(le.value.mapValue),Yi.exists(!0)))}return _.mutationQueue.addMutationBatch(S,p,Q,m)})).next((H=>{w=H;const Q=H.applyToLocalDocumentSet(v,V);return _.documentOverlayCache.saveOverlays(S,H.batchId,Q)}))})).then((()=>({batchId:w.batchId,changes:z0(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),(function(h,m,_){let p=h.du[h.currentUser.toKey()];p||(p=new Et(xe)),p=p.insert(m,_),h.du[h.currentUser.toKey()]=p})(r,o.batchId,i),await Wl(r,o.changes),await ch(r.remoteStore)}catch(o){const u=Cm(o,"Failed to persist write");i.reject(u)}}async function EE(t,e){const i=Ie(t);try{const r=await b1(i.localStore,e);e.targetChanges.forEach(((o,u)=>{const h=i.Au.get(u);h&&($e(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?h.hu=!0:o.modifiedDocuments.size>0?$e(h.hu,14607):o.removedDocuments.size>0&&($e(h.hu,42227),h.hu=!1))})),await Wl(i,r,e)}catch(r){await so(r)}}function ST(t,e,i){const r=Ie(t);if(r.isPrimaryClient&&i===0||!r.isPrimaryClient&&i===1){const o=[];r.Tu.forEach(((u,h)=>{const m=h.view.va(e);m.snapshot&&o.push(m.snapshot)})),(function(h,m){const _=Ie(h);_.onlineState=m;let p=!1;_.queries.forEach(((y,v)=>{for(const w of v.ba)w.va(m)&&(p=!0)})),p&&Mm(_)})(r.eventManager,e),o.length&&r.Pu.J_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function _R(t,e,i){const r=Ie(t);r.sharedClientState.updateQueryState(e,"rejected",i);const o=r.Au.get(e),u=o&&o.key;if(u){let h=new Et(ge.comparator);h=h.insert(u,mn.newNoDocument(u,Ae.min()));const m=Pe().add(u),_=new oh(Ae.min(),new Map,new Et(xe),h,m);await EE(r,_),r.Ru=r.Ru.remove(u),r.Au.delete(e),Lm(r)}else await Jd(r.localStore,e,!1).then((()=>nm(r,e,i))).catch(so)}async function pR(t,e){const i=Ie(t),r=e.batch.batchId;try{const o=await w1(i.localStore,e);wE(i,r,null),vE(i,r),i.sharedClientState.updateMutationState(r,"acknowledged"),await Wl(i,o)}catch(o){await so(o)}}async function gR(t,e,i){const r=Ie(t);try{const o=await(function(h,m){const _=Ie(h);return _.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let y;return _.mutationQueue.lookupMutationBatch(p,m).next((v=>($e(v!==null,37113),y=v.keys(),_.mutationQueue.removeMutationBatch(p,v)))).next((()=>_.mutationQueue.performConsistencyCheck(p))).next((()=>_.documentOverlayCache.removeOverlaysForBatchId(p,y,m))).next((()=>_.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y))).next((()=>_.localDocuments.getDocuments(p,y)))}))})(r.localStore,e);wE(r,e,i),vE(r,e),r.sharedClientState.updateMutationState(e,"rejected",i),await Wl(r,o)}catch(o){await so(o)}}function vE(t,e){(t.mu.get(e)||[]).forEach((i=>{i.resolve()})),t.mu.delete(e)}function wE(t,e,i){const r=Ie(t);let o=r.du[r.currentUser.toKey()];if(o){const u=o.get(e);u&&(i?u.reject(i):u.resolve(),o=o.remove(e)),r.du[r.currentUser.toKey()]=o}}function nm(t,e,i=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),i&&t.Pu.yu(r,i);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach((r=>{t.Vu.containsKey(r)||bE(t,r)}))}function bE(t,e){t.Eu.delete(e.path.canonicalString());const i=t.Ru.get(e);i!==null&&(Im(t.remoteStore,i),t.Ru=t.Ru.remove(e),t.Au.delete(i),Lm(t))}function RT(t,e,i){for(const r of i)r instanceof gE?(t.Vu.addReference(r.key,e),yR(t,r)):r instanceof yE?(he(Vm,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||bE(t,r.key)):we(19791,{wu:r})}function yR(t,e){const i=e.key,r=i.path.canonicalString();t.Ru.get(i)||t.Eu.has(r)||(he(Vm,"New document in limbo: "+i),t.Eu.add(r),Lm(t))}function Lm(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const i=new ge(ct.fromString(e)),r=t.fu.next();t.Au.set(r,new oR(i)),t.Ru=t.Ru.insert(i,r),hE(t.remoteStore,new Qa(qi(V0(i.path)),r,"TargetPurposeLimboResolution",eh.ce))}}async function Wl(t,e,i){const r=Ie(t),o=[],u=[],h=[];r.Tu.isEmpty()||(r.Tu.forEach(((m,_)=>{h.push(r.pu(_,e,i).then((p=>{if((p||i)&&r.isPrimaryClient){const y=p?!p.fromCache:i?.targetChanges.get(_.targetId)?.current;r.sharedClientState.updateQueryState(_.targetId,y?"current":"not-current")}if(p){o.push(p);const y=Sm.Es(_.targetId,p);u.push(y)}})))})),await Promise.all(h),r.Pu.J_(o),await(async function(_,p){const y=Ie(_);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ne.forEach(p,(w=>ne.forEach(w.Ts,(S=>y.persistence.referenceDelegate.addReference(v,w.targetId,S))).next((()=>ne.forEach(w.Is,(S=>y.persistence.referenceDelegate.removeReference(v,w.targetId,S)))))))))}catch(v){if(!oo(v))throw v;he(Rm,"Failed to update sequence numbers: "+v)}for(const v of p){const w=v.targetId;if(!v.fromCache){const S=y.vs.get(w),x=S.snapshotVersion,V=S.withLastLimboFreeSnapshotVersion(x);y.vs=y.vs.insert(w,V)}}})(r.localStore,u))}async function TR(t,e){const i=Ie(t);if(!i.currentUser.isEqual(e)){he(Vm,"User change. New user:",e.toKey());const r=await oE(i.localStore,e);i.currentUser=e,(function(u,h){u.mu.forEach((m=>{m.forEach((_=>{_.reject(new ue(ee.CANCELLED,h))}))})),u.mu.clear()})(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Wl(i,r.Ns)}}function ER(t,e){const i=Ie(t),r=i.Au.get(e);if(r&&r.hu)return Pe().add(r.key);{let o=Pe();const u=i.Iu.get(e);if(!u)return o;for(const h of u){const m=i.Tu.get(h);o=o.unionWith(m.view.nu)}return o}}function AE(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=EE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ER.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_R.bind(null,e),e.Pu.J_=nR.bind(null,e.eventManager),e.Pu.yu=iR.bind(null,e.eventManager),e}function vR(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=pR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gR.bind(null,e),e}class Zc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,i){return null}Mu(e,i){return null}vu(e){return v1(this.persistence,new y1,e.initialUser,this.serializer)}Cu(e){return new sE(Am.Vi,this.serializer)}Du(e){return new k1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zc.provider={build:()=>new Zc};class wR extends Zc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,i){$e(this.persistence.referenceDelegate instanceof Kc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new i1(r,e.asyncQueue,i)}Cu(e){const i=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new sE((r=>Kc.Vi(r,i)),this.serializer)}}class im{async initialize(e,i){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ST(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=TR.bind(null,this.syncEngine),await Z1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new J1})()}createDatastore(e){const i=lh(e.databaseInfo.databaseId),r=M1(e.databaseInfo);return P1(e.authCredentials,e.appCheckCredentials,r,i)}createRemoteStore(e){return(function(r,o,u,h,m){return new U1(r,o,u,h,m)})(this.localStore,this.datastore,e.asyncQueue,(i=>ST(this.syncEngine,i,0)),(function(){return TT.v()?new TT:new O1})())}createSyncEngine(e,i){return(function(o,u,h,m,_,p,y){const v=new lR(o,u,h,m,_,p);return y&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){const r=Ie(i);he(Yr,"RemoteStore shutting down."),r.Ea.add(5),await Fl(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}im.provider={build:()=>new im};class bR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ma("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,i){setTimeout((()=>{this.muted||e(i)}),0)}}const or="FirestoreClient";class AR{constructor(e,i,r,o,u){this.authCredentials=e,this.appCheckCredentials=i,this.asyncQueue=r,this._databaseInfo=o,this.user=dn.UNAUTHENTICATED,this.clientId=fm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(r,(async h=>{he(or,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(r,(h=>(he(or,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(i){const r=Cm(i,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Dd(t,e){t.asyncQueue.verifyOperationInProgress(),he(or,"Initializing OfflineComponentProvider");const i=t.configuration;await e.initialize(i);let r=i.initialUser;t.setCredentialChangeListener((async o=>{r.isEqual(o)||(await oE(e.localStore,o),r=o)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function IT(t,e){t.asyncQueue.verifyOperationInProgress();const i=await SR(t);he(or,"Initializing OnlineComponentProvider"),await e.initialize(i,t.configuration),t.setCredentialChangeListener((r=>vT(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,o)=>vT(e.remoteStore,o))),t._onlineComponents=e}async function SR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){he(or,"Using user provided OfflineComponentProvider");try{await Dd(t,t._uninitializedComponentsProvider._offline)}catch(e){const i=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ee.FAILED_PRECONDITION||o.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(i))throw i;qr("Error using user provided cache. Falling back to memory cache: "+i),await Dd(t,new Zc)}}else he(or,"Using default OfflineComponentProvider"),await Dd(t,new wR(void 0));return t._offlineComponents}async function SE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(he(or,"Using user provided OnlineComponentProvider"),await IT(t,t._uninitializedComponentsProvider._online)):(he(or,"Using default OnlineComponentProvider"),await IT(t,new im))),t._onlineComponents}function RR(t){return SE(t).then((e=>e.syncEngine))}async function IR(t){const e=await SE(t),i=e.eventManager;return i.onListen=uR.bind(null,e.syncEngine),i.onUnlisten=fR.bind(null,e.syncEngine),i.onFirstRemoteStoreListen=cR.bind(null,e.syncEngine),i.onLastRemoteStoreUnlisten=dR.bind(null,e.syncEngine),i}function kR(t,e,i={}){const r=new er;return t.asyncQueue.enqueueAndForget((async()=>(function(u,h,m,_,p){const y=new bR({next:w=>{y.Nu(),h.enqueueAndForget((()=>tR(u,v))),w.fromCache&&_.source==="server"?p.reject(new ue(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(w)},error:w=>p.reject(w)}),v=new aR(m,y,{includeMetadataChanges:!0,Ka:!0});return eR(u,v)})(await IR(t),t.asyncQueue,e,i,r))),r.promise}function OR(t,e){const i=new er;return t.asyncQueue.enqueueAndForget((async()=>mR(await RR(t),e,i))),i.promise}function RE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const DR="ComponentProvider",kT=new Map;function NR(t,e,i,r,o){return new WA(t,e,i,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,RE(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,r)}const IE="firestore.googleapis.com",OT=!0;class DT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ue(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=IE,this.ssl=OT}else this.host=e.host,this.ssl=e.ssl??OT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<t1)throw new ue(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}LA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RE(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ue(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ue(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ue(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hh{constructor(e,i,r,o){this._authCredentials=e,this._appCheckCredentials=i,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new DT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new DT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new SA;switch(r.type){case"firstParty":return new OA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(i){const r=kT.get(i);r&&(he(DR,"Removing Datastore"),kT.delete(i),r.terminate())})(this),Promise.resolve()}}function CR(t,e,i,r={}){t=Cl(t,hh);const o=um(e),u=t._getSettings(),h={...u,emulatorOptions:t._getEmulatorOptions()},m=`${e}:${i}`;o&&(Zw(`https://${m}`),tb("Firestore",!0)),u.host!==IE&&u.host!==m&&qr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const _={...u,host:m,ssl:o,emulatorOptions:r};if(!Pc(_,h)&&(t._setSettings(_),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=dn.MOCK_USER;else{p=$w(r.mockUserToken,t._app?.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new ue(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new dn(v)}t._authCredentials=new RA(new _0(p,y))}}class lr{constructor(e,i,r){this.converter=i,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lr(this.firestore,e,this._query)}}class Qt{constructor(e,i,r){this.converter=i,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}toJSON(){return{type:Qt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,i,r){if(ql(i,Qt._jsonSchema))return new Qt(e,r||null,new ge(ct.fromString(i.referencePath)))}}Qt._jsonSchemaVersion="firestore/documentReference/1.0",Qt._jsonSchema={type:Ut("string",Qt._jsonSchemaVersion),referencePath:Ut("string")};class tr extends lr{constructor(e,i,r){super(e,i,V0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new ge(e))}withConverter(e){return new tr(this.firestore,e,this._path)}}function co(t,e,...i){if(t=Zs(t),p0("collection","path",e),t instanceof hh){const r=ct.fromString(e,...i);return qy(r),new tr(t,null,r)}{if(!(t instanceof Qt||t instanceof tr))throw new ue(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ct.fromString(e,...i));return qy(r),new tr(t.firestore,null,r)}}function MR(t,e,...i){if(t=Zs(t),arguments.length===1&&(e=fm.newId()),p0("doc","path",e),t instanceof hh){const r=ct.fromString(e,...i);return Gy(r),new Qt(t,null,new ge(r))}{if(!(t instanceof Qt||t instanceof tr))throw new ue(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ct.fromString(e,...i));return Gy(r),new Qt(t.firestore,t instanceof tr?t.converter:null,new ge(r))}}const NT="AsyncQueue";class CT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new uE(this,"async_queue_retry"),this._c=()=>{const r=Od();r&&he(NT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const i=Od();i&&typeof i.addEventListener=="function"&&i.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const i=Od();i&&typeof i.removeEventListener=="function"&&i.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const i=new er;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(i.resolve,i.reject),i.promise))).then((()=>i.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!oo(e))throw e;he(NT,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const i=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ma("INTERNAL UNHANDLED ERROR: ",MT(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=i,i}enqueueAfterDelay(e,i,r){this.uc(),this.oc.indexOf(e)>-1&&(i=0);const o=Nm.createAndSchedule(this,e,i,r,(u=>this.hc(u)));return this.tc.push(o),o}uc(){this.nc&&we(47125,{Pc:MT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const i of this.tc)if(i.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((i,r)=>i.targetTimeMs-r.targetTimeMs));for(const i of this.tc)if(i.skipDelay(),e!=="all"&&i.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const i=this.tc.indexOf(e);this.tc.splice(i,1)}}function MT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class fh extends hh{constructor(e,i,r,o){super(e,i,r,o),this.type="firestore",this._queue=new CT,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new CT(e),this._firestoreClient=void 0,await e}}}function VR(t,e){const i=typeof t=="object"?t:hA(),r=typeof t=="string"?t:Gc,o=sA(i,"firestore").getImmediate({identifier:r});if(!o._initialized){const u=Kw("firestore");u&&CR(o,...u)}return o}function kE(t){if(t._terminated)throw new ue(ee.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||LR(t),t._firestoreClient}function LR(t){const e=t._freezeSettings(),i=NR(t._databaseId,t._app?.options.appId||"",t._persistenceKey,t._app?.options.apiKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new AR(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&(function(o){const u=o?._online.build();return{_offline:o?._offline.build(u),_online:u}})(t._componentsProvider))}class ti{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ti(cn.fromBase64String(e))}catch(i){throw new ue(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(e){return new ti(cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ti._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ql(e,ti._jsonSchema))return ti.fromBase64String(e.bytes)}}ti._jsonSchemaVersion="firestore/bytes/1.0",ti._jsonSchema={type:Ut("string",ti._jsonSchemaVersion),bytes:Ut("string")};class OE{constructor(...e){for(let i=0;i<e.length;++i)if(e[i].length===0)throw new ue(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class DE{constructor(e){this._methodName=e}}class Fi{constructor(e,i){if(!isFinite(e)||e<-90||e>90)throw new ue(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(i)||i<-180||i>180)throw new ue(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=e,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fi._jsonSchemaVersion}}static fromJSON(e){if(ql(e,Fi._jsonSchema))return new Fi(e.latitude,e.longitude)}}Fi._jsonSchemaVersion="firestore/geoPoint/1.0",Fi._jsonSchema={type:Ut("string",Fi._jsonSchemaVersion),latitude:Ut("number"),longitude:Ut("number")};class yi{constructor(e){this._values=(e||[]).map((i=>i))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,o){if(r.length!==o.length)return!1;for(let u=0;u<r.length;++u)if(r[u]!==o[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:yi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ql(e,yi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((i=>typeof i=="number")))return new yi(e.vectorValues);throw new ue(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yi._jsonSchemaVersion="firestore/vectorValue/1.0",yi._jsonSchema={type:Ut("string",yi._jsonSchemaVersion),vectorValues:Ut("object")};const HR=/^__.*__$/;class xR{constructor(e,i,r){this.data=e,this.fieldMask=i,this.fieldTransforms=r}toMutation(e,i){return this.fieldMask!==null?new Wr(e,this.data,this.fieldMask,i,this.fieldTransforms):new Yl(e,this.data,i,this.fieldTransforms)}}function NE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we(40011,{dataSource:t})}}class Hm{constructor(e,i,r,o,u,h){this.settings=e,this.databaseId=i,this.serializer=r,this.ignoreUndefinedProperties=o,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Hm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const i=this.path?.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const i=this.path?.child(e),r=this.contextWith({path:i,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return $c(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((i=>e.isPrefixOf(i)))!==void 0||this.fieldTransforms.find((i=>e.isPrefixOf(i.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(NE(this.dataSource)&&HR.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class PR{constructor(e,i,r){this.databaseId=e,this.ignoreUndefinedProperties=i,this.serializer=r||lh(e)}createContext(e,i,r,o=!1){return new Hm({dataSource:e,methodName:i,targetDoc:r,path:ln.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function CE(t){const e=t._freezeSettings(),i=lh(t._databaseId);return new PR(t._databaseId,!!e.ignoreUndefinedProperties,i)}function zR(t,e,i,r,o,u={}){const h=t.createContext(u.merge||u.mergeFields?2:0,e,i,o);LE("Data must be an object, but it was:",h,r);const m=ME(r,h);let _,p;if(u.merge)_=new pi(h.fieldMask),p=h.fieldTransforms;else if(u.mergeFields){const y=[];for(const v of u.mergeFields){const w=dh(e,v,i);if(!h.contains(w))throw new ue(ee.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);qR(y,w)||y.push(w)}_=new pi(y),p=h.fieldTransforms.filter((v=>_.covers(v.field)))}else _=null,p=h.fieldTransforms;return new xR(new ei(m),_,p)}function UR(t,e,i,r=!1){return xm(i,t.createContext(r?4:3,e))}function xm(t,e){if(VE(t=Zs(t)))return LE("Unsupported field value:",e,t),ME(t,e);if(t instanceof DE)return(function(r,o){if(!NE(o.dataSource))throw o.createError(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${r._methodName}() is not currently supported inside arrays`);const u=r._toFieldTransform(o);u&&o.fieldTransforms.push(u)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,o){const u=[];let h=0;for(const m of r){let _=xm(m,o.childContextForArray(h));_==null&&(_={nullValue:"NULL_VALUE"}),u.push(_),h++}return{arrayValue:{values:u}}})(t,e)}return(function(r,o){if((r=Zs(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return TS(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const u=mt.fromDate(r);return{timestampValue:Xc(o.serializer,u)}}if(r instanceof mt){const u=new mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Xc(o.serializer,u)}}if(r instanceof Fi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ti)return{bytesValue:Z0(o.serializer,r._byteString)};if(r instanceof Qt){const u=o.databaseId,h=r.firestore._databaseId;if(!h.isEqual(u))throw o.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:wm(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof yi)return(function(h,m){const _=h instanceof yi?h.toArray():h;return{mapValue:{fields:{[S0]:{stringValue:R0},[qc]:{arrayValue:{values:_.map((y=>{if(typeof y!="number")throw m.createError("VectorValues must only contain numeric values.");return ym(m.serializer,y)}))}}}}}})(r,o);if(aE(r))return r._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Jc(r)}`)})(t,e)}function ME(t,e){const i={};return T0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jr(t,((r,o)=>{const u=xm(o,e.childContextForField(r));u!=null&&(i[r]=u)})),{mapValue:{fields:i}}}function VE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof mt||t instanceof Fi||t instanceof ti||t instanceof Qt||t instanceof DE||t instanceof yi||aE(t))}function LE(t,e,i){if(!VE(i)||!g0(i)){const r=Jc(i);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function dh(t,e,i){if((e=Zs(e))instanceof OE)return e._internalPath;if(typeof e=="string")return GR(t,e);throw $c("Field path arguments must be of type string or ",t,!1,void 0,i)}const BR=new RegExp("[~\\*/\\[\\]]");function GR(t,e,i){if(e.search(BR)>=0)throw $c(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,i);try{return new OE(...e.split("."))._internalPath}catch{throw $c(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,i)}}function $c(t,e,i,r,o){const u=r&&!r.isEmpty(),h=o!==void 0;let m=`Function ${e}() called with invalid data`;i&&(m+=" (via `toFirestore()`)"),m+=". ";let _="";return(u||h)&&(_+=" (found",u&&(_+=` in field ${r}`),h&&(_+=` in document ${o}`),_+=")"),new ue(ee.INVALID_ARGUMENT,m+t+_)}function qR(t,e){return t.some((i=>i.isEqual(e)))}class YR{convertValue(e,i="none"){switch(rr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,i);case 5:return e.stringValue;case 6:return this.convertBytes(ar(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,i);case 11:return this.convertObject(e.mapValue,i);case 10:return this.convertVectorValue(e.mapValue);default:throw we(62114,{value:e})}}convertObject(e,i){return this.convertObjectMap(e.fields,i)}convertObjectMap(e,i="none"){const r={};return jr(e,((o,u)=>{r[o]=this.convertValue(u,i)})),r}convertVectorValue(e){const i=e.fields?.[qc].arrayValue?.values?.map((r=>kt(r.doubleValue)));return new yi(i)}convertGeoPoint(e){return new Fi(kt(e.latitude),kt(e.longitude))}convertArray(e,i){return(e.values||[]).map((r=>this.convertValue(r,i)))}convertServerTimestamp(e,i){switch(i){case"previous":const r=nh(e);return r==null?null:this.convertValue(r,i);case"estimate":return this.convertTimestamp(Vl(e));default:return null}}convertTimestamp(e){const i=ir(e);return new mt(i.seconds,i.nanos)}convertDocumentKey(e,i){const r=ct.fromString(e);$e(iE(r),9688,{name:e});const o=new Ll(r.get(1),r.get(3)),u=new ge(r.popFirst(5));return o.isEqual(i)||ma(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),u}}class jR extends YR{constructor(e){super(),this.firestore=e}convertBytes(e){return new ti(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,i)}}const VT="@firebase/firestore",LT="4.11.0";class HE{constructor(e,i,r,o,u){this._firestore=e,this._userDataWriter=i,this._key=r,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new FR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const i=this._document.data.field(dh("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i)}}}class FR extends HE{data(){return super.data()}}function WR(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ue(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pm{}class zm extends Pm{}function xE(t,e,...i){let r=[];e instanceof Pm&&r.push(e),r=r.concat(i),(function(u){const h=u.filter((_=>_ instanceof Bm)).length,m=u.filter((_=>_ instanceof Um)).length;if(h>1||h>0&&m>0)throw new ue(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const o of r)t=o._apply(t);return t}class Um extends zm{constructor(e,i,r){super(),this._field=e,this._op=i,this._value=r,this.type="where"}static _create(e,i,r){return new Um(e,i,r)}_apply(e){const i=this._parse(e);return UE(e._query,i),new lr(e.firestore,e.converter,Xd(e._query,i))}_parse(e){const i=CE(e.firestore);return(function(u,h,m,_,p,y,v){let w;if(p.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ue(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){xT(v,y);const x=[];for(const V of v)x.push(HT(_,u,V));w={arrayValue:{values:x}}}else w=HT(_,u,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||xT(v,y),w=UR(m,h,v,y==="in"||y==="not-in");return zt.create(p,y,w)})(e._query,"where",i,e.firestore._databaseId,this._field,this._op,this._value)}}class Bm extends Pm{constructor(e,i){super(),this.type=e,this._queryConstraints=i}static _create(e,i){return new Bm(e,i)}_parse(e){const i=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return i.length===1?i[0]:Ti.create(i,this._getOperator())}_apply(e){const i=this._parse(e);return i.getFilters().length===0?e:((function(o,u){let h=o;const m=u.getFlattenedFilters();for(const _ of m)UE(h,_),h=Xd(h,_)})(e._query,i),new lr(e.firestore,e.converter,Xd(e._query,i)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gm extends zm{constructor(e,i){super(),this._field=e,this._direction=i,this.type="orderBy"}static _create(e,i){return new Gm(e,i)}_apply(e){const i=(function(o,u,h){if(o.startAt!==null)throw new ue(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new ue(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xl(u,h)})(e._query,this._field,this._direction);return new lr(e.firestore,e.converter,hS(e._query,i))}}function PE(t,e="asc"){const i=e,r=dh("orderBy",t);return Gm._create(r,i)}class qm extends zm{constructor(e,i,r){super(),this.type=e,this._limit=i,this._limitType=r}static _create(e,i,r){return new qm(e,i,r)}_apply(e){return new lr(e.firestore,e.converter,jc(e._query,this._limit,this._limitType))}}function zE(t){return HA("limit",t),qm._create("limit",t,"F")}function HT(t,e,i){if(typeof(i=Zs(i))=="string"){if(i==="")throw new ue(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L0(e)&&i.indexOf("/")!==-1)throw new ue(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${i}' contains a '/' character.`);const r=e.path.child(ct.fromString(i));if(!ge.isDocumentKey(r))throw new ue(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Zy(t,new ge(r))}if(i instanceof Qt)return Zy(t,i._key);throw new ue(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jc(i)}.`)}function xT(t,e){if(!Array.isArray(t)||t.length===0)throw new ue(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function UE(t,e){const i=(function(o,u){for(const h of o)for(const m of h.getFlattenedFilters())if(u.indexOf(m.op)>=0)return m.op;return null})(t.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(i!==null)throw i===e.op?new ue(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${i.toString()}' filters.`)}function XR(t,e,i){let r;return r=t?t.toFirestore(e):e,r}class kc{constructor(e,i){this.hasPendingWrites=e,this.fromCache=i}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ws extends HE{constructor(e,i,r,o,u,h){super(e,i,r,o,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const i=new Hc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,i={}){if(this._document){const r=this._document.data.field(dh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,i.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,i={};return i.type=Ws._jsonSchemaVersion,i.bundle="",i.bundleSource="DocumentSnapshot",i.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?i:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),i.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),i)}}Ws._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ws._jsonSchema={type:Ut("string",Ws._jsonSchemaVersion),bundleSource:Ut("string","DocumentSnapshot"),bundleName:Ut("string"),bundle:Ut("string")};class Hc extends Ws{data(e={}){return super.data(e)}}class Xs{constructor(e,i,r,o){this._firestore=e,this._userDataWriter=i,this._snapshot=o,this.metadata=new kc(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach((i=>e.push(i))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,i){this._snapshot.docs.forEach((r=>{e.call(i,new Hc(this._firestore,this._userDataWriter,r.key,r,new kc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const i=!!e.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new ue(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=(function(o,u){if(o._snapshot.oldDocs.isEmpty()){let h=0;return o._snapshot.docChanges.map((m=>{const _=new Hc(o._firestore,o._userDataWriter,m.doc.key,m.doc,new kc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:_,oldIndex:-1,newIndex:h++}}))}{let h=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>u||m.type!==3)).map((m=>{const _=new Hc(o._firestore,o._userDataWriter,m.doc.key,m.doc,new kc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let p=-1,y=-1;return m.type!==0&&(p=h.indexOf(m.doc.key),h=h.delete(m.doc.key)),m.type!==1&&(h=h.add(m.doc),y=h.indexOf(m.doc.key)),{type:KR(m.type),doc:_,oldIndex:p,newIndex:y}}))}})(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=fm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const i=[],r=[],o=[];return this.docs.forEach((u=>{u._document!==null&&(i.push(u._document),r.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),o.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function KR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we(61501,{type:t})}}Xs._jsonSchemaVersion="firestore/querySnapshot/1.0",Xs._jsonSchema={type:Ut("string",Xs._jsonSchemaVersion),bundleSource:Ut("string","QuerySnapshot"),bundleName:Ut("string"),bundle:Ut("string")};function mh(t){t=Cl(t,lr);const e=Cl(t.firestore,fh),i=kE(e),r=new jR(e);return WR(t._query),kR(i,t._query).then((o=>new Xs(e,r,t,o)))}function BE(t){return qE(Cl(t.firestore,fh),[new Tm(t._key,Yi.none())])}function GE(t,e){const i=Cl(t.firestore,fh),r=MR(t),o=XR(t.converter,e),u=CE(t.firestore);return qE(i,[zR(u,"addDoc",r._key,o,t.converter!==null,{}).toMutation(r._key,Yi.exists(!1))]).then((()=>r))}function qE(t,e){const i=kE(t);return OR(i,e)}(function(e,i=!0){AA(cA),Uc(new Dl("firestore",((r,{instanceIdentifier:o,options:u})=>{const h=r.getProvider("app").getImmediate(),m=new fh(new IA(r.getProvider("auth-internal")),new DA(h,r.getProvider("app-check-internal")),XA(h,o),h);return u={useFetchStreams:i,...u},m._setSettings(u),m}),"PUBLIC").setMultipleInstances(!0)),Ys(VT,LT,e),Ys(VT,LT,"esm2020")})();const QR={apiKey:"AIzaSyC0DwgLW_TZ0_F_sFtV7ClXiRamS19Ko0k",authDomain:"snowpeak-16fcc.firebaseapp.com",projectId:"snowpeak-16fcc",storageBucket:"snowpeak-16fcc.firebasestorage.app",messagingSenderId:"516645386130",appId:"1:516645386130:web:926f1606c8e82e5f27b34b"},ZR=r0(QR),ho=VR(ZR),Ym="high_scores",jm="slalom_scores";async function $R(){try{const t=xE(co(ho,Ym),PE("steps","asc"),zE(50));return(await mh(t)).docs.map(i=>i.data())}catch(t){return console.warn("Failed to fetch scores from cloud:",t),null}}async function PT(t){try{await GE(co(ho,Ym),t)}catch(e){console.warn("Failed to save score to cloud:",e)}}async function JR(){try{const e=(await mh(co(ho,Ym))).docs.map(i=>BE(i.ref));await Promise.all(e)}catch(t){console.warn("Failed to clear scores from cloud:",t)}}async function e2(){try{const t=xE(co(ho,jm),PE("score","desc"),zE(100));return(await mh(t)).docs.map(i=>i.data())}catch(t){return console.warn("Failed to fetch slalom scores from cloud:",t),null}}async function t2(t){try{await GE(co(ho,jm),t)}catch(e){console.warn("Failed to save slalom score to cloud:",e)}}async function n2(){try{const e=(await mh(co(ho,jm))).docs.map(i=>BE(i.ref));await Promise.all(e)}catch(t){console.warn("Failed to clear slalom scores from cloud:",t)}}const Ul="snowpeak_high_scores_v4",am=50,i2=240*1e3;function Bl(){try{let t=localStorage.getItem(Ul);if(!t&&(t=localStorage.getItem("snowpeak_high_scores_v3"),t)){const i=jE(JSON.parse(t));return Gl(i),localStorage.setItem(Ul,JSON.stringify(i)),localStorage.removeItem("snowpeak_high_scores_v3"),i}const e=t?JSON.parse(t):[];if(e.length>0){const i=YE(e);return Gl(i),i}return e}catch{return[]}}function Gl(t){return t.sort((e,i)=>{const r={expert:0,standard:1,easy:2},o=(r[e.mode]??1)-(r[i.mode]??1);if(o!==0)return o;if(e.steps!==i.steps)return e.steps-i.steps;const u=e.date?new Date(e.date).getTime():0;return(i.date?new Date(i.date).getTime():0)-u})}function YE(t){const e={expert:0,standard:1,easy:2},i=new Map;for(const r of t){const o=r.name.toLowerCase(),u=i.get(o);if(!u)i.set(o,r);else{const h=e[u.mode]??1,m=e[r.mode]??1;(m<h||m===h&&r.steps<u.steps)&&i.set(o,r)}}return Array.from(i.values())}function a2(t,e,i,r){const o=_h(i),u=Bl(),h={name:t,steps:e,time:o,elapsedMs:i,mode:r,date:new Date().toISOString(),migrated_v4:!0},m=u.findIndex(y=>y.name.toLowerCase()===t.toLowerCase());if(m!==-1){const y=u[m],v={expert:0,standard:1,easy:2},w=v[y.mode]??1,S=v[h.mode]??1;if(S<w||S===w&&e<y.steps)u.splice(m,1),u.push(h),PT(h);else{Gl(u);const V=u.slice(0,am);return{rank:V.findIndex(Q=>Q.name.toLowerCase()===t.toLowerCase())+1,scores:V,keptPrevious:!0,previousMode:y.mode,previousSteps:y.steps}}}else u.push(h),PT(h);Gl(u);const _=u.slice(0,am);try{localStorage.setItem(Ul,JSON.stringify(_))}catch{}return{rank:_.findIndex(y=>y.name.toLowerCase()===t.toLowerCase())+1,scores:_,keptPrevious:!1}}function jE(t){return t.map(e=>{if(e.migrated_v4)return e;const i=(e.elapsedMs||0)+i2;return{...e,elapsedMs:i,time:_h(i),migrated_v4:!0}})}async function r2(){const t=await $R();if(!t||t.length===0)return Bl();const e=jE(t),i=Bl(),r=[...e,...i],o=YE(r);Gl(o);const u=o.slice(0,am);try{localStorage.setItem(Ul,JSON.stringify(u))}catch{}return u}async function s2(){try{localStorage.removeItem(Ul),localStorage.removeItem("snowpeak_high_scores_v3")}catch{}try{await JR()}catch{}}function _h(t){const e=Math.floor(t/1e3),i=Math.floor(e/60),r=e%60;return i===0?`${r}s`:`${i}m ${String(r).padStart(2,"0")}s`}function FE(t){if(!t)return"";const e=new Date(t);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`}function WE(t,e=!1){const i=[],r=e?50:10,o=t.slice(0,r);i.push({text:"",type:"normal"}),i.push({text:"--------- TOP ADVENTURERS WHO UNLOCKED THE SECRET ---------",type:"system"}),i.push({text:"  #   PLAYER           STEPS   ELAPSED TIME   MODE        DATE",type:"system"}),i.push({text:"  --  --------         -----   ------------   ---------   ----",type:"system"});for(let u=0;u<o.length;u++){const h=o[u],m="  "+String(u+1).padEnd(4)+h.name.slice(0,15).padEnd(18)+String(h.steps).padEnd(7)+(h.time||"").padEnd(14)+(h.mode||"standard").padEnd(11)+FE(h.date);i.push({text:m,type:"system"})}return!e&&t.length>10&&(i.push({text:"",type:"normal"}),i.push({text:`  Showing top 10 of ${t.length}.`,type:"normal",action:{label:"[Show all]",command:"scores all"}})),e&&t.length>10&&(i.push({text:"",type:"normal"}),i.push({text:`  Showing all ${Math.min(t.length,50)} scores.`,type:"normal",action:{label:"[Show less]",command:"scores"}})),i.push({text:"",type:"normal"}),i}const kl=["A friendly Siberian Husky bounds out of nowhere, tail wagging furiously! It drops a snow-covered stick at your feet, barks once, then zooms away in a blur of fluff.","You hear excited panting behind you. A Siberian Husky with bright blue eyes nudges your hand with its cold nose, demands exactly three pets, then trots off looking very satisfied.","A Husky appears, spins in three tight circles chasing its own tail, stops to give you a goofy tongue-out grin, then disappears around the corner at full speed.","A fluffy Siberian Husky slides across the icy ground on its belly like a furry toboggan, bumps gently into your leg, looks up at you with zero shame, and scrambles off.",'A Husky pops its head out from behind a snowdrift, lets out a dramatic "AWOOOO!", then army-crawls toward you for belly rubs before bounding away happily.',"A snow-dusted Husky trots up carrying something in its mouth. It drops a frozen finger at your feet, wags its tail proudly, and prances away before you can react. That's... unsettling.","You spot a Husky rolling ecstatically in a fresh patch of snow, all four paws in the air. It notices you watching, freezes mid-roll, then bolts off as if nothing happened.","A Siberian Husky zooms past at incredible speed, loops back, sniffs your boots thoroughly, sneezes directly on your shoes, and gallops away looking enormously pleased.","A Husky appears with snow on its nose and what appears to be a tiny snowball balanced on its head. It sits perfectly still for two seconds, shakes everything off, and dashes into the distance.","A playful Husky rushes up and play-bows in front of you, butt wiggling in the air. It lets out a series of excited yips, does a victory lap around you, and vanishes into the snow."];function W(t,e,i="normal"){return{...t,output:[...t.output,{text:e,type:i}]}}function zT(t,e){return{...t,output:[...t.output,...e]}}function rn(t,e){return{...t,output:[...t.output,{type:"sound",sound:e}]}}function Nd(t,e){return t==="mountain_peak"&&e==="ski_lift_top"?"lift_motor":{lodge_lobby:"lobby_chatter",lodge_bar:"lobby_chatter",game_room:"footstep",lodge_balcony:"wind",basement:"creak_door",main_street:"snow_crunch",ski_rental:"creak_door",village:"snow_crunch",ski_slopes:"snow_crunch",ski_lift_top:"wind",frozen_waterfall:"wind",mountain_peak:"wind",hidden_cave:"cave_echo",underground_vault:"vault_rumble",staff_hallway:"footstep",staff_quarters:"creak_door",kitchen:"wood_floor",pantry:"wood_floor",storage_room:"creak_door",general_store:"store_bell",chapel:"chapel_echo",old_cabin:"wood_floor",underground_tunnel:"tunnel_drip",hidden_observatory:"observatory_hum",ice_caves:"wind",avalanche_zone:"wind",ridge_trail:"snow_crunch",summit_shelter:"wind"}[t]||"footstep"}function ph(t){return t.currentRoomId==="hidden_cave"&&!t.inventory.includes("torch")}function Ol(t,e){const i=t.rooms[e];let r=t;if(e==="hidden_cave"&&!r.inventory.includes("torch"))return r=W(r,"Hidden Cave","title"),r=W(r,"You squeeze through the narrow opening into total darkness. The air is frigid and still. You can't see a thing, but you can feel the rough cave walls around you. Near the entrance, your hand brushes against something wooden mounted on the wall -- it feels like a torch.","normal"),r=W(r,`
Exits: west`,"system"),r;i.ascii&&(r=W(r,i.ascii,"ascii")),r=W(r,i.name,"title"),r=W(r,i.description,"normal");const o=i.items.filter(p=>{const y=r.items[p];return y&&!y.hidden});if(o.length>0){const p=o.map(y=>r.items[y].name);r=W(r,`
You can see: ${p.join(", ")}.`,"normal")}if(i.npcs.length>0){const p=i.npcs.map(y=>r.npcs[y].name);r=W(r,`${p.join(" and ")} ${i.npcs.length===1?"is":"are"} here.`,"normal")}const u={...i.exits,...i.hiddenExits},m=e!=="hidden_cave"?i.lockedExits||{}:{},_=[];for(const p of Object.keys(u)){const y=u[p],v=r.rooms[y];v?_.push(`${p} (${v.name})`):_.push(p)}for(const p of Object.keys(m)){const v=m[p].roomId,w=r.rooms[v];w?_.push(`${p} (${w.name})`):_.push(p)}return _.length>0&&(r=W(r,`
Exits: ${_.join(", ")}`,"system")),r}function o2(t,{direction:e}){const i=t.rooms[t.currentRoomId];let o={...i.exits,...i.hiddenExits}[e];if(!o&&i.lockedExits&&i.lockedExits[e]){const _=i.lockedExits[e];if(_.keyId&&t.inventory.includes(_.keyId)){o=_.roomId;const p={...i,exits:{...i.exits,[e]:_.roomId},lockedExits:{...i.lockedExits}};delete p.lockedExits[e];let y={...t,rooms:{...t.rooms,[t.currentRoomId]:p}};return _.roomId==="basement"?y=W(y,"The old basement key fits perfectly in the lock. With a satisfying click, the heavy wooden door creaks open, revealing stone steps leading down into darkness.","normal"):_.roomId==="staff_quarters"?(y=W(y,"You slide the staff key into the lock. The mechanism turns with a heavy *CLUNK* and the door to the staff quarters swings open, revealing a dimly lit corridor beyond.","normal"),y=rn(y,"unlock")):y=W(y,`You use the ${t.items[_.keyId].name} to unlock the way ${e}.`,"normal"),y=W(y,"","normal"),y=rn(y,Nd(o,t.currentRoomId)),y={...y,currentRoomId:o,previousRoomId:t.currentRoomId},y=Ol(y,o),y={...y,rooms:{...y.rooms,[o]:{...y.rooms[o],visited:!0}}},y}if(_.requireItems)if(_.requireItems.every(y=>t.inventory.includes(y))){o=_.roomId;const y={...i,exits:{...i.exits,[e]:_.roomId},lockedExits:{...i.lockedExits}};delete y.lockedExits[e];let v={...t,rooms:{...t.rooms,[t.currentRoomId]:y}};return _.roomId==="ice_caves"?(v=W(v,"You hammer the pickaxe into the ice wall and secure the climbing rope to a rock anchor. Carefully rappelling down the frozen passage, you descend into the mountain. The ice groans and cracks around you as you go deeper. Finally, you reach the bottom -- a vast cavern of glittering ice!","normal"),v=rn(v,"wind")):v=W(v,`You use your equipment to unlock the way ${e}.`,"normal"),v=W(v,"","normal"),v=rn(v,Nd(o,t.currentRoomId)),v={...v,currentRoomId:o,previousRoomId:t.currentRoomId},v=Ol(v,o),v={...v,rooms:{...v.rooms,[o]:{...v.rooms[o],visited:!0}}},v}else return W(t,_.message,"error");if(_.requireItem&&t.inventory.includes(_.requireItem))o=_.roomId;else return W(t,_.message,"error")}if(!o)return W(t,"You can't go that way.","error");if(["ski_slopes","frozen_waterfall","ski_lift_top","mountain_peak"].includes(o)&&!t.inventory.includes("warm_coat"))return W(t,"The bitter mountain wind cuts right through you! It's far too cold to continue without a warm coat. You turn back, shivering.","error");let h=rn(t,Nd(o,t.currentRoomId));if(h={...h,currentRoomId:o,previousRoomId:t.currentRoomId},h=W(h,"","normal"),h=Ol(h,o),h={...h,rooms:{...h.rooms,[o]:{...h.rooms[o],visited:!0}}},!["hidden_cave","underground_vault"].includes(o)&&Math.random()<.2){const p=h.puzzles.finger_given;let y=Math.floor(Math.random()*kl.length);y===5&&p&&(y=(y+1)%kl.length),h=W(h,"","normal"),h=W(h,kl[y],"npc"),y===5&&!p&&(h={...h,inventory:[...h.inventory,"frozen_finger"],puzzles:{...h.puzzles,finger_given:!0}},h=W(h,`
[Frozen finger added to inventory]`,"system"))}return h.mode==="expert"&&h.puzzles.candle_lit&&["ski_slopes","frozen_waterfall","ski_lift_top","mountain_peak","ridge_trail","avalanche_zone","summit_shelter","ice_caves"].includes(o)&&(h=W(h,"","normal"),h=W(h,"The fierce mountain wind blows out your candle! The flame flickers and dies, leaving you in darkness once more.","normal"),h={...h,puzzles:{...h.puzzles,candle_lit:!1}}),h}function l2(t,e={}){if(ph(t)&&(e.itemId||e.npcId||e.target))return W(t,"It's pitch black! You can't see a thing.","error");if(e.npcId){const i=t.npcs[e.npcId];return W(t,i.description,"normal")}if(e.itemId){const i=t.items[e.itemId];return W(t,i.description,"normal")}if(e.target){const i=t.rooms[t.currentRoomId];if(t.currentRoomId==="frozen_waterfall"&&(e.target.includes("waterfall")||e.target.includes("ice")||e.target.includes("water"))){if(i.hiddenExits?.east)return W(t,"You examine the frozen waterfall closely. You can see the narrow gap in the ice on the east side -- the hidden cave entrance you discovered with your binoculars.","normal");const r=t.npcs.angry_boss?.flags?.calmed,o=t.npcs.dill_pickle?.flags?.fixed_radio;return r||o?t.inventory.includes("binoculars")?W(t,"You examine the ice closely. You can tell something is behind it... try using your binoculars to get a better look!","normal"):W(t,"You examine the frozen waterfall closely. Knowing there's supposed to be a cave here, you squint at the ice... but you can't quite make out where the entrance might be. Maybe you need something to help you see better -- like binoculars?","normal"):W(t,"The frozen waterfall is mesmerizing -- a wall of ice frozen in mid-flow. It's beautiful but you feel like there might be more to it than meets the eye. Maybe someone at the resort knows something...","normal")}return t.currentRoomId==="basement"&&t.mode==="expert"&&(e.target.includes("metal")||e.target.includes("glint")||e.target.includes("behind")||e.target.includes("cabinet"))&&!t.puzzles.fuse_dislodged?W(t,"You crouch down and peer behind the old arcade cabinet. There's definitely something metallic wedged back there  looks like it could be some kind of heavy-duty electrical component. But it's jammed tight between the cabinet and the stone wall. No amount of reaching or prying is going to get it out. Maybe if the cabinet moved somehow...","normal"):W(t,"You don't see anything special about that.","normal")}return Ol(t,t.currentRoomId)}function u2(t,{itemId:e}){const i=t.rooms[t.currentRoomId];if(ph(t)&&e!=="torch")return W(t,"It's pitch black! You can't see anything to take. You can feel something wooden on the wall near the entrance though...","error");if(!i.items.includes(e))return t.inventory.includes(e)?W(t,"You already have that.","error"):W(t,"That's not here.","error");const r=t.items[e];if(!r.takeable)return W(t,"You can't take that.","error");const o={...i,items:i.items.filter(h=>h!==e)};let u={...t,rooms:{...t.rooms,[t.currentRoomId]:o},inventory:[...t.inventory,e]};return u=W(u,`You pick up the ${r.name}.`,"normal"),e==="torch"&&t.currentRoomId==="hidden_cave"&&(u=W(u,`
The torch sputters to life, casting a warm flickering glow across the cave walls!`,"normal"),u=W(u,"","normal"),u=Ol(u,"hidden_cave")),u}function c2(t,{itemId:e}){if(!t.inventory.includes(e))return W(t,"You're not carrying that.","error");const i=t.items[e],r=t.rooms[t.currentRoomId],o={...r,items:[...r.items,e]};let u={...t,rooms:{...t.rooms,[t.currentRoomId]:o},inventory:t.inventory.filter(h=>h!==e)};return u=W(u,`You drop the ${i.name}.`,"normal"),u}function h2(t){if(t.inventory.length===0)return W(t,"You're not carrying anything.","normal");const e=t.inventory.map(r=>`  - ${t.items[r].name}`);let i=W(t,"You are carrying:","normal");for(const r of e)i=W(i,r,"normal");return i}function XE(t,{npcId:e}){const i=t.npcs[e];if(!t.rooms[t.currentRoomId].npcs.includes(e))return W(t,`${i.name} isn't here.`,"error");const o=i.dialogue.filter(_=>_.state===i.dialogueState);let u=null;for(const _ of o)if(_.condition){if(_.condition.hasItem&&t.inventory.includes(_.condition.hasItem)){u=_;break}if(_.condition.hasFlag&&t.puzzles[_.condition.hasFlag]){u=_;break}}if(u||(u=o.find(_=>!_.condition)),!u)return W(t,`${i.name} has nothing to say.`,"normal");let h=W(t,u.text,"npc");if(e==="angry_boss"&&!t.puzzles.angry_boss_image_shown&&(h=rn(h,"angry_grunt"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/boss.jpg",text:"Angry Boss"}],puzzles:{...h.puzzles,angry_boss_image_shown:!0}}),e==="mr_smiles"&&!t.puzzles.mr_smiles_image_shown&&(h=rn(h,"kid_laugh"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/mistersmiles.jpg",text:"Mr Smiles"}],puzzles:{...h.puzzles,mr_smiles_image_shown:!0}}),e==="mr_smiles"&&u.effects?.removeItem==="ski_poles"&&(h=rn(h,"kid_laugh"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/smilespoles.jpg",text:"Mr Smiles with his ski poles"}]}),e==="dill_pickle"&&!t.puzzles.dill_pickle_image_shown&&(h={...h,output:[...h.output,{type:"image",src:"/snowpeak/skishop.jpg",text:"Dill Pickle in the ski shop"}],puzzles:{...h.puzzles,dill_pickle_image_shown:!0}}),e==="coach_joe"&&!t.puzzles.coach_joe_image_shown&&(h=rn(h,"whistle"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/coach.jpg",text:"Coach Joe"}],puzzles:{...h.puzzles,coach_joe_image_shown:!0}}),e==="henrys_mom"&&!t.puzzles.henrys_mom_image_shown&&(h=rn(h,"bag_rummage"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/snackmom.jpg",text:"Henry's Mom"}],puzzles:{...h.puzzles,henrys_mom_image_shown:!0}}),e==="dance_mom"&&!t.puzzles.dance_mom_image_shown&&(h=rn(h,"camera_click"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/dancemom.jpg",text:"Social Media Influencer"}],puzzles:{...h.puzzles,dance_mom_image_shown:!0}}),e==="old_dad"&&!t.puzzles.old_dad_image_shown&&(h=rn(h,"rocking_chair"),h={...h,output:[...h.output,{type:"image",src:"/snowpeak/olddad.jpg",text:"Old Dad"}],puzzles:{...h.puzzles,old_dad_image_shown:!0}}),u.effects){const _=u.effects;if(_.removeItem){const p=h.items[_.removeItem];h={...h,inventory:h.inventory.filter(y=>y!==_.removeItem)},p&&(h=W(h,`
[${p.name} removed from inventory]`,"system"))}if(_.addItem&&(h={...h,inventory:[...h.inventory,_.addItem]},h=W(h,`
[You received: ${h.items[_.addItem].name}]`,"system")),_.revealItem){const[p,y]=_.revealItem,v=h.items[p];if(v&&v.hidden){const w=h.rooms[y];h={...h,items:{...h.items,[p]:{...v,hidden:!1}},rooms:{...h.rooms,[y]:{...w,items:w.items.includes(p)?w.items:[...w.items,p]}}},h=W(h,`
[A ${v.name} has appeared on the floor!]`,"system")}}if(_.setFlag){const[p,y,v]=_.setFlag;h={...h,npcs:{...h.npcs,[p]:{...h.npcs[p],flags:{...h.npcs[p].flags,[y]:v}}}}}if(_.moveNpc){const[p,y]=_.moveNpc,v=h.npcs[p].currentRoomId;h={...h,npcs:{...h.npcs,[p]:{...h.npcs[p],currentRoomId:y}},rooms:{...h.rooms,[v]:{...h.rooms[v],npcs:h.rooms[v].npcs.filter(w=>w!==p)},[y]:{...h.rooms[y],npcs:[...h.rooms[y].npcs,p]}}}}}return(u.effects||i.dialogueState===0)&&(h={...h,npcs:{...h.npcs,[e]:{...h.npcs[e],dialogueState:i.dialogueState+1}}}),h}function f2(t,{itemId:e}){if(e==="arcade_machine"){if(!t.rooms[t.currentRoomId].items.includes("arcade_machine"))return W(t,"There's no arcade machine here.","error");let u=W(t,"You step up to the arcade machine and press START. The screen flickers to life...","normal");return u=W(u,"","normal"),u=W(u,"* SLALOM CHALLENGE *","title"),u=W(u,"The cabinet hums and the screen fills with green pixels. Time to hit the slopes!","normal"),u=rn(u,"arcade_start"),u={...u,launchSlalom:!0},u}if(e==="basement_arcade"){if(!t.rooms[t.currentRoomId].items.includes("basement_arcade"))return W(t,"There's no arcade cabinet here.","error");let u=W(t,"You pull the dusty tarp aside and blow the cobwebs off the screen. The old CRT monitor crackles and hums to life, bathing the dark basement in an eerie green glow...","normal");return u=W(u,"","normal"),u=W(u,"* DEFEND THE VILLAGE *","title"),u=W(u,"The ancient cabinet shudders awake. Pixel wolves howl across the screen. Time to defend the village!","normal"),u=rn(u,"arcade_start"),u={...u,launchDefend:!0},u}if(e==="store_arcade"){if(!t.rooms[t.currentRoomId].items.includes("store_arcade"))return W(t,"There's no arcade cabinet here.","error");if(!t.inventory.includes("game_tokens"))return W(t,'You squeeze past the shelves and find the old cabinet tucked in the corner. A slot on the front reads "INSERT TOKENS." You need game tokens to play this machine.',"normal");let u=W(t,"You fish a token out of the bag and drop it into the slot. The old cabinet hums to life with a satisfying clunk. The monitor crackles through a burst of static, casting a cool blue glow across the empty store...","normal");return u=W(u,"","normal"),u=W(u,"* SNOWBALL SHOWDOWN *","title"),u=W(u,'Two pixel characters face off across a snowy field. The screen reads: "READY... FIGHT!" Time for a snowball fight!',"normal"),u=rn(u,"arcade_start"),u={...u,launchSnowball:!0},u}if(e==="store_bell"){if(!t.rooms[t.currentRoomId].items.includes("store_bell"))return W(t,"There's no bell here.","error");let u=W(t,"You ring the brass bell. *DING!* The sound echoes through the empty store.","normal");if(u=rn(u,"bell"),Math.random()<.5){const h=kl[Math.floor(Math.random()*kl.length)];u=W(u,"","normal"),u=W(u,h,"normal"),h.includes("frozen finger")&&(u={...u,inventory:[...u.inventory,"frozen_finger"]})}else u=W(u,"","normal"),u=W(u,"Nobody comes. The store remains silent and empty.","normal");return u}if(!t.inventory.includes(e))return W(t,"You're not carrying that.","error");if(ph(t))return W(t,"It's too dark to see what you're doing!","error");const i=t.items[e],r=t.currentRoomId;if(e==="frozen_finger")return W(t,"You use the frozen finger to pick your nose. It's a strangely refreshing feeling.","normal");if(e==="binoculars"&&r==="frozen_waterfall"){if(t.rooms.frozen_waterfall.hiddenExits?.east)return W(t,"You peer through the binoculars at the ice wall up close. You can already see the cave entrance to the east.","normal");let o=W(t,"You hold the binoculars up to the frozen waterfall and scan the ice closely. Through the lenses, a narrow crack in the ice comes into sharp focus -- it's not just a crack, it's an opening! A hidden passage leads east, into a cave behind the waterfall!","normal");return o={...o,rooms:{...o.rooms,frozen_waterfall:{...o.rooms.frozen_waterfall,hiddenExits:{...o.rooms.frozen_waterfall.hiddenExits,east:"hidden_cave"}}}},o=W(o,`
A new exit has been revealed: east (Hidden Cave)`,"system"),o}if(e==="binoculars"){const u={ridge_trail:["You peer through the binoculars along the ridge. The trail winds like a white ribbon between jagged peaks. Far below, the resort looks like a toy village. You can see tiny figures on the slopes, carving turns through fresh powder.","Through the lenses, you spot a family of mountain goats picking their way along a rocky outcrop across the valley. They move with impossible grace on the near-vertical cliff face.","The binoculars reveal an endless panorama of snow-capped peaks stretching to the horizon. The late afternoon sun paints them in shades of gold and pink. This is why people climb mountains."],mountain_peak:["From the summit, the binoculars reveal the entire valley spread out below like a living map. You can trace every trail, every road, every frozen stream. The world feels impossibly vast and quiet up here.","You scan the horizon through the binoculars. Peak after peak stretches into the distance, each one catching the light differently. You can see three other ski resorts, tiny and distant, nestled in neighboring valleys.","Peering straight down with the binoculars is dizzying -- the slopes fall away dramatically. You can see the ski lift chairs swaying gently in the wind, and far below, the warm glow of the lodge windows."],ski_lift_top:["You train the binoculars on the lift line stretching down the mountain. The cables hum in the wind. Below, you can see the full run of the ski slopes -- every mogul, every turn, every tree line.","Through the binoculars, you spot a hawk circling on the thermals above the valley. It dips and soars effortlessly, riding invisible currents of air. You feel a pang of envy.","The binoculars reveal details on the distant frozen waterfall -- layers of blue and white ice, frozen in mid-cascade. It looks like time itself stopped flowing there."],ice_caves:["You raise the binoculars inside the ice cave and peer through a gap in the frozen wall. The ice acts like a lens, refracting the light into shimmering rainbows that dance across the ceiling.","Through the binoculars, you study the ice formations up close. The crystalline structures are breathtaking -- delicate spires and curtains of ice that look like they were sculpted by an artist."],avalanche_zone:["You nervously scan the slopes above with the binoculars. Fresh snow sits heavy on the ridgeline -- it could slide at any moment. You can see where previous avalanches have carved paths through the trees, snapping trunks like matchsticks.","The binoculars reveal cracks in the snowpack above. This area is genuinely dangerous. Through the lenses, you spot what looks like an old warning sign half-buried in snow.","Scanning the debris field with binoculars, you notice strange shapes under the snow. Could be buried trees... or something else entirely. Best not to linger here."],ski_slopes:["You watch the empty slopes through the binoculars. Without any skiers, the mountain feels hauntingly peaceful. Fresh tracks from some animal -- maybe a fox -- zigzag across the pristine powder.","Through the binoculars, you can see all the way up to the ski lift station at the top. The slope looks steeper from down here than it does up close. No wonder they call it a black diamond run.","Scanning the tree line with binoculars, you catch a flash of movement -- a deer bounding through the deep snow at the edge of the forest, kicking up little clouds of white behind it."],frozen_waterfall:["The binoculars bring the frozen waterfall into sharp detail. Thousands of icicles hang like crystal chandeliers, some as thick as your arm. Behind the curtain of ice, you can just make out a dark opening...","You study the ice formations through the binoculars. The waterfall froze in layers -- you can see bands of clear blue ice alternating with milky white. It must have frozen over the course of several cold nights."]}[r];if(u){const h=u[Math.floor(Math.random()*u.length)];return W(t,h,"normal")}return W(t,"You peer through the binoculars, but there's nothing particularly interesting to see from here. Try using them somewhere with a view -- the mountain trails or slopes might be more rewarding.","normal")}if(e==="fuse"&&r==="ski_lift_top"){t.inventory.includes("fuse");const o=t.inventory.includes("screwdriver");if(t.mode==="expert"){if(!o)return W(t,"You try to install the fuse in the electrical panel. The fuse looks like it would fit perfectly, but you can't open the panel cover -- it's held shut by several screws. You need a tool... maybe a screwdriver to complete the job.","error");let u=W(t,"You use the screwdriver to open the electrical panel cover, then carefully slot the fuse into the empty socket. There's a satisfying CLUNK, followed by a low hum. The ski lift machinery groans to life! The chairs begin moving along the cable. The lift is working! You can now ride it up to the mountain peak.","normal");const h=u.rooms.ski_lift_top;return u={...u,inventory:u.inventory.filter(m=>m!=="fuse"&&m!=="screwdriver"),puzzles:{...u.puzzles,ski_lift_fixed:!0},rooms:{...u.rooms,ski_lift_top:{...h,description:"The upper ski lift station hums with power. The lift chairs glide smoothly along the cable, ready to carry riders to the peak. The electrical panel on the side of the station house is closed, the fuse and screwdriver both used in the repair.",exits:{...h.exits,up:"mountain_peak"}}}},u=W(u,`
[The ski lift is now operational! You can go up to the mountain peak.]`,"system"),u}else{let u=W(t,"You slot the electrical fuse into the empty socket on the control panel. There's a satisfying CLUNK, followed by a low hum. The ski lift machinery groans to life! The chairs begin moving along the cable. The lift is working! You can now ride it up to the mountain peak.","normal");const h=u.rooms.ski_lift_top;return u={...u,inventory:u.inventory.filter(m=>m!=="fuse"),puzzles:{...u.puzzles,ski_lift_fixed:!0},rooms:{...u.rooms,ski_lift_top:{...h,description:"The upper ski lift station hums with power. The lift chairs glide smoothly along the cable, ready to carry riders to the peak. The electrical panel on the side of the station house is closed, the fuse securely in place.",exits:{...h.exits,up:"mountain_peak"}}}},u=W(u,`
[The ski lift is now operational! You can go up to the mountain peak.]`,"system"),u}}if(e==="screwdriver"&&r==="ski_lift_top"&&t.mode==="expert")return W(t,"You use the screwdriver to open the electrical panel. Inside you can see an empty fuse socket -- the lift won't work without a fuse. You close the panel back up.","normal");if(e==="strange_medallion"&&r==="hidden_cave"){let o=W(t,"You press the strange medallion into the circular indentation beside the stone steps. It fits perfectly. There's a deep RUMBLE as ancient mechanisms engage. The heavy stone door at the bottom of the steps slowly grinds open, revealing a passage leading down into the mountain.","normal");const u=o.rooms.hidden_cave;return o={...o,inventory:o.inventory.filter(h=>h!=="strange_medallion"),rooms:{...o.rooms,hidden_cave:{...u,exits:{...u.exits,down:"underground_vault"},lockedExits:{}}}},o=W(o,`
[A new exit has been revealed: down]`,"system"),o}if(e==="binoculars"&&r==="lodge_balcony")return W(t,"You peer through the binoculars toward the mountain. The frozen waterfall comes into sharp focus. Behind the shimmering ice, you can make out what looks like... a cave entrance! The ice partially conceals a dark opening. Interesting.","normal");if(e==="torch"&&r==="hidden_cave")return W(t,"You hold the torch high. The flickering light reveals the cave walls in detail -- ancient markings, trail symbols, and an arrow pointing down toward the stone steps. The circular indentation beside the steps gleams in the torchlight.","normal");if(e==="matches"&&t.mode==="expert")return W(t,"You strike a match. It flares to life with a warm, flickering glow... but the mountain wind quickly snuffs it out. The brief light was comforting, but not very useful. Perhaps a candle would hold a flame longer.","normal");if(e==="candles"&&t.mode==="expert"){if(!t.inventory.includes("matches"))return W(t,"You hold the prayer candles, but you have no way to light them. You need matches or some other source of fire.","error");let o=W(t,"You strike a match and carefully light one of the prayer candles. The warm glow pushes back the shadows around you. The flame flickers but holds steady -- a comforting light in the cold mountain air.","normal");return o={...o,puzzles:{...o.puzzles,candle_lit:!0}},o=W(o,`
[The candle provides dim light, but beware of the wind!]`,"system"),o}if(e==="avalanche_beacon"&&t.mode==="expert"){let o=W(t,"You press the activation button on the avalanche beacon. Nothing happens -- the battery is long dead.","normal");return o=W(o,"","normal"),o=W(o,"Even if it worked, activating a beacon when there's no actual avalanche emergency is incredibly dangerous and irresponsible. False alarms put rescue teams at risk and waste critical resources.","normal"),o=W(o,"","normal"),o=W(o,`Have you heard the story of "The Boy Who Cried Wolf"? When a real emergency happens, nobody will believe you if you've raised false alarms. Out here in the mountains, that kind of mistake can cost lives.`,"normal"),o}return W(t,`You're not sure how to use the ${i.name} here.`,"error")}function d2(t,{itemId:e,npcId:i}){if(!t.inventory.includes(e))return W(t,"You're not carrying that.","error");if(!t.rooms[t.currentRoomId].npcs.includes(i))return W(t,"They're not here.","error");t.items[e];const o=t.npcs[i];if(e==="frozen_flower"){if(t.puzzles.frozen_flower_given)return W(t,"You've already given the frozen flower away.","error");let u=t;if(i==="angry_boss")u=W(u,`You hold out the frozen flower to ${o.name}.`,"normal"),u=W(u,"","normal"),u=W(u,`"What is THIS?!" Angry Boss snatches the flower and holds it up to the light. Her scowl flickers for just a moment. "A frozen flower. Great. Just GREAT. You know what this reminds me of? My FEELINGS on this vacation -- FROZEN and DEAD."

She pauses, turning the delicate petals in her fingers.

"...It's actually kind of beautiful though. Fine. FINE! I'll keep it. But DON'T tell anyone I said that. My reputation as the angriest person in this resort is ALL I have left."`,"npc");else if(i==="dance_mom")u=W(u,`You hold out the frozen flower to ${o.name}.`,"normal"),u=W(u,"","normal"),u=W(u,`"Oh. My. GOD!" She nearly drops her phone. "Is that a FROZEN FLOWER?! This is going STRAIGHT on my livestream! Hold on -- let me get the angle right --"

She grabs the flower and poses with it for approximately forty-seven selfies.

"This is CONTENT GOLD, honey! 'Mountain adventurer gifts rare frozen botanical specimen to influencer' -- my followers are going to LOSE IT! All four of them! Samantha is going to be SO jealous. You are now officially my favorite person at this resort. Don't let it go to your head."`,"npc");else if(i==="henrys_mom")u=W(u,`You hold out the frozen flower to ${o.name}.`,"normal"),u=W(u,"","normal"),u=W(u,`"Oh... oh my goodness." Henry's Mom takes the frozen flower gently, her eyes lighting up with the warmest smile. "This is just the sweetest thing. You know, Henry used to pick me dandelions from the backyard every single day. He'd line them up on the kitchen counter like little soldiers."

She carefully tucks the flower into her tote bag, nestled between the trail mix and a thermos of hot cocoa.

"I'm going to keep this forever. You are such a kind soul. Please  take some snacks. Take ALL the snacks. I insist. Granola bars, fruit snacks, string cheese  whatever you want. An adventurer with a good heart deserves a full stomach!"`,"npc");else return u=W(u,`You offer the frozen flower to ${o.name}, but they don't seem interested.`,"normal"),u;return u={...u,inventory:u.inventory.filter(h=>h!=="frozen_flower"),puzzles:{...u.puzzles,frozen_flower_given:!0}},u=W(u,`
[Frozen flower removed from inventory]`,"system"),u}return XE(t,{npcId:i})}function m2(t,{itemId:e}){if(!t.inventory.includes(e))return W(t,"You need to pick that up first before you can read it.","error");const i=t.items[e];if(e==="founders_letter"){let r=W(t,i.readText||i.description,"npc");r=W(r,"","normal"),r=W(r,"A faded photograph falls out of the envelope. It shows Tobias Snowpeak and friends on the slopes, grinning from ear to ear.","normal"),r={...r,output:[...r.output,{type:"image",src:"/snowpeak/founderskids.jpg",text:"Tobias Snowpeak and friends on the slopes"}]},r=zT(r,Hw);try{const o=Date.now()-(t.startTime||Date.now()),u=t.turnCount+1,h=a2(t.playerName||"Adventurer",u,o,t.mode||"standard"),{rank:m,scores:_,keptPrevious:p,previousMode:y,previousSteps:v}=h;r=W(r,"","normal"),r=W(r,`${t.playerName}'s stats:  ${u} steps  |  ${_h(o)}`,"victory"),p?r=W(r,`Your earlier score remains (#${m})  ${v} steps in ${y} mode was a better run!`,"system"):m===1?r=W(r,"NEW #1 HIGH SCORE!","victory"):r=W(r,`Ranked #${m} on the leaderboard!`,"victory"),r=zT(r,WE(_))}catch{r=W(r,"","normal"),r=W(r,"Congratulations on completing the adventure!","victory")}return r={...r,output:[...r.output,{type:"image",src:"/snowpeak/victory.svg",text:"The Golden Ski Trophy"}]},r=rn(r,"victory"),r={...r,gameOver:!0,puzzles:{...r.puzzles,victory:!0}},r}if(e==="old_map"&&i.readText){const r={"Lodge Lobby":"lodge_lobby","Lodge Bar":"lodge_bar",Bar:"lodge_bar",Balcony:"lodge_balcony","Game Room":"game_room",Basement:"basement","Main Street":"main_street","Ski Rental":"ski_rental",Village:"village","Ski Slopes":"ski_slopes","Frozen Waterfall":"frozen_waterfall","Ski Lift Top":"ski_lift_top","Mountain Peak":"mountain_peak",Staff:"staff_hallway","Staff Quarters":"staff_quarters","Staff Q":"staff_quarters",Kitchen:"kitchen",Pantry:"pantry",Storage:"storage_room","General Store":"general_store",Chapel:"chapel","Old Cabin":"old_cabin","Underground Tunnel":"underground_tunnel",Observatory:"hidden_observatory","Ice Caves":"ice_caves","Avalanche Zone":"avalanche_zone","Ridge Trail":"ridge_trail","Summit Shelter":"summit_shelter"},o=i.readText.split(`
`);let u=t;for(const h of o){const m=/\[([^\]]+)\]/g,_=[];let p;for(;(p=m.exec(h))!==null;){const y=p[1],v=r[y];v&&_.push({start:p.index,end:p.index+p[0].length,text:p[0],displayName:y,roomId:v})}if(_.length===0)u=W(u,h,"normal");else{const y=[];let v=0;for(const w of _)w.start>v&&y.push({text:h.slice(v,w.start)}),w.roomId===t.currentRoomId?y.push({text:w.text,type:"current"}):t.rooms[w.roomId]?.visited?y.push({text:w.text,type:"visited"}):y.push({text:w.text}),v=w.end;v<h.length&&y.push({text:h.slice(v)}),u={...u,output:[...u.output,{text:"",type:"normal",segments:y}]}}}return u}return i.readText?W(t,i.readText,"normal"):W(t,i.description,"normal")}function _2(t){return{...t,gameRestart:!0,output:[...t.output,{text:"",type:"normal"},{text:"Restarting game...",type:"system"},{text:"Returning to mode selection...",type:"system"}]}}const Pn=7;function p2(t){const e=t.rooms[t.currentRoomId],i=[];if(ph(t))return i.push({label:"Go west (Frozen Waterfall)",command:"west"}),e.items.includes("torch")&&i.push({label:"Take torch",command:"take torch"}),i.push({label:"Look around",command:"look"}),i;const r={...e.exits,...e.hiddenExits},u=t.currentRoomId!=="hidden_cave"?Object.keys(e.lockedExits||{}):[],h=[...Object.keys(r),...u],m={north:"Go north",south:"Go south",east:"Go east",west:"Go west",up:"Go up",down:"Go down"},_=h.filter(H=>{const Q=r[H]||e.lockedExits?.[H]?.roomId;return Q&&!t.rooms[Q]?.visited}),p=h.filter(H=>{const Q=r[H]||e.lockedExits?.[H]?.roomId;return!Q||t.rooms[Q]?.visited}),y=[..._,...p];function v(H){const Q=r[H]||e.lockedExits?.[H]?.roomId,$=Q?t.rooms[Q]?.name:null;return{label:$?`${m[H]||`Go ${H}`} (${$})`:`${m[H]||`Go ${H}`}`,command:H}}for(const H of y){if(i.length>=Pn)break;i.push(v(H))}for(const H of e.npcs){if(i.length>=Pn)break;const Q=t.npcs[H],$=g2(t,H);if($){const le=t.items[$];i.push({label:`Give ${le.name} to ${Q.name}`,command:`give ${le.name} to ${Q.name.toLowerCase()}`})}else i.push({label:`Talk to ${Q.name}`,command:`talk to ${Q.name.toLowerCase()}`})}const w=e.items.filter(H=>{const Q=t.items[H];return Q&&!Q.hidden});for(const H of w){if(i.length>=Pn)break;const Q=t.items[H];Q.takeable?i.push({label:`Take ${Q.name}`,command:`take ${Q.name}`}):i.push({label:`Look at ${Q.name}`,command:`look at ${Q.name}`})}const S=y2(t);S&&i.length<Pn&&i.push(S);const x=T2(t);if(x&&i.length<Pn){const H=t.items[x];i.push({label:`Use ${H.name}`,command:`use ${H.name}`})}t.currentRoomId==="game_room"&&e.items.includes("arcade_machine")&&i.length<Pn&&i.push({label:"Play the arcade game",command:"play arcade game"}),t.currentRoomId==="basement"&&e.items.includes("basement_arcade")&&i.length<Pn&&i.push({label:"Play the dusty arcade cabinet",command:"play defend game"}),t.currentRoomId==="general_store"&&e.items.includes("store_arcade")&&i.length<Pn&&i.push({label:"Play the snowball arcade game",command:"play snowball game"});const V=E2(t);if(V&&i.length<Pn){const H=t.items[V];i.push({label:`Read ${H.name}`,command:`read ${H.name}`})}return i.length<Pn&&t.inventory.length>0&&i.push({label:"Check inventory",command:"inventory"}),i.length<Pn&&i.push({label:"Look around",command:"look"}),i.length<Pn&&i.push({label:"Help",command:"help"}),i.slice(0,Pn)}function g2(t,e){const i=t.npcs[e];if(!i||i.dialogueState===0)return null;const o={angry_boss:"whiskey_bottle",mr_smiles:"ski_poles",dill_pickle:"broken_radio"}[e];return o&&t.inventory.includes(o)?o:null}function y2(t){return t.currentRoomId==="frozen_waterfall"&&!t.rooms.frozen_waterfall.hiddenExits?.east&&!t.inventory.includes("binoculars")?{label:"Examine the frozen waterfall closely",command:"look at waterfall"}:null}function T2(t){const e=t.currentRoomId;for(const i of t.inventory){if(i==="fuse"&&e==="ski_lift_top"||i==="strange_medallion"&&e==="hidden_cave"||i==="binoculars"&&e==="lodge_balcony"||i==="binoculars"&&e==="frozen_waterfall"&&!t.rooms.frozen_waterfall.hiddenExits?.east)return i;const r=t.rooms[e];if(i==="whiskey_bottle"&&r.npcs.includes("angry_boss")||i==="ski_poles"&&r.npcs.includes("mr_smiles")||i==="broken_radio"&&r.npcs.includes("dill_pickle"))return null}for(const i of t.inventory)if(i==="torch"&&e==="hidden_cave")return i;return null}function E2(t){if(t.inventory.includes("founders_letter"))return"founders_letter";for(const e of t.inventory)if(["old_map","dusty_journal","note_from_founder"].includes(e))return e;return null}function v2({output:t,onCommand:e,gameOver:i,mode:r,gameState:o}){const[u,h]=oe.useState(""),[m,_]=oe.useState([]),[p,y]=oe.useState(-1),v=oe.useRef(null),w=oe.useRef(null),S=oe.useMemo(()=>r!=="easy"||i||!o?.currentRoomId?[]:p2(o),[r,i,o]);oe.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[t]),oe.useEffect(()=>{w.current&&w.current.focus()},[]);const x=oe.useCallback($=>{$.preventDefault();const le=u.trim();le&&(_(ce=>[...ce,le]),y(-1),h(""),e(le))},[u,e]),V=oe.useCallback($=>{e($)},[e]),H=oe.useCallback($=>{$.key==="ArrowUp"?($.preventDefault(),y(le=>{const ce=le===-1?m.length-1:Math.max(0,le-1);return m[ce]!==void 0&&h(m[ce]),ce})):$.key==="ArrowDown"&&($.preventDefault(),y(le=>{const ce=le+1;return ce>=m.length?(h(""),-1):(h(m[ce]),ce)}))},[m]),Q=oe.useCallback(()=>{w.current&&w.current.focus()},[]);return C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"terminal-output",ref:v,onClick:Q,children:t.map(($,le)=>$.type==="sound"?null:$.type==="image"?C.jsx("div",{className:"output-line output-image",children:C.jsx("img",{src:$.src,alt:$.text||"image",onLoad:()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)}})},le):$.segments?C.jsx("div",{className:`output-line output-${$.type||"normal"}`,children:$.segments.map((ce,ot)=>C.jsx("span",{className:ce.type?`output-${ce.type}`:void 0,children:ce.text},ot))},le):C.jsxs("div",{className:`output-line output-${$.type||"normal"}`,children:[$.text,$.action&&C.jsxs(C.Fragment,{children:[" ",C.jsx("span",{className:"scores-expand-link",onClick:ce=>{ce.stopPropagation(),e($.action.command)},children:$.action.label})]})]},le))}),!i&&r==="easy"&&S.length>0&&C.jsxs("div",{className:"choices-container",children:[S.map(($,le)=>C.jsxs("button",{className:"choice-button",onClick:()=>V($.command),children:["[",le+1,"] ",$.label]},`${$.command}-${le}`)),C.jsx("button",{className:"choice-button choice-button-wildcard",onClick:()=>w.current?.focus(),children:"[*] Type a command..."})]}),!i&&C.jsxs("form",{className:"terminal-input-form",onSubmit:x,children:[C.jsx("span",{className:"prompt-char",children:">"}),C.jsx("input",{ref:w,type:"text",value:u,onChange:$=>h($.target.value),onKeyDown:H,autoFocus:!0,spellCheck:!1,autoComplete:"off"})]})]})}const w2=["ass","asses","asshole","assholes","bastard","bastards","bitch","bitches","bitchy","bullshit","cock","cocks","crap","cum","damn","damned","dammit","dick","dicks","dickhead","douche","douchebag","fag","fags","faggot","faggots","fuck","fucker","fuckers","fuckin","fucking","fucks","fuckoff","goddamn","goddamnit","hell","ho","hoe","hoes","jackass","jerkoff","kike","kikes","milf","nazi","nazis","nigga","niggas","nigger","niggers","piss","pissed","prick","pricks","pussy","pussies","retard","retarded","retards","shit","shits","shitty","shithead","slut","sluts","slutty","tit","tits","titty","twat","twats","wank","wanker","wankers","whore","whores"];function b2(t){const e=t.toLowerCase().replace(/[^a-z]/g,"");return w2.some(i=>e.includes(i))}function A2({onSubmit:t}){const[e,i]=oe.useState(""),[r,o]=oe.useState("name"),[u,h]=oe.useState(""),[m,_]=oe.useState(Bl()),[p,y]=oe.useState(!1),v=oe.useRef(null);oe.useEffect(()=>{r2().then(_)},[]),oe.useEffect(()=>{v.current&&v.current.focus()},[r]);const w=oe.useCallback(x=>{x.preventDefault();const V=e.trim();if(V){if(b2(V)){h("Please choose a more appropriate handle.");return}h(""),o("mode")}},[e]),S=oe.useCallback(x=>{t({name:e.trim(),mode:x})},[e,t]);return oe.useEffect(()=>{if(r!=="mode")return;const x=V=>{const H=V.key;H==="1"?S("standard"):H==="2"?S("easy"):H==="3"?S("expert"):H==="4"&&S("bonus")};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[r,S]),C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"terminal-output",children:[C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-ascii welcome-art",children:`         *  .  *  .  *  .  *  .  *
      .     *     .     *     .
            .  *  .  *  .  *
               *  .  *
                 /\\
                /  \\         *  .  *
               / /\\ \\       .  *  .
              / /  \\ \\        *  .
             / /    \\ \\      .  *
            /  \\    /  \\
           /____\\  /____\\
          / ~~~~ SNOWPEAK ~~~~ \\
         / ~~~~~ RESORT  ~~~~~ \\
        /________________________\\
       /     est. 1976            \\
      /____________________________\\`}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"welcome-title",children:"THE SECRET OF SNOWPEAK RESORT"}),C.jsx("div",{className:"welcome-subtitle",children:"A Zork-Style Text Adventure"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-system",children:"Welcome, adventurer! Before we begin..."}),C.jsx("div",{className:"output-line output-normal",children:""}),m.length>0&&C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"output-line output-system",children:"--- TOP ADVENTURERS WHO UNLOCKED THE SECRET ---"}),C.jsx("div",{className:"output-line output-system",children:"  #   PLAYER           STEPS  ELAPSED TIME  MODE       DATE"}),C.jsx("div",{className:"output-line output-system",children:"  -   ------           -----  ------------  ----       ----"}),m.slice(0,p?50:10).map((x,V)=>C.jsxs("div",{className:"output-line output-system",children:["  ",String(V+1).padEnd(4),x.name.slice(0,15).padEnd(18),String(x.steps).padEnd(7),(x.time||"").padEnd(14),(x.mode||"standard").padEnd(11),FE(x.date)]},V)),!p&&m.length>10&&C.jsxs("div",{className:"output-line output-normal",children:["  ","Showing top 10 of ",m.length,"."," ",C.jsx("span",{className:"scores-expand-link",onClick:()=>y(!0),children:"[Show all]"})]}),p&&m.length>10&&C.jsxs("div",{className:"output-line output-normal",children:["  ","Showing all ",Math.min(m.length,50)," scores."," ",C.jsx("span",{className:"scores-expand-link",onClick:()=>y(!1),children:"[Show less]"})]}),C.jsx("div",{className:"output-line output-normal",children:""})]}),r==="mode"&&C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"output-line output-normal",children:["Welcome, ",e.trim(),"! Choose a mode:"]}),C.jsx("div",{className:"output-line output-normal",children:""})]})]}),r==="name"&&C.jsxs(C.Fragment,{children:[u&&C.jsx("div",{className:"output-line output-error",style:{padding:"0 20px 6px"},children:u}),C.jsxs("form",{className:"terminal-input-form name-entry-form",onSubmit:w,children:[C.jsx("label",{className:"prompt-label",children:"What name should I call you?"}),C.jsxs("div",{className:"name-input-row",children:[C.jsx("span",{className:"prompt-char",children:">"}),C.jsx("input",{ref:v,type:"text",value:e,onChange:x=>{i(x.target.value),h("")},autoFocus:!0,spellCheck:!1,autoComplete:"off",maxLength:15,placeholder:""})]})]})]}),r==="mode"&&C.jsxs("div",{className:"mode-select",children:[C.jsxs("button",{className:"mode-button",onClick:()=>S("standard"),autoFocus:!0,ref:v,children:["[1] STANDARD MODE",C.jsx("span",{className:"mode-desc",children:"Type commands freely, classic Zork style"})]}),C.jsxs("button",{className:"mode-button",onClick:()=>S("easy"),children:["[2] EASY (CHEAT) MODE",C.jsx("span",{className:"mode-desc",children:"Choose from multiple choice options each turn, beginner friendly"})]}),C.jsxs("button",{className:"mode-button",onClick:()=>S("expert"),children:["[3] EXPERT MODE (BETA)",C.jsx("span",{className:"mode-desc",children:"Double-size map with more locations to explore, for experienced adventurers"})]}),C.jsxs("button",{className:"mode-button",onClick:()=>S("bonus"),children:["[4] BONUS CONTENT",C.jsx("span",{className:"mode-desc",children:"Play mini-games and view release notes"})]})]})]})}const me={WIDTH:480,HEIGHT:640},Ye={SNOW_LIGHT:"#e8e8f0",SNOW_DARK:"#d0d0e0",SKI_BODY:"#ff5555",SKI_SKIS:"#333333",GATE_LEFT:"#ff4444",GATE_RIGHT:"#4488ff",GATE_POLE:"#886644",OBSTACLE_ROCK:"#888888",OBSTACLE_BEAR:"#dddddd",OBSTACLE_SKIER:"#ff8800",TREE_TRUNK:"#664422",TREE_LEAVES:"#227744",HUD_GREEN:"#33ff33",HUD_BG:"rgba(0,0,0,0.6)",OVERLAY_BG:"rgba(0,0,0,0.85)",MISS_RED:"#ff4444",TEXT_WHITE:"#ffffff",TEXT_DIM:"#88ff88"},Rn={WIDTH:16,HEIGHT:24,START_Y:100,ACCEL:.6,FRICTION:.88,MAX_VX:6},Tt={MIN_GAP:60,MAX_GAP:120,FLAG_WIDTH:8,FLAG_HEIGHT:20,POLE_WIDTH:3,POLE_HEIGHT:28,SPAWN_SPACING_MIN:150,SPAWN_SPACING_MAX:200},io={GATE_COUNT:10,GAP:160,SPACING:180,MAX_DRIFT:100},_i={ROCK:{width:24,height:20},BEAR:{width:28,height:28},SKIER:{width:16,height:24},TYPES:["rock","bear","skier"],SKIER_MOVE_MIN_DIFFICULTY:4,SKIER_VX_MIN:.3,SKIER_VX_MAX:1.2},Jn={MIN_SIZE:20,MAX_SIZE:40,EDGE_MARGIN:60},In={LEVELS:10,DISTANCE_PER_LEVEL:750,SPEED_MIN:2,SPEED_MAX:6,OBSTACLE_CHANCE_MIN:.003,OBSTACLE_CHANCE_MAX:.015},kn={MAX_MISSES:5,SPAWN_AHEAD:300,DESPAWN_BEHIND:-50,TREE_SPAWN_CHANCE:.08,SCORE_PER_GATE:100,CHAMPION_SCORE:2e3,GATE_DRIFT_FACTOR:.55},gi={GATE_INTERVAL:5,SPEED_MULT_START:1.5,SPEED_MULT_MAX:4,ACCEL_FRAMES:120,BODY_COLOR:"#33ff33",HELMET_COLOR:"#ffcc00",LABEL:"NPC"},$n={GATE_INTERVAL:10,PEOPLE_PER_SIDE:5,PERSON_WIDTH:8,PERSON_HEIGHT:16,SPACING:14,SIDE_MARGIN:10,JACKET_COLORS:["#ff5555","#55ff55","#5555ff","#ffff55","#ff55ff","#55ffff","#ff8800","#ff44aa"]},sn={HUD:"20px VT323, monospace",TITLE:"48px VT323, monospace",SUBTITLE:"24px VT323, monospace",OVERLAY:"28px VT323, monospace",SMALL:"18px VT323, monospace"};function S2(){const t=[];for(let e=-200;e<me.HEIGHT+kn.SPAWN_AHEAD+400;e+=35+Math.random()*30){const i=Jn.MIN_SIZE+Math.random()*(Jn.MAX_SIZE-Jn.MIN_SIZE),o=(t.length%2===0?"left":"right")==="left"?Math.random()*Jn.EDGE_MARGIN:me.WIDTH-Jn.EDGE_MARGIN+Math.random()*Jn.EDGE_MARGIN;t.push({x:o,y:e,size:i})}return t}function Cd(){return{phase:"ready",skier:{x:me.WIDTH/2,vx:0,y:Rn.START_Y,width:Rn.WIDTH,height:Rn.HEIGHT},worldY:0,speed:In.SPEED_MIN,gates:[],obstacles:[],trees:S2(),crowds:[],lastCrowdAt:0,rivals:[],lastRivalAt:0,score:0,gatesPassed:0,gatesMissed:0,gatesSpawned:0,lastGateCenterX:me.WIDTH/2,maxMisses:kn.MAX_MISSES,difficulty:1,input:{left:!1,right:!1},canvasWidth:me.WIDTH,canvasHeight:me.HEIGHT,nextGateY:me.HEIGHT+100,events:[]}}function R2(t){if(t.phase!=="playing")return t;let e={...t,events:[]};e.worldY+=e.speed;const i=Math.min(In.LEVELS,Math.floor(e.worldY/In.DISTANCE_PER_LEVEL)+1);i>e.difficulty&&(e={...e,difficulty:i,events:[...e.events,"speed_up"]});const r=(e.difficulty-1)/(In.LEVELS-1);return e.speed=In.SPEED_MIN+r*(In.SPEED_MAX-In.SPEED_MIN),e=I2(e),e=C2(e),e=V2(e),e=H2(e),e=L2(e),e=P2(e),e=z2(e),e=B2(e),e=G2(e),e.gatesMissed>=e.maxMisses&&(e={...e,phase:"gameover",events:[...e.events,"game_over"]}),e}function I2(t){let{x:e,vx:i}=t.skier;return t.input.left&&(i-=Rn.ACCEL),t.input.right&&(i+=Rn.ACCEL),i*=Rn.FRICTION,i=Math.max(-6,Math.min(Rn.MAX_VX,i)),Math.abs(i)<.1&&(i=0),e+=i,e=Math.max(Rn.WIDTH/2,Math.min(me.WIDTH-Rn.WIDTH/2,e)),{...t,skier:{...t.skier,x:e,vx:i}}}function k2(t){return t<io.GATE_COUNT}function Fm(t,e,i){if(t>=io.GATE_COUNT)return i;const r=t/io.GATE_COUNT;return e+r*(i-e)}function O2(t,e){const i=Tt.MAX_GAP-(t-1)/(In.LEVELS-1)*(Tt.MAX_GAP-Tt.MIN_GAP);return Fm(e,io.GAP,i)}function D2(t,e){const i=Tt.SPAWN_SPACING_MAX-(t-1)/(In.LEVELS-1)*(Tt.SPAWN_SPACING_MAX-Tt.SPAWN_SPACING_MIN);return Fm(e,io.SPACING,i)}function N2(t,e,i){const r=t/Math.max(e,1),u=Rn.MAX_VX*r*kn.GATE_DRIFT_FACTOR;return Fm(i,io.MAX_DRIFT,u)}function C2(t){const e=t.worldY+me.HEIGHT+kn.SPAWN_AHEAD;if(t.nextGateY>e)return t;const i=O2(t.difficulty,t.gatesSpawned),r=D2(t.difficulty,t.gatesSpawned),o=N2(r,t.speed,t.gatesSpawned),u=40+i/2,h=Math.max(u,t.lastGateCenterX-o),m=Math.min(me.WIDTH-u,t.lastGateCenterX+o),_=h+Math.random()*(m-h),p=_-i/2,y=_+i/2,v={y:t.nextGateY,leftX:p,rightX:y,passed:!1,missed:!1};return{...t,gates:[...t.gates,v],nextGateY:t.nextGateY+r,gatesSpawned:t.gatesSpawned+1,lastGateCenterX:_}}function M2(t,e,i,r){const u=t-20,h=t+e+20,m=t+e/2;for(let _=0;_<r.length;_++){const p=r[_];if(Math.abs(i-p.y)<120&&h>p.leftX&&u<p.rightX)return!0;const y=r[_+1];if(y&&i>p.y&&i<y.y){const v=(i-p.y)/(y.y-p.y),w=(p.leftX+p.rightX)/2,S=(y.leftX+y.rightX)/2,x=w+v*(S-w),V=p.rightX-p.leftX,H=y.rightX-y.leftX,Q=(V+v*(H-V))/2+20;if(Math.abs(m-x)<Q)return!0}}return!1}function V2(t){if(k2(t.gatesSpawned))return t;const e=(t.difficulty-1)/(In.LEVELS-1),i=In.OBSTACLE_CHANCE_MIN+e*(In.OBSTACLE_CHANCE_MAX-In.OBSTACLE_CHANCE_MIN);if(Math.random()>i)return t;const r=Math.floor(Math.random()*_i.TYPES.length),o=_i.TYPES[r],u=o==="rock"?_i.ROCK:o==="bear"?_i.BEAR:_i.SKIER,h=30,m=h+Math.random()*(me.WIDTH-2*h-u.width),_=t.worldY+me.HEIGHT+kn.SPAWN_AHEAD+Math.random()*100;if(M2(m,u.width,_,t.gates))return t;let p=0;if(o==="skier"&&t.difficulty>=_i.SKIER_MOVE_MIN_DIFFICULTY){const y=(t.difficulty-_i.SKIER_MOVE_MIN_DIFFICULTY)/(In.LEVELS-_i.SKIER_MOVE_MIN_DIFFICULTY),v=_i.SKIER_VX_MIN+y*(_i.SKIER_VX_MAX-_i.SKIER_VX_MIN);p=(Math.random()<.5?-1:1)*v}return{...t,obstacles:[...t.obstacles,{type:o,x:m,y:_,width:u.width,height:u.height,vx:p}]}}function L2(t){let e=!1;const i=t.obstacles.map(r=>{if(!r.vx||r.vx===0)return r;e=!0;let o=r.x+r.vx,u=r.vx;return o<10&&(o=10,u=Math.abs(u)),o+r.width>me.WIDTH-10&&(o=me.WIDTH-10-r.width,u=-Math.abs(u)),{...r,x:o,vx:u}});return e?{...t,obstacles:i}:t}function H2(t){if(Math.random()>kn.TREE_SPAWN_CHANCE)return t;const e=Jn.MIN_SIZE+Math.random()*(Jn.MAX_SIZE-Jn.MIN_SIZE),r=(Math.random()<.5?"left":"right")==="left"?Math.random()*Jn.EDGE_MARGIN:me.WIDTH-Jn.EDGE_MARGIN+Math.random()*Jn.EDGE_MARGIN,o=t.worldY+me.HEIGHT+kn.SPAWN_AHEAD+Math.random()*50;return{...t,trees:[...t.trees,{x:r,y:o,size:e}]}}function x2(t){const e=t.worldY-me.HEIGHT+50,i=[...t.gates].filter(r=>r.y>e).sort((r,o)=>r.y-o.y);return{...t,rivals:[...t.rivals,{x:me.WIDTH/2,y:e,frame:0,gateIndex:0,gateCenters:i.map(r=>({y:r.y,cx:(r.leftX+r.rightX)/2}))}],lastRivalAt:t.gatesPassed}}function P2(t){if(t.rivals.length===0)return t;const i=t.rivals.map(r=>{const o=Math.min(1,r.frame/gi.ACCEL_FRAMES),u=gi.SPEED_MULT_START+o*(gi.SPEED_MULT_MAX-gi.SPEED_MULT_START),h=t.speed*u,m=r.y+h;let _=r.x;const p=r.gateCenters;let y=r.gateIndex;for(;y<p.length&&m>p[y].y+20;)y++;y<p.length&&(_=p[y].cx);const v=_-r.x,w=Math.min(Math.abs(v),4+o*3),S=r.x+Math.sign(v)*w;return{...r,x:S,y:m,frame:r.frame+1,gateIndex:y}}).filter(r=>ni(r.y,t.worldY)<me.HEIGHT+200);return{...t,rivals:i}}function ni(t,e){return t-e+me.HEIGHT-100}function z2(t){let e=[...t.events],i=t.score,r=t.gatesPassed,o=t.gatesMissed;const u=t.skier.y,h=t.skier.x,m=t.gates.map(p=>p.passed||p.missed?p:ni(p.y,t.worldY)<u-Rn.HEIGHT/2?h>p.leftX&&h<p.rightX?(i+=kn.SCORE_PER_GATE,r+=1,e.push("gate_pass"),{...p,passed:!0}):(o+=1,e.push("gate_miss"),{...p,missed:!0}):p);let _={...t,gates:m,score:i,gatesPassed:r,gatesMissed:o,events:e};return r>0&&r>=_.lastCrowdAt+$n.GATE_INTERVAL&&Math.floor(r/$n.GATE_INTERVAL)>Math.floor(_.lastCrowdAt/$n.GATE_INTERVAL)&&(_=U2(_),_={..._,lastCrowdAt:r,events:[..._.events,"crowd_cheer"]}),r>0&&r>=_.lastRivalAt+gi.GATE_INTERVAL&&Math.floor(r/gi.GATE_INTERVAL)>Math.floor(_.lastRivalAt/gi.GATE_INTERVAL)&&(_=x2(_),_={..._,events:[..._.events,"rival_zoom"]}),_}function U2(t){const e=t.worldY+Rn.START_Y+80,i=[];for(const r of["left","right"])for(let o=0;o<$n.PEOPLE_PER_SIDE;o++){const u=$n.JACKET_COLORS[Math.floor(Math.random()*$n.JACKET_COLORS.length)],h=r==="left"?$n.SIDE_MARGIN+o*$n.SPACING:me.WIDTH-$n.SIDE_MARGIN-(o+1)*$n.SPACING;i.push({side:r,x:h+(Math.random()-.5)*4,offsetY:(Math.random()-.5)*10,color:u,armPhase:Math.random()*Math.PI*2})}return{...t,crowds:[...t.crowds,{y:e,people:i}]}}function B2(t){const e=t.skier,i=e.x-e.width/2,r=e.x+e.width/2,o=e.y-e.height/2,u=e.y+e.height/2;for(const h of t.obstacles){const m=ni(h.y,t.worldY),_=h.x,p=h.x+h.width,y=m-h.height/2,v=m+h.height/2;if(i<p&&r>_&&o<v&&u>y)return{...t,phase:"gameover",events:[...t.events,"crash"]}}return t}function G2(t){return{...t,gates:t.gates.filter(e=>ni(e.y,t.worldY)>kn.DESPAWN_BEHIND),obstacles:t.obstacles.filter(e=>ni(e.y,t.worldY)>kn.DESPAWN_BEHIND),trees:t.trees.filter(e=>ni(e.y,t.worldY)>kn.DESPAWN_BEHIND),crowds:t.crowds.filter(e=>ni(e.y,t.worldY)>kn.DESPAWN_BEHIND-30)}}const Ks="slalom_scores_v1",Ka={name:"Coach Joe",score:1e3,date:"2025-01-01"};function Qs(){return new Date().toISOString().split("T")[0]}function Wm(){try{const t=localStorage.getItem(Ks);if(!t){const r={allTime:Ka,daily:{date:Qs(),record:Ka}};return localStorage.setItem(Ks,JSON.stringify(r)),r}const e=JSON.parse(t),i=Qs();return e.daily.date!==i&&(e.daily={date:i,record:Ka},localStorage.setItem(Ks,JSON.stringify(e))),e}catch{return{allTime:Ka,daily:{date:Qs(),record:Ka}}}}function q2(t,e){const i=Wm(),r=Qs();let o=!1,u=!1,h=!1;const m={name:t,score:e,date:r};return e>Ka.score&&(o=!0),e>i.allTime.score&&(i.allTime=m,h=!0),e>i.daily.record.score&&(i.daily.record=m,u=!0),localStorage.setItem(Ks,JSON.stringify(i)),t2(m).catch(()=>{}),{beatCoachJoe:o,newDailyRecord:u,newAllTimeRecord:h,dailyRecord:i.daily.record,allTimeRecord:i.allTime}}async function Y2(){try{const t=await e2();if(!t||t.length===0)return;const e=Wm(),i=Qs();let r=!1;const o=t.reduce((h,m)=>m.score>h.score?m:h,{score:0});o.score>e.allTime.score&&(e.allTime=o,r=!0);const u=t.filter(h=>h.date===i).reduce((h,m)=>m.score>h.score?m:h,{score:0});u.score>0&&u.score>e.daily.record.score&&(e.daily.record=u,r=!0),r&&localStorage.setItem(Ks,JSON.stringify(e))}catch{}}function j2(){const t={allTime:Ka,daily:{date:Qs(),record:Ka}};return localStorage.setItem(Ks,JSON.stringify(t)),n2().catch(()=>{}),t}function UT(t,e){t.fillStyle=Ye.SNOW_LIGHT,t.fillRect(0,0,me.WIDTH,me.HEIGHT),F2(t,e),W2(t,e),X2(t,e),K2(t,e),Q2(t,e),Z2(t,e),$2(t,e),J2(t,e),e.phase==="ready"&&eI(t),e.phase==="gameover"&&tI(t,e)}function F2(t,e){const o=e.worldY*.5%160;t.fillStyle=Ye.SNOW_DARK;for(let u=-160+o;u<me.HEIGHT;u+=160)t.fillRect(0,u+120,me.WIDTH,40)}function W2(t,e){for(const i of e.trees){const r=ni(i.y,e.worldY),{x:o,size:u}=i;t.fillStyle=Ye.TREE_TRUNK,t.fillRect(o+u/2-3,r,6,u*.4),t.fillStyle=Ye.TREE_LEAVES,t.beginPath(),t.moveTo(o+u/2,r-u*.6),t.lineTo(o,r+2),t.lineTo(o+u,r+2),t.closePath(),t.fill()}}function X2(t,e){const i=Date.now()/150;for(const r of e.crowds){const o=ni(r.y,e.worldY);for(const h of r.people){const m=o+h.offsetY,_=h.x,p=$n.PERSON_WIDTH,y=$n.PERSON_HEIGHT;t.fillStyle="#334",t.fillRect(_,m+y*.6,p*.35,y*.4),t.fillRect(_+p*.65,m+y*.6,p*.35,y*.4),t.fillStyle=h.color,t.fillRect(_,m+y*.2,p,y*.45),t.fillStyle="#ffcc88",t.fillRect(_+p*.15,m,p*.7,y*.25);const v=Math.sin(i+h.armPhase)*.6,w=y*.35,S=m+y*.25,x=_+p/2;t.strokeStyle=h.color,t.lineWidth=2,t.beginPath(),t.moveTo(x-p*.4,S),t.lineTo(x-p*.4-Math.cos(v+.5)*w,S-Math.sin(v+.5)*w),t.stroke(),t.beginPath(),t.moveTo(x+p*.4,S),t.lineTo(x+p*.4+Math.cos(-v+.5)*w,S-Math.sin(-v+.5)*w),t.stroke()}const u=o-20;t.fillStyle="#ffcc00",t.font=sn.SMALL,t.textAlign="center",t.fillText("GO!",38,u),t.fillText("GO!",me.WIDTH-38,u)}}function K2(t,e){for(const i of e.gates){const r=ni(i.y,e.worldY);t.fillStyle=Ye.GATE_POLE,t.fillRect(i.leftX-Tt.POLE_WIDTH/2,r-Tt.POLE_HEIGHT,Tt.POLE_WIDTH,Tt.POLE_HEIGHT),t.fillStyle=i.missed?Ye.MISS_RED:Ye.GATE_LEFT,t.fillRect(i.leftX-Tt.POLE_WIDTH/2,r-Tt.POLE_HEIGHT,Tt.FLAG_WIDTH,Tt.FLAG_HEIGHT),t.fillStyle=Ye.GATE_POLE,t.fillRect(i.rightX-Tt.POLE_WIDTH/2,r-Tt.POLE_HEIGHT,Tt.POLE_WIDTH,Tt.POLE_HEIGHT),t.fillStyle=i.missed?Ye.MISS_RED:Ye.GATE_RIGHT,t.fillRect(i.rightX-Tt.FLAG_WIDTH+Tt.POLE_WIDTH/2,r-Tt.POLE_HEIGHT,Tt.FLAG_WIDTH,Tt.FLAG_HEIGHT),i.passed&&(t.fillStyle=Ye.HUD_GREEN,t.font=sn.SMALL,t.textAlign="center",t.fillText("+"+kn.SCORE_PER_GATE,(i.leftX+i.rightX)/2,r-Tt.POLE_HEIGHT-4))}}function Q2(t,e){for(const i of e.obstacles){const r=ni(i.y,e.worldY);i.type==="rock"?(t.fillStyle=Ye.OBSTACLE_ROCK,t.fillRect(i.x,r-i.height/2,i.width,i.height),t.fillStyle="#666666",t.fillRect(i.x+2,r-i.height/2+2,i.width-4,4)):i.type==="bear"?(t.fillStyle=Ye.OBSTACLE_BEAR,t.fillRect(i.x+4,r-i.height/2+4,i.width-8,i.height-4),t.fillRect(i.x+8,r-i.height/2,i.width-16,10),t.fillStyle="#000000",t.fillRect(i.x+10,r-i.height/2+2,3,3),t.fillRect(i.x+i.width-13,r-i.height/2+2,3,3)):i.type==="skier"&&(t.fillStyle=Ye.OBSTACLE_SKIER,t.fillRect(i.x,r-i.height/2+6,i.width,i.height-6),t.fillStyle="#ffcc88",t.fillRect(i.x+4,r-i.height/2,8,8),t.fillStyle="#333333",t.fillRect(i.x-2,r+i.height/2-3,i.width+4,3))}}function Z2(t,e){for(const i of e.rivals){const r=ni(i.y,e.worldY),o=i.x,u=Rn.WIDTH,h=Rn.HEIGHT;t.fillStyle=gi.BODY_COLOR,t.fillRect(o-u/2,r-h/2+6,u,h-10),t.fillStyle="#ffcc88",t.fillRect(o-4,r-h/2,8,8),t.fillStyle=gi.HELMET_COLOR,t.fillRect(o-5,r-h/2-1,10,5),t.fillStyle=Ye.SKI_SKIS,t.fillRect(o-u/2-2,r+h/2-4,u+4,3),t.fillStyle=gi.HELMET_COLOR,t.font=sn.SMALL,t.textAlign="center",t.fillText(gi.LABEL,o,r-h/2-6)}}function $2(t,e){const{x:i,y:r,width:o,height:u,vx:h}=e.skier;t.fillStyle=Ye.SKI_BODY,t.fillRect(i-o/2,r-u/2+6,o,u-10),t.fillStyle="#ffcc88",t.fillRect(i-4,r-u/2,8,8),t.fillStyle="#4444ff",t.fillRect(i-5,r-u/2-1,10,5),t.fillStyle=Ye.SKI_SKIS;const m=Math.min(3,Math.abs(h))*Math.sign(h);t.fillRect(i-o/2-2+m,r+u/2-4,o+4,3)}function J2(t,e){t.fillStyle=Ye.HUD_BG,t.fillRect(0,0,me.WIDTH,36),t.font=sn.HUD,t.textBaseline="top",t.fillStyle=Ye.HUD_GREEN,t.textAlign="left",t.fillText(`SCORE: ${e.score}`,10,8),t.font=sn.SMALL,t.fillStyle=Ye.TEXT_DIM,t.fillText(`LVL ${e.difficulty}`,10,22),t.font=sn.HUD,t.fillStyle=Ye.HUD_GREEN,t.textAlign="center",t.fillText(`GATES: ${e.gatesPassed}`,me.WIDTH/2,8),t.textAlign="right";let i="";for(let r=0;r<e.maxMisses;r++)r<e.gatesMissed?i+="X ":i+="- ";t.fillStyle=e.gatesMissed>0?Ye.MISS_RED:Ye.HUD_GREEN,t.fillText(i.trim(),me.WIDTH-10,8),t.textBaseline="alphabetic"}function eI(t){t.fillStyle=Ye.OVERLAY_BG,t.fillRect(0,0,me.WIDTH,me.HEIGHT),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Ye.HUD_GREEN,t.font=sn.TITLE,t.fillText("MR. CRAWFORD",me.WIDTH/2,me.HEIGHT/2-140),t.fillText("SLALOM",me.WIDTH/2,me.HEIGHT/2-90),t.fillText("CHALLENGE",me.WIDTH/2,me.HEIGHT/2-40),t.fillStyle=Ye.TEXT_DIM,t.font=sn.SUBTITLE,t.fillText("A SNOWPEAK RESORT PRODUCTION",me.WIDTH/2,me.HEIGHT/2+4),t.fillStyle=Ye.TEXT_WHITE,t.font=sn.OVERLAY,["LEFT/RIGHT arrows to steer","Ski between the gates to score","Miss 5 gates = Game Over","Avoid rocks, bears & skiers!"].forEach((r,o)=>{t.fillText(r,me.WIDTH/2,me.HEIGHT/2+50+o*32)}),t.fillStyle=Ye.HUD_GREEN,t.font=sn.SUBTITLE,Math.floor(Date.now()/500)%2&&t.fillText("PRESS SPACE TO START",me.WIDTH/2,me.HEIGHT/2+220),t.textBaseline="alphabetic"}function tI(t,e){t.fillStyle=Ye.OVERLAY_BG,t.fillRect(0,0,me.WIDTH,me.HEIGHT),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Ye.MISS_RED,t.font=sn.TITLE,t.fillText("GAME OVER",me.WIDTH/2,me.HEIGHT/2-140),t.fillStyle=Ye.HUD_GREEN,t.font=sn.OVERLAY,t.fillText(`FINAL SCORE: ${e.score}`,me.WIDTH/2,me.HEIGHT/2-80),t.fillStyle=Ye.TEXT_WHITE,t.font=sn.SUBTITLE,t.fillText(`Gates Passed: ${e.gatesPassed}`,me.WIDTH/2,me.HEIGHT/2-50),t.fillText(`Difficulty Reached: ${e.difficulty}`,me.WIDTH/2,me.HEIGHT/2-20);const i=Wm();t.fillStyle="#ffcc00",t.font=sn.SUBTITLE,t.fillText("--- HIGH SCORES ---",me.WIDTH/2,me.HEIGHT/2+20),t.fillStyle=Ye.TEXT_WHITE,t.font=sn.SMALL,t.fillText(`TODAY: ${i.daily.record.score} by ${i.daily.record.name}`,me.WIDTH/2,me.HEIGHT/2+50),t.fillText(`ALL-TIME: ${i.allTime.score} by ${i.allTime.name}`,me.WIDTH/2,me.HEIGHT/2+75),e.score>=kn.CHAMPION_SCORE&&(t.fillStyle="#ffcc00",t.font=sn.OVERLAY,t.fillText("CHAMPION RUN!",me.WIDTH/2,me.HEIGHT/2+110)),t.fillStyle=Ye.HUD_GREEN,t.font=sn.SUBTITLE,Math.floor(Date.now()/500)%2&&t.fillText("PRESS SPACE TO PLAY AGAIN",me.WIDTH/2,me.HEIGHT/2+170),t.textBaseline="alphabetic"}function nI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="square",e.frequency.setValueAtTime(880,t.currentTime),e.frequency.linearRampToValueAtTime(1320,t.currentTime+.08),i.gain.setValueAtTime(.12,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.12),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.15),setTimeout(()=>t.close(),500)}catch{}}function iI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(400,t.currentTime),e.frequency.linearRampToValueAtTime(200,t.currentTime+.15),i.gain.setValueAtTime(.1,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.2),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.25),setTimeout(()=>t.close(),600)}catch{}}function aI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=Math.floor(t.sampleRate*.15),i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let m=0;m<e;m++)r[m]=Math.random()*2-1;const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="lowpass",u.frequency.setValueAtTime(800,t.currentTime),u.frequency.exponentialRampToValueAtTime(200,t.currentTime+.12);const h=t.createGain();h.gain.setValueAtTime(.1,t.currentTime),h.gain.exponentialRampToValueAtTime(.01,t.currentTime+.12),o.connect(u),u.connect(h),h.connect(t.destination),o.start(),setTimeout(()=>t.close(),600)}catch{}}function rI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(300,t.currentTime),e.frequency.exponentialRampToValueAtTime(900,t.currentTime+.3),i.gain.setValueAtTime(.08,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.35),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.4),setTimeout(()=>t.close(),800)}catch{}}function sI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:466,start:0,dur:.3},{freq:440,start:.35,dur:.3},{freq:415,start:.7,dur:.3},{freq:370,start:1.05,dur:.6}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sawtooth",r.frequency.setValueAtTime(i.freq,t.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.97,t.currentTime+i.start+i.dur),o.gain.setValueAtTime(0,t.currentTime+i.start),o.gain.linearRampToValueAtTime(.1,t.currentTime+i.start+.03),o.gain.setValueAtTime(.1,t.currentTime+i.start+i.dur*.7),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.05)}setTimeout(()=>t.close(),2500)}catch{}}function oI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=Math.floor(t.sampleRate*.8),i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let p=0;p<e;p++)r[p]=Math.random()*2-1;const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="bandpass",u.frequency.setValueAtTime(1200,t.currentTime),u.frequency.linearRampToValueAtTime(800,t.currentTime+.6),u.Q.value=.8;const h=t.createGain();h.gain.setValueAtTime(0,t.currentTime),h.gain.linearRampToValueAtTime(.12,t.currentTime+.08),h.gain.setValueAtTime(.12,t.currentTime+.3),h.gain.linearRampToValueAtTime(.06,t.currentTime+.5),h.gain.exponentialRampToValueAtTime(.01,t.currentTime+.8),o.connect(u),u.connect(h),h.connect(t.destination),o.start();const m=t.createOscillator(),_=t.createGain();m.type="sine",m.frequency.setValueAtTime(400,t.currentTime),m.frequency.linearRampToValueAtTime(700,t.currentTime+.2),m.frequency.linearRampToValueAtTime(500,t.currentTime+.5),_.gain.setValueAtTime(0,t.currentTime),_.gain.linearRampToValueAtTime(.04,t.currentTime+.05),_.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),m.connect(_),_.connect(t.destination),m.start(),m.stop(t.currentTime+.55),setTimeout(()=>t.close(),1500)}catch{}}function lI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(1200,t.currentTime),e.frequency.exponentialRampToValueAtTime(300,t.currentTime+.3),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.08,t.currentTime+.03),i.gain.setValueAtTime(.08,t.currentTime+.1),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.3),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.35),setTimeout(()=>t.close(),800)}catch{}}function uI(t){const i={gate_pass:nI,gate_miss:iI,crash:aI,speed_up:rI,game_over:sI,crowd_cheer:oI,rival_zoom:lI}[t];i&&i()}function Xm({standalone:t=!1,onGameOver:e}){const i=oe.useRef(null),r=oe.useRef(Cd()),o=oe.useRef(null),u=oe.useCallback(()=>{const p=r.current,y=R2(p);r.current=y;for(const w of y.events)uI(w);const v=i.current;if(v){const w=v.getContext("2d");UT(w,y)}o.current=requestAnimationFrame(u)},[t,e]);oe.useEffect(()=>{const p=i.current;if(p){const y=p.getContext("2d");UT(y,r.current)}return o.current=requestAnimationFrame(u),()=>{o.current&&cancelAnimationFrame(o.current)}},[u]),oe.useEffect(()=>{const p=v=>{const w=r.current;if(v.key===" "||v.code==="Space"){v.preventDefault(),w.phase==="ready"?r.current={...w,phase:"playing"}:w.phase==="gameover"&&(t?r.current={...Cd(),phase:"ready"}:e&&e({score:w.score,gatesPassed:w.gatesPassed,difficulty:w.difficulty}));return}if(v.key==="Escape"){if(v.preventDefault(),!t&&e){const S=r.current;e({score:S.score,gatesPassed:S.gatesPassed,difficulty:S.difficulty})}return}v.key==="ArrowLeft"&&(v.preventDefault(),r.current={...r.current,input:{...r.current.input,left:!0}}),v.key==="ArrowRight"&&(v.preventDefault(),r.current={...r.current,input:{...r.current.input,right:!0}})},y=v=>{v.key==="ArrowLeft"&&(r.current={...r.current,input:{...r.current.input,left:!1}}),v.key==="ArrowRight"&&(r.current={...r.current,input:{...r.current.input,right:!1}})};return window.addEventListener("keydown",p),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",p),window.removeEventListener("keyup",y)}},[t,e]);const h=oe.useCallback(()=>{const p=r.current;p.phase==="ready"?r.current={...p,phase:"playing"}:p.phase==="gameover"&&(t?r.current={...Cd(),phase:"ready"}:e&&e({score:p.score,gatesPassed:p.gatesPassed,difficulty:p.difficulty}))},[t,e]),m=oe.useCallback(p=>{r.current={...r.current,input:{...r.current.input,left:p}}},[]),_=oe.useCallback(p=>{r.current={...r.current,input:{...r.current.input,right:p}}},[]);return C.jsx("div",{className:"slalom-container",children:C.jsxs("div",{className:"arcade-cabinet",children:[C.jsx("div",{className:"arcade-top"}),C.jsx("div",{className:"arcade-marquee",children:"MR. CRAWFORD SLALOM CHALLENGE"}),C.jsx("div",{className:"arcade-screen-bezel",children:C.jsx("canvas",{ref:i,width:me.WIDTH,height:me.HEIGHT,className:"slalom-canvas"})}),C.jsx("div",{className:"arcade-controls",children:C.jsxs("div",{className:"arcade-controls-inner",children:[C.jsx("button",{className:"arcade-touch-btn",onTouchStart:p=>{p.preventDefault(),m(!0)},onTouchEnd:p=>{p.preventDefault(),m(!1)},onMouseDown:()=>m(!0),onMouseUp:()=>m(!1),onMouseLeave:()=>m(!1),children:""}),C.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:p=>{p.preventDefault(),h()},onMouseDown:h,children:"START"}),C.jsx("button",{className:"arcade-touch-btn",onTouchStart:p=>{p.preventDefault(),_(!0)},onTouchEnd:p=>{p.preventDefault(),_(!1)},onMouseDown:()=>_(!0),onMouseUp:()=>_(!1),onMouseLeave:()=>_(!1),children:""})]})}),C.jsx("div",{className:"arcade-base"})]})})}const ie={WIDTH:480,HEIGHT:640},Te={SKY_TOP:"#1a0a2e",SKY_BOTTOM:"#2d1b4e",GROUND:"#2a4a1a",GROUND_DARK:"#1e3a12",SNOW_CAPS:"#ccccdd",MOUNTAIN:"#3a3a5a",MOUNTAIN_DARK:"#2a2a4a",TREE_TRUNK:"#553311",TREE_LEAVES:"#1a5522",CABIN_WALL:"#885533",CABIN_ROOF:"#553322",CABIN_WINDOW:"#ffcc44",RETICLE:"#ff3333",MUZZLE_FLASH:"#ffff88",HUD_GREEN:"#33ff33",HUD_BG:"rgba(0,0,0,0.6)",OVERLAY_BG:"rgba(0,0,0,0.85)",TEXT_WHITE:"#ffffff",TEXT_DIM:"#88ff88",MISS_RED:"#ff4444",WOLF_BODY:"#777788",WOLF_DARK:"#555566",WOLF_EYE:"#ffcc00",BEAR_BODY:"#664422",BEAR_DARK:"#553311",BEAR_EYE:"#ff4444",HIT_FLASH:"#ffffff",HEALTH_GREEN:"#33ff33",HEALTH_YELLOW:"#ffcc00",HEALTH_RED:"#ff3333",BOSS_GLOW:"#ff2200"},un={HUD:"20px VT323, monospace",TITLE:"48px VT323, monospace",SUBTITLE:"24px VT323, monospace",OVERLAY:"28px VT323, monospace",SMALL:"18px VT323, monospace"},rm={SIZE:20,SPEED:5,LINE_WIDTH:2},De={TOTAL_ANIMALS:20,SPAWN_INTERVAL_START:120,SPAWN_INTERVAL_MIN:45,WOLF_SPEED_MIN:.24,WOLF_SPEED_MAX:.64,BEAR_SPEED_MIN:.18,BEAR_SPEED_MAX:.48,SCALE_MIN:.12,SCALE_MAX:2.5,REACH_SCALE:2.2,HIT_RADIUS_MULT:.5,WOLF_WIDTH:40,WOLF_HEIGHT:28,BEAR_WIDTH:36,BEAR_HEIGHT:55,BEAR_CHANCE:.25,RETREAT_SPEED:3,RETREAT_DURATION:60,FLASH_DURATION:4,SHOT_COOLDOWN:12,AMMO_MAX:5,RELOAD_TIME:90,BOSS_HP:20,BOSS_SIZE_MULT:2,BOSS_SPEED_MIN:.144,BOSS_SPEED_MAX:.384,BOSS_SPAWN_DELAY:90},dt={HORIZON_Y:280,GROUND_TOP:280,PLAYER_Y:620,SPAWN_Y_MIN:288,SPAWN_Y_MAX:310,SPAWN_X_MIN:100,SPAWN_X_MAX:380,GUN_X:240};function Oc(){return{phase:"ready",reticle:{x:ie.WIDTH/2,y:ie.HEIGHT/2},animals:[],animalsSpawned:0,animalsDefeated:0,totalAnimals:De.TOTAL_ANIMALS,frameCount:0,startTime:0,elapsedMs:0,lastSpawnFrame:0,shotCooldown:0,muzzleFlash:0,lastShotX:0,lastShotY:0,input:{left:!1,right:!1,up:!1,down:!1},events:[],ammo:De.AMMO_MAX,reloading:!1,reloadTimer:0,halfwayShown:!1,halfwayTimer:0,bossPhase:!1,bossSpawned:!1,bossDefeated:!1,bossDelayTimer:0}}function cI(t){if(t.phase!=="playing")return t;let e={...t,events:[],frameCount:t.frameCount+1};e.elapsedMs=Date.now()-e.startTime,e=hI(e),e.bossPhase||(e=fI(e)),e.bossPhase&&!e.bossSpawned&&e.animals.filter(r=>r.state!=="gone").length===0&&(e.bossDelayTimer<=0?e=dI(e):e={...e,bossDelayTimer:e.bossDelayTimer-1}),e=mI(e),e.shotCooldown>0&&(e={...e,shotCooldown:e.shotCooldown-1}),e.muzzleFlash>0&&(e={...e,muzzleFlash:e.muzzleFlash-1}),e.reloading&&(e.reloadTimer<=0?e={...e,reloading:!1,ammo:De.AMMO_MAX,events:[...e.events,"reload_done"]}:e={...e,reloadTimer:e.reloadTimer-1}),e.halfwayTimer>0&&(e={...e,halfwayTimer:e.halfwayTimer-1});for(const i of e.animals)if(i.state==="approaching"&&i.scale>=De.REACH_SCALE)return e={...e,phase:"gameover",events:[...e.events,"game_over"]},e;return!e.halfwayShown&&e.animalsDefeated>=Math.floor(e.totalAnimals/2)&&(e={...e,halfwayShown:!0,halfwayTimer:120,events:[...e.events,"halfway"]}),!e.bossPhase&&e.animalsDefeated>=e.totalAnimals&&(e={...e,bossPhase:!0,bossDelayTimer:De.BOSS_SPAWN_DELAY,events:[...e.events,"boss_incoming"]}),e.bossDefeated&&e.animals.filter(r=>r.state!=="gone").length===0&&(e={...e,phase:"victory",events:[...e.events,"victory"]}),e}function Md(t){if(t.phase!=="playing"||t.shotCooldown>0||t.reloading||t.ammo<=0)return t;const e=t.ammo-1;let i={...t,shotCooldown:De.SHOT_COOLDOWN,muzzleFlash:De.FLASH_DURATION,lastShotX:t.reticle.x,lastShotY:t.reticle.y,ammo:e,events:[...t.events,"shoot"]};e<=0&&(i={...i,reloading:!0,reloadTimer:De.RELOAD_TIME});const r=i.animals.map((o,u)=>({...o,idx:u})).filter(o=>o.state==="approaching").sort((o,u)=>u.scale-o.scale);for(const o of r){const m=(o.type==="wolf"?De.WOLF_WIDTH:De.BEAR_WIDTH)*o.scale*(o.sizeMult||1)*De.HIT_RADIUS_MULT,_=i.reticle.x-o.x,p=i.reticle.y-o.y;if(Math.sqrt(_*_+p*p)<m){const v=[...i.animals],w={...v[o.idx]};if(w.hp-=1,w.hitFlash=8,w.hp<=0){w.state="retreating",w.retreatDir=o.x<ie.WIDTH/2?-1:1,w.retreatTimer=De.RETREAT_DURATION;const S=o.type==="boss",x=o.type==="wolf"?"wolf_whimper":S?"boss_defeat":"bear_roar";i={...i,animalsDefeated:i.animalsDefeated+1,bossDefeated:S?!0:i.bossDefeated,events:[...i.events,x]}}else i={...i,events:[...i.events,"hit"]};v[o.idx]=w,i={...i,animals:v};break}}return i}function hI(t){let{x:e,y:i}=t.reticle;const r=rm.SPEED;return t.input.left&&(e-=r),t.input.right&&(e+=r),t.input.up&&(i-=r),t.input.down&&(i+=r),e=Math.max(10,Math.min(ie.WIDTH-10,e)),i=Math.max(dt.HORIZON_Y,Math.min(ie.HEIGHT-30,i)),{...t,reticle:{x:e,y:i}}}function fI(t){if(t.animalsSpawned>=t.totalAnimals)return t;const e=t.animalsSpawned/t.totalAnimals,i=De.SPAWN_INTERVAL_START-e*(De.SPAWN_INTERVAL_START-De.SPAWN_INTERVAL_MIN);if(t.frameCount-t.lastSpawnFrame<i)return t;const o=Math.random()<De.BEAR_CHANCE?"bear":"wolf",u=dt.SPAWN_X_MIN+Math.random()*(dt.SPAWN_X_MAX-dt.SPAWN_X_MIN),h=dt.SPAWN_Y_MIN+Math.random()*(dt.SPAWN_Y_MAX-dt.SPAWN_Y_MIN),m=o==="bear"?De.BEAR_SPEED_MIN:De.WOLF_SPEED_MIN,_=o==="bear"?De.BEAR_SPEED_MAX:De.WOLF_SPEED_MAX,p=m+Math.random()*(_-m),y=1+e*.5,v={type:o,x:u,y:h,startX:u,startY:h,scale:De.SCALE_MIN,sizeMult:1,approachSpeed:p*y,hp:o==="wolf"?1:3,maxHp:o==="wolf"?1:3,state:"approaching",retreatDir:0,retreatTimer:0,hitFlash:0,drift:(Math.random()-.5)*.8,wobble:Math.random()*Math.PI*2};return{...t,animals:[...t.animals,v],animalsSpawned:t.animalsSpawned+1,lastSpawnFrame:t.frameCount,events:[...t.events,o==="bear"?"bear_spawn":"wolf_spawn"]}}function dI(t){const e=ie.WIDTH/2,i=dt.SPAWN_Y_MIN+5,r=De.BOSS_SPEED_MIN+Math.random()*(De.BOSS_SPEED_MAX-De.BOSS_SPEED_MIN),o={type:"boss",x:e,y:i,startX:e,startY:i,scale:De.SCALE_MIN,sizeMult:De.BOSS_SIZE_MULT,approachSpeed:r,hp:De.BOSS_HP,maxHp:De.BOSS_HP,state:"approaching",retreatDir:0,retreatTimer:0,hitFlash:0,drift:0,wobble:0};return{...t,animals:[...t.animals,o],bossSpawned:!0,events:[...t.events,"boss_roar"]}}function mI(t){const i=t.animals.map(r=>{if(r.hitFlash>0&&(r={...r,hitFlash:r.hitFlash-1}),r.state==="approaching"){const o=r.scale+r.approachSpeed*.008,u=(o-De.SCALE_MIN)/(De.SCALE_MAX-De.SCALE_MIN),h=r.startY+u*(dt.PLAYER_Y-r.startY),m=Math.sin(r.wobble+t.frameCount*.03)*15*r.scale,_=r.startX+r.drift*u*80+m;return{...r,scale:o,y:h,x:_}}if(r.state==="retreating"){const o=r.retreatTimer-1;if(o<=0)return{...r,state:"gone"};const u=r.x+r.retreatDir*De.RETREAT_SPEED,h=r.scale*.995;return{...r,x:u,retreatTimer:o,scale:h}}return r}).filter(r=>r.state!=="gone");return{...t,animals:i}}function BT(t,e){_I(t),pI(t),gI(t),yI(t),TI(t,e),e.muzzleFlash>0&&bI(t,e),e.phase==="playing"&&wI(t,e),e.phase==="playing"&&AI(t,e),e.phase==="playing"&&SI(t,e),e.phase==="playing"&&RI(t,e),e.phase==="playing"&&e.halfwayTimer>0&&II(t,e),e.phase==="ready"&&kI(t),e.phase==="gameover"&&OI(t,e),e.phase==="victory"&&DI(t,e)}function _I(t){const e=t.createLinearGradient(0,0,0,dt.HORIZON_Y);e.addColorStop(0,Te.SKY_TOP),e.addColorStop(1,Te.SKY_BOTTOM),t.fillStyle=e,t.fillRect(0,0,ie.WIDTH,dt.HORIZON_Y),t.fillStyle="#ffffff";const i=[[45,30],[120,55],[200,20],[280,65],[350,35],[410,50],[70,90],[160,110],[300,100],[440,80],[30,140],[240,130],[380,150],[90,170],[460,160],[55,210],[180,230],[320,215],[420,240],[140,255],[260,200],[400,190],[75,260],[350,265],[460,225]];for(const[r,o]of i)if(o<dt.HORIZON_Y-20){const u=Math.sin(Date.now()*.003+r)>.3?2:1;t.fillRect(r,o,u,u)}}function pI(t){const e=dt.HORIZON_Y;t.fillStyle=Te.MOUNTAIN_DARK,t.beginPath(),t.moveTo(0,e),t.lineTo(60,e-130),t.lineTo(140,e-90),t.lineTo(200,e-155),t.lineTo(280,e-100),t.lineTo(360,e-165),t.lineTo(420,e-110),t.lineTo(ie.WIDTH,e-120),t.lineTo(ie.WIDTH,e),t.closePath(),t.fill(),t.fillStyle=Te.SNOW_CAPS,GT(t,200,e-155,30),GT(t,360,e-165,25),t.fillStyle=Te.MOUNTAIN,t.beginPath(),t.moveTo(0,e),t.lineTo(30,e-85),t.lineTo(100,e-65),t.lineTo(170,e-95),t.lineTo(240,e-60),t.lineTo(310,e-80),t.lineTo(400,e-70),t.lineTo(ie.WIDTH,e-75),t.lineTo(ie.WIDTH,e),t.closePath(),t.fill()}function GT(t,e,i,r){t.beginPath(),t.moveTo(e,i),t.lineTo(e-r*.6,i+r*.4),t.lineTo(e+r*.6,i+r*.4),t.closePath(),t.fill()}function gI(t,e){t.fillStyle=Te.GROUND,t.fillRect(0,dt.GROUND_TOP,ie.WIDTH,ie.HEIGHT-dt.GROUND_TOP),t.fillStyle=Te.GROUND_DARK;for(let i=dt.GROUND_TOP+15;i<ie.HEIGHT;i+=30){const o=2+(i-dt.GROUND_TOP)/(ie.HEIGHT-dt.GROUND_TOP)*6;t.fillRect(0,i,ie.WIDTH,o)}t.fillStyle="#3a3a2a",t.beginPath(),t.moveTo(ie.WIDTH/2-4,dt.HORIZON_Y),t.lineTo(ie.WIDTH/2-120,ie.HEIGHT),t.lineTo(ie.WIDTH/2+120,ie.HEIGHT),t.lineTo(ie.WIDTH/2+4,dt.HORIZON_Y),t.closePath(),t.fill()}function yI(t){const e=dt.HORIZON_Y+30;qT(t,60,e+10,.5),qT(t,370,e+15,.45),zs(t,30,e+5,.55),zs(t,440,e+10,.6),zs(t,130,e+25,.45),zs(t,340,e+20,.5),zs(t,15,e+80,.9),zs(t,455,e+70,.85),t.fillStyle="#886644";const i=e+50;for(let r=60;r<ie.WIDTH-60;r+=45)t.fillRect(r,i,3,14);t.fillStyle="#775533",t.fillRect(60,i+3,ie.WIDTH-120,2),t.fillRect(60,i+9,ie.WIDTH-120,2)}function qT(t,e,i,r){const o=60*r,u=35*r,h=20*r;t.fillStyle=Te.CABIN_WALL,t.fillRect(e,i,o,u),t.fillStyle=Te.CABIN_ROOF,t.beginPath(),t.moveTo(e-5*r,i),t.lineTo(e+o/2,i-h),t.lineTo(e+o+5*r,i),t.closePath(),t.fill(),t.fillStyle=Te.CABIN_WINDOW,t.fillRect(e+o*.3,i+u*.25,o*.15,u*.3),t.fillRect(e+o*.55,i+u*.25,o*.15,u*.3),t.fillStyle="#442211",t.fillRect(e+o*.4,i+u*.5,o*.2,u*.5)}function zs(t,e,i,r){const o=6*r,u=20*r,h=24*r,m=30*r;t.fillStyle=Te.TREE_TRUNK,t.fillRect(e-o/2,i,o,u),t.fillStyle=Te.TREE_LEAVES;for(let _=0;_<3;_++){const p=h*(1-_*.25),y=i-m*.3*_;t.beginPath(),t.moveTo(e,y-m*.4),t.lineTo(e-p/2,y+m*.2),t.lineTo(e+p/2,y+m*.2),t.closePath(),t.fill()}}function TI(t,e){const i=[...e.animals].sort((r,o)=>r.scale-o.scale);for(const r of i)r.type==="wolf"?EI(t,r):vI(t,r);e.bossPhase&&!e.bossSpawned&&Math.floor(Date.now()/300)%2&&(t.save(),t.fillStyle=Te.BOSS_GLOW,t.font=un.SUBTITLE,t.textAlign="center",t.textBaseline="middle",t.fillText("!! BOSS APPROACHING !!",ie.WIDTH/2,ie.HEIGHT/2),t.restore())}function EI(t,e){const{x:i,y:r,scale:o,hitFlash:u,state:h}=e,m=De.WOLF_WIDTH*o,_=De.WOLF_HEIGHT*o;t.save(),u>0&&u%2===0&&(t.globalAlpha=.5);const p=u>0,y=p?Te.HIT_FLASH:Te.WOLF_BODY,v=p?Te.HIT_FLASH:Te.WOLF_DARK,w=h==="retreating"?e.retreatDir*.35:0;t.fillStyle="rgba(0,0,0,0.3)",t.beginPath(),t.ellipse(i,r+_*.45,m*.4,_*.1,0,0,Math.PI*2),t.fill();const S=Math.sin(Date.now()*.008+e.wobble)*m*.06;t.fillStyle=v,t.beginPath(),t.moveTo(i-m*.35,r-_*.15),t.quadraticCurveTo(i-m*.6+S,r-_*.7,i-m*.45+S,r-_*.55),t.lineTo(i-m*.35,r-_*.1),t.closePath(),t.fill(),t.fillStyle=y,t.beginPath(),t.moveTo(i-m*.35,r-_*.1),t.lineTo(i-m*.3,r-_*.35),t.lineTo(i+m*.15,r-_*.4),t.lineTo(i+m*.3,r-_*.2),t.lineTo(i+m*.25,r+_*.15),t.lineTo(i-m*.3,r+_*.15),t.closePath(),t.fill(),t.fillStyle=v,t.beginPath(),t.moveTo(i-m*.3,r-_*.35),t.lineTo(i+m*.1,r-_*.4),t.lineTo(i+m*.1,r-_*.3),t.lineTo(i-m*.3,r-_*.25),t.closePath(),t.fill(),t.fillStyle=v;const x=Math.sin(Date.now()*.012+e.wobble)*m*.1;t.fillRect(i+m*.12+x,r+_*.05,m*.06,_*.42),t.fillRect(i+m*.22-x,r+_*.05,m*.06,_*.42),t.fillRect(i-m*.25-x,r+_*.05,m*.07,_*.42),t.fillRect(i-m*.12+x,r+_*.05,m*.07,_*.42),t.fillRect(i+m*.1+x,r+_*.42,m*.1,_*.06),t.fillRect(i+m*.2-x,r+_*.42,m*.1,_*.06),t.fillRect(i-m*.27-x,r+_*.42,m*.1,_*.06),t.fillRect(i-m*.14+x,r+_*.42,m*.1,_*.06);const V=i+m*(.3+w*.5),H=r-_*.25;t.fillStyle=y,t.beginPath(),t.moveTo(i+m*.15,r-_*.4),t.lineTo(V+m*.05,H-_*.3),t.lineTo(V+m*.12,H-_*.15),t.lineTo(i+m*.3,r-_*.2),t.closePath(),t.fill();const Q=V+m*.05+w*m*.1,$=H-_*.35;if(t.fillStyle=v,t.beginPath(),t.moveTo(Q-m*.12,$),t.lineTo(Q+m*.12,$),t.lineTo(Q+m*.1,$+_*.25),t.lineTo(Q-m*.1,$+_*.25),t.closePath(),t.fill(),t.fillStyle=y,t.beginPath(),t.moveTo(Q+m*.12,$+_*.08),t.lineTo(Q+m*.3,$+_*.18),t.lineTo(Q+m*.12,$+_*.22),t.closePath(),t.fill(),t.fillStyle="#111111",t.beginPath(),t.arc(Q+m*.28,$+_*.18,Math.max(1.5,m*.03),0,Math.PI*2),t.fill(),t.fillStyle=v,t.beginPath(),t.moveTo(Q-m*.08,$),t.lineTo(Q-m*.14,$-_*.25),t.lineTo(Q-m*.01,$+_*.02),t.closePath(),t.fill(),t.beginPath(),t.moveTo(Q+m*.05,$),t.lineTo(Q+m*.1,$-_*.25),t.lineTo(Q+m*.14,$+_*.02),t.closePath(),t.fill(),t.fillStyle="#998877",t.beginPath(),t.moveTo(Q-m*.07,$+_*.01),t.lineTo(Q-m*.12,$-_*.18),t.lineTo(Q-m*.02,$+_*.02),t.closePath(),t.fill(),t.beginPath(),t.moveTo(Q+m*.06,$+_*.01),t.lineTo(Q+m*.09,$-_*.18),t.lineTo(Q+m*.13,$+_*.02),t.closePath(),t.fill(),o>.25){t.fillStyle=Te.WOLF_EYE;const le=Math.max(2,m*.06);t.fillRect(Q+m*.02,$+_*.06,le,le),t.fillStyle="#111111",t.fillRect(Q+m*.03,$+_*.07,Math.max(1,le*.5),Math.max(1,le*.5))}if(o>.6){t.fillStyle="#331111",t.beginPath(),t.moveTo(Q+m*.12,$+_*.22),t.lineTo(Q+m*.28,$+_*.24),t.lineTo(Q+m*.12,$+_*.3),t.closePath(),t.fill(),t.fillStyle="#eeeeee";for(let le=0;le<3;le++)t.fillRect(Q+m*.14+le*m*.04,$+_*.22,m*.015,_*.04)}t.restore()}function vI(t,e){const{x:i,y:r,scale:o,hitFlash:u,state:h,hp:m,maxHp:_}=e,p=e.sizeMult||1,y=e.type==="boss",v=De.BEAR_WIDTH*o*p,w=De.BEAR_HEIGHT*o*p;t.save(),u>0&&u%2===0&&(t.globalAlpha=.5);const S=u>0,x=S?Te.HIT_FLASH:Te.BEAR_BODY,V=S?Te.HIT_FLASH:Te.BEAR_DARK;if(y&&h==="approaching"){t.save();const ce=.15+Math.sin(Date.now()*.005)*.1;t.globalAlpha=ce,t.fillStyle=Te.BOSS_GLOW,t.beginPath(),t.ellipse(i,r-w*.1,v*.6,w*.5,0,0,Math.PI*2),t.fill(),t.restore()}t.fillStyle="rgba(0,0,0,0.3)",t.beginPath(),t.ellipse(i,r+w*.45,v*.35,w*.08,0,0,Math.PI*2),t.fill();const H=Math.sin(Date.now()*.008+e.wobble)*v*.06;t.fillStyle=V,t.fillRect(i-v*.22+H,r+w*.15,v*.18,w*.3),t.fillRect(i+v*.04-H,r+w*.15,v*.18,w*.3),t.fillStyle=V,t.fillRect(i-v*.25+H,r+w*.42,v*.22,w*.06),t.fillRect(i+v*.02-H,r+w*.42,v*.22,w*.06),t.fillStyle=x,t.beginPath(),t.ellipse(i,r-w*.05,v*.35,w*.28,0,0,Math.PI*2),t.fill(),t.fillStyle=S?Te.HIT_FLASH:"#886644",t.beginPath(),t.ellipse(i,r+w*.02,v*.2,w*.15,0,0,Math.PI*2),t.fill();const Q=Math.sin(Date.now()*.006+e.wobble)*.15;t.fillStyle=x,t.save(),t.translate(i-v*.3,r-w*.2),t.rotate(-.8+Q),t.fillRect(0,0,v*.12,w*.3),t.fillStyle=V,t.fillRect(-v*.03,-w*.05,v*.18,w*.08),t.fillStyle="#ccccaa";for(let ce=0;ce<3;ce++)t.fillRect(v*.01+ce*v*.05,-w*.1,v*.02,w*.06);t.restore(),t.fillStyle=x,t.save(),t.translate(i+v*.3,r-w*.2),t.rotate(.8-Q),t.fillRect(-v*.12,0,v*.12,w*.3),t.fillStyle=V,t.fillRect(-v*.15,-w*.05,v*.18,w*.08),t.fillStyle="#ccccaa";for(let ce=0;ce<3;ce++)t.fillRect(-v*.1+ce*v*.05,-w*.1,v*.02,w*.06);t.restore();const $=h==="retreating"?e.retreatDir*v*.1:0;if(t.fillStyle=V,t.beginPath(),t.ellipse(i+$,r-w*.35,v*.22,w*.13,0,0,Math.PI*2),t.fill(),t.fillStyle=x,t.beginPath(),t.arc(i-v*.16+$,r-w*.45,v*.08,0,Math.PI*2),t.arc(i+v*.16+$,r-w*.45,v*.08,0,Math.PI*2),t.fill(),t.fillStyle="#996655",t.beginPath(),t.arc(i-v*.16+$,r-w*.45,v*.04,0,Math.PI*2),t.arc(i+v*.16+$,r-w*.45,v*.04,0,Math.PI*2),t.fill(),t.fillStyle="#886644",t.beginPath(),t.ellipse(i+$,r-w*.31,v*.1,w*.05,0,0,Math.PI*2),t.fill(),t.fillStyle="#222222",t.fillRect(i-v*.03+$,r-w*.33,v*.06,w*.03),o>.25){t.fillStyle=Te.BEAR_EYE;const ce=Math.max(2,v*.06);t.fillRect(i-v*.12+$,r-w*.38,ce,ce),t.fillRect(i+v*.06+$,r-w*.38,ce,ce)}if(o>.6){t.fillStyle="#441111",t.fillRect(i-v*.06+$,r-w*.28,v*.12,w*.04),t.fillStyle="#eeeeee";for(let ce=0;ce<3;ce++)t.fillRect(i-v*.04+ce*v*.04+$,r-w*.28,v*.02,w*.02)}if(t.restore(),y?h==="approaching"&&o>.2:h==="approaching"&&m<_&&o>.25){const ce=v*.6,ot=Math.max(3,5*o*p),ze=i-ce/2,O=r-w*.55;y&&o>.3&&(t.fillStyle=Te.BOSS_GLOW,t.font=un.SMALL,t.textAlign="center",t.textBaseline="bottom",t.fillText("BOSS",i,O-2)),t.fillStyle="#333333",t.fillRect(ze,O,ce,ot);const R=m/_;t.fillStyle=R>.5?Te.HEALTH_GREEN:R>.25?Te.HEALTH_YELLOW:Te.HEALTH_RED,t.fillRect(ze,O,ce*R,ot)}}function wI(t,e){const i=dt.GUN_X,r=ie.HEIGHT,o=(e.reticle.x-ie.WIDTH/2)*.15,u=(e.reticle.y-ie.HEIGHT/2)*.05;if(t.save(),t.translate(o,u),t.fillStyle="#333344",t.beginPath(),t.moveTo(i-8,r),t.lineTo(i-6,r-80),t.lineTo(i+6,r-80),t.lineTo(i+8,r),t.closePath(),t.fill(),t.fillStyle="#444466",t.fillRect(i-2,r-80,4,80),t.fillStyle="#222233",t.beginPath(),t.ellipse(i,r-80,7,4,0,0,Math.PI*2),t.fill(),t.fillStyle="#664422",t.beginPath(),t.moveTo(i-8,r),t.lineTo(i-20,r),t.lineTo(i-14,r-30),t.lineTo(i-8,r-20),t.closePath(),t.fill(),t.fillStyle="#664422",t.beginPath(),t.moveTo(i+8,r),t.lineTo(i+20,r),t.lineTo(i+14,r-30),t.lineTo(i+8,r-20),t.closePath(),t.fill(),t.fillStyle="#cc9966",t.beginPath(),t.ellipse(i-12,r-35,8,6,-.3,0,Math.PI*2),t.fill(),t.beginPath(),t.ellipse(i+10,r-20,7,6,.3,0,Math.PI*2),t.fill(),e.muzzleFlash>0){const h=e.muzzleFlash/De.FLASH_DURATION;t.globalAlpha=h*.6,t.fillStyle=Te.MUZZLE_FLASH,t.beginPath(),t.arc(i,r-85,12+(De.FLASH_DURATION-e.muzzleFlash)*4,0,Math.PI*2),t.fill(),t.globalAlpha=1}t.restore()}function bI(t,e){t.save(),t.globalAlpha=e.muzzleFlash/De.FLASH_DURATION,t.fillStyle=Te.MUZZLE_FLASH,t.beginPath(),t.arc(e.lastShotX,e.lastShotY,8+(De.FLASH_DURATION-e.muzzleFlash)*3,0,Math.PI*2),t.fill(),t.restore()}function AI(t,e){const{x:i,y:r}=e.reticle,o=rm.SIZE;t.strokeStyle=Te.RETICLE,t.lineWidth=rm.LINE_WIDTH,t.beginPath(),t.arc(i,r,o,0,Math.PI*2),t.stroke(),t.beginPath(),t.moveTo(i-o-6,r),t.lineTo(i-o*.4,r),t.moveTo(i+o*.4,r),t.lineTo(i+o+6,r),t.moveTo(i,r-o-6),t.lineTo(i,r-o*.4),t.moveTo(i,r+o*.4),t.lineTo(i,r+o+6),t.stroke(),t.fillStyle=Te.RETICLE,t.fillRect(i-1,r-1,3,3)}function SI(t,e){if(t.fillStyle=Te.HUD_BG,t.fillRect(0,0,ie.WIDTH,36),t.font=un.HUD,t.textBaseline="top",t.fillStyle=e.bossPhase?Te.BOSS_GLOW:Te.HUD_GREEN,t.textAlign="left",e.bossPhase){const i=e.animals.find(r=>r.type==="boss");i&&i.state==="approaching"?t.fillText(`BOSS HP: ${i.hp}/${i.maxHp}`,10,8):e.bossSpawned?t.fillText("BOSS DEFEATED!",10,8):t.fillText("BOSS INCOMING...",10,8)}else{const i=e.totalAnimals-e.animalsDefeated;t.fillText(`HOSTILES: ${i}`,10,8)}t.textAlign="center",t.fillText(Km(e.elapsedMs),ie.WIDTH/2,8),t.textAlign="right",t.fillText(`DEFEATED: ${e.animalsDefeated}/${e.totalAnimals}`,ie.WIDTH-10,8),t.textBaseline="alphabetic"}function RI(t,e){const u=ie.WIDTH-20-De.AMMO_MAX*13,h=ie.HEIGHT-45;for(let m=0;m<De.AMMO_MAX;m++){const _=u+m*13;m<e.ammo?(t.fillStyle="#cc9933",t.fillRect(_,h+6,8,16),t.fillStyle="#aa7722",t.beginPath(),t.moveTo(_,h+6),t.lineTo(_+8/2,h),t.lineTo(_+8,h+6),t.closePath(),t.fill(),t.fillStyle="#886622",t.fillRect(_+1,h+22-3,6,3)):(t.strokeStyle="#555555",t.lineWidth=1,t.strokeRect(_,h,8,22))}e.reloading&&Math.floor(Date.now()/200)%2&&(t.fillStyle=Te.MISS_RED,t.font=un.SUBTITLE,t.textAlign="right",t.textBaseline="bottom",t.fillText("RELOAD",ie.WIDTH-15,h-5))}function II(t,e){const i=Math.min(1,e.halfwayTimer/30);t.save(),t.globalAlpha=i,t.fillStyle="rgba(0, 80, 0, 0.7)",t.fillRect(0,ie.HEIGHT/2-25,ie.WIDTH,50),t.fillStyle=Te.HUD_GREEN,t.font=un.TITLE,t.textAlign="center",t.textBaseline="middle",t.fillText("HALF WAY DONE!",ie.WIDTH/2,ie.HEIGHT/2),t.restore()}function Km(t){const e=Math.floor(t/1e3),i=Math.floor(e/60),r=e%60;return`${String(i).padStart(2,"0")}:${String(r).padStart(2,"0")}`}function kI(t){t.fillStyle=Te.OVERLAY_BG,t.fillRect(0,0,ie.WIDTH,ie.HEIGHT),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Te.HUD_GREEN,t.font=un.TITLE,t.fillText("DEFEND",ie.WIDTH/2,ie.HEIGHT/2-150),t.fillText("THE VILLAGE",ie.WIDTH/2,ie.HEIGHT/2-100),t.fillStyle=Te.TEXT_DIM,t.font=un.SUBTITLE,t.fillText("A SNOWPEAK RESORT PRODUCTION",ie.WIDTH/2,ie.HEIGHT/2-55),t.fillStyle=Te.TEXT_WHITE,t.font=un.OVERLAY,["Tap or click to aim & shoot!","Or: Arrow keys + SPACE","5 shots per clip  auto-reloads!","Wolves: 1 hit  |  Bears: 3 hits","Don't let them reach the village!"].forEach((r,o)=>{t.fillText(r,ie.WIDTH/2,ie.HEIGHT/2+o*34)}),t.fillStyle=Te.HUD_GREEN,t.font=un.SUBTITLE,Math.floor(Date.now()/500)%2&&t.fillText("TAP or PRESS SPACE TO START",ie.WIDTH/2,ie.HEIGHT/2+220),t.textBaseline="alphabetic"}function OI(t,e){t.fillStyle=Te.OVERLAY_BG,t.fillRect(0,0,ie.WIDTH,ie.HEIGHT),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Te.MISS_RED,t.font=un.TITLE,t.fillText("GAME OVER",ie.WIDTH/2,ie.HEIGHT/2-100),t.fillStyle=Te.TEXT_WHITE,t.font=un.OVERLAY,t.fillText("A wild animal reached the village!",ie.WIDTH/2,ie.HEIGHT/2-40),t.fillStyle=Te.HUD_GREEN,t.font=un.SUBTITLE,t.fillText(`Animals Defeated: ${e.animalsDefeated}/${e.totalAnimals}`,ie.WIDTH/2,ie.HEIGHT/2+10),t.fillText(`Time: ${Km(e.elapsedMs)}`,ie.WIDTH/2,ie.HEIGHT/2+40),t.fillStyle=Te.HUD_GREEN,t.font=un.SUBTITLE,Math.floor(Date.now()/500)%2&&t.fillText("TAP or PRESS SPACE TO CONTINUE",ie.WIDTH/2,ie.HEIGHT/2+120),t.textBaseline="alphabetic"}function DI(t,e){t.fillStyle=Te.OVERLAY_BG,t.fillRect(0,0,ie.WIDTH,ie.HEIGHT),t.textAlign="center",t.textBaseline="middle",t.fillStyle="#ffcc00",t.font=un.TITLE,t.fillText("VICTORY!",ie.WIDTH/2,ie.HEIGHT/2-100),t.fillStyle=Te.TEXT_WHITE,t.font=un.OVERLAY,t.fillText("The village is safe!",ie.WIDTH/2,ie.HEIGHT/2-40),t.fillStyle=Te.HUD_GREEN,t.font=un.SUBTITLE,t.fillText(`${e.totalAnimals} animals + BOSS defeated!`,ie.WIDTH/2,ie.HEIGHT/2+10),t.fillText(`Time: ${Km(e.elapsedMs)}`,ie.WIDTH/2,ie.HEIGHT/2+40),t.fillStyle=Te.HUD_GREEN,t.font=un.SUBTITLE,Math.floor(Date.now()/500)%2&&t.fillText("TAP or PRESS SPACE TO CONTINUE",ie.WIDTH/2,ie.HEIGHT/2+120),t.textBaseline="alphabetic"}function NI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="square",e.frequency.setValueAtTime(800,t.currentTime),e.frequency.exponentialRampToValueAtTime(200,t.currentTime+.05),i.gain.setValueAtTime(.15,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.08),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.1);const r=Math.floor(t.sampleRate*.03),o=t.createBuffer(1,r,t.sampleRate),u=o.getChannelData(0);for(let _=0;_<r;_++)u[_]=(Math.random()*2-1)*(1-_/r);const h=t.createBufferSource();h.buffer=o;const m=t.createGain();m.gain.setValueAtTime(.08,t.currentTime),h.connect(m),m.connect(t.destination),h.start(),setTimeout(()=>t.close(),400)}catch{}}function CI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(600,t.currentTime),e.frequency.linearRampToValueAtTime(400,t.currentTime+.1),i.gain.setValueAtTime(.1,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.12),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.15),setTimeout(()=>t.close(),400)}catch{}}function MI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:800,start:0,dur:.12},{freq:600,start:.12,dur:.1},{freq:400,start:.22,dur:.15}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sine",r.frequency.setValueAtTime(i.freq,t.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.7,t.currentTime+i.start+i.dur),o.gain.setValueAtTime(.1,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),800)}catch{}}function VI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(120,t.currentTime),e.frequency.linearRampToValueAtTime(80,t.currentTime+.4),i.gain.setValueAtTime(.12,t.currentTime),i.gain.linearRampToValueAtTime(.15,t.currentTime+.15),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.55);const r=Math.floor(t.sampleRate*.4),o=t.createBuffer(1,r,t.sampleRate),u=o.getChannelData(0);for(let p=0;p<r;p++)u[p]=Math.random()*2-1;const h=t.createBufferSource();h.buffer=o;const m=t.createBiquadFilter();m.type="lowpass",m.frequency.value=300;const _=t.createGain();_.gain.setValueAtTime(.06,t.currentTime),_.gain.exponentialRampToValueAtTime(.01,t.currentTime+.4),h.connect(m),m.connect(_),_.connect(t.destination),h.start(),setTimeout(()=>t.close(),1e3)}catch{}}function LI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(80,t.currentTime),e.frequency.linearRampToValueAtTime(50,t.currentTime+.8),i.gain.setValueAtTime(.18,t.currentTime),i.gain.linearRampToValueAtTime(.22,t.currentTime+.3),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+1),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+1.1);const r=t.createOscillator(),o=t.createGain();r.type="triangle",r.frequency.setValueAtTime(55,t.currentTime),r.frequency.linearRampToValueAtTime(35,t.currentTime+.9),o.gain.setValueAtTime(.1,t.currentTime),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+.9),r.connect(o),o.connect(t.destination),r.start(),r.stop(t.currentTime+1);const u=Math.floor(t.sampleRate*.8),h=t.createBuffer(1,u,t.sampleRate),m=h.getChannelData(0);for(let v=0;v<u;v++)m[v]=Math.random()*2-1;const _=t.createBufferSource();_.buffer=h;const p=t.createBiquadFilter();p.type="lowpass",p.frequency.value=200;const y=t.createGain();y.gain.setValueAtTime(.08,t.currentTime),y.gain.exponentialRampToValueAtTime(.01,t.currentTime+.7),_.connect(p),p.connect(y),y.connect(t.destination),_.start(),setTimeout(()=>t.close(),1500)}catch{}}function HI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:110,start:0,dur:.2},{freq:110,start:.3,dur:.2},{freq:110,start:.6,dur:.2},{freq:80,start:.9,dur:.5}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.12,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.05)}setTimeout(()=>t.close(),2e3)}catch{}}function xI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(90,t.currentTime),e.frequency.linearRampToValueAtTime(120,t.currentTime+.3),e.frequency.exponentialRampToValueAtTime(20,t.currentTime+1.8),i.gain.setValueAtTime(.25,t.currentTime),i.gain.linearRampToValueAtTime(.3,t.currentTime+.2),i.gain.linearRampToValueAtTime(.2,t.currentTime+.8),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+2),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+2.1);const r=t.createOscillator(),o=t.createGain();r.type="triangle",r.frequency.setValueAtTime(45,t.currentTime),r.frequency.linearRampToValueAtTime(60,t.currentTime+.3),r.frequency.exponentialRampToValueAtTime(20,t.currentTime+1.5),o.gain.setValueAtTime(.15,t.currentTime),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+1.6),r.connect(o),o.connect(t.destination),r.start(),r.stop(t.currentTime+1.7);const u=t.createOscillator(),h=t.createGain();u.type="square",u.frequency.setValueAtTime(150,t.currentTime),u.frequency.exponentialRampToValueAtTime(40,t.currentTime+1.2),h.gain.setValueAtTime(.08,t.currentTime),h.gain.exponentialRampToValueAtTime(.01,t.currentTime+1),u.connect(h),h.connect(t.destination),u.start(),u.stop(t.currentTime+1.1);const m=Math.floor(t.sampleRate*1.5),_=t.createBuffer(1,m,t.sampleRate),p=_.getChannelData(0);for(let S=0;S<m;S++)p[S]=Math.random()*2-1;const y=t.createBufferSource();y.buffer=_;const v=t.createBiquadFilter();v.type="lowpass",v.frequency.value=180;const w=t.createGain();w.gain.setValueAtTime(.12,t.currentTime),w.gain.exponentialRampToValueAtTime(.01,t.currentTime+1.3),y.connect(v),v.connect(w),w.connect(t.destination),y.start(),setTimeout(()=>t.close(),2500)}catch{}}function PI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:660,start:0,dur:.12},{freq:880,start:.15,dur:.2}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.1,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),600)}catch{}}function zI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="square",e.frequency.setValueAtTime(300,t.currentTime),e.frequency.exponentialRampToValueAtTime(150,t.currentTime+.04),i.gain.setValueAtTime(.12,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.06),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.08);const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.setValueAtTime(400,t.currentTime+.08),r.frequency.exponentialRampToValueAtTime(200,t.currentTime+.12),o.gain.setValueAtTime(.12,t.currentTime+.08),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+.14),r.connect(o),o.connect(t.destination),r.start(t.currentTime+.08),r.stop(t.currentTime+.16),setTimeout(()=>t.close(),400)}catch{}}function UI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:466,start:0,dur:.3},{freq:440,start:.35,dur:.3},{freq:415,start:.7,dur:.3},{freq:370,start:1.05,dur:.6}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sawtooth",r.frequency.setValueAtTime(i.freq,t.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.97,t.currentTime+i.start+i.dur),o.gain.setValueAtTime(0,t.currentTime+i.start),o.gain.linearRampToValueAtTime(.1,t.currentTime+i.start+.03),o.gain.setValueAtTime(.1,t.currentTime+i.start+i.dur*.7),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.05)}setTimeout(()=>t.close(),2500)}catch{}}function BI(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:523,start:0,dur:.15},{freq:659,start:.18,dur:.15},{freq:784,start:.36,dur:.15},{freq:1047,start:.54,dur:.4}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(0,t.currentTime+i.start),o.gain.linearRampToValueAtTime(.12,t.currentTime+i.start+.02),o.gain.setValueAtTime(.12,t.currentTime+i.start+i.dur*.7),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.05)}setTimeout(()=>t.close(),1500)}catch{}}function Vd(t){const i={shoot:NI,hit:CI,wolf_whimper:MI,bear_roar:VI,boss_roar:LI,boss_incoming:HI,boss_defeat:xI,halfway:PI,reload_done:zI,game_over:UI,victory:BI}[t];i&&i()}function Qm({standalone:t=!1,onGameOver:e}){const i=oe.useRef(null),r=oe.useRef(Oc()),o=oe.useRef(null),u=oe.useCallback((w,S)=>{const x=i.current;if(!x)return null;const V=x.getBoundingClientRect(),H=ie.WIDTH/V.width,Q=ie.HEIGHT/V.height;return{x:(w-V.left)*H,y:(S-V.top)*Q}},[]);oe.useCallback(w=>{for(const S of w.events)Vd(S);w.events.length>0&&(r.current={...r.current,events:[]})},[]);const h=oe.useCallback(()=>{const w=r.current;if(w.events.length>0)for(const V of w.events)Vd(V);const S=cI({...w,events:[]});r.current=S;for(const V of S.events)Vd(V);const x=i.current;if(x){const V=x.getContext("2d");BT(V,S)}o.current=requestAnimationFrame(h)},[t,e]);oe.useEffect(()=>{const w=i.current;if(w){const S=w.getContext("2d");BT(S,r.current)}return o.current=requestAnimationFrame(h),()=>{o.current&&cancelAnimationFrame(o.current)}},[h]),oe.useEffect(()=>{const w=x=>{const V=r.current;if(x.key===" "||x.code==="Space"){if(x.preventDefault(),V.phase==="ready"){r.current={...V,phase:"playing",startTime:Date.now()};return}if(V.phase==="playing"){r.current=Md(V);return}if(V.phase==="gameover"||V.phase==="victory"){t?r.current={...Oc(),phase:"ready"}:e&&e({defeated:V.animalsDefeated,total:V.totalAnimals,elapsedMs:V.elapsedMs,won:V.phase==="victory"});return}}if(x.key==="Escape"){if(x.preventDefault(),!t&&e){const H=r.current;e({defeated:H.animalsDefeated,total:H.totalAnimals,elapsedMs:H.elapsedMs,won:!1})}return}x.key==="ArrowLeft"&&(x.preventDefault(),r.current={...r.current,input:{...r.current.input,left:!0}}),x.key==="ArrowRight"&&(x.preventDefault(),r.current={...r.current,input:{...r.current.input,right:!0}}),x.key==="ArrowUp"&&(x.preventDefault(),r.current={...r.current,input:{...r.current.input,up:!0}}),x.key==="ArrowDown"&&(x.preventDefault(),r.current={...r.current,input:{...r.current.input,down:!0}})},S=x=>{x.key==="ArrowLeft"&&(r.current={...r.current,input:{...r.current.input,left:!1}}),x.key==="ArrowRight"&&(r.current={...r.current,input:{...r.current.input,right:!1}}),x.key==="ArrowUp"&&(r.current={...r.current,input:{...r.current.input,up:!1}}),x.key==="ArrowDown"&&(r.current={...r.current,input:{...r.current.input,down:!1}})};return window.addEventListener("keydown",w),window.addEventListener("keyup",S),()=>{window.removeEventListener("keydown",w),window.removeEventListener("keyup",S)}},[t,e]);const m=oe.useCallback((w,S)=>{const x=u(w,S);if(!x)return;const V=r.current;if(V.phase==="ready"){r.current={...V,phase:"playing",startTime:Date.now()};return}if(V.phase==="playing"){const H=Math.max(dt.HORIZON_Y,Math.min(ie.HEIGHT-30,x.y)),Q=Math.max(10,Math.min(ie.WIDTH-10,x.x)),$={...V,reticle:{x:Q,y:H}};r.current=Md($);return}(V.phase==="gameover"||V.phase==="victory")&&(t?r.current={...Oc(),phase:"ready"}:e&&e({defeated:V.animalsDefeated,total:V.totalAnimals,elapsedMs:V.elapsedMs,won:V.phase==="victory"}))},[u,t,e]),_=oe.useCallback(w=>{const S=r.current;if(S.phase!=="playing")return;const x=u(w.clientX,w.clientY);if(!x)return;const V=Math.max(dt.HORIZON_Y,Math.min(ie.HEIGHT-30,x.y)),H=Math.max(10,Math.min(ie.WIDTH-10,x.x));r.current={...S,reticle:{x:H,y:V}}},[u]),p=oe.useCallback(()=>{const w=r.current;w.phase==="ready"?r.current={...w,phase:"playing",startTime:Date.now()}:(w.phase==="gameover"||w.phase==="victory")&&(t?r.current={...Oc(),phase:"ready"}:e&&e({defeated:w.animalsDefeated,total:w.totalAnimals,elapsedMs:w.elapsedMs,won:w.phase==="victory"}))},[t,e]),y=oe.useCallback((w,S)=>{r.current={...r.current,input:{...r.current.input,[w]:S}}},[]),v=oe.useCallback(()=>{const w=r.current;w.phase==="playing"&&(r.current=Md(w))},[]);return C.jsx("div",{className:"slalom-container",children:C.jsxs("div",{className:"arcade-cabinet",children:[C.jsx("div",{className:"arcade-top"}),C.jsx("div",{className:"arcade-marquee",children:"DEFEND THE VILLAGE"}),C.jsx("div",{className:"arcade-screen-bezel",children:C.jsx("canvas",{ref:i,width:ie.WIDTH,height:ie.HEIGHT,className:"slalom-canvas",style:{cursor:"crosshair",touchAction:"none"},onClick:w=>m(w.clientX,w.clientY),onMouseMove:_,onTouchStart:w=>{w.preventDefault();const S=w.touches[0];S&&m(S.clientX,S.clientY)},onTouchMove:w=>{w.preventDefault();const S=w.touches[0];if(!S)return;const x=r.current;if(x.phase!=="playing")return;const V=u(S.clientX,S.clientY);if(!V)return;const H=Math.max(dt.HORIZON_Y,Math.min(ie.HEIGHT-30,V.y)),Q=Math.max(10,Math.min(ie.WIDTH-10,V.x));r.current={...x,reticle:{x:Q,y:H}}}})}),C.jsx("div",{className:"arcade-controls",children:C.jsxs("div",{className:"arcade-controls-inner",children:[C.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[C.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("up",!0)},onTouchEnd:w=>{w.preventDefault(),y("up",!1)},onMouseDown:()=>y("up",!0),onMouseUp:()=>y("up",!1),onMouseLeave:()=>y("up",!1),children:""}),C.jsxs("div",{style:{display:"flex",gap:"2px"},children:[C.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("left",!0)},onTouchEnd:w=>{w.preventDefault(),y("left",!1)},onMouseDown:()=>y("left",!0),onMouseUp:()=>y("left",!1),onMouseLeave:()=>y("left",!1),children:""}),C.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("down",!0)},onTouchEnd:w=>{w.preventDefault(),y("down",!1)},onMouseDown:()=>y("down",!0),onMouseUp:()=>y("down",!1),onMouseLeave:()=>y("down",!1),children:""}),C.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("right",!0)},onTouchEnd:w=>{w.preventDefault(),y("right",!1)},onMouseDown:()=>y("right",!0),onMouseUp:()=>y("right",!1),onMouseLeave:()=>y("right",!1),children:""})]})]}),C.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:w=>{w.preventDefault(),p()},onMouseDown:p,children:"START"}),C.jsx("button",{className:"arcade-touch-btn",style:{backgroundColor:"#cc2222",fontSize:"14px",padding:"8px 16px"},onTouchStart:w=>{w.preventDefault(),v()},onMouseDown:v,children:"FIRE"})]})}),C.jsx("div",{className:"arcade-base"})]})})}const Re={WIDTH:480,HEIGHT:640},ve={SKY_TOP:"#0a1a3e",SKY_BOTTOM:"#1a3a6e",GROUND:"#ddeeff",GROUND_DARK:"#bbccee",TREE_TRUNK:"#553311",TREE_LEAVES:"#1a5522",TREE_SNOW:"#ddeeff",MOUNTAIN_DARK:"#445588",SNOW_CAPS:"#eeeeff",FORT_WALL:"#8899bb",FORT_SHADOW:"#667799",SNOWBALL:"#ffffff",SNOWBALL_SHADOW:"#bbccdd",PLAYER_BODY:"#cc3333",PLAYER_DARK:"#991111",PLAYER_SKIN:"#ffcc99",PLAYER_HAT:"#cc3333",OPPONENT_BODY:"#3366cc",OPPONENT_DARK:"#1144aa",OPPONENT_HAT:"#3366cc",HUD_BG:"rgba(0,0,0,0.6)",HUD_GREEN:"#33ff33",HUD_YELLOW:"#ffcc00",HUD_RED:"#ff4444",OVERLAY_BG:"rgba(0,0,0,0.85)",TEXT_WHITE:"#ffffff",TEXT_DIM:"#88ccff"},on={HUD:"20px VT323, monospace",TITLE:"44px VT323, monospace",SUBTITLE:"24px VT323, monospace",OVERLAY:"28px VT323, monospace",SMALL:"18px VT323, monospace",TINY:"14px VT323, monospace",BIG:"36px VT323, monospace"},ut={THROWS_PER_TURN:5,HITS_TO_WIN:5,THROW_DELAY:60,TURN_SWITCH_DELAY:90,SNOWBALL_SPEED:6,SNOWBALL_SIZE:8,SPLAT_DURATION:40,HIT_STUN:30,DOUBLE_THROW_CHANCE:.3,PLAYER_TURN_TIMEOUT:600},bt={X:370,Y_CENTER:400,HEIGHT:56,MOVE_SPEED:4,Y_MIN:280,Y_MAX:520},Ke={X:110,Y_CENTER:400,HEIGHT:56,MOVE_SPEED:3,Y_MIN:280,Y_MAX:520,DODGE_CHANCE:.6,DODGE_MISS_CHANCE:.15},Fe={HORIZON_Y:200,CENTER_LINE:240,FORT_HEIGHT:40};function YT(){return{phase:"ready",turn:"computer",turnPhase:"throwing",player:{y:bt.Y_CENTER,hits:0,stunTimer:0,splatTimer:0,splatY:0,throwAnim:0},opponent:{y:Ke.Y_CENTER,hits:0,stunTimer:0,splatTimer:0,splatY:0,dodgeTarget:null,dodgeDecided:!1,throwAnim:0,wanderTarget:null,wanderTimer:0},snowballs:[],splats:[],throwsRemaining:ut.THROWS_PER_TURN,throwCooldown:0,switchTimer:0,turnTimer:0,aimY:bt.Y_CENTER,frameCount:0,startTime:0,events:[],input:{up:!1,down:!1,space:!1},announcement:"",announcementTimer:0}}function GI(t){if(t.phase!=="playing")return t;let e={...t,frameCount:t.frameCount+1,events:[]};return e.player.stunTimer>0&&(e={...e,player:{...e.player,stunTimer:e.player.stunTimer-1}}),e.opponent.stunTimer>0&&(e={...e,opponent:{...e.opponent,stunTimer:e.opponent.stunTimer-1}}),e.player.splatTimer>0&&(e={...e,player:{...e.player,splatTimer:e.player.splatTimer-1}}),e.opponent.splatTimer>0&&(e={...e,opponent:{...e.opponent,splatTimer:e.opponent.splatTimer-1}}),e.player.throwAnim>0&&(e={...e,player:{...e.player,throwAnim:e.player.throwAnim-1}}),e.opponent.throwAnim>0&&(e={...e,opponent:{...e.opponent,throwAnim:e.opponent.throwAnim-1}}),e.announcementTimer>0&&(e={...e,announcementTimer:e.announcementTimer-1},e.announcementTimer===0&&(e={...e,announcement:""})),e={...e,splats:e.splats.map(i=>({...i,timer:i.timer-1})).filter(i=>i.timer>0)},e.turn==="computer"&&e.player.stunTimer===0&&(e=qI(e)),e.turn==="player"&&(e=YI(e)),e.turn==="player"&&e.opponent.stunTimer===0&&(e=FI(e)),e.turn==="computer"&&(e=jI(e)),e=WI(e),e.turnPhase==="switching"&&(e={...e,switchTimer:e.switchTimer-1},e.switchTimer<=0&&(e=XI(e))),e.throwCooldown>0&&(e={...e,throwCooldown:e.throwCooldown-1}),e.turn==="player"&&e.turnPhase==="throwing"&&e.throwsRemaining>0&&(e={...e,turnTimer:e.turnTimer+1},e.turnTimer>=ut.PLAYER_TURN_TIMEOUT&&(e={...e,throwsRemaining:0,turnTimer:0,announcement:"TOO SLOW! TURN FORFEIT!",announcementTimer:ut.TURN_SWITCH_DELAY},e.snowballs.length===0&&(e={...e,turnPhase:"switching",switchTimer:ut.TURN_SWITCH_DELAY,announcement:"OPPONENT'S TURN!"}))),e}function qI(t){let e=t.player.y;return t.input.up&&(e-=bt.MOVE_SPEED),t.input.down&&(e+=bt.MOVE_SPEED),e=Math.max(bt.Y_MIN,Math.min(bt.Y_MAX,e)),{...t,player:{...t.player,y:e}}}function YI(t){let e=t.aimY;return t.input.up&&(e-=bt.MOVE_SPEED),t.input.down&&(e+=bt.MOVE_SPEED),e=Math.max(Ke.Y_MIN,Math.min(Ke.Y_MAX,e)),{...t,aimY:e}}function Ld(t){if(t.phase!=="playing"||t.turn!=="player"||t.turnPhase!=="throwing"||t.throwsRemaining<=0||t.throwCooldown>0)return t;const e=sm(bt.X,t.player.y,Ke.X,t.aimY,"player");return{...t,snowballs:[...t.snowballs,e],throwsRemaining:t.throwsRemaining-1,throwCooldown:30,turnTimer:0,player:{...t.player,throwAnim:15},events:[...t.events,"throw"]}}function jI(t){if(t.turnPhase!=="throwing"||t.throwsRemaining<=0||t.throwCooldown>0||t.opponent.stunTimer>0)return t;if(t.throwCooldown===0&&t.frameCount%ut.THROW_DELAY===0){const e=t.player.y+(Math.random()-.5)*80;let r=[sm(Ke.X,t.opponent.y,bt.X,e,"computer")],o=1;if(t.throwsRemaining>=2&&Math.random()<ut.DOUBLE_THROW_CHANCE){const u=t.player.y+(Math.random()-.5)*120,h=sm(Ke.X,t.opponent.y+10,bt.X,u,"computer");r.push(h),o=2}return{...t,snowballs:[...t.snowballs,...r],throwsRemaining:t.throwsRemaining-o,throwCooldown:ut.THROW_DELAY,opponent:{...t.opponent,throwAnim:15},events:[...t.events,"throw"]}}return t}function FI(t){const e=t.snowballs.filter(r=>r.thrower==="player"&&r.x>Fe.CENTER_LINE&&r.vx<0);let i={...t.opponent};if(e.length>0){const r=e.reduce((u,h)=>u.x<h.x?u:h),o=r.x-Ke.X;if(o<200&&!i.dodgeDecided){i.dodgeDecided=!0,i.wanderTarget=null;const u=o/Math.abs(r.vx),h=r.y+r.vy*u;if(Math.random()<Ke.DODGE_CHANCE){const m=h>i.y?-1:1;i.dodgeTarget=i.y+m*(60+Math.random()*40)}else Math.random()<Ke.DODGE_MISS_CHANCE?i.dodgeTarget=h:i.dodgeTarget=i.y}if(i.dodgeTarget!==null){const u=i.dodgeTarget-i.y;Math.abs(u)>2&&(i.y+=Math.sign(u)*Ke.MOVE_SPEED*1.3),i.y=Math.max(Ke.Y_MIN,Math.min(Ke.Y_MAX,i.y))}}else{if(i.dodgeDecided=!1,i.dodgeTarget=null,i.wanderTimer=(i.wanderTimer||0)-1,i.wanderTimer<=0||i.wanderTarget===null){const o=Ke.Y_MAX-Ke.Y_MIN,u=i.y>Ke.Y_CENTER?-.3:.3;i.wanderTarget=Ke.Y_MIN+(Math.random()+u)*o,i.wanderTarget=Math.max(Ke.Y_MIN,Math.min(Ke.Y_MAX,i.wanderTarget)),i.wanderTimer=30+Math.floor(Math.random()*40)}const r=i.wanderTarget-i.y;Math.abs(r)>2&&(i.y+=Math.sign(r)*Ke.MOVE_SPEED*.8),i.y=Math.max(Ke.Y_MIN,Math.min(Ke.Y_MAX,i.y))}return{...t,opponent:i}}function sm(t,e,i,r,o){const u=i-t,h=r-e,_=Math.sqrt(u*u+h*h)/ut.SNOWBALL_SPEED,p=u/_,y=h/_;return{x:t,y:e,startX:t,startY:e,targetX:i,targetY:r,vx:p,vy:y,progress:0,totalFrames:_,thrower:o}}function WI(t){let e=[],i={...t.player},r={...t.opponent},o=[...t.events],u=[...t.splats],h=t.announcement,m=t.announcementTimer,_=t.turnPhase,p=t.switchTimer,y=t.throwsRemaining;for(const w of t.snowballs){const S={...w,x:w.x+w.vx,y:w.y+w.vy,progress:w.progress+1/w.totalFrames},x=Math.min(S.progress,1),V=-.15*S.totalFrames*4*x*(1-x);if(S.progress>=1&&!w.resolved)if(S.resolved=!0,w.thrower==="computer")if(Math.abs(i.y-w.targetY)<bt.HEIGHT*.6){r.hits++,i.stunTimer=ut.HIT_STUN,i.splatTimer=ut.SPLAT_DURATION,i.splatY=i.y,o.push("hit");continue}else u.push({x:bt.X+(Math.random()-.5)*30,y:w.targetY,timer:60}),o.push("miss");else if(Math.abs(r.y-w.targetY)<Ke.HEIGHT*.6){i.hits++,r.stunTimer=ut.HIT_STUN,r.splatTimer=ut.SPLAT_DURATION,r.splatY=r.y,r.dodgeDecided=!1,r.dodgeTarget=null,o.push("hit");continue}else u.push({x:Ke.X+(Math.random()-.5)*30,y:w.targetY,timer:60}),o.push("miss"),r.dodgeDecided=!1,r.dodgeTarget=null;S.x<-20||S.x>Re.WIDTH+20||S.y<-20||S.y>Re.HEIGHT+20||(S.arcOffset=V,e.push(S))}let v={...t,snowballs:e,player:i,opponent:r,events:o,splats:u,announcement:h,announcementTimer:m,turnPhase:_,switchTimer:p,throwsRemaining:y};return i.hits>=ut.HITS_TO_WIN?{...v,phase:"gameover",winner:"player",events:[...v.events,"victory"]}:r.hits>=ut.HITS_TO_WIN?{...v,phase:"gameover",winner:"computer",events:[...v.events,"game_over"]}:(y<=0&&e.length===0&&_==="throwing"&&(v={...v,turnPhase:"switching",switchTimer:ut.TURN_SWITCH_DELAY,announcement:t.turn==="computer"?"YOUR TURN!":"OPPONENT'S TURN!",announcementTimer:ut.TURN_SWITCH_DELAY}),v)}function XI(t){const e=t.turn==="computer"?"player":"computer";return{...t,turn:e,turnPhase:"throwing",throwsRemaining:ut.THROWS_PER_TURN,throwCooldown:ut.THROW_DELAY,turnTimer:0,aimY:t.opponent.y,opponent:{...t.opponent,dodgeTarget:null,dodgeDecided:!1},events:[...t.events,"turn_switch"]}}function jT(t,e){t.imageSmoothingEnabled=!1,KI(t),QI(t),ZI(t),$I(t),ek(t),tk(t,e),rk(t,e),WT(t,Ke.X,e.opponent.y,"opponent",e.opponent,e),WT(t,bt.X,e.player.y,"player",e.player,e),ak(t,e),ik(t,e),e.phase==="playing"&&(ok(t,e),e.turn==="player"&&e.turnPhase==="throwing"&&sk(t,e),e.announcement&&lk(t,e)),e.phase==="ready"&&uk(t),e.phase==="gameover"&&ck(t,e)}function KI(t){const e=t.createLinearGradient(0,0,0,Fe.HORIZON_Y);e.addColorStop(0,ve.SKY_TOP),e.addColorStop(1,ve.SKY_BOTTOM),t.fillStyle=e,t.fillRect(0,0,Re.WIDTH,Fe.HORIZON_Y),t.fillStyle="#ffffff";const i=[[50,30],[120,60],[200,20],[280,50],[350,35],[420,55],[80,90],[300,80],[450,25],[160,45]];for(const[r,o]of i)t.fillRect(r,o,2,2)}function QI(t){t.fillStyle=ve.MOUNTAIN_DARK,t.beginPath(),t.moveTo(0,Fe.HORIZON_Y),t.lineTo(60,Fe.HORIZON_Y-80),t.lineTo(130,Fe.HORIZON_Y-40),t.lineTo(200,Fe.HORIZON_Y-100),t.lineTo(270,Fe.HORIZON_Y-50),t.lineTo(340,Fe.HORIZON_Y-90),t.lineTo(400,Fe.HORIZON_Y-60),t.lineTo(Re.WIDTH,Fe.HORIZON_Y-70),t.lineTo(Re.WIDTH,Fe.HORIZON_Y),t.fill(),t.fillStyle=ve.SNOW_CAPS,t.beginPath(),t.moveTo(190,Fe.HORIZON_Y-100),t.lineTo(200,Fe.HORIZON_Y-100),t.lineTo(210,Fe.HORIZON_Y-90),t.lineTo(195,Fe.HORIZON_Y-85),t.fill(),t.beginPath(),t.moveTo(330,Fe.HORIZON_Y-90),t.lineTo(340,Fe.HORIZON_Y-90),t.lineTo(350,Fe.HORIZON_Y-80),t.lineTo(335,Fe.HORIZON_Y-78),t.fill()}function ZI(t){const e=t.createLinearGradient(0,Fe.HORIZON_Y,0,Re.HEIGHT);e.addColorStop(0,ve.GROUND),e.addColorStop(1,ve.GROUND_DARK),t.fillStyle=e,t.fillRect(0,Fe.HORIZON_Y,Re.WIDTH,Re.HEIGHT-Fe.HORIZON_Y),t.strokeStyle="#aabbcc",t.lineWidth=1,t.setLineDash([8,8]),t.beginPath(),t.moveTo(Fe.CENTER_LINE,Fe.HORIZON_Y+20),t.lineTo(Fe.CENTER_LINE,Re.HEIGHT),t.stroke(),t.setLineDash([])}function $I(t){const e=[{x:20,y:Fe.HORIZON_Y+5,s:.6},{x:460,y:Fe.HORIZON_Y+8,s:.7},{x:100,y:Fe.HORIZON_Y+3,s:.5},{x:380,y:Fe.HORIZON_Y+6,s:.55},{x:240,y:Fe.HORIZON_Y+2,s:.4}];for(const i of e)JI(t,i.x,i.y,i.s)}function JI(t,e,i,r){const o=r;t.fillStyle=ve.TREE_TRUNK,t.fillRect(e-3*o,i,6*o,20*o),t.fillStyle=ve.TREE_LEAVES;for(let u=0;u<3;u++){const h=(24-u*6)*o,m=14*o,_=i-u*12*o;t.beginPath(),t.moveTo(e,_-m),t.lineTo(e-h/2,_),t.lineTo(e+h/2,_),t.fill()}t.fillStyle=ve.TREE_SNOW;for(let u=0;u<3;u++){const h=(16-u*4)*o,m=i-u*12*o;t.fillRect(e-h/2,m-14*o,h,4*o)}}function ek(t){FT(t,Ke.X-25,460),FT(t,bt.X-25,460)}function FT(t,e,i){t.fillStyle=ve.FORT_WALL,t.fillRect(e,i,50,Fe.FORT_HEIGHT);for(let r=0;r<3;r++)t.fillRect(e+5+r*16,i-10,12,10);t.fillStyle=ve.FORT_SHADOW,t.fillRect(e,i+Fe.FORT_HEIGHT-6,50,6),t.fillStyle="#ffffff";for(let r=0;r<3;r++)t.fillRect(e+5+r*16,i-12,12,3)}function tk(t,e){if(e.phase!=="playing")return;const i=e.turn==="player",r=e.throwsRemaining;if(e.turnPhase!=="throwing"&&e.turnPhase!=="switching")return;const o=i?bt.X+30:Ke.X-30;nk(t,o,480,r)}function nk(t,e,i,r){const u=15.400000000000002,h=[{x:e-u,y:i},{x:e,y:i},{x:e+u,y:i},{x:e-u*.5,y:i-u*.85},{x:e+u*.5,y:i-u*.85}];for(let m=0;m<Math.min(r,5);m++){const _=h[m];t.fillStyle=ve.SNOWBALL_SHADOW,t.beginPath(),t.arc(_.x+1,_.y+1,7,0,Math.PI*2),t.fill(),t.fillStyle=ve.SNOWBALL,t.beginPath(),t.arc(_.x,_.y,7,0,Math.PI*2),t.fill(),t.fillStyle="#ffffff",t.beginPath(),t.arc(_.x-2,_.y-2,2.5,0,Math.PI*2),t.fill()}r>0&&(t.font=on.TINY,t.fillStyle=ve.TEXT_DIM,t.textAlign="center",t.fillText(`${r}`,e,i+7+12))}function WT(t,e,i,r,o,u){const h=r==="player"?ve.PLAYER_BODY:ve.OPPONENT_BODY,m=r==="player"?ve.PLAYER_DARK:ve.OPPONENT_DARK,_=r==="player"?ve.PLAYER_HAT:ve.OPPONENT_HAT,p=o.stunTimer>0?Math.sin(o.stunTimer*.8)*3:0,y=e+p;t.fillStyle="rgba(0,0,0,0.15)",t.beginPath(),t.ellipse(y,i+28,18,6,0,0,Math.PI*2),t.fill(),t.fillStyle=h,t.fillRect(y-12,i-16,24,32),t.fillStyle=m,t.fillRect(y-12,i-16,24,4),t.fillRect(y-12,i+12,24,4),t.fillStyle=ve.PLAYER_SKIN,t.beginPath(),t.arc(y,i-24,10,0,Math.PI*2),t.fill(),t.fillStyle=_,t.beginPath(),t.arc(y,i-28,10,Math.PI,0),t.fill(),t.fillRect(y-10,i-28,20,4),t.fillStyle="#ffffff",t.beginPath(),t.arc(y,i-36,4,0,Math.PI*2),t.fill(),t.fillStyle="#000000";const v=r==="player"?-1:1;t.fillRect(y+v*3-1,i-26,3,3),t.fillRect(y+v*-5,i-26,3,3);const w=r==="player"?-1:1,S=r==="player"&&u.turn==="player"||r!=="player"&&u.turn==="computer",x=o.throwAnim||0;if(t.fillStyle=h,x>0){const V=1-x/15,H=-Math.PI*.4+V*Math.PI*.8;t.save(),t.translate(y+w*8,i-10),t.rotate(H*w),t.fillRect(0,-3,18,6),t.restore(),t.fillRect(y-w*16,i-10,5,18)}else S&&u.turnPhase==="throwing"?(t.fillRect(y+w*12,i-16,8*w,-16),t.fillStyle=ve.SNOWBALL,t.beginPath(),t.arc(y+w*18,i-30,5,0,Math.PI*2),t.fill(),t.fillStyle=h,t.fillRect(y-w*16,i-10,5,18)):(t.fillRect(y-16,i-10,5,18),t.fillRect(y+11,i-10,5,18));t.fillStyle="#444466",t.fillRect(y-8,i+16,7,12),t.fillRect(y+1,i+16,7,12),t.fillStyle="#332211",t.fillRect(y-9,i+26,9,4),t.fillRect(y,i+26,9,4)}function ik(t,e){e.player.splatTimer>0&&XT(t,bt.X,e.player.splatY,e.player.splatTimer),e.opponent.splatTimer>0&&XT(t,Ke.X,e.opponent.splatY,e.opponent.splatTimer)}function XT(t,e,i,r){const o=1-r/ut.SPLAT_DURATION,u=Math.max(0,1-o);t.fillStyle=`rgba(255, 255, 255, ${u})`,t.beginPath(),t.arc(e,i-10,14+o*8,0,Math.PI*2),t.fill(),t.fillStyle=`rgba(220, 235, 255, ${u*.8})`;const h=8;for(let m=0;m<h;m++){const _=m/h*Math.PI*2,p=10+o*30,y=e+Math.cos(_)*p,v=i-10+Math.sin(_)*p*.6,w=4*(1-o);t.beginPath(),t.arc(y,v,w,0,Math.PI*2),t.fill()}}function ak(t,e){for(const i of e.snowballs){const r=i.y+(i.arcOffset||0);t.fillStyle="rgba(0,0,0,0.1)",t.beginPath(),t.ellipse(i.x,i.y+2,6,3,0,0,Math.PI*2),t.fill(),t.fillStyle=ve.SNOWBALL,t.beginPath(),t.arc(i.x,r,ut.SNOWBALL_SIZE,0,Math.PI*2),t.fill(),t.fillStyle=ve.SNOWBALL_SHADOW,t.beginPath(),t.arc(i.x+2,r+2,ut.SNOWBALL_SIZE*.6,0,Math.PI*2),t.fill(),t.fillStyle="#ffffff",t.beginPath(),t.arc(i.x-2,r-2,3,0,Math.PI*2),t.fill()}}function rk(t,e){for(const i of e.splats){const r=i.timer/60;t.fillStyle=`rgba(200, 220, 240, ${r*.5})`,t.beginPath(),t.ellipse(i.x,i.y,12,5,0,0,Math.PI*2),t.fill()}}function sk(t,e){const i=Ke.X,r=e.aimY;t.strokeStyle="rgba(255, 100, 100, 0.4)",t.lineWidth=1,t.setLineDash([4,4]),t.beginPath();const o=bt.X,u=e.player.y,h=.5;for(let V=0;V<=h;V+=.05){const H=o+(i-o)*V,Q=u+(r-u)*V-Math.sin(V*Math.PI)*40;V===0?t.moveTo(H,Q):t.lineTo(H,Q)}t.stroke(),t.setLineDash([]);const m=h,_=h-.05,p=o+(i-o)*m,y=u+(r-u)*m-Math.sin(m*Math.PI)*40,v=o+(i-o)*_,w=u+(r-u)*_-Math.sin(_*Math.PI)*40,S=Math.atan2(y-w,p-v),x=10;t.strokeStyle="rgba(255, 100, 100, 0.6)",t.lineWidth=2,t.beginPath(),t.moveTo(p,y),t.lineTo(p-x*Math.cos(S-.5),y-x*Math.sin(S-.5)),t.moveTo(p,y),t.lineTo(p-x*Math.cos(S+.5),y-x*Math.sin(S+.5)),t.stroke()}function ok(t,e){t.fillStyle=ve.HUD_BG,t.fillRect(0,0,Re.WIDTH,50),t.font=on.HUD,t.textAlign="left",t.fillStyle=ve.OPPONENT_BODY,t.fillText(`CPU: ${e.opponent.hits}/${ut.HITS_TO_WIN}`,20,20),KT(t,20,28,e.opponent.hits,ve.OPPONENT_BODY),t.fillStyle=ve.PLAYER_BODY,t.textAlign="right",t.fillText(`YOU: ${e.player.hits}/${ut.HITS_TO_WIN}`,Re.WIDTH-20,20);const i=ut.HITS_TO_WIN*16;if(KT(t,Re.WIDTH-20-i,28,e.player.hits,ve.PLAYER_BODY),t.textAlign="left",t.fillStyle=ve.TEXT_WHITE,t.textAlign="center",t.font=on.SMALL,e.turn==="player"&&e.turnPhase==="throwing"){const r=Math.ceil((ut.PLAYER_TURN_TIMEOUT-(e.turnTimer||0))/60),o=r<=3?ve.HUD_RED:ve.HUD_GREEN;t.fillStyle=o,t.fillText(`YOUR THROW  [${e.throwsRemaining} left]  ${r}s`,Re.WIDTH/2,20),t.fillStyle=ve.TEXT_DIM,t.font=on.TINY,t.fillText(" AIM    SPACE/TAP THROW",Re.WIDTH/2,38)}else e.turn==="computer"&&e.turnPhase==="throwing"?(t.fillStyle=ve.HUD_YELLOW,t.fillText(`DODGE!  [${e.throwsRemaining} incoming]`,Re.WIDTH/2,20),t.fillStyle=ve.TEXT_DIM,t.font=on.TINY,t.fillText(" DODGE",Re.WIDTH/2,38)):(t.fillStyle=ve.TEXT_DIM,t.fillText("SWITCHING...",Re.WIDTH/2,28))}function KT(t,e,i,r,o){for(let u=0;u<ut.HITS_TO_WIN;u++)t.fillStyle=u<r?o:"rgba(255,255,255,0.2)",t.beginPath(),t.arc(e+u*16+6,i+8,5,0,Math.PI*2),t.fill()}function lk(t,e){const i=Math.min(1,e.announcementTimer/20);t.fillStyle=`rgba(0, 0, 0, ${i*.6})`,t.fillRect(0,Re.HEIGHT/2-30,Re.WIDTH,60),t.font=on.BIG,t.textAlign="center",t.fillStyle=`rgba(255, 255, 255, ${i})`,t.fillText(e.announcement,Re.WIDTH/2,Re.HEIGHT/2+10)}function uk(t){t.fillStyle=ve.OVERLAY_BG,t.fillRect(0,0,Re.WIDTH,Re.HEIGHT),t.textAlign="center",t.font=on.TITLE,t.fillStyle=ve.TEXT_WHITE,t.fillText("SNOWBALL",Re.WIDTH/2,200),t.fillText("SHOWDOWN",Re.WIDTH/2,250),t.font=on.SUBTITLE,t.fillStyle=ve.TEXT_DIM,t.fillText("* * *",Re.WIDTH/2,300),t.font=on.OVERLAY,t.fillStyle=ve.TEXT_WHITE,t.fillText("Dodge snowballs!",Re.WIDTH/2,360),t.fillText("Aim & throw back!",Re.WIDTH/2,395),t.font=on.SMALL,t.fillStyle=ve.TEXT_DIM,t.fillText("  Move / Aim",Re.WIDTH/2,440),t.fillText("SPACE or TAP  Throw",Re.WIDTH/2,465),t.fillText(`First to ${ut.HITS_TO_WIN} hits wins!`,Re.WIDTH/2,500),t.font=on.SUBTITLE,Math.floor(Date.now()/500)%2&&(t.fillStyle=ve.HUD_GREEN,t.fillText("TAP or PRESS SPACE TO START",Re.WIDTH/2,560))}function ck(t,e){t.fillStyle=ve.OVERLAY_BG,t.fillRect(0,0,Re.WIDTH,Re.HEIGHT),t.textAlign="center",e.winner==="player"?(t.font=on.TITLE,t.fillStyle=ve.HUD_GREEN,t.fillText("YOU WIN!",Re.WIDTH/2,220),t.font=on.OVERLAY,t.fillStyle=ve.TEXT_WHITE,t.fillText("Snowball Champion!",Re.WIDTH/2,280)):(t.font=on.TITLE,t.fillStyle=ve.HUD_RED,t.fillText("YOU LOSE!",Re.WIDTH/2,220),t.font=on.OVERLAY,t.fillStyle=ve.TEXT_WHITE,t.fillText("Better luck next time!",Re.WIDTH/2,280)),t.font=on.SUBTITLE,t.fillStyle=ve.TEXT_DIM,t.fillText(`CPU: ${e.opponent.hits}    YOU: ${e.player.hits}`,Re.WIDTH/2,340),t.font=on.SUBTITLE,Math.floor(Date.now()/500)%2&&(t.fillStyle=ve.TEXT_WHITE,t.fillText("TAP or PRESS SPACE TO CONTINUE",Re.WIDTH/2,420))}function hk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=Math.floor(t.sampleRate*.2),i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let m=0;m<e;m++)r[m]=(Math.random()*2-1)*(1-m/e);const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="bandpass",u.frequency.setValueAtTime(800,t.currentTime),u.frequency.linearRampToValueAtTime(2e3,t.currentTime+.1),u.frequency.linearRampToValueAtTime(500,t.currentTime+.2),u.Q.value=2;const h=t.createGain();h.gain.setValueAtTime(.12,t.currentTime),h.gain.exponentialRampToValueAtTime(.01,t.currentTime+.2),o.connect(u),u.connect(h),h.connect(t.destination),o.start(),setTimeout(()=>t.close(),500)}catch{}}function fk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=Math.floor(t.sampleRate*.15),i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let p=0;p<e;p++)r[p]=(Math.random()*2-1)*Math.pow(1-p/e,.5);const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="lowpass",u.frequency.value=1500;const h=t.createGain();h.gain.setValueAtTime(.18,t.currentTime),h.gain.exponentialRampToValueAtTime(.01,t.currentTime+.15),o.connect(u),u.connect(h),h.connect(t.destination),o.start();const m=t.createOscillator(),_=t.createGain();m.type="sine",m.frequency.setValueAtTime(150,t.currentTime),m.frequency.exponentialRampToValueAtTime(60,t.currentTime+.1),_.gain.setValueAtTime(.15,t.currentTime),_.gain.exponentialRampToValueAtTime(.01,t.currentTime+.12),m.connect(_),_.connect(t.destination),m.start(),m.stop(t.currentTime+.15),setTimeout(()=>t.close(),500)}catch{}}function dk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(100,t.currentTime),e.frequency.exponentialRampToValueAtTime(40,t.currentTime+.1),i.gain.setValueAtTime(.08,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.12),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.15);const r=Math.floor(t.sampleRate*.06),o=t.createBuffer(1,r,t.sampleRate),u=o.getChannelData(0);for(let _=0;_<r;_++)u[_]=(Math.random()*2-1)*(1-_/r)*.5;const h=t.createBufferSource();h.buffer=o;const m=t.createGain();m.gain.setValueAtTime(.05,t.currentTime),h.connect(m),m.connect(t.destination),h.start(),setTimeout(()=>t.close(),400)}catch{}}function mk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:440,start:0,dur:.12},{freq:660,start:.15,dur:.18}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.08,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),600)}catch{}}function _k(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:440,start:0,dur:.25},{freq:415,start:.3,dur:.25},{freq:370,start:.6,dur:.25},{freq:330,start:.9,dur:.5}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sawtooth",r.frequency.setValueAtTime(i.freq,t.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.97,t.currentTime+i.start+i.dur),o.gain.setValueAtTime(.08,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),2e3)}catch{}}function pk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:523,start:0,dur:.15},{freq:659,start:.18,dur:.15},{freq:784,start:.36,dur:.15},{freq:1047,start:.54,dur:.4}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.1,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),1500)}catch{}}function QT(t){const i={throw:hk,hit:fk,miss:dk,turn_switch:mk,game_over:_k,victory:pk}[t];i&&i()}function Zm({standalone:t=!1,onGameOver:e}){const i=oe.useRef(null),r=oe.useRef(YT()),o=oe.useRef(null),u=oe.useCallback((S,x)=>{const V=i.current;if(!V)return null;const H=V.getBoundingClientRect(),Q=Re.WIDTH/H.width,$=Re.HEIGHT/H.height;return{x:(S-H.left)*Q,y:(x-H.top)*$}},[]),h=oe.useCallback(()=>{const S=r.current;if(S.events.length>0)for(const H of S.events)QT(H);const x=GI({...S,events:[]});r.current=x;for(const H of x.events)QT(H);const V=i.current;if(V){const H=V.getContext("2d");jT(H,x)}o.current=requestAnimationFrame(h)},[t,e]);oe.useEffect(()=>{const S=i.current;if(S){const x=S.getContext("2d");jT(x,r.current)}return o.current=requestAnimationFrame(h),()=>{o.current&&cancelAnimationFrame(o.current)}},[h]);const m=oe.useCallback(S=>{t?r.current={...YT(),phase:"ready"}:e&&e({playerHits:S.player.hits,computerHits:S.opponent.hits,won:S.winner==="player"})},[t,e]);oe.useEffect(()=>{const S=V=>{const H=r.current;if(V.key===" "||V.code==="Space"){if(V.preventDefault(),H.phase==="ready"){r.current={...H,phase:"playing",startTime:Date.now()};return}if(H.phase==="playing"&&H.turn==="player"&&H.turnPhase==="throwing"){r.current=Ld(H);return}if(H.phase==="gameover"){m(H);return}}if(V.key==="Escape"){V.preventDefault(),!t&&e&&e({playerHits:H.player.hits,computerHits:H.opponent.hits,won:!1});return}V.key==="ArrowUp"&&(V.preventDefault(),r.current={...r.current,input:{...r.current.input,up:!0}}),V.key==="ArrowDown"&&(V.preventDefault(),r.current={...r.current,input:{...r.current.input,down:!0}})},x=V=>{V.key==="ArrowUp"&&(r.current={...r.current,input:{...r.current.input,up:!1}}),V.key==="ArrowDown"&&(r.current={...r.current,input:{...r.current.input,down:!1}})};return window.addEventListener("keydown",S),window.addEventListener("keyup",x),()=>{window.removeEventListener("keydown",S),window.removeEventListener("keyup",x)}},[t,e,m]);const _=oe.useCallback((S,x)=>{const V=u(S,x);if(!V)return;const H=r.current;if(H.phase==="ready"){r.current={...H,phase:"playing",startTime:Date.now()};return}if(H.phase==="playing"){if(H.turn==="player"&&H.turnPhase==="throwing"){const Q=Math.max(Ke.Y_MIN,Math.min(Ke.Y_MAX,V.y)),$={...H,aimY:Q};r.current=Ld($)}else if(H.turn==="computer"){const Q=Math.max(bt.Y_MIN,Math.min(bt.Y_MAX,V.y));r.current={...H,player:{...H.player,y:Q}}}return}H.phase==="gameover"&&m(H)},[u,m]),p=oe.useCallback(S=>{S.preventDefault();const x=S.touches[0];if(!x)return;const V=r.current;if(V.phase!=="playing")return;const H=u(x.clientX,x.clientY);if(H){if(V.turn==="computer"){const Q=Math.max(bt.Y_MIN,Math.min(bt.Y_MAX,H.y));r.current={...V,player:{...V.player,y:Q}}}else if(V.turn==="player"){const Q=Math.max(Ke.Y_MIN,Math.min(Ke.Y_MAX,H.y));r.current={...V,aimY:Q}}}},[u]),y=oe.useCallback((S,x)=>{r.current={...r.current,input:{...r.current.input,[S]:x}}},[]),v=oe.useCallback(()=>{const S=r.current;S.phase==="ready"?r.current={...S,phase:"playing",startTime:Date.now()}:S.phase==="gameover"&&m(S)},[m]),w=oe.useCallback(()=>{const S=r.current;S.phase==="playing"&&S.turn==="player"&&S.turnPhase==="throwing"&&(r.current=Ld(S))},[]);return C.jsx("div",{className:"slalom-container",children:C.jsxs("div",{className:"arcade-cabinet",children:[C.jsx("div",{className:"arcade-top"}),C.jsx("div",{className:"arcade-marquee",children:"SNOWBALL SHOWDOWN"}),C.jsx("div",{className:"arcade-screen-bezel",children:C.jsx("canvas",{ref:i,width:Re.WIDTH,height:Re.HEIGHT,className:"slalom-canvas",style:{cursor:"crosshair",touchAction:"none"},onClick:S=>_(S.clientX,S.clientY),onTouchStart:S=>{S.preventDefault();const x=S.touches[0];x&&_(x.clientX,x.clientY)},onTouchMove:p})}),C.jsx("div",{className:"arcade-controls",children:C.jsxs("div",{className:"arcade-controls-inner",children:[C.jsx("button",{className:"arcade-touch-btn",onTouchStart:S=>{S.preventDefault(),y("up",!0)},onTouchEnd:S=>{S.preventDefault(),y("up",!1)},onMouseDown:()=>y("up",!0),onMouseUp:()=>y("up",!1),onMouseLeave:()=>y("up",!1),children:""}),C.jsx("button",{className:"arcade-touch-btn",onTouchStart:S=>{S.preventDefault(),y("down",!0)},onTouchEnd:S=>{S.preventDefault(),y("down",!1)},onMouseDown:()=>y("down",!0),onMouseUp:()=>y("down",!1),onMouseLeave:()=>y("down",!1),children:""}),C.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:S=>{S.preventDefault(),v()},onMouseDown:v,children:"START"}),C.jsx("button",{className:"arcade-touch-btn arcade-touch-throw",onTouchStart:S=>{S.preventDefault(),w()},onMouseDown:w,children:"THROW"})]})}),C.jsx("div",{className:"arcade-base"})]})})}function gk({onBack:t}){const[e,i]=oe.useState("menu"),r=oe.useCallback(()=>{i("menu")},[]),o=oe.useCallback(()=>{i("menu")},[]),u=oe.useCallback(()=>{i("menu")},[]);return oe.useEffect(()=>{const h=m=>{const _=m.key;e==="menu"?_==="1"?i("slalom"):_==="2"?i("defend"):_==="3"?i("snowball"):_==="4"?i("notes"):_==="5"&&t():e==="notes"&&(_==="Escape"||_==="b"||_==="B")&&i("menu")};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[e,t]),e==="slalom"?C.jsx(Xm,{standalone:!1,onGameOver:r}):e==="defend"?C.jsx(Qm,{standalone:!1,onGameOver:o}):e==="snowball"?C.jsx(Zm,{standalone:!1,onGameOver:u}):e==="notes"?C.jsxs("div",{className:"terminal",children:[C.jsxs("div",{className:"terminal-output",children:[C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-ascii welcome-art",children:`         *  .  *  .  *  .  *  .  *
      .     *     .     *     .
            .  *  .  *  .  *
               *  .  *
                 /\\
                /  \\         *  .  *
               / /\\ \\       .  *  .
              / /  \\ \\        *  .
             / /    \\ \\      .  *
            /  \\    /  \\
           /____\\  /____\\
          / ~~~~ SNOWPEAK ~~~~ \\
         / ~~~~~ RESORT  ~~~~~ \\
        /________________________\\
       /     est. 1976            \\
      /____________________________\\`}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"welcome-title",children:"RELEASE NOTES"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-system",children:"=".repeat(40)}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.8 -- Snowball Showdown"}),C.jsx("div",{className:"output-line output-normal",children:"  - New arcade mini-game: Snowball Showdown!"}),C.jsx("div",{className:"output-line output-normal",children:"  - Turn-based snowball fight with AI opponent"}),C.jsx("div",{className:"output-line output-normal",children:"  - Hidden arcade cabinet in the general store (expert mode)"}),C.jsx("div",{className:"output-line output-normal",children:"  - Requires game tokens from the abandoned cabin to play"}),C.jsx("div",{className:"output-line output-normal",children:"  - Old Dad NPC hints at tokens and the arcade"}),C.jsx("div",{className:"output-line output-normal",children:"  - Touch/click controls for mobile play"}),C.jsx("div",{className:"output-line output-normal",children:"  - Available in Bonus Content menu and in-game"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.7 -- Defend the Village"}),C.jsx("div",{className:"output-line output-normal",children:"  - New arcade mini-game: Defend the Village from wolves and bears!"}),C.jsx("div",{className:"output-line output-normal",children:"  - Hidden dusty arcade cabinet in the locked basement"}),C.jsx("div",{className:"output-line output-normal",children:"  - Boss bear finale after 20 animals defeated"}),C.jsx("div",{className:"output-line output-normal",children:"  - Ammo/reload system with 5-shot clips"}),C.jsx("div",{className:"output-line output-normal",children:"  - Available in Bonus Content menu and in-game"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.6 -- Expert Mode (BETA)"}),C.jsx("div",{className:"output-line output-normal",children:"  - New Expert Mode with double-size map (24 rooms vs 12)"}),C.jsx("div",{className:"output-line output-normal",children:"  - 12 new locations: Staff areas, village expansion, mountain zones"}),C.jsx("div",{className:"output-line output-normal",children:"  - Modified item discovery: explore to find critical items"}),C.jsx("div",{className:"output-line output-normal",children:"  - Expert mode winners prioritized on leaderboard"}),C.jsx("div",{className:"output-line output-normal",children:"  - Quit/restart command added to all modes"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.5 -- Mobile & Responsive"}),C.jsx("div",{className:"output-line output-normal",children:"  - Fully responsive layout for phones and tablets"}),C.jsx("div",{className:"output-line output-normal",children:"  - Touch controls for the slalom arcade game"}),C.jsx("div",{className:"output-line output-normal",children:"  - Smarter obstacle placement for fairer gameplay"}),C.jsx("div",{className:"output-line output-normal",children:"  - NPC portraits for all characters"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.4 -- Game Room & Custom Arcade Game"}),C.jsx("div",{className:"output-line output-normal",children:"  - Added a game room off the lodge bar"}),C.jsx("div",{className:"output-line output-normal",children:"  - Custom-built slalom arcade mini-game with retro 80s graphics"}),C.jsx("div",{className:"output-line output-normal",children:"  - NPC rival skiers and cheering spectator crowds"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.3 -- High Score Table"}),C.jsx("div",{className:"output-line output-normal",children:"  - Leaderboard tracking for completed adventures"}),C.jsx("div",{className:"output-line output-normal",children:"  - Player stats: steps taken, elapsed time, game mode"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.2 -- Images & Sound"}),C.jsx("div",{className:"output-line output-normal",children:"  - Character portraits and location images"}),C.jsx("div",{className:"output-line output-normal",children:"  - Web Audio API sound effects throughout the adventure"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.1 -- Easy Mode"}),C.jsx("div",{className:"output-line output-normal",children:"  - Multiple choice option for beginner-friendly gameplay"}),C.jsx("div",{className:"output-line output-normal",children:"  - Smart context-sensitive choice generation"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-title",children:"v1.0 -- First Playable Version"}),C.jsx("div",{className:"output-line output-normal",children:"  - Complete Zork-style text adventure"}),C.jsx("div",{className:"output-line output-normal",children:"  - 10+ rooms, NPCs, puzzles, and the Secret of Snowpeak Resort"}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-system",children:"=".repeat(40)}),C.jsx("div",{className:"output-line output-normal",children:""})]}),C.jsx("div",{className:"mode-select",children:C.jsxs("button",{className:"mode-button",onClick:()=>i("menu"),autoFocus:!0,children:["BACK",C.jsx("span",{className:"mode-desc",children:"Return to bonus content menu"})]})})]}):C.jsxs("div",{className:"terminal",children:[C.jsxs("div",{className:"terminal-output",children:[C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"output-line output-ascii welcome-art",children:`         *  .  *  .  *  .  *  .  *
      .     *     .     *     .
            .  *  .  *  .  *
               *  .  *
                 /\\
                /  \\         *  .  *
               / /\\ \\       .  *  .
              / /  \\ \\        *  .
             / /    \\ \\      .  *
            /  \\    /  \\
           /____\\  /____\\
          / ~~~~ SNOWPEAK ~~~~ \\
         / ~~~~~ RESORT  ~~~~~ \\
        /________________________\\
       /     est. 1976            \\
      /____________________________\\`}),C.jsx("div",{className:"output-line output-normal",children:""}),C.jsx("div",{className:"welcome-title",children:"BONUS CONTENT"}),C.jsx("div",{className:"welcome-subtitle",children:"Mini-games & extras"}),C.jsx("div",{className:"output-line output-normal",children:""})]}),C.jsxs("div",{className:"mode-select",children:[C.jsxs("button",{className:"mode-button",onClick:()=>i("slalom"),autoFocus:!0,children:["[1] PLAY SLALOM CHALLENGE",C.jsx("span",{className:"mode-desc",children:"Hit the slopes in the 80s arcade ski game"})]}),C.jsxs("button",{className:"mode-button",onClick:()=>i("defend"),children:["[2] PLAY DEFEND THE VILLAGE",C.jsx("span",{className:"mode-desc",children:"Protect the village from wolves and bears!"})]}),C.jsxs("button",{className:"mode-button",onClick:()=>i("snowball"),children:["[3] PLAY SNOWBALL SHOWDOWN",C.jsx("span",{className:"mode-desc",children:"Turn-based snowball fight  dodge and throw!"})]}),C.jsxs("button",{className:"mode-button",onClick:()=>i("notes"),children:["[4] RELEASE NOTES",C.jsx("span",{className:"mode-desc",children:"View version history and changelog"})]}),C.jsxs("button",{className:"mode-button",onClick:t,children:["[5] BACK",C.jsx("span",{className:"mode-desc",children:"Return to the start screen"})]})]})]})}function yk(t){let e={...t};return e.puzzles.victory&&(e={...e,gameOver:!0}),e}function Tk(t,e){if(t.gameOver&&e.type!=="ADD_OUTPUT")return t;let i;switch(e.type){case"MOVE":i=o2(t,e.payload);break;case"LOOK":i=l2(t,e.payload);break;case"TAKE":i=u2(t,e.payload);break;case"DROP":i=c2(t,e.payload);break;case"INVENTORY":i=h2(t);break;case"TALK":i=XE(t,e.payload);break;case"GIVE":i=d2(t,e.payload);break;case"USE":i=f2(t,e.payload);break;case"READ":i=m2(t,e.payload);break;case"QUIT":i=_2(t);break;case"HELP":{const r=_h(Date.now()-(t.startTime||Date.now())),o={text:`Current stats:  ${t.turnCount} steps  |  ${r} elapsed`,type:"system"},h={text:`Current mode:   ${t.mode==="expert"?"Expert (BETA)":t.mode==="easy"?"Easy":t.mode==="standard"?"Standard":t.mode||"Standard"}`,type:"system"};i={...t,output:[...t.output,...Pw,o,h]};break}case"SCORES":{const r=Bl(),o=e.payload?.showAll||!1;r.length===0?i={...t,output:[...t.output,{text:"No high scores yet. Be the first to complete the adventure!",type:"system"}]}:i={...t,output:[...t.output,...WE(r,o)]};break}case"ERASE_SCORES":s2(),j2(),i={...t,output:[...t.output,{text:"High score tables have been erased.",type:"system"},{text:"Adventure scores reset to defaults.",type:"system"},{text:"Slalom scores reset to Coach Joe (1000).",type:"system"}]};break;case"SLALOM_RESULT":{const{score:r,gatesPassed:o,difficulty:u}=e.payload,h=q2(t.playerName||"Player",r),m=[{text:"",type:"normal"},{text:"The arcade screen fades and you step back from the machine.",type:"normal"},{text:`Final Score: ${r}  |  Gates: ${o}  |  Difficulty: ${u}`,type:"system"}];h.newAllTimeRecord?m.push({text:"NEW ALL-TIME HIGH SCORE!",type:"victory"}):h.newDailyRecord&&m.push({text:"NEW DAILY HIGH SCORE!",type:"victory"}),h.beatCoachJoe?m.push({text:"You beat Coach Joe's high score of 1000! You are the Slalom Champion!",type:"victory"}):m.push({text:"Coach Joe's high score is 1000. Think you can beat it?",type:"normal"}),i={...t,launchSlalom:!1,output:[...t.output,...m],puzzles:h.beatCoachJoe?{...t.puzzles,slalom_champion:!0}:t.puzzles};break}case"DEFEND_RESULT":{const{defeated:r,total:o,elapsedMs:u,won:h}=e.payload,m=[{text:"",type:"normal"},{text:"The old CRT fades to black and you step back from the dusty cabinet, blinking in the dim basement light.",type:"normal"}];h?(m.push({text:`You defended the village! ${r} animals + BOSS defeated in ${Math.round(u/1e3)}s!`,type:"victory"}),m.push({text:'The ancient machine plays a triumphant 8-bit fanfare. "VILLAGE CHAMPION" flashes across the screen.',type:"normal"})):(m.push({text:`The village fell... You deterred ${r} of ${o} animals before being overrun.`,type:"system"}),m.push({text:'The cabinet lets out a mournful beep. "GAME OVER - INSERT COIN" scrolls across the screen.',type:"normal"}));let _={...t,launchDefend:!1,output:[...t.output,...m],puzzles:h?{...t.puzzles,village_champion:!0}:t.puzzles};if(t.mode==="expert"&&!t.puzzles.fuse_dislodged){const p=_.rooms.basement,y=_.items.fuse;if(y&&y.hidden&&p){const v=[{text:"",type:"normal"},{text:"As the ancient cabinet powers down, it shudders violently  decades of built-up static discharge and rickety wiring sending one final THUNK through its frame. The whole machine lurches sideways an inch on the stone floor.",type:"normal"},{text:"",type:"normal"},{text:"CLANG!",type:"title"},{text:"",type:"normal"},{text:"Something heavy and metallic tumbles out from behind the cabinet, bouncing across the basement floor with a ringing clatter. It spins to a stop at your feet  a heavy-duty electrical fuse! It must have been wedged between the cabinet and the wall for years, completely unreachable until the old machine shook it loose.",type:"normal"},{text:"",type:"normal"},{text:"[An electrical fuse has appeared on the floor!]",type:"system"}];_={..._,output:[..._.output,...v],items:{..._.items,fuse:{...y,hidden:!1}},puzzles:{..._.puzzles,fuse_dislodged:!0}}}}i=_;break}case"SNOWBALL_RESULT":{const{playerHits:r,computerHits:o,won:u}=e.payload,h=[{text:"",type:"normal"},{text:"The old screen flickers off and you step back, brushing pixelated snow from your imagination.",type:"normal"}];u?(h.push({text:`Snowball Champion! You landed ${r} hits to their ${o}!`,type:"victory"}),h.push({text:'The ancient cabinet buzzes triumphantly. "SNOWBALL CHAMPION" scrolls across the screen in icy blue letters.',type:"normal"})):(h.push({text:`Defeated... You only landed ${r} hits while taking ${o} snowballs to the face.`,type:"system"}),h.push({text:'The cabinet plays a sad little jingle. "BETTER LUCK NEXT TIME" blinks on screen.',type:"normal"})),i={...t,launchSnowball:!1,output:[...t.output,...h],puzzles:u?{...t.puzzles,snowball_champion:!0}:t.puzzles};break}case"ADD_OUTPUT":return{...t,output:[...t.output,e.payload]};default:return t}return i={...i,turnCount:t.turnCount+1},i=yk(i),i}const Dc={north:"north",n:"north",south:"south",s:"south",east:"east",e:"east",west:"west",w:"west",up:"up",u:"up",down:"down",d:"down"},Ek=[{verbs:["go","walk","move","head","travel"],action:"MOVE"},{verbs:["look","l","examine","inspect","describe"],action:"LOOK"},{verbs:["take","get","grab","pickup"],action:"TAKE"},{verbs:["drop","put","discard","leave"],action:"DROP"},{verbs:["use","apply","play"],action:"USE"},{verbs:["give","offer","hand","show"],action:"GIVE"},{verbs:["talk","speak","ask","chat"],action:"TALK"},{verbs:["read"],action:"READ"},{verbs:["inventory","inv","i"],action:"INVENTORY"},{verbs:["help","h","?","commands"],action:"HELP"},{verbs:["scores","score","highscores","leaderboard"],action:"SCORES"},{verbs:["quit","exit","restart","reset"],action:"QUIT"}];function vk(t){return t.filter(e=>!["the","a","an","at","to","with","on","in"].includes(e))}function Hd(t,e){const i=e.rooms[e.currentRoomId];for(const r of i.npcs){const o=e.npcs[r];if(o.name.toLowerCase().split(/\s+/).some(h=>t.includes(h))||t.includes(o.name.toLowerCase()))return r}for(const r of i.npcs)if(t.some(o=>r.includes(o)))return r;return null}const wk={"arcade game":"arcade_machine","defend game":"basement_arcade","defend the village":"basement_arcade","defend village":"basement_arcade","dusty arcade":"basement_arcade","old arcade":"basement_arcade","basement arcade":"basement_arcade","snowball game":"store_arcade","snowball fight":"store_arcade","snowball showdown":"store_arcade","store arcade":"store_arcade","store cabinet":"store_arcade",tokens:"game_tokens","game tokens":"game_tokens","bag of tokens":"game_tokens","token bag":"game_tokens"};function ZT(t,e){const i=e.rooms[e.currentRoomId],r=[...i.items,...e.inventory],o=t.join(" ");for(const[u,h]of Object.entries(wk))if(o.includes(u)&&r.includes(h))return h;for(const u of r){const h=e.items[u];if(!h||h.hidden&&i.items.includes(u))continue;if(h.name.toLowerCase().split(/\s+/).some(_=>t.includes(_))||t.includes(h.name.toLowerCase()))return u}for(const u of r){const h=e.items[u];if(h&&!(h.hidden&&i.items.includes(u))&&t.some(m=>u.includes(m)))return u}return null}function bk(t,e){const i=t.toLowerCase().trim();if(!i)return{error:"Say something!"};const r=i.split(/\s+/);if(i==="erase table")return{type:"ERASE_SCORES"};if(r.length===1&&Dc[r[0]])return{type:"MOVE",payload:{direction:Dc[r[0]]}};let o=r[0],u=r.slice(1);o==="pick"&&r[1]==="up"&&(o="pickup",u=r.slice(2));const h=Ek.find(p=>p.verbs.includes(o));if(!h){const p=Dc[r[r.length-1]];return p?{type:"MOVE",payload:{direction:p}}:{error:`I don't understand "${i}". Type "help" for a list of commands.`}}const m=h.action;if(m==="INVENTORY"||m==="HELP"||m==="QUIT")return{type:m};if(m==="SCORES")return{type:"SCORES",payload:{showAll:u.some(y=>["all","more","full","expand"].includes(y))}};if(m==="LOOK"&&u.length===0)return{type:"LOOK",payload:{}};const _=vk(u);if(m==="MOVE"){const p=_[0],y=Dc[p];return y?{type:"MOVE",payload:{direction:y}}:{error:"Go where? Try a direction: north, south, east, west, up, down."}}if(m==="GIVE"){if(_.length===0)return{error:'Give what to whom? Try "give <item> to <character>".'};const p=e.rooms[e.currentRoomId],y=ZT(_,e),v=Hd(_,e);return y&&v?{type:"GIVE",payload:{itemId:y,npcId:v}}:y&&!v?p.npcs.length===1?{type:"GIVE",payload:{itemId:y,npcId:p.npcs[0]}}:p.npcs.length>1?{error:"Give it to whom? There are multiple people here."}:{error:"There's nobody here to give that to."}:v?{type:"TALK",payload:{npcId:v}}:p.npcs.length>0?{type:"TALK",payload:{npcId:p.npcs[0]}}:{error:"There's nobody here to give that to."}}if(m==="TALK"){if(_.length===0)return{error:'Talk to whom? Try "talk to <character name>".'};const p=Hd(_,e);return p?{type:"TALK",payload:{npcId:p}}:{error:`There's nobody called "${u.join(" ")}" here.`}}if(["TAKE","DROP","USE","LOOK","READ"].includes(m)){if(_.length===0)return{error:`${m==="LOOK"?"Look at":m.charAt(0)+m.slice(1).toLowerCase()} what?`};if(m==="LOOK"){const y=Hd(_,e);if(y)return{type:"LOOK",payload:{npcId:y}}}const p=ZT(_,e);return p?{type:m,payload:{itemId:p}}:m==="LOOK"?{type:"LOOK",payload:{target:u.join(" ")}}:{error:`I don't see "${u.join(" ")}" here.`}}return{error:`I don't understand "${i}". Type "help" for a list of commands.`}}const Ak={lodge_lobby:{id:"lodge_lobby",name:"Resort Lodge Lobby",ascii:`
        ___________________________
       |  SNOWPEAK RESORT - 1976  |
       |__________________________|
       |    |              |    |
       | [] |  ___    ___  | [] |
       |    | |   |  |   | |    |
       |    | | ~ |  | ~ | |    |
   ____|____|_|___|__|___|_|____|____
  |  _____                  _____  |
  | |     | /\\  ~~flames~~ |     | |
  | |     |/  \\  /\\ /\\ /\\  |     | |
  | |_____| __ \\/__\\/__\\/__\\|_____| |
  |________|____|__________|________|`,description:'You stand in the grand lobby of Snowpeak Resort. Once magnificent, the place has seen better days. A massive stone fireplace dominates one wall, though only embers glow within it. Dusty chandeliers hang overhead, and faded ski posters line the walls. A moth-eaten welcome banner reads "SNOWPEAK RESORT - EST. 1976."',exits:{north:"main_street",east:"lodge_bar",west:"lodge_balcony"},hiddenExits:{},lockedExits:{down:{roomId:"basement",keyId:"basement_key",message:"A heavy wooden door leads downward, but it's locked tight. You'd need a key."}},items:["old_map"],npcs:["mr_smiles"]},lodge_bar:{id:"lodge_bar",name:"Lodge Bar",ascii:`
     _________________________________
    |  _   _   _                     |
    | (o) (o) (o)  <-- ski goggles!  |
    |  |   |   |                     |
    |  ~~  ~~  ~~   taxidermy heads  |
    |________________________________|
    |          ____                  |
    |   ___   |    |  _  _  _        |
    |  |   |  |    | |_||_||_|       |
    |  | ~ |  |    | |  |  |         |
    |  |/\\.| |____|_|__|__|__        |
    |__|____|_|_______________|____ _|
    |====BAR COUNTER=================|
    |________________________________|`,description:"A dimly lit bar with a crackling fireplace that provides the only warmth in the whole resort. Taxidermied animal heads line the walls, all wearing tiny ski goggles. The shelves behind the bar are mostly empty, save for a few dusty bottles. The air smells of old wood and stale pretzels. To the east, a doorway leads to a game room.",exits:{west:"lodge_lobby",east:"game_room"},hiddenExits:{},lockedExits:{},items:["broken_radio","whiskey_bottle"],npcs:["angry_boss"]},game_room:{id:"game_room",name:"Game Room",ascii:`
     _________________________________
    |  ___   GAME ROOM          ___  |
    | |   |                    |   | |
    | | S |   ___________      | D | |
    | | L |  |           |     | A | |
    | | A |  | POOL TABLE|     | R | |
    | | L |  |    (o)    |     | T | |
    | | O |  |___________|     | S | |
    | | M |                    |   | |
    | |___|  [FREE PLAY]       |___| |
    |________________________________|`,description:"A recreation room off the bar, filled with old entertainment. A battered arcade cabinet dominates one corner, its screen glowing with green pixels. A pool table with faded felt sits in the center, and a dartboard hangs on the far wall. The room smells of old carpet and nostalgia.",exits:{west:"lodge_bar"},hiddenExits:{},lockedExits:{},items:["arcade_machine"],npcs:[]},lodge_balcony:{id:"lodge_balcony",name:"Lodge Balcony",ascii:`
               /\\
              /  \\        *
             /    \\      *
            //\\/\\\\    *  <-- glint!
           //    \\ \\
          / \\    /  \\
         /___\\  /____\\
        /   MOUNTAIN   \\
    ~~~~/~~~~~~~~~~~~~~~\\~~~~
       |                  |
    ===|====BALCONY=======|===
    |  |  []          []  |  |
    |  |__________________|  |
    |________________________|`,description:"A wide wooden balcony overlooking the resort grounds. The mountain rises dramatically to the north, its peak shrouded in mist. From here you can see the main street below and the ski slopes winding up the mountainside. The railing is icy to the touch. Something glints far up on the mountain, near the frozen waterfall.",exits:{east:"lodge_lobby"},hiddenExits:{},lockedExits:{},items:["binoculars"],npcs:[]},basement:{id:"basement",name:"Mysterious Basement",ascii:`
     ___________________________________
    |  ~  ~  ~  COBWEBS  ~  ~  ~       |
    |    _______                       |
    |   |       |   ____  ____         |
    |   | TOBIAS|  |    ||    |        |
    |   | SNOW- |  | __ || __ |        |
    |   | PEAK  |  ||__|||__| |        |
    |   | /__\\ |  |WORKBENCH |        |
    |   |_______|  |__________|  ___   |
    |                           |   |  |
    |  ///  ///   old ski      |???|  |
    |  ///  ///   equipment    |___|  |
    |__________________________________|`,description:"A damp stone basement beneath the lodge. Old ski equipment rusts in the corners. Cobwebs hang from exposed wooden beams. Against the far wall, a workbench is covered in old papers and tools. A portrait of a distinguished-looking man in vintage ski attire hangs crooked on the wall -- the resort's founder, Tobias Snowpeak. In a dark corner, half-buried under a dusty tarp, sits what appears to be an old arcade cabinet.",exits:{up:"lodge_lobby"},hiddenExits:{},lockedExits:{},items:["dusty_journal","basement_arcade"],npcs:[]},main_street:{id:"main_street",name:"Main Street",ascii:`
            *  *  *  *  *
         *  snowflakes   *
           *  *  *  *
     _____    (  )    _____
    |SHOP |   |  |   |SHOP |
    |_____|   |  |   |CLOSE|
    |XXXXX|   |  |   |XXXXX|
    |XXXXX|   |  |   |XXXXX|
    |_____|   |  |   |_____|
       |      |  |      |
    ---+------+--+------+---
    ~~~~ MAIN STREET ~~~~~~~~
    ---+------+--+------+---
       |  <- SKI    VILLAGE
       | RENTAL       -> |`,description:`The resort's main thoroughfare is covered in packed snow. Quaint shops line both sides, though most are boarded up for the season -- or perhaps permanently. Old-fashioned lamp posts flicker with weak electric light. To the north, the ski slopes begin their gentle ascent. A cheerful sign pointing east reads "Mountain Village" and another pointing west reads "Ski Rental."`,exits:{south:"lodge_lobby",north:"ski_slopes",east:"village",west:"ski_rental"},hiddenExits:{},lockedExits:{},items:[],npcs:["henrys_mom"]},ski_rental:{id:"ski_rental",name:"Ski Rental Shop",ascii:`
     _________________________________
    | "HELP YOURSELF" - Management   |
    |________________________________|
    |   /|  /|  /|     __|__         |
    |  / | / | / |    |BOOTS|        |
    | /  |/  |/  |    |pile |        |
    | SKIS SKIS  |    |o]_[o|        |
    |            |    |o]_[o|        |
    |  __|  __|  |    |_____|        |
    | |  | |  |  |                   |
    | |--| |--|  |  _O_  goggles     |
    | |__| |__|  | (___) basket      |
    |____________|___________________|`,description:'A chaotic shop overflowing with mismatched ski equipment. Skis of every era lean against the walls -- from modern carbon fiber to what appear to be actual wooden planks with leather straps. Boots are piled in heaps, helmets dangle from hooks, and a basket of goggles sits on the counter. A hand-written sign says "HELP YOURSELF - Management."',exits:{east:"main_street"},hiddenExits:{},lockedExits:{},items:["ski_poles"],npcs:["dill_pickle"]},village:{id:"village",name:"Mountain Village",ascii:`
          /\\           /\\
         /  \\   ^^^   /  \\
        / /\\ \\ ^^^  //\\ \\
       / /  \\ \\    //  \\ \\
      /  \\  /  \\  / \\  /  \\
     /____\\/____\\/___\\/____\\
      A-FRAMES     VILLAGE
            ______
           | /_\\ |
           ||   ||    TOBIAS
           || O ||    SNOWPEAK
           ||/\\||    statue
           |_____|
        "He who seeks the
       still water finds
           the path"`,description:'A picturesque alpine village with A-frame buildings covered in snow. Smoke rises from a few chimneys, but the streets are eerily quiet. In the center of the village square stands a bronze statue of a man on skis, one arm raised triumphantly. The plaque reads: "TOBIAS SNOWPEAK - He who seeks the still water finds the path." A small general store appears to be the only open business.',exits:{west:"main_street"},hiddenExits:{},lockedExits:{},items:["warm_coat","note_from_founder"],npcs:["dance_mom"]},ski_slopes:{id:"ski_slopes",name:"Ski Slopes",ascii:`
                           /\\
                          /  \\
                   /\\   / -- \\  lift
                  /  \\ /______\\ station
                 /    \\\\
                / ---- \\\\   ___
               / SLOPES \\\\  |:|
              /  ~~~~~~~~ \\  |:| <--lift
             / ~~~~~~~~~~~~\\ |:|
    ______  / ~~~~~~~~~~~~~~\\
   | :)  :)|~~~~~~~~~~~~~~~~|
   |BEGINR |~~~~~~~~~~~~~~~~|
   |_ZONE__|~~~~~~~~~~~~~~~~|`,description:`The bunny slope -- a comically gentle incline that wouldn't challenge a toddler on a sled. A faded sign reads "BEGINNER ZONE" with encouraging smiley faces. The snow is well-packed but the slope is deserted. To the north, the terrain rises more steeply toward a frozen waterfall. A rickety ski lift station is visible further up the mountain.`,exits:{south:"main_street",north:"frozen_waterfall",up:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:[],npcs:["coach_joe"]},ski_lift_top:{id:"ski_lift_top",name:"Ski Lift Top Station",ascii:`
     >>>>  FIERCE WIND  >>>>
         ________________
        |  SKI LIFT TOP |
        |    STATION    |
        |_______________|
        |  ___          |
        | | ! | FUSE    |
        | | ! | PANEL   |
        | |___| [EMPTY] |
        |_______________|
            |  |
    ~~~~~~~~|  |~~~~~~~~
      ___/  |  |  \\___
     |__|   |__|   |__|
     chairs  on  cable`,description:"The upper ski lift station sits on a windswept platform. The lift chairs hang motionless on the cable -- the machinery is dead. An electrical panel on the side of the station house hangs open, revealing a conspicuously empty fuse socket. If the lift were working, it could carry you up to the mountain peak.",exits:{down:"ski_slopes",east:"frozen_waterfall"},hiddenExits:{},lockedExits:{},items:[],npcs:[]},frozen_waterfall:{id:"frozen_waterfall",name:"Frozen Waterfall",ascii:`
        .  *  .  *  .  *  .
      *    icicles    *
        . \\ | / . \\ | / .
         \\\\|//   \\\\|//
    ______\\|/______\\|/____
    |  ~~~ FROZEN ~~~      |
    | |  WATERFALL  |      |
    | | icicicicic | ????  |
    | | icicicicic |       |
    | | icicicicic | crack |
    | | icicicicic |  in   |
    | | icicicicic |  ice  |
    |_|____________|_______|
    ~~~~~~~~~~~~~~~~~~~~~~~~
     water stands still...`,description:"A spectacular wall of ice rises before you -- a waterfall frozen mid-cascade. The ice is crystal blue and translucent, with strange shapes visible deep within. Icicles the size of swords hang from rocky outcrops above. The whole scene is eerily beautiful and perfectly, impossibly still. Water that stands still...",exits:{south:"ski_slopes",west:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["chewed_gum"],npcs:[]},hidden_cave:{id:"hidden_cave",name:"Hidden Cave",ascii:`
    _/\\_/\\___/\\_____/\\_/\\_
   /                       \\
  /  /\\/\\   strange  /\\  \\
 |  /  Y  \\  markings /  \\ |
 | |  ~~~  | on walls |****| |
 | | ~~~ ~ |  <> <>   |****| |
 | |  ~~~  |  <> <>   |****| |
 |  \\ ~~~ /   _____  | ** | |
 |   \\   /   |     | |    | |
 |    \\ /    | (O) | steps| |
  \\    V     |medal| down /
   \\_______ _|_____|_____/`,description:"A narrow cave behind the waterfall, its walls glistening with frost. The passage winds deeper into the mountain. Strange markings are scratched into the stone walls -- they look like a mix of ski trail markers and something much older. The air is cold and still. At the back of the cave, rough stone steps lead downward into darkness. A circular indentation in the wall beside the steps looks like something should fit into it.",exits:{west:"frozen_waterfall"},hiddenExits:{},lockedExits:{down:{roomId:"underground_vault",keyId:"strange_medallion",message:"Stone steps lead down to a heavy door with a circular indentation. It looks like a medallion-shaped key is needed."}},items:["torch"],npcs:[]},underground_vault:{id:"underground_vault",name:"Underground Vault",ascii:`
    .  *  .  *  .  *  .  *  .
   _____________________________
  |  *   THE UNDERGROUND   *   |
  |      ~~~~VAULT~~~~         |
  | *     ___________      *   |
  |      |           |         |
  |  /-\\|  __/\\__  |/-\\     |
  | |SKI||  \\    /  ||SKI|    |
  | |___|   \\\\  // ||___|    |
  |      |  TROPHY   |         |
  |      |___________|         |
  |  *     [======]        *   |
  |        [letter]            |
  |____________________________|`,description:"You descend into a hidden chamber carved from the living rock of the mountain. Torchlight dances across the walls, revealing intricate carvings of skiers, mountains, and snowflakes. In the center of the vault, on a pedestal of polished stone, sits a magnificent golden trophy shaped like a ski. Beside it lies a sealed envelope. This is it -- the legendary secret of Snowpeak Resort.",exits:{up:"hidden_cave"},hiddenExits:{},lockedExits:{},items:["golden_ski_trophy","founders_letter"],npcs:[]},mountain_peak:{id:"mountain_peak",name:"Mountain Peak",ascii:`
              YOU
             \\o/
              |         * . * . *
         ____/\\______  .  *  .  *  .
        /     SUMMIT  \\   *  .  *
       / ~~~~~~~~~~~~~ \\
      / /\\  /\\  /\\  /\\ \\
     / /  \\/  \\/  \\/  \\ \\
    / /    \\   \\   \\   \\ \\
   /_/______\\_  \\_  \\_  \\_\\
  /     SNOWPEAK     MOUNTAIN  \\
 /  PANORAMIC VIEW OF WORLD     \\
/________________________________\\`,description:"You stand at the summit of Snowpeak Mountain. The wind howls around you but the view is breathtaking -- an endless panorama of snow-covered peaks stretching to the horizon. Far below, the resort looks like a toy village. You can see everything from here: the frozen waterfall, the village, the winding slopes. Half-buried in the snow near a cairn of stacked rocks, something glints in the sunlight. The ski lift can carry you back down.",exits:{down:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["strange_medallion"],npcs:[]}},Sk={lodge_lobby:{id:"lodge_lobby",name:"Resort Lodge Lobby",ascii:`
        ___________________________
       |  SNOWPEAK RESORT - 1976  |
       |__________________________|
       |    |              |    |
       | [] |  ___    ___  | [] |
       |    | |   |  |   | |    |
       |    | | ~ |  | ~ | |    |
   ____|____|_|___|__|___|_|____|____
  |  _____                  _____  |
  | |     | /\\  ~~flames~~ |     | |
  | |     |/  \\  /\\ /\\ /\\  |     | |
  | |_____| __ \\/__\\/__\\/__\\|_____| |
  |________|____|__________|________|`,description:'You stand in the grand lobby of Snowpeak Resort. Once magnificent, the place has seen better days. A massive stone fireplace dominates one wall, though only embers glow within it. Dusty chandeliers hang overhead, and faded ski posters line the walls. A moth-eaten welcome banner reads "SNOWPEAK RESORT - EST. 1976." To the south, a narrow hallway leads to the staff quarters.',exits:{north:"main_street",east:"lodge_bar",west:"lodge_balcony",south:"staff_hallway"},hiddenExits:{},lockedExits:{down:{roomId:"basement",keyId:"basement_key",message:"A heavy wooden door leads downward, but it's locked tight. You'd need a key."}},items:["old_map"],npcs:["mr_smiles"]},lodge_bar:{id:"lodge_bar",name:"Lodge Bar",ascii:`
     _________________________________
    |  _   _   _                     |
    | (o) (o) (o)  <-- ski goggles!  |
    |  |   |   |                     |
    |  ~~  ~~  ~~   taxidermy heads  |
    |________________________________|
    |          ____                  |
    |   ___   |    |  _  _  _        |
    |  |   |  |    | |_||_||_|       |
    |  | ~ |  |    | |  |  |         |
    |  |/\\.| |____|_|__|__|__        |
    |__|____|_|_______________|____ _|
    |====BAR COUNTER=================|
    |________________________________|`,description:"A dimly lit bar with a crackling fireplace that provides the only warmth in the whole resort. Taxidermied animal heads line the walls, all wearing tiny ski goggles. The shelves behind the bar are mostly empty, save for a few dusty bottles. The air smells of old wood and stale pretzels. To the east, a doorway leads to a game room. A swinging door to the south leads to the kitchen.",exits:{west:"lodge_lobby",east:"game_room",south:"kitchen"},hiddenExits:{},lockedExits:{},items:["broken_radio","whiskey_bottle"],npcs:["angry_boss"]},game_room:{id:"game_room",name:"Game Room",ascii:`
     _________________________________
    |  ___   GAME ROOM          ___  |
    | |   |                    |   | |
    | | S |   ___________      | D | |
    | | L |  |           |     | A | |
    | | A |  | POOL TABLE|     | R | |
    | | L |  |    (o)    |     | T | |
    | | O |  |___________|     | S | |
    | | M |                    |   | |
    | |___|  [FREE PLAY]       |___| |
    |________________________________|`,description:"A recreation room off the bar, filled with old entertainment. A battered arcade cabinet dominates one corner, its screen glowing with green pixels. A pool table with faded felt sits in the center, and a dartboard hangs on the far wall. The room smells of old carpet and nostalgia.",exits:{west:"lodge_bar"},hiddenExits:{},lockedExits:{},items:["arcade_machine"],npcs:[]},lodge_balcony:{id:"lodge_balcony",name:"Lodge Balcony",ascii:`
               /\\
              /  \\        *
             /    \\      *
            //\\/\\\\    *  <-- glint!
           //    \\ \\
          / \\    /  \\
         /___\\  /____\\
        /   MOUNTAIN   \\
    ~~~~/~~~~~~~~~~~~~~~\\~~~~
       |                  |
    ===|====BALCONY=======|===
    |  |  []          []  |  |
    |  |__________________|  |
    |________________________|`,description:"A wide wooden balcony overlooking the resort grounds. The mountain rises dramatically to the north, its peak shrouded in mist. From here you can see the main street below and the ski slopes winding up the mountainside. The railing is icy to the touch. Something glints far up on the mountain, near the frozen waterfall.",exits:{east:"lodge_lobby"},hiddenExits:{},lockedExits:{},items:["binoculars"],npcs:[]},basement:{id:"basement",name:"Mysterious Basement",ascii:`
     ___________________________________
    |  ~  ~  ~  COBWEBS  ~  ~  ~       |
    |    _______                       |
    |   |       |   ____  ____         |
    |   | TOBIAS|  |    ||    |        |
    |   | SNOW- |  | __ || __ |        |
    |   | PEAK  |  ||__|||__| |        |
    |   | /__\\ |  |WORKBENCH |        |
    |   |_______|  |__________|  ___   |
    |                           |   |  |
    |  ///  ///   old ski      |???|  |
    |  ///  ///   equipment    |___|  |
    |__________________________________|`,description:"A damp stone basement beneath the lodge. Old ski equipment rusts in the corners. Cobwebs hang from exposed wooden beams. Against the far wall, a workbench is covered in old papers and tools. A portrait of a distinguished-looking man in vintage ski attire hangs crooked on the wall -- the resort's founder, Tobias Snowpeak. A dark tunnel entrance is barely visible in the corner. In a dark corner, half-buried under a dusty tarp, sits what appears to be an old arcade cabinet. Something metallic glints behind it, wedged between the cabinet and the stone wall.",exits:{up:"lodge_lobby",north:"underground_tunnel"},hiddenExits:{},lockedExits:{},items:["dusty_journal","basement_arcade","fuse"],npcs:[]},main_street:{id:"main_street",name:"Main Street",ascii:`
            *  *  *  *  *
         *  snowflakes   *
           *  *  *  *
     _____    (  )    _____
    |SHOP |   |  |   |SHOP |
    |_____|   |  |   |CLOSE|
    |XXXXX|   |  |   |XXXXX|
    |XXXXX|   |  |   |XXXXX|
    |_____|   |  |   |_____|
       |      |  |      |
    ---+------+--+------+---
    ~~~~ MAIN STREET ~~~~~~~~
    ---+------+--+------+---
       |  <- SKI    VILLAGE
       | RENTAL       -> |`,description:`The resort's main thoroughfare is covered in packed snow. Quaint shops line both sides, though most are boarded up for the season -- or perhaps permanently. Old-fashioned lamp posts flicker with weak electric light. To the north, the ski slopes begin their gentle ascent. A cheerful sign pointing east reads "Mountain Village" and another pointing west reads "Ski Rental."`,exits:{south:"lodge_lobby",north:"ski_slopes",east:"village",west:"ski_rental"},hiddenExits:{},lockedExits:{},items:[],npcs:["henrys_mom"]},ski_rental:{id:"ski_rental",name:"Ski Rental Shop",ascii:`
     _________________________________
    | "HELP YOURSELF" - Management   |
    |________________________________|
    |   /|  /|  /|     __|__         |
    |  / | / | / |    |BOOTS|        |
    | /  |/  |/  |    |pile |        |
    | SKIS SKIS  |    |o]_[o|        |
    |            |    |o]_[o|        |
    |  __|  __|  |    |_____|        |
    | |  | |  |  |                   |
    | |--| |--|  |  _O_  goggles     |
    | |__| |__|  | (___) basket      |
    |____________|___________________|`,description:'A chaotic shop overflowing with mismatched ski equipment. Skis of every era lean against the walls -- from modern carbon fiber to what appear to be actual wooden planks with leather straps. Boots are piled in heaps, helmets dangle from hooks, and a basket of goggles sits on the counter. A hand-written sign says "HELP YOURSELF - Management." A dusty storage room is visible through a back door.',exits:{east:"main_street",north:"storage_room"},hiddenExits:{},lockedExits:{},items:["ski_poles"],npcs:["dill_pickle"]},village:{id:"village",name:"Mountain Village",ascii:`
          /\\           /\\
         /  \\   ^^^   /  \\
        / /\\ \\ ^^^  //\\ \\
       / /  \\ \\    //  \\ \\
      /  \\  /  \\  / \\  /  \\
     /____\\/____\\/___\\/____\\
      A-FRAMES     VILLAGE
            ______
           | /_\\ |
           ||   ||    TOBIAS
           || O ||    SNOWPEAK
           ||/\\||    statue
           |_____|
        "He who seeks the
       still water finds
           the path"`,description:'A picturesque alpine village with A-frame buildings covered in snow. Smoke rises from a few chimneys, but the streets are eerily quiet. In the center of the village square stands a bronze statue of a man on skis, one arm raised triumphantly. The plaque reads: "TOBIAS SNOWPEAK - He who seeks the still water finds the path." A small general store appears to be the only open business. To the north, an old chapel stands on a hill. To the south, a weathered cabin sits among the trees.',exits:{west:"main_street",north:"chapel",south:"old_cabin",east:"general_store"},hiddenExits:{},lockedExits:{},items:["warm_coat","note_from_founder"],npcs:["dance_mom"]},ski_slopes:{id:"ski_slopes",name:"Ski Slopes",ascii:`
                           /\\
                          /  \\
                   /\\   / -- \\  lift
                  /  \\ /______\\ station
                 /    \\\\
                / ---- \\\\   ___
               / SLOPES \\\\  |:|
              /  ~~~~~~~~ \\  |:| <--lift
             / ~~~~~~~~~~~~\\ |:|
    ______  / ~~~~~~~~~~~~~~\\
   | :)  :)|~~~~~~~~~~~~~~~~|
   |BEGINR |~~~~~~~~~~~~~~~~|
   |_ZONE__|~~~~~~~~~~~~~~~~|`,description:`The bunny slope -- a comically gentle incline that wouldn't challenge a toddler on a sled. A faded sign reads "BEGINNER ZONE" with encouraging smiley faces. The snow is well-packed but the slope is deserted. To the north, the terrain rises more steeply toward a frozen waterfall. A rickety ski lift station is visible further up the mountain. To the east, a narrow trail marked "DANGER: AVALANCHE ZONE" leads into treacherous terrain.`,exits:{south:"main_street",north:"frozen_waterfall",up:"ski_lift_top",east:"avalanche_zone"},hiddenExits:{},lockedExits:{},items:[],npcs:["coach_joe"]},ski_lift_top:{id:"ski_lift_top",name:"Ski Lift Top Station",ascii:`
     >>>>  FIERCE WIND  >>>>
         ________________
        |  SKI LIFT TOP |
        |    STATION    |
        |_______________|
        |  ___          |
        | | ! | FUSE    |
        | | ! | PANEL   |
        | |___| [EMPTY] |
        |_______________|
            |  |
    ~~~~~~~~|  |~~~~~~~~
      ___/  |  |  \\___
     |__|   |__|   |__|
     chairs  on  cable`,description:"The upper ski lift station sits on a windswept platform. The lift chairs hang motionless on the cable -- the machinery is dead. An electrical panel on the side of the station house hangs open, revealing a conspicuously empty fuse socket. If the lift were working, it could carry you up to the mountain peak. A treacherous ridge trail leads west along the mountain face. To the north, a narrow icy passage disappears into the mountain.",exits:{down:"ski_slopes",east:"frozen_waterfall",west:"ridge_trail"},hiddenExits:{},lockedExits:{north:{roomId:"ice_caves",requireItems:["rope","pickaxe"],message:"To the north, a narrow icy passage leads down into what looks like caves beneath the mountain. The walls are slick with ice and the descent is treacherous. You'd need both climbing rope and a pickaxe to make it down safely."}},items:[],npcs:[]},frozen_waterfall:{id:"frozen_waterfall",name:"Frozen Waterfall",ascii:`
        .  *  .  *  .  *  .
      *    icicles    *
        . \\ | / . \\ | / .
         \\\\|//   \\\\|//
    ______\\|/______\\|/____
    |  ~~~ FROZEN ~~~      |
    | |  WATERFALL  |      |
    | | icicicicic | ????  |
    | | icicicicic |       |
    | | icicicicic | crack |
    | | icicicicic |  in   |
    | | icicicicic |  ice  |
    |_|____________|_______|
    ~~~~~~~~~~~~~~~~~~~~~~~~
     water stands still...`,description:"A spectacular wall of ice rises before you -- a waterfall frozen mid-cascade. The ice is crystal blue and translucent, with strange shapes visible deep within. Icicles the size of swords hang from rocky outcrops above. The whole scene is eerily beautiful and perfectly, impossibly still. Water that stands still...",exits:{south:"ski_slopes",west:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["chewed_gum"],npcs:[]},hidden_cave:{id:"hidden_cave",name:"Hidden Cave",ascii:`
    _/\\_/\\___/\\_____/\\_/\\_
   /                       \\
  /  /\\/\\   strange  /\\  \\
 |  /  Y  \\  markings /  \\ |
 | |  ~~~  | on walls |****| |
 | | ~~~ ~ |  <> <>   |****| |
 | |  ~~~  |  <> <>   |****| |
 |  \\ ~~~ /   _____  | ** | |
 |   \\   /   |     | |    | |
 |    \\ /    | (O) | steps| |
  \\    V     |medal| down /
   \\_______ _|_____|_____/`,description:"A narrow cave behind the waterfall, its walls glistening with frost. The passage winds deeper into the mountain. Strange markings are scratched into the stone walls -- they look like a mix of ski trail markers and something much older. The air is cold and still. At the back of the cave, rough stone steps lead downward into darkness. A circular indentation in the wall beside the steps looks like something should fit into it.",exits:{west:"frozen_waterfall"},hiddenExits:{},lockedExits:{down:{roomId:"underground_vault",keyId:"strange_medallion",message:"Stone steps lead down to a heavy door with a circular indentation. It looks like a medallion-shaped key is needed."}},items:["torch"],npcs:[]},underground_vault:{id:"underground_vault",name:"Underground Vault",ascii:`
    .  *  .  *  .  *  .  *  .
   _____________________________
  |  *   THE UNDERGROUND   *   |
  |      ~~~~VAULT~~~~         |
  | *     ___________      *   |
  |      |           |         |
  |  /-\\|  __/\\__  |/-\\     |
  | |SKI||  \\    /  ||SKI|    |
  | |___|   \\\\  // ||___|    |
  |      |  TROPHY   |         |
  |      |___________|         |
  |  *     [======]        *   |
  |        [letter]            |
  |____________________________|`,description:"You descend into a hidden chamber carved from the living rock of the mountain. Torchlight dances across the walls, revealing intricate carvings of skiers, mountains, and snowflakes. In the center of the vault, on a pedestal of polished stone, sits a magnificent golden trophy shaped like a ski. Beside it lies a sealed envelope. This is it -- the legendary secret of Snowpeak Resort.",exits:{up:"hidden_cave"},hiddenExits:{},lockedExits:{},items:["golden_ski_trophy","founders_letter"],npcs:[]},mountain_peak:{id:"mountain_peak",name:"Mountain Peak",ascii:`
              YOU
             \\o/
              |         * . * . *
         ____/\\______  .  *  .  *  .
        /     SUMMIT  \\   *  .  *
       / ~~~~~~~~~~~~~ \\
      / /\\  /\\  /\\  /\\ \\
     / /  \\/  \\/  \\/  \\ \\
    / /    \\   \\   \\   \\ \\
   /_/______\\_  \\_  \\_  \\_\\
  /     SNOWPEAK     MOUNTAIN  \\
 /  PANORAMIC VIEW OF WORLD     \\
/________________________________\\`,description:"You stand at the summit of Snowpeak Mountain. The wind howls around you but the view is breathtaking -- an endless panorama of snow-covered peaks stretching to the horizon. Far below, the resort looks like a toy village. You can see everything from here: the frozen waterfall, the village, the winding slopes. Half-buried in the snow near a cairn of stacked rocks, something glints in the sunlight. A small stone shelter provides protection from the wind. The ski lift can carry you back down.",exits:{down:"ski_lift_top",east:"summit_shelter"},hiddenExits:{},lockedExits:{},items:["strange_medallion"],npcs:[]},staff_hallway:{id:"staff_hallway",name:"Staff Hallway",ascii:`
     _________________________________
    | ===== STAFF ONLY =====         |
    | ________________  ____________ |
    ||                ||            ||
    ||   STAFF        ||  KITCHEN   ||
    ||   QUARTERS     ||            ||
    ||    [locked]    ||    [open]  ||
    ||________________||____________||
    |                                |
    |  ~~~  ~~~  worn carpet  ~~~    |
    |________________________________|`,description:'A narrow hallway with faded wallpaper and worn carpet. Flickering fluorescent lights cast an institutional glow. Two doors line the hallway: one marked "STAFF QUARTERS" (locked), and another leading to the kitchen. Framed photos of smiling resort staff from decades past hang on the walls, their faces cheerful but somehow unsettling in the dim light.',exits:{north:"lodge_lobby",east:"kitchen"},hiddenExits:{},lockedExits:{west:{roomId:"staff_quarters",keyId:"staff_key",message:"The staff quarters door is locked. You need a staff key."}},items:[],npcs:[]},staff_quarters:{id:"staff_quarters",name:"Staff Quarters",ascii:`
     _________________________________
    |  STAFF    SLEEPING    QUARTERS |
    | ____  ____  ____  ____  ____   |
    ||    ||    ||    ||    ||    |  |
    || [] || [] || [] || [] || [] |  |
    ||____||____||____||____||____|  |
    | beds  beds  beds  beds  beds   |
    |   _______________              |
    |  |   FOOTLOCKER  |             |
    |  |   [unlocked]  |             |
    |  |_______________|             |
    |________________________________|`,description:"A cramped dormitory-style room with rows of narrow beds and metal lockers. The air smells of mothballs and old linens. Personal effects suggest the staff left in a hurry -- uniforms draped over chairs, magazines open on nightstands. An unlocked footlocker at the end of one bed contains various items left behind.",exits:{east:"staff_hallway"},hiddenExits:{},lockedExits:{},items:["staff_uniform","old_photograph"],npcs:[]},kitchen:{id:"kitchen",name:"Lodge Kitchen",ascii:`
     _________________________________
    |  KITCHEN - SNOWPEAK RESORT     |
    |   ___   ___   ___              |
    |  |   | |   | |   |  PANTRY     |
    |  |___| |___| |___|  DOOR       |
    |   OVENS (COLD)      [north]    |
    |                                |
    |  ######################        |
    |  ####  PREP TABLE  ####        |
    |  ######################        |
    |   pots    pans    knives       |
    |________________________________|`,description:"An industrial kitchen that once served hundreds of guests daily. Now it sits silent and cold. Stainless steel counters and hanging pots catch what little light filters through grimy windows. The ovens are cold, but a walk-in pantry to the north might still hold supplies. A calendar on the wall is frozen at February 1976.",exits:{north:"pantry",west:"staff_hallway",east:"lodge_bar"},hiddenExits:{},lockedExits:{},items:["rusty_knife","old_recipe"],npcs:[]},pantry:{id:"pantry",name:"Walk-in Pantry",ascii:`
     _________________________________
    |  [] [] [] [] [] [] [] [] []    |
    |  [] [] [] [] [] [] [] [] []    |
    |  SHELVES OF CANNED GOODS       |
    |  (most expired since 1976)     |
    |                                |
    |    _______________             |
    |   |  FREEZER      |            |
    |   |  [broken]     |            |
    |   |_______________|            |
    |                                |
    |   Fallen crates and old         |
    |   supplies litter the floor... |
    |________________________________|`,description:"A cold storage room lined with metal shelving. Hundreds of cans and jars sit gathering dust -- most decades past their expiration date. A broken freezer in the corner is frosted over. The shelves are mostly bare aside from some expired canned goods.",exits:{south:"kitchen"},hiddenExits:{},lockedExits:{},items:["canned_beans"],npcs:[]},storage_room:{id:"storage_room",name:"Equipment Storage",ascii:`
     _________________________________
    |  STORAGE - SKI RENTAL SHOP     |
    |  /|  /|  /|  /|  /|  /|  /|    |
    | / | / | / | / | / | / | / |    |
    |/  |/  |/  |/  |/  |/  |/  |    |
    | MORE SKIS AND POLES            |
    |                                |
    |   _______________              |
    |  | =-=-=-=-=-=- |  TOOLBOX     |
    |  | =-=-=-=-=-=- |              |
    |  |_____________|               |
    |________________________________|`,description:"A cluttered storage room packed with even more ski equipment. Skis are stacked floor to ceiling, and poles lean in every corner. A heavy toolbox sits on a workbench, filled with wrenches, screwdrivers, and other maintenance tools. The dust is thick enough to write in.",exits:{south:"ski_rental"},hiddenExits:{},lockedExits:{},items:["screwdriver","rope"],npcs:[]},general_store:{id:"general_store",name:"Village General Store",ascii:`
     _________________________________
    |  SNOWPEAK GENERAL STORE        |
    |  ____  ____  ____  ____        |
    | |    ||    ||    ||    |       |
    | |FOOD||MAPS||GEAR||MISC|       |
    | |____||____||____||____|       |
    |   SHELVES  (mostly empty)      |
    |                         ___    |
    |  #########################|S|  |
    |  #####  COUNTER  ########|N|  |
    |  #########################|O|  |
    |    [bell]  [register]   |W|  |
    |________________________________|`,description:'A quaint general store with wooden shelves and a friendly bell above the door. Most of the shelves are bare, but a few items remain: emergency supplies and old postcards. Behind the counter, an ancient cash register sits closed. A brass service bell sits on the counter with a small sign: "RING FOR SERVICE." Wedged into the far corner beside the shelves, an old arcade cabinet sits gathering dust. The side art shows two kids pelting each other with snowballs.',exits:{west:"village"},hiddenExits:{},lockedExits:{},items:["store_bell","matches","postcard","store_arcade"],npcs:[]},chapel:{id:"chapel",name:"Mountain Chapel",ascii:`
     _________________________________
    |           ___                  |
    |          /   \\                 |
    |         / === \\                |
    |        / ===== \\   STEEPLE     |
    |       /_________\\              |
    |      |  []   []  |             |
    |      |           |             |
    |   ___|___________|___          |
    |  |  _______________  |         |
    |  | |     ALTAR     | |         |
    |  | |_______________| |         |
    |  |  === === === ===  | PEWS   |
    |__|__________________|_|________|`,description:'A small wooden chapel perched on a hillside overlooking the village. Simple wooden pews face a modest altar. Stained glass windows depict mountains and snowflakes instead of religious scenes. A guest book sits open on a podium, its last entry dated February 12, 1976: "May the mountain protect all who ski here. - T.S."',exits:{south:"village"},hiddenExits:{},lockedExits:{},items:["candles","guest_book"],npcs:[]},old_cabin:{id:"old_cabin",name:"Abandoned Cabin",ascii:`
     _________________________________
    |        ____/\\____              |
    |       |          |             |
    |       |  []  []  |  LOG        |
    |       |          |  CABIN      |
    |    ___|__________|___          |
    |   |                   |        |
    |   |  ___          ___ |        |
    |   | |   |        |   ||        |
    |   | | O |  FIRE  | X ||        |
    |   | |___|  PLACE |___||        |
    |   |___________________|        |
    |________________________________|`,description:"An old log cabin hidden among snow-covered pines. The roof sags in places, and the windows are clouded with frost. Inside, a stone fireplace dominates one wall (cold and dark). Furniture is covered with dusty sheets. An old writing desk by the window holds yellowed papers. A small leather pouch sits on the desk, jingling faintly. A silver-haired man sits in a rocking chair by the fireplace, wrapped in a wool blanket, reading a battered paperback. He looks like he's been here a while  and likes it that way.",exits:{north:"village"},hiddenExits:{},lockedExits:{},items:["game_tokens","basement_key"],npcs:["old_dad"]},underground_tunnel:{id:"underground_tunnel",name:"Underground Tunnel",ascii:`
     _________________________________
    | ~~~~ DARK TUNNEL ~~~~          |
    |  /\\ /\\ /\\ /\\ /\\ /\\ /\\ /\\       |
    | /  V  V  V  V  V  V  V  \\      |
    ||  rock walls     lichen   |    |
    ||  dripping water          |    |
    ||   ________________       |    |
    ||  |                |      |    |
    | \\ |  LADDER (up)   | ____/     |
    |  \\|________________|/           |
    |     narrow passage              |
    |________________________________|`,description:"A narrow stone tunnel carved through the mountain. The walls are damp and covered with pale green lichen. Water drips from the ceiling, creating small puddles on the uneven floor. The tunnel extends both north and south. A rusty ladder leads upward to what might be an old observatory. Your footsteps echo strangely here.",exits:{south:"basement",up:"hidden_observatory"},hiddenExits:{},lockedExits:{},items:["pickaxe"],npcs:[]},hidden_observatory:{id:"hidden_observatory",name:"Hidden Observatory",ascii:`
     _________________________________
    |  *  .  *  .  *  .  *  .  *  .  |
    |    ____________________        |
    |   /  dome (cracked)     \\      |
    |  |  ==================  |      |
    |  |  ==   TELESCOPE  =  |       |
    |  |  =  (still works!) =  |     |
    |  |  ==================  |      |
    |  |     ____   ____      |      |
    |  |    |    | |    |     |      |
    |   \\   | [] | | [] |    /       |
    |    \\__|____|_|____|___/        |
    |       STAR    CHARTS           |
    |________________________________|`,description:'A secret observatory hidden within the mountain itself. The domed ceiling has a large crack letting in starlight and snow. An old brass telescope still stands on its mount, pointed toward the peak. Star charts and astronomical notes cover the walls. One note reads: "The summit aligns with Polaris on the winter solstice. The medallion is the key."',exits:{down:"underground_tunnel"},hiddenExits:{},lockedExits:{},items:["telescope","star_chart","astronomers_note"],npcs:[]},ice_caves:{id:"ice_caves",name:"Ice Caves",ascii:`
     _________________________________
    |  *  *  GLITTERING ICE  *  *    |
    | \\\\//  \\\\//  \\\\//  \\\\//  \\\\//   |
    |  \\\\ICICLES EVERYWHERE//        |
    |   \\\\//  \\\\//  \\\\//  \\\\//        |
    |    ===  ===  ===  ===          |
    |  CRYSTAL BLUE WALLS             |
    |   _______________               |
    |  /   FROZEN      \\              |
    | /   UNDERGROUND   \\             |
    ||   LAKE (solid)    |            |
    | \\                 /             |
    |  \\_____________/                |
    |________________________________|`,description:"A vast network of caves carved from solid ice. The walls shimmer with blue and white crystalline formations. Icicles hang from the ceiling like chandeliers, and your breath forms clouds in the frigid air. A frozen underground lake dominates the cavern floor -- perfectly smooth and glassy. Mysterious ice formations create natural sculptures. The acoustics are strange here; sounds echo in unusual ways.",exits:{south:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["ice_crystal","frozen_flower"],npcs:[]},avalanche_zone:{id:"avalanche_zone",name:"Avalanche Zone",ascii:`
     _________________________________
    |  !!!  DANGER  !!!  WARNING !!! |
    |                                |
    |   /\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\     |
    |  /  UNSTABLE  SNOW     \\       |
    | /   PRECARIOUS  SLOPE   \\      |
    |/  ~~~~~~~~~~~~~~~~~~~~   \\     |
    |  ~~~~  DEEP  SNOW  ~~~~  |     |
    | \\  ~~~~~~~~~~~~~~~~~~~~  /     |
    |  \\   fallen trees       /      |
    |   \\  broken skis       /       |
    |    \\/\\/\\/\\/\\/\\/\\/\\/\\/\\/       |
    |  This area is TREACHEROUS!     |
    |________________________________|`,description:"A dangerously steep slope where avalanches are common. The snow here is deep and unstable, marked by old debris flows. Broken trees and abandoned equipment poke through the snow -- remnants of past disasters. Warning signs are posted everywhere, though most are half-buried. To the north, you can see a precarious ridge trail. This is not a place to linger.",exits:{west:"ski_slopes",north:"ridge_trail"},hiddenExits:{},lockedExits:{},items:["avalanche_beacon","broken_ski"],npcs:[]},ridge_trail:{id:"ridge_trail",name:"Mountain Ridge Trail",ascii:`
     _________________________________
    |  >>>>  HOWLING WIND  >>>>      |
    |                                |
    |     /\\                         |
    |    /  \\    you are HERE       |
    |   /    \\   on a narrow         |
    |  /  /\\  \\  ridge trail         |
    | |  /  \\  |                     |
    | | /    \\ |  CLIFF  CLIFF       |
    | |/      \\|  DROP   DROP        |
    | |        |  (!)    (!)         |
    |  \\_____/                       |
    |    path continues              |
    |________________________________|`,description:"A narrow trail carved into the mountainside, with sheer drops on either side. The wind howls fiercely here, and the path is barely wider than your shoulders. Ice makes the footing treacherous. Far below, you can see the village and ski slopes looking impossibly small. To the east, the lift station is visible. To the south, the avalanche zone awaits. One wrong step here would be your last.",exits:{east:"ski_lift_top",south:"avalanche_zone"},hiddenExits:{},lockedExits:{},items:["climbing_gear"],npcs:[]},summit_shelter:{id:"summit_shelter",name:"Summit Shelter",ascii:`
     _________________________________
    |  ____/\\____                    |
    | |          |  EMERGENCY        |
    | |  []  []  |  SHELTER          |
    | |          |                   |
    | |__________|                   |
    |  STONE HUT                     |
    |   _______________              |
    |  |               |  SUPPLY     |
    |  |   EMERGENCY   |  CACHE      |
    |  |    SUPPLIES   |             |
    |  |_______________|             |
    |   firewood, blankets, rations  |
    |________________________________|`,description:'A small stone shelter built at the summit for emergencies. The walls provide blessed protection from the wind. Inside, emergency supplies are neatly organized: firewood, blankets, rations, first aid. A logbook records summit visitors dating back to the 1950s. The last entry is from February 1976, written in an elegant hand: "The secret lies beneath the still water. The mountain holds its treasures close. - T.S."',exits:{west:"mountain_peak"},hiddenExits:{},lockedExits:{},items:["emergency_kit","summit_logbook","staff_key"],npcs:[]}},Rk={old_map:{id:"old_map",name:"old map",description:'A faded resort map printed on yellowed paper. Most of it shows standard ski trails and facilities, but someone has drawn a large red X near the north peak, right where the frozen waterfall would be. In the margin, hasty handwriting reads: "T.S. hid it where water stands still." Try "read old map" to study it.',takeable:!0,readable:!0,readText:`You unfold the old map and study it carefully:

                               [Mountain Peak]
                                     |
                               [Ski Lift Top]
                                     |
                               [Ski Slopes]---[Frozen Waterfall]
                                     |
                [Ski Rental]---[Main Street]---[Village]
                                     |
   [Game Room]---[Lodge Bar]---[Lodge Lobby]---[Balcony]
                                     |
                                [Basement]
                           (locked door, need key)

   --- = paths     | = trails

In the margin, hasty handwriting reads:
"The path begins where water stands
still." -- T.S.`},binoculars:{id:"binoculars",name:"binoculars",description:"A pair of heavy brass binoculars, scratched but functional. Looking through them toward the mountain, you can make out a strange glint of metal behind the frozen waterfall -- as if there's an opening in the ice.",takeable:!0},broken_radio:{id:"broken_radio",name:"broken radio",description:"An old transistor radio with a cracked case. It crackles with static when you shake it. The tuning dial is stuck. Someone who knows electronics might be able to fix it.",takeable:!0},whiskey_bottle:{id:"whiskey_bottle",name:"bottle of juice",description:'A half-full bottle of "Mountain Bear" juice. The label features a bear on skis. It looks like decent stuff -- aged 12 years, according to the label.',takeable:!0},basement_key:{id:"basement_key",name:"small brass key",description:`A small brass key with an ornate handle shaped like a snowflake. It looks old but well-made. There's a tiny tag attached that reads "B" -- probably for "basement."`,takeable:!0,hidden:!0},dusty_journal:{id:"dusty_journal",name:"dusty journal",description:`A leather-bound journal belonging to Tobias Snowpeak, dated 1978. The entries describe his grand vision for the resort and his obsession with creating the "perfect ski trophy." The final entry reads: "I've hidden my greatest creation in the vault beneath the mountain. The medallion is the key. Only those worthy -- who help others and seek the truth -- will find it. The path begins where water stands still."`,takeable:!0},ski_poles:{id:"ski_poles",name:"ski poles",description:"A pair of sturdy aluminum ski poles with rubber grips. They're in good condition -- much better than most of the equipment in this shop.",takeable:!0},warm_coat:{id:"warm_coat",name:"warm coat",description:"A heavy-duty mountaineering coat lined with down filling. It's bright orange with reflective strips. Toasty warm -- perfect for braving the mountain peak.",takeable:!0},note_from_founder:{id:"note_from_founder",name:"welcome note",description:'A weathered note pinned to the base of the statue. It reads: "To future adventurers: The greatest treasures are found not alone, but with the help of friends -- even the grumpy ones. Seek the still water, and bring light to the darkness below. -- T. Snowpeak"',takeable:!0},fuse:{id:"fuse",name:"electrical fuse",description:"A heavy-duty electrical fuse, the kind used in industrial machinery. It's rated for high amperage -- exactly what a ski lift motor would need.",takeable:!0},chewed_gum:{id:"chewed_gum",name:"chewed gum",description:"A wad of already-chewed bubblegum stuck to a rock. It's bright pink and still slightly warm. Gross. Someone was here recently.",takeable:!0},torch:{id:"torch",name:"torch",description:"A wooden torch mounted on the cave wall. It still has oil-soaked rags wrapped around the top. Surprisingly, it lights easily and burns with a warm, steady flame.",takeable:!0},strange_medallion:{id:"strange_medallion",name:"strange medallion",description:"A heavy bronze medallion half-buried in the snow near the summit cairn. It's about the size of your palm, shaped like a snowflake with a ski carved in the center. The craftsmanship is extraordinary. It feels important -- like a key to something ancient.",takeable:!0},golden_ski_trophy:{id:"golden_ski_trophy",name:"golden ski trophy",description:`A magnificent trophy crafted from solid gold, shaped like a miniature ski balanced on a crystal mountain. It gleams with an inner light. An engraving on the base reads: "To the worthy adventurer who found their way -- may you always have beginner's luck." This is the legendary treasure of Snowpeak Resort!`,takeable:!0},founders_letter:{id:"founders_letter",name:"founder's letter",description:'A sealed envelope with "To the Finder" written in elegant script.',takeable:!0,readable:!0,readText:`You break the seal and unfold the letter inside:

"Dear Adventurer,

If you are reading this, you have proven yourself worthy. You helped others along the way, you followed the clues, and you braved the mountain's secrets.

I built Snowpeak Resort as a place where beginners could find magic in the mountains. The Golden Ski Trophy was never about gold -- it was about the journey. The friends you made. The puzzles you solved. The courage to explore the unknown.

Keep the trophy as a reminder: every expert was once a beginner, and every mountain is climbed one step at a time.

With warm regards and fresh powder,
Tobias Snowpeak
Founder, Snowpeak Resort
1978"

THE END

Congratulations! You have completed THE SECRET OF SNOWPEAK RESORT!`},frozen_finger:{id:"frozen_finger",name:"frozen finger",description:"A stiff, frozen finger of mysterious origin, delivered to you by an enthusiastic Husky. It's ice-cold and slightly blue. You have no idea whose it is or why a dog had it. Probably best not to think about it too hard.",takeable:!0},arcade_machine:{id:"arcade_machine",name:"arcade machine",description:'A battered arcade cabinet in the game room. The side art shows a pixelated skier racing downhill through slalom gates. The screen glows with green text: "SLALOM CHALLENGE - INSERT COIN". A hand-written note taped to the coin slot reads "FREE PLAY." Try "play arcade game" to play!',takeable:!1},basement_arcade:{id:"basement_arcade",name:"dusty arcade cabinet",description:'An ancient arcade cabinet hidden under a tarp in the basement corner. Years of dust and cobwebs cover it, but when you wipe the grime away, the side art reveals a dramatic scene: wolves and bears charging through a moonlit forest toward a tiny village. The marquee reads "DEFEND THE VILLAGE" in faded red letters. Amazingly, a dim green power light still glows on the back panel. Someone must have left it plugged in decades ago. Try "play defend game" to play!',takeable:!1},staff_uniform:{id:"staff_uniform",name:"staff uniform",description:`A faded Snowpeak Resort staff uniform -- red polo shirt and khaki pants. A name tag still pinned to the shirt reads "SARAH." The uniform looks like it hasn't been worn in decades.`,takeable:!0},old_photograph:{id:"old_photograph",name:"old photograph",description:"A black and white photograph of the resort staff from 1976. Everyone is smiling in their uniforms. The photo is dated February 10, 1976 -- just two days before the resort mysteriously closed.",takeable:!0},rusty_knife:{id:"rusty_knife",name:"rusty knife",description:"A chef's knife, heavily rusted but still sharp. The handle is worn from years of use. It's seen better days but could still be useful.",takeable:!0},old_recipe:{id:"old_recipe",name:"old recipe",description:`A recipe card for "Snowpeak Hot Chocolate" -- the resort's signature drink. The ingredients include cocoa, milk, vanilla, and "a pinch of mountain magic." Someone has written in the margin: "The key is in the pantry."`,takeable:!0,readable:!0,readText:'SNOWPEAK HOT CHOCOLATE: Heat milk, add cocoa and vanilla, stir with love. "The warmth of the mountain in every cup!" Note in margin: "The key is in the pantry."'},canned_beans:{id:"canned_beans",name:"canned beans",description:"A can of beans with a faded label. Expired in 1977, but canned goods last forever, right? ...Right?",takeable:!0},screwdriver:{id:"screwdriver",name:"screwdriver",description:"A well-used flathead screwdriver with a wooden handle. Perfect for repairs or prying open stubborn panels.",takeable:!0},rope:{id:"rope",name:"climbing rope",description:"A coil of sturdy climbing rope, about 50 feet long. It looks trustworthy enough for serious mountaineering.",takeable:!0},trail_map:{id:"trail_map",name:"trail guide",description:"A detailed trail guide of the entire mountain, showing expert slopes, ridge trails, and danger zones marked in red. Much more comprehensive than the old map from the lobby.",takeable:!0},matches:{id:"matches",name:"waterproof matches",description:"A box of waterproof matches -- essential for mountain survival. The box is nearly full.",takeable:!0},postcard:{id:"postcard",name:"vintage postcard",description:'A vintage postcard showing Snowpeak Resort in its heyday -- crowded slopes, happy skiers, the lodge lit up at night. On the back, an unsent message reads: "Having a wonderful time! This place is magical. - T."',takeable:!0},candles:{id:"candles",name:"prayer candles",description:"Several tall white candles used for prayer or meditation. They smell faintly of beeswax.",takeable:!0},guest_book:{id:"guest_book",name:"chapel guest book",description:"A leather-bound guest book from the chapel, filled with entries from visitors over the years. The last entry is from T.S. on February 12, 1976.",takeable:!0,readable:!0,readText:'You flip through the guest book. Most entries are standard tourist fare. The last entry, in elegant script, reads: "May the mountain protect all who ski here. The greatest treasure is not gold, but the journey we share. - T.S., February 12, 1976"'},cabin_journal:{id:"cabin_journal",name:"cabin journal",description:"A personal journal found in the abandoned cabin. It appears to belong to Tobias Snowpeak himself. The entries describe his life at the resort and his secret project.",takeable:!0,readable:!0,readText:`You read the journal entries. Most describe daily resort operations, but later entries grow more mysterious: "I've completed the vault. Only those who truly understand the mountain -- who help others and explore thoroughly -- will find it. I've left clues throughout the resort. The medallion waits at the summit for the worthy."`},pickaxe:{id:"pickaxe",name:"pickaxe",description:"A sturdy mining pickaxe with a wooden handle. The metal head is still sharp. It could be useful for breaking through ice or rock.",takeable:!0},telescope:{id:"telescope",name:"brass telescope",description:"An antique brass telescope mounted on a stand. Despite the cracked observatory dome, it still functions perfectly. When pointed at the peak, you can see the summit in remarkable detail.",takeable:!1},star_chart:{id:"star_chart",name:"star chart",description:'An astronomical chart showing the winter night sky. Someone has circled Polaris (the North Star) and drawn lines connecting it to the mountain peak. A note reads: "Winter solstice alignment."',takeable:!0},astronomers_note:{id:"astronomers_note",name:"astronomer's note",description:"A yellowed note pinned to the observatory wall.",takeable:!0,readable:!0,readText:`The note reads: "The summit aligns with Polaris on the winter solstice. T.S. was obsessed with this alignment. He believed the mountain held ancient secrets. The medallion at the summit is more than decoration -- it's the KEY to the vault beneath the frozen waterfall."`},ice_crystal:{id:"ice_crystal",name:"ice crystal",description:"A perfectly formed ice crystal, about the size of your hand. It refracts light into beautiful rainbow patterns. Remarkably, it doesn't melt.",takeable:!0},frozen_flower:{id:"frozen_flower",name:"frozen flower",description:"A delicate alpine flower, perfectly preserved in clear ice. It must have been frozen instantly -- every petal is intact.",takeable:!0},avalanche_beacon:{id:"avalanche_beacon",name:"avalanche beacon",description:"An electronic avalanche beacon, partially buried in the snow. Its battery is dead, but it's still a somber reminder of the dangers here.",takeable:!0},broken_ski:{id:"broken_ski",name:"broken ski",description:"Half of a wooden ski, snapped in two. The wood is weathered and old -- from an avalanche years ago.",takeable:!0},climbing_gear:{id:"climbing_gear",name:"climbing gear",description:"Professional mountaineering equipment: carabiners, pitons, and anchors. Left here by previous climbers, perhaps for emergencies.",takeable:!0},emergency_kit:{id:"emergency_kit",name:"emergency kit",description:"A weatherproof emergency survival kit containing first aid supplies, emergency blankets, signal flares, and energy bars. All in good condition.",takeable:!0},summit_logbook:{id:"summit_logbook",name:"summit logbook",description:"A logbook recording everyone who reached the summit, dating back to 1950. The final entry is from February 1976.",takeable:!0,readable:!0,readText:'You flip through decades of summit entries. The last one, in elegant handwriting, reads: "February 12, 1976 - My final ascent. The secret lies beneath the still water. The mountain holds its treasures close to those who earn them. May future adventurers find what I have hidden. - Tobias Snowpeak"'},staff_key:{id:"staff_key",name:"staff key",description:'A brass key labeled "STAFF QUARTERS." It looks like it opens the locked staff area in the lodge.',takeable:!0,hidden:!1}},Ik={old_map:{id:"old_map",name:"old map",description:'A faded resort map printed on yellowed paper, heavily marked with additions and notes. Parts of the map are worn and illegible -- some areas may be missing entirely. Someone has drawn a large red X near the north peak, right where the frozen waterfall would be. In the margin, hasty handwriting reads: "T.S. hid it where water stands still." Try "read old map" to study it.',takeable:!0,readable:!0,readText:`You unfold the old map and study it carefully:

        [Summit Shelter]---[Mountain Peak]
                                  |
           [Ridge Trail]---[Ski Lift Top]---[Ice Caves]
                 |                |
         [Avalanche Zone]---[Ski Slopes]---[Frozen Waterfall]
                                  |
 [Storage]---[Ski Rental]---[Main Street]---[Village]---[General Store]
                                  |             |
                                  |         [Chapel]
                                  |             |
                                  |        [Old Cabin]
                                  |
                [Balcony]---[Lodge Lobby]---[Bar]---[Game Room]
                                  |           |
                               [Staff]    [Kitchen]
                                  |           |
                              [Staff Q]   [Pantry]
                                  |
                             [Basement]

   --- = paths     | = trails
   [Basement] requires a key to access

   ADDITIONAL NOTES (in red ink):
   - Staff areas require special key
   - Ridge trail is DANGEROUS - proceed with caution
   - Map is faded and incomplete -- some areas not shown

In the margin, hasty handwriting reads:
"The path begins where water stands still.
Explore thoroughly - all areas matter now." -- T.S.`},binoculars:{id:"binoculars",name:"binoculars",description:"A pair of heavy brass binoculars, scratched but functional. Looking through them toward the mountain, you can make out a strange glint of metal behind the frozen waterfall -- as if there's an opening in the ice.",takeable:!0},broken_radio:{id:"broken_radio",name:"broken radio",description:"An old transistor radio with a cracked case. It crackles with static when you shake it. The tuning dial is stuck. Someone who knows electronics might be able to fix it.",takeable:!0},whiskey_bottle:{id:"whiskey_bottle",name:"bottle of juice",description:'A half-full bottle of "Mountain Bear" juice. The label features a bear on skis. It looks like decent stuff -- aged 12 years, according to the label.',takeable:!0},basement_key:{id:"basement_key",name:"old basement key",description:'An old brass key with an ornate handle shaped like a snowflake. A faded tag attached to the ring reads "BASEMENT" in block letters. It looks like it fits a heavy door.',takeable:!0},dusty_journal:{id:"dusty_journal",name:"dusty journal",description:`A leather-bound journal belonging to Tobias Snowpeak, dated 1978. The entries describe his grand vision for the resort and his obsession with creating the "perfect ski trophy." The final entry reads: "I've hidden my greatest creation in the vault beneath the mountain. The medallion is the key. Only those worthy -- who help others and seek the truth -- will find it. The path begins where water stands still."`,takeable:!0},ski_poles:{id:"ski_poles",name:"ski poles",description:"A pair of sturdy aluminum ski poles with rubber grips. They're in good condition -- much better than most of the equipment in this shop.",takeable:!0},warm_coat:{id:"warm_coat",name:"warm coat",description:"A heavy-duty mountaineering coat lined with down filling. It's bright orange with reflective strips. Toasty warm -- perfect for braving the mountain peak.",takeable:!0},note_from_founder:{id:"note_from_founder",name:"welcome note",description:'A weathered note pinned to the base of the statue. It reads: "To future adventurers: The greatest treasures are found not alone, but with the help of friends -- even the grumpy ones. Seek the still water, and bring light to the darkness below. -- T. Snowpeak"',takeable:!0},fuse:{id:"fuse",name:"electrical fuse",description:"A heavy-duty electrical fuse, the kind used in industrial machinery. It's rated for high amperage -- exactly what a ski lift motor would need. It must have been wedged behind that old arcade cabinet for decades.",takeable:!0,hidden:!0},chewed_gum:{id:"chewed_gum",name:"chewed gum",description:"A wad of already-chewed bubblegum stuck to a rock. It's bright pink and still slightly warm. Gross. Someone was here recently.",takeable:!0},torch:{id:"torch",name:"torch",description:"A wooden torch mounted on the cave wall. It still has oil-soaked rags wrapped around the top. Surprisingly, it lights easily and burns with a warm, steady flame.",takeable:!0},strange_medallion:{id:"strange_medallion",name:"strange medallion",description:"A heavy bronze medallion half-buried in the snow near the summit cairn. It's about the size of your palm, shaped like a snowflake with a ski carved in the center. The craftsmanship is extraordinary. It feels important -- like a key to something ancient.",takeable:!0},golden_ski_trophy:{id:"golden_ski_trophy",name:"golden ski trophy",description:`A magnificent trophy crafted from solid gold, shaped like a miniature ski balanced on a crystal mountain. It gleams with an inner light. An engraving on the base reads: "To the worthy adventurer who found their way -- may you always have beginner's luck." This is the legendary treasure of Snowpeak Resort!`,takeable:!0},founders_letter:{id:"founders_letter",name:"founder's letter",description:'A sealed envelope with "To the Finder" written in elegant script.',takeable:!0,readable:!0,readText:`You break the seal and unfold the letter inside:

"Dear Adventurer,

If you are reading this, you have proven yourself worthy. You helped others along the way, you followed the clues, and you braved the mountain's secrets.

I built Snowpeak Resort as a place where beginners could find magic in the mountains. The Golden Ski Trophy was never about gold -- it was about the journey. The friends you made. The puzzles you solved. The courage to explore the unknown.

Keep the trophy as a reminder: every expert was once a beginner, and every mountain is climbed one step at a time.

With warm regards and fresh powder,
Tobias Snowpeak
Founder, Snowpeak Resort
1978"

THE END

Congratulations! You have completed THE SECRET OF SNOWPEAK RESORT!`},frozen_finger:{id:"frozen_finger",name:"frozen finger",description:"A stiff, frozen finger of mysterious origin, delivered to you by an enthusiastic Husky. It's ice-cold and slightly blue. You have no idea whose it is or why a dog had it. Probably best not to think about it too hard.",takeable:!0},arcade_machine:{id:"arcade_machine",name:"arcade machine",description:'A battered arcade cabinet in the game room. The side art shows a pixelated skier racing downhill through slalom gates. The screen glows with green text: "SLALOM CHALLENGE - INSERT COIN". A hand-written note taped to the coin slot reads "FREE PLAY." Try "play arcade game" to play!',takeable:!1},basement_arcade:{id:"basement_arcade",name:"dusty arcade cabinet",description:'An ancient arcade cabinet hidden under a tarp in the basement corner. Years of dust and cobwebs cover it, but when you wipe the grime away, the side art reveals a dramatic scene: wolves and bears charging through a moonlit forest toward a tiny village. The marquee reads "DEFEND THE VILLAGE" in faded red letters. Amazingly, a dim green power light still glows on the back panel. Someone must have left it plugged in decades ago. Try "play defend game" to play!',takeable:!1},store_arcade:{id:"store_arcade",name:"snowball arcade cabinet",description:'A beat-up arcade cabinet wedged into the corner of the general store. The side art shows two pixelated kids in winter gear hurling snowballs at each other across a snowy field. The marquee reads "SNOWBALL SHOWDOWN" in icy blue letters. A brass token slot on the front panel reads "INSERT TOKEN." Try "play snowball game" to play!',takeable:!1},staff_uniform:{id:"staff_uniform",name:"staff uniform",description:`A faded Snowpeak Resort staff uniform -- red polo shirt and khaki pants. A name tag still pinned to the shirt reads "SARAH." The uniform looks like it hasn't been worn in decades.`,takeable:!0},old_photograph:{id:"old_photograph",name:"old photograph",description:"A black and white photograph of the resort staff from 1976. Everyone is smiling in their uniforms. The photo is dated February 10, 1976 -- just two days before the resort mysteriously closed.",takeable:!0},rusty_knife:{id:"rusty_knife",name:"rusty knife",description:"A chef's knife, heavily rusted but still sharp. The handle is worn from years of use. It's seen better days but could still be useful.",takeable:!0},old_recipe:{id:"old_recipe",name:"old recipe",description:`A recipe card for "Snowpeak Hot Chocolate" -- the resort's signature drink. The ingredients include cocoa, milk, vanilla, and "a pinch of mountain magic." Someone has written in the margin: "The key is in the pantry."`,takeable:!0,readable:!0,readText:'SNOWPEAK HOT CHOCOLATE: Heat milk, add cocoa and vanilla, stir with love. "The warmth of the mountain in every cup!" Note in margin: "The key is in the pantry."'},canned_beans:{id:"canned_beans",name:"canned beans",description:"A can of beans with a faded label. Expired in 1977, but canned goods last forever, right? ...Right?",takeable:!0},screwdriver:{id:"screwdriver",name:"screwdriver",description:"A well-used flathead screwdriver with a wooden handle. Perfect for repairs or prying open stubborn panels.",takeable:!0},rope:{id:"rope",name:"climbing rope",description:"A coil of sturdy climbing rope, about 50 feet long. It looks trustworthy enough for serious mountaineering.",takeable:!0},trail_map:{id:"trail_map",name:"trail guide",description:"A detailed trail guide of the entire mountain, showing expert slopes, ridge trails, and danger zones marked in red. Much more comprehensive than the old map from the lobby.",takeable:!0},matches:{id:"matches",name:"waterproof matches",description:"A box of waterproof matches -- essential for mountain survival. The box is nearly full. Perfect for lighting candles or creating temporary light, though a single match won't last long in the mountain wind.",takeable:!0},postcard:{id:"postcard",name:"vintage postcard",description:'A vintage postcard showing Snowpeak Resort in its heyday -- crowded slopes, happy skiers, the lodge lit up at night. On the back, an unsent message reads: "Having a wonderful time! This place is magical. - T."',takeable:!0},candles:{id:"candles",name:"prayer candles",description:"Several tall white candles used for prayer or meditation. They smell faintly of beeswax. Unlit, but they could provide a comforting light if you had matches. The wax is thick and sturdy -- they might hold a flame better than matches alone, though strong winds would still snuff them out.",takeable:!0},guest_book:{id:"guest_book",name:"chapel guest book",description:"A leather-bound guest book from the chapel, filled with entries from visitors over the years. The last entry is from T.S. on February 12, 1976.",takeable:!0,readable:!0,readText:'You flip through the guest book. Most entries are standard tourist fare. The last entry, in elegant script, reads: "May the mountain protect all who ski here. The greatest treasure is not gold, but the journey we share. - T.S., February 12, 1976"'},game_tokens:{id:"game_tokens",name:"bag of game tokens",description:"A small drawstring pouch made of worn leather, jingling with brass tokens. Each token is stamped with the Snowpeak Resort logo  a tiny ski crossed with a snowflake. These must be for the old arcade machines around the resort.",takeable:!0},pickaxe:{id:"pickaxe",name:"pickaxe",description:"A sturdy mining pickaxe with a wooden handle. The metal head is still sharp. It could be useful for breaking through ice or rock.",takeable:!0},telescope:{id:"telescope",name:"brass telescope",description:"An antique brass telescope mounted on a stand. Despite the cracked observatory dome, it still functions perfectly. When pointed at the peak, you can see the summit in remarkable detail.",takeable:!1},star_chart:{id:"star_chart",name:"star chart",description:'An astronomical chart showing the winter night sky. Someone has circled Polaris (the North Star) and drawn lines connecting it to the mountain peak. A note reads: "Winter solstice alignment."',takeable:!0},astronomers_note:{id:"astronomers_note",name:"astronomer's note",description:"A yellowed note pinned to the observatory wall.",takeable:!0,readable:!0,readText:`The note reads: "The summit aligns with Polaris on the winter solstice. T.S. was obsessed with this alignment. He believed the mountain held ancient secrets. The medallion at the summit is more than decoration -- it's the KEY to the vault beneath the frozen waterfall."`},ice_crystal:{id:"ice_crystal",name:"ice crystal",description:"A perfectly formed ice crystal, about the size of your hand. It refracts light into beautiful rainbow patterns. Remarkably, it doesn't melt.",takeable:!0},frozen_flower:{id:"frozen_flower",name:"frozen flower",description:"A delicate alpine flower, perfectly preserved in clear ice. It must have been frozen instantly -- every petal is intact.",takeable:!0},avalanche_beacon:{id:"avalanche_beacon",name:"avalanche beacon",description:"An electronic avalanche beacon, partially buried in the snow. Its battery is dead, but it's still a somber reminder of the dangers here.",takeable:!0},broken_ski:{id:"broken_ski",name:"broken ski",description:"Half of a wooden ski, snapped in two. The wood is weathered and old -- from an avalanche years ago.",takeable:!0},climbing_gear:{id:"climbing_gear",name:"climbing gear",description:"Professional mountaineering equipment: carabiners, pitons, and anchors. Left here by previous climbers, perhaps for emergencies.",takeable:!0},emergency_kit:{id:"emergency_kit",name:"emergency kit",description:"A weatherproof emergency survival kit containing first aid supplies, emergency blankets, signal flares, and energy bars. All in good condition.",takeable:!0},summit_logbook:{id:"summit_logbook",name:"summit logbook",description:"A logbook recording everyone who reached the summit, dating back to 1950. The final entry is from February 1976.",takeable:!0,readable:!0,readText:'You flip through decades of summit entries. The last one, in elegant handwriting, reads: "February 12, 1976 - My final ascent. The secret lies beneath the still water. The mountain holds its treasures close to those who earn them. May future adventurers find what I have hidden. - Tobias Snowpeak"'},staff_key:{id:"staff_key",name:"staff key",description:'A brass key labeled "STAFF QUARTERS." It looks like it opens the locked staff area in the lodge.',takeable:!0,hidden:!1},store_bell:{id:"store_bell",name:"bell",description:`A brass service bell sitting on the counter. A small sign next to it reads "RING FOR SERVICE" though there's clearly nobody here to answer.`,takeable:!1}},kk={angry_boss:{id:"angry_boss",name:"Angry Boss",description:`A young woman with a permanently mad face, squeezed into a ski suit two sizes too big. She's gripping the bar counter like she's trying to strangle it, muttering furiously about "incompetent resort staff."`,currentRoomId:"lodge_bar",dialogueState:0,dialogue:[{state:0,text:`"WHAT DO YOU WANT?!" Angry Boss slams her fist on the bar. "This whole resort is a DISASTER! The ski lift is broken, my room smells like mildew, the hot tub is frozen solid, and NOW the radio is dead! I came here to RELAX and instead I'm having the WORST vacation of my LIFE!"`},{state:1,condition:{hasItem:"whiskey_bottle"},text:`You offer the bottle of juice. Angry Boss's eyes widen. Her red face softens just slightly.

"Well... maybe this trip isn't ALL bad." She takes a long swig and exhales. "You know what, kid? I'll tell you something. Yesterday I was stomping around the slopes in a rage -- don't judge me -- and I saw something STRANGE. Behind that frozen waterfall up north... there's a CAVE. I could see an opening in the ice. Looked like someone sealed it up years ago. Might be worth checking out."

She takes another swig and almost smiles. Almost.`,effects:{removeItem:"whiskey_bottle",setFlag:["angry_boss","calmed",!0]}},{state:1,text:`"I TOLD you, leave me ALONE! Can't a woman be furious in peace?! Unless you've got something to improve my day -- and I mean SIGNIFICANTLY -- then GET LOST!"`},{state:2,text:`"What, you want MORE from me? I told you about the cave behind the waterfall. Now let me enjoy my whiskey in peace. This is the first thing that's gone RIGHT all week."`}]},mr_smiles:{id:"mr_smiles",name:"Mr Smiles",description:"A happy boy with an impossibly wide grin, wearing a neon yellow ski jacket so bright it practically glows. Despite looking like he's never seen snow before, his enthusiasm is absolutely unshakeable.",currentRoomId:"lodge_lobby",dialogueState:0,dialogue:[{state:0,text:`"Oh HELLO there, friend! Isn't this resort just WONDERFUL?" Mr Smiles gestures enthusiastically at a boarded-up window. "I mean, sure, the ski lift is broken and I lost my ski poles somewhere, and I fell down seventeen times on the bunny slope, but WHAT. A. VIEW! I just know today is going to be AMAZING!"`},{state:1,condition:{hasItem:"ski_poles"},text:`"MY SKI POLES! You FOUND them! Oh you are just the BEST PERSON I have ever met, and I have met a LOT of people!"

Mr Smiles does a little dance of joy.

"Here, take this -- I found it rattling around in the ski lift machinery when I was, uh, definitely NOT trying to ride the broken lift. It looked important!" He hands you an electrical fuse. "Now if you'll excuse me, I'm going to CONQUER that bunny slope! WISH ME LUCK!"

Mr Smiles practically skips toward the door.`,effects:{removeItem:"ski_poles",addItem:"fuse",setFlag:["mr_smiles","helped",!0],moveNpc:["mr_smiles","ski_slopes"]}},{state:1,text:`"I'd LOVE to hit the slopes but I seem to have misplaced my ski poles! I had them in the rental shop, I'm SURE of it. Without them I just flop around like a happy noodle! Not that there's anything WRONG with being a happy noodle!"`},{state:2,text:`"HELLO AGAIN, best friend! I'm having the TIME OF MY LIFE on this slope! I've only fallen down six times! That's a PERSONAL BEST!"`}]},dill_pickle:{id:"dill_pickle",name:"Dill Pickle",description:"A cute boy with mischevious smile and wearing completely mismatched ski gear -- one red boot, one blue boot, goggles on their forehead, and a ski jacket worn inside-out. They're examining a ski boot with the intensity of an archaeologist studying an ancient artifact.",currentRoomId:"ski_rental",dialogueState:0,dialogue:[{state:0,text:`"Hmm, FASCINATING." Dill Pickle holds up a ski boot and peers inside it. "Did you know that ski boots were originally medieval torture devices repurposed for recreation? I read that on a bathroom wall once. Very reliable source."

They turn the boot upside down and shake it. A small brass key falls out and clatters to the floor.

"Oh. That was in there. Huh. You know, I've been shaking boots all morning hoping a sandwich would fall out, but a key is good too. Probably."`,effects:{revealItem:["basement_key","ski_rental"]}},{state:1,condition:{hasItem:"broken_radio"},text:`"Ooh, a BROKEN RADIO! Give it here!" Dill Pickle's eyes light up. "I once repaired a submarine's sonar system with a paperclip, a wad of gum, and an overwhelming sense of optimism. A radio should be easy."

They tinker with it for about ten seconds, somehow using a ski pole as a soldering iron. The radio crackles to life:

"...the founder hid his greatest treasure where water stands still... the medallion is the key to the vault below... seek the cave behind the ice..."

Dill Pickle nods sagely. "Sounds legit. Water standing still... like a frozen waterfall, maybe? I'm just spitballing here. I'm mostly thinking about sandwiches."`,effects:{removeItem:"broken_radio",setFlag:["dill_pickle","fixed_radio",!0]}},{state:1,text:`"Still trying to figure out which foot is the ski foot. Is it the left foot? The right foot? The THIRD foot? I feel like if I had a broken radio I could do something really useful. Don't ask me why. It's a FEELING."`},{state:2,text:`"That radio keeps repeating something about water standing still and a vault. Very mysterious. You know what ELSE is mysterious? Why they don't sell sandwiches at a ski resort. Criminal, really."`}]},coach_joe:{id:"coach_joe",name:"Coach Joe",description:"A muscular man in a whistle and tracksuit, somehow wearing sneakers in the snow. He keeps blowing his whistle at nobody in particular and shouting motivational phrases at the mountain.",currentRoomId:"ski_slopes",dialogueState:0,dialogue:[{state:0,condition:{hasFlag:"slalom_champion"},text:`"Good job, kid. I heard you beat my high score in Slalom Challenge." He gives you a respectful nod. "That's real talent right there. I've been holding that record since '82. You earned it, CHAMP!"`},{state:0,text:`"HUSTLE HUSTLE HUSTLE!" Coach Joe blows his whistle at a nearby tree. "You think this mountain is gonna ski ITSELF? Give me twenty push-ups! Actually, don't. The snow is cold. Give me twenty MENTAL push-ups. Think really hard about push-ups. GREAT WORK, CHAMP!"`},{state:1,text:`"You know what separates a WINNER from a LOSER on the slopes? NOTHING! They both fall down! But the WINNER falls down with CONFIDENCE!" He blows his whistle triumphantly. "That's free advice. Normally I charge for that."`},{state:2,text:`"I've been coaching ski beginners for thirty years and I've never actually been on skis myself. You know why? Because a true coach leads from the SIDELINES! Also I'm terrified of heights. DON'T TELL ANYONE!"`}]},dance_mom:{id:"dance_mom",name:"Social Media Influencer",description:"A woman in a sequined ski jacket and full stage makeup, filming everything on her phone with a ring light clipped to the top. She appears to be live-streaming her ski resort experience to an audience of possibly no one.",currentRoomId:"village",dialogueState:0,dialogue:[{state:0,text:`"And THIS, followers, is what we call RUSTIC CHARM!" She pans her phone across the village with practiced flair. "My daughter Samantha would have LOVED this mountain  she's got the best ski aesthetic of anyone I know. But her dance recital is this weekend so she couldn't make it. Her loss is YOUR gain, followers. CONTENT waits for no one!"`},{state:1,text:`"Excuse me, can you hold this phone and film me doing a dramatic pose by that statue? No? FINE. I'll use the selfie stick. You know, in MY day, mountains were taller AND the hot chocolate was free. This resort is a THREE out of TEN. But the lighting is GORGEOUS. Samantha is going to be SO jealous when she sees these stories."`},{state:2,text:`"My livestream just hit FOUR viewers! That's double from last time! One of them might be my mom, but engagement is engagement, honey. Samantha says I should try TikTok but I told her  mommy is a MULTI-PLATFORM creator. If you find any secret treasure in this dump, tag me. I need CONTENT."`}]},henrys_mom:{id:"henrys_mom",name:"Henry's Mom",description:"A warm, cheerful woman bundled in a cozy puffer jacket, surrounded by an impressive array of tote bags overflowing with snacks of every variety. Granola bars, fruit snacks, trail mix, string cheese, juice boxes  it's like a mobile convenience store. She has the kind smile of someone who's never met a stranger, though right now she keeps glancing around nervously for her son.",currentRoomId:"main_street",dialogueState:0,dialogue:[{state:0,text:`"Oh, hello sweetie!" She beams at you and immediately starts rummaging through one of her tote bags. "Have you seen my Henry? That boy took off to 'explore the mountain' about an hour ago and I just KNOW he didn't pack enough snacks. I gave him two granola bars but that's barely a warmup!"

She pulls out a fruit snack pouch and offers it to you. "Here, take this. You look like you could use a snack. I always say  you can never have too many snacks on an adventure. Do you want trail mix too? I have seven bags. SEVEN."`},{state:1,text:`"Still no Henry!" She shakes her head but manages a warm laugh. "That kid  he's got his father's sense of adventure and absolutely NONE of his common sense about packing food. I bet he's out there right now, climbing something he shouldn't be, with nothing but an empty granola bar wrapper in his pocket."

She holds up a thermos. "Hot cocoa? I made it from scratch this morning. I also have chicken soup, apple cider, and something that might be tea? Oh, and string cheese! The good kind, not the weird rubbery kind. Please, take something. I brought enough snacks for the entire resort and it would make me feel SO much better knowing at least someone out there is well-fed."`},{state:2,text:`"Henry just texted! He says he's been having the BEST time exploring the lodge. The LODGE! He was right here the whole time!" She laughs and wipes her eyes. "He says he made friends with some angry lady at the bar and they've been debating whether this resort needs better snack machines. That's my boy."

She starts reorganizing her tote bags with visible relief. "I swear, being a mom is 10% parenting and 90% making sure everyone has enough to eat. Are you SURE you don't want a juice box? I have a whole case. Take two. Take three! You're an adventurer  you need your energy!"`}]}},Ok={angry_boss:{id:"angry_boss",name:"Angry Boss",description:`A young woman with a permanently mad face, squeezed into a ski suit two sizes too big. She's gripping the bar counter like she's trying to strangle it, muttering furiously about "incompetent resort staff."`,currentRoomId:"lodge_bar",dialogueState:0,dialogue:[{state:0,text:`"WHAT DO YOU WANT?!" Angry Boss slams her fist on the bar. "This whole resort is a DISASTER! The ski lift is broken, my room smells like mildew, the hot tub is frozen solid, and NOW the radio is dead! I came here to RELAX and instead I'm having the WORST vacation of my LIFE!"`},{state:1,condition:{hasItem:"whiskey_bottle"},text:`You offer the bottle of juice. Angry Boss's eyes widen. Her red face softens just slightly.

"Well... maybe this trip isn't ALL bad." She takes a long swig and exhales. "You know what, kid? I'll tell you something. Yesterday I was stomping around the slopes in a rage -- don't judge me -- and I saw something STRANGE. Behind that frozen waterfall up north... there's a CAVE. I could see an opening in the ice. Looked like someone sealed it up years ago. Might be worth checking out."

She takes another swig and almost smiles. Almost.`,effects:{removeItem:"whiskey_bottle",setFlag:["angry_boss","calmed",!0]}},{state:1,text:`"I TOLD you, leave me ALONE! Can't a woman be furious in peace?! Unless you've got something to improve my day -- and I mean SIGNIFICANTLY -- then GET LOST!"`},{state:2,text:`"What, you want MORE from me? I told you about the cave behind the waterfall. Now let me enjoy my whiskey in peace. This is the first thing that's gone RIGHT all week."`}]},mr_smiles:{id:"mr_smiles",name:"Mr Smiles",description:"A happy boy with an impossibly wide grin, wearing a neon yellow ski jacket so bright it practically glows. Despite looking like he's never seen snow before, his enthusiasm is absolutely unshakeable.",currentRoomId:"lodge_lobby",dialogueState:0,dialogue:[{state:0,text:`"Oh HELLO there, friend! Isn't this resort just WONDERFUL?" Mr Smiles gestures enthusiastically at a boarded-up window. "I mean, sure, the ski lift is broken and I lost my ski poles somewhere, and I fell down seventeen times on the bunny slope, but WHAT. A. VIEW! I just know today is going to be AMAZING!"`},{state:1,condition:{hasItem:"ski_poles"},text:`"MY SKI POLES! You FOUND them! Oh you are just the BEST PERSON I have ever met, and I have met a LOT of people!"

Mr Smiles does a little dance of joy.

"Thank you SO MUCH! Now if you'll excuse me, I'm going to CONQUER that bunny slope! WISH ME LUCK!"

Mr Smiles practically skips toward the door.`,effects:{removeItem:"ski_poles",setFlag:["mr_smiles","helped",!0],moveNpc:["mr_smiles","ski_slopes"]}},{state:1,text:`"I'd LOVE to hit the slopes but I seem to have misplaced my ski poles! I had them in the rental shop, I'm SURE of it. Without them I just flop around like a happy noodle! Not that there's anything WRONG with being a happy noodle!"`},{state:2,text:`"HELLO AGAIN, best friend! I'm having the TIME OF MY LIFE on this slope! I've only fallen down six times! That's a PERSONAL BEST!"`}]},dill_pickle:{id:"dill_pickle",name:"Dill Pickle",description:"A cute boy with mischevious smile and wearing completely mismatched ski gear -- one red boot, one blue boot, goggles on their forehead, and a ski jacket worn inside-out. They're examining a ski boot with the intensity of an archaeologist studying an ancient artifact.",currentRoomId:"ski_rental",dialogueState:0,dialogue:[{state:0,text:`"Hmm, FASCINATING." Dill Pickle holds up a ski boot and peers inside it. "Did you know that ski boots were originally medieval torture devices repurposed for recreation? I read that on a bathroom wall once. Very reliable source."

They turn the boot upside down and shake it vigorously.

"Nothing. Not even a sandwich. Disappointing, but I respect the boot's commitment to being empty. Very zen."`,effects:{}},{state:1,condition:{hasItem:"broken_radio"},text:`"Ooh, a BROKEN RADIO! Give it here!" Dill Pickle's eyes light up. "I once repaired a submarine's sonar system with a paperclip, a wad of gum, and an overwhelming sense of optimism. A radio should be easy."

They tinker with it for about ten seconds, somehow using a ski pole as a soldering iron. The radio crackles to life:

"...the founder hid his greatest treasure where water stands still... the medallion is the key to the vault below... seek the cave behind the ice..."

Dill Pickle nods sagely. "Sounds legit. Water standing still... like a frozen waterfall, maybe? I'm just spitballing here. I'm mostly thinking about sandwiches."`,effects:{removeItem:"broken_radio",setFlag:["dill_pickle","fixed_radio",!0]}},{state:1,text:`"Still trying to figure out which foot is the ski foot. Is it the left foot? The right foot? The THIRD foot? I feel like if I had a broken radio I could do something really useful. Don't ask me why. It's a FEELING."`},{state:2,text:`"That radio keeps repeating something about water standing still and a vault. Very mysterious. You know what ELSE is mysterious? Why they don't sell sandwiches at a ski resort. Criminal, really."`}]},coach_joe:{id:"coach_joe",name:"Coach Joe",description:"A muscular man in a whistle and tracksuit, somehow wearing sneakers in the snow. He keeps blowing his whistle at nobody in particular and shouting motivational phrases at the mountain.",currentRoomId:"ski_slopes",dialogueState:0,dialogue:[{state:0,condition:{hasFlag:"slalom_champion"},text:`"Good job, kid. I heard you beat my high score in Slalom Challenge." He gives you a respectful nod. "That's real talent right there. I've been holding that record since '82. You earned it, CHAMP!"`},{state:0,text:`"HUSTLE HUSTLE HUSTLE!" Coach Joe blows his whistle at a nearby tree. "You think this mountain is gonna ski ITSELF? Give me twenty push-ups! Actually, don't. The snow is cold. Give me twenty MENTAL push-ups. Think really hard about push-ups. GREAT WORK, CHAMP!"`},{state:1,text:`"You know what separates a WINNER from a LOSER on the slopes? NOTHING! They both fall down! But the WINNER falls down with CONFIDENCE!" He blows his whistle triumphantly. "That's free advice. Normally I charge for that."`},{state:2,text:`"I've been coaching ski beginners for thirty years and I've never actually been on skis myself. You know why? Because a true coach leads from the SIDELINES! Also I'm terrified of heights. DON'T TELL ANYONE!"`}]},dance_mom:{id:"dance_mom",name:"Social Media Influencer",description:"A woman in a sequined ski jacket and full stage makeup, filming everything on her phone with a ring light clipped to the top. She appears to be live-streaming her ski resort experience to an audience of possibly no one.",currentRoomId:"village",dialogueState:0,dialogue:[{state:0,text:`"And THIS, followers, is what we call RUSTIC CHARM!" She pans her phone across the village with practiced flair. "My daughter Samantha would have LOVED this mountain  she's got the best ski aesthetic of anyone I know. But her dance recital is this weekend so she couldn't make it. Her loss is YOUR gain, followers. CONTENT waits for no one!"`},{state:1,text:`"Excuse me, can you hold this phone and film me doing a dramatic pose by that statue? No? FINE. I'll use the selfie stick. You know, in MY day, mountains were taller AND the hot chocolate was free. This resort is a THREE out of TEN. But the lighting is GORGEOUS. Samantha is going to be SO jealous when she sees these stories."`},{state:2,text:`"My livestream just hit FOUR viewers! That's double from last time! One of them might be my mom, but engagement is engagement, honey. Samantha says I should try TikTok but I told her  mommy is a MULTI-PLATFORM creator. If you find any secret treasure in this dump, tag me. I need CONTENT."`}]},henrys_mom:{id:"henrys_mom",name:"Henry's Mom",description:"A warm, cheerful woman bundled in a cozy puffer jacket, surrounded by an impressive array of tote bags overflowing with snacks of every variety. Granola bars, fruit snacks, trail mix, string cheese, juice boxes  it's like a mobile convenience store. She has the kind smile of someone who's never met a stranger, though right now she keeps glancing around nervously for her son.",currentRoomId:"main_street",dialogueState:0,dialogue:[{state:0,text:`"Oh, hello sweetie!" She beams at you and immediately starts rummaging through one of her tote bags. "Have you seen my Henry? That boy took off to 'explore the mountain' about an hour ago and I just KNOW he didn't pack enough snacks. I gave him two granola bars but that's barely a warmup!"

She pulls out a fruit snack pouch and offers it to you. "Here, take this. You look like you could use a snack. I always say  you can never have too many snacks on an adventure. Do you want trail mix too? I have seven bags. SEVEN."`},{state:1,text:`"Still no Henry!" She shakes her head but manages a warm laugh. "That kid  he's got his father's sense of adventure and absolutely NONE of his common sense about packing food. I bet he's out there right now, climbing something he shouldn't be, with nothing but an empty granola bar wrapper in his pocket."

She holds up a thermos. "Hot cocoa? I made it from scratch this morning. I also have chicken soup, apple cider, and something that might be tea? Oh, and string cheese! The good kind, not the weird rubbery kind. Please, take something. I brought enough snacks for the entire resort and it would make me feel SO much better knowing at least someone out there is well-fed."`},{state:2,text:`"Henry just texted! He says he's been having the BEST time exploring the lodge. The LODGE! He was right here the whole time!" She laughs and wipes her eyes. "He says he made friends with some angry lady at the bar and they've been debating whether this resort needs better snack machines. That's my boy."

She starts reorganizing her tote bags with visible relief. "I swear, being a mom is 10% parenting and 90% making sure everyone has enough to eat. Are you SURE you don't want a juice box? I have a whole case. Take two. Take three! You're an adventurer  you need your energy!"`}]},old_dad:{id:"old_dad",name:"Old Dad",description:"A weathered, silver-haired man sitting in a creaky rocking chair by the cold fireplace. He's wrapped in a wool blanket with a thermos of coffee and a battered paperback novel. His eyes have the contented squint of someone who came here specifically to get away from everyone  and succeeded.",currentRoomId:"old_cabin",dialogueState:0,dialogue:[{state:0,text:`The old man looks up from his book with mild surprise  the kind that suggests he hasn't seen another human being in quite some time, and was perfectly fine with that.

"Well, well. A visitor." He takes a long sip of coffee. "Name's Dad. Well  Old Dad, if you ask the kids. Been holed up in this cabin since... what month is it? Doesn't matter. Came up here for some peace and quiet after thirty years of youth hockey tournaments, school drop-offs, and assembling furniture with missing screws."

He gestures at the cozy mess around him. "Found this place abandoned. Moved right in. Best decision I ever made. Nobody asking me to fix the WiFi out here."`},{state:1,text:`"Still here? Most people take the hint when a man's reading in an abandoned cabin in the middle of nowhere." He chuckles warmly. "I'm kidding. It's nice to have company. For exactly five minutes."

He leans forward conspiratorially. "You know, I've been hearing strange noises from under the lodge at night. Thumping. Buzzing. Like old machinery trying to wake up. The basement, I reckon. I tried the door once but it was locked tight. Found the key in that desk over there, but my knees aren't what they used to be. Too many stairs."

He glances at the leather pouch on the desk. "Oh, and take those game tokens while you're at it. Found 'em in a drawer. There's an old arcade cabinet in the general store over in the village  might still work if you feed it a token. Lord knows I have no use for 'em. Go play a game, stretch your legs, and let an old man read in peace."`},{state:2,text:`"You're back AGAIN? What is this, a social club?" He pretends to be annoyed but can't hide a grin. "Fine, fine. Sit down. Want some coffee? It's three days old but it builds character."

He stares out the frosty window. "This mountain has secrets, you know. Old Tobias Snowpeak  the founder  he was a peculiar fellow. Built this whole resort and then just... vanished. Left behind riddles and locked doors everywhere. Like a man who couldn't stop playing games even after he was gone."

He picks his book back up. "Now shoo. This chapter isn't going to read itself. And if you haven't tried that arcade in the general store yet, you should. Might find more than you expect over there."`}]}};function Dk(t,e){const i=e==="expert"?Sk:Ak,r=e==="expert"?Ik:Rk,o=e==="expert"?Ok:kk,u={};for(const[V,H]of Object.entries(i))u[V]={...H,items:[...H.items],npcs:[...H.npcs],hiddenExits:{...H.hiddenExits},lockedExits:H.lockedExits?{...H.lockedExits}:{},visited:!1};const h={};for(const[V,H]of Object.entries(r))h[V]={...H};const m={};for(const[V,H]of Object.entries(o))m[V]={...H,dialogue:[...H.dialogue],flags:{}};const _="lodge_lobby",p=u[_],y=[...Lw,{text:`Good luck, ${t}!`,type:"system"},{text:"",type:"normal"}];p.ascii&&y.push({text:p.ascii,type:"ascii"}),y.push({text:p.name,type:"title"}),y.push({text:p.description,type:"normal"});const v=p.items.filter(V=>!h[V]?.hidden);if(v.length>0){const V=v.map(H=>h[H].name);y.push({text:`
You can see: ${V.join(", ")}.`,type:"normal"})}if(p.npcs.length>0){const V=p.npcs.map(H=>m[H].name);y.push({text:`${V.join(" and ")} ${p.npcs.length===1?"is":"are"} here.`,type:"normal"})}const w={...p.exits,...p.hiddenExits},S=p.lockedExits||{},x=[];for(const V of Object.keys(w)){const H=u[w[V]];H?x.push(`${V} (${H.name})`):x.push(V)}for(const V of Object.keys(S)){const H=u[S[V].roomId];H?x.push(`${V} (${H.name})`):x.push(V)}return x.length>0&&y.push({text:`
Exits: ${x.join(", ")}`,type:"system"}),u[_].visited=!0,{currentRoomId:_,previousRoomId:null,inventory:[],rooms:u,items:h,npcs:m,puzzles:{},output:y,gameOver:!1,turnCount:0,playerName:t||"Adventurer",mode:e||"standard",startTime:Date.now()}}function Nk(t,e){const[i,r]=oe.useReducer(Tk,{playerName:t,mode:e},({playerName:h,mode:m})=>Dk(h,m)),o=oe.useRef(i);o.current=i;const u=oe.useCallback(h=>{const m=o.current;r({type:"ADD_OUTPUT",payload:{text:`> ${h}`,type:"command"}});const _=bk(h,m);_.error?r({type:"ADD_OUTPUT",payload:{text:_.error,type:"error"}}):r(_)},[]);return{gameState:i,processCommand:u,dispatch:r}}function Ck(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(3500,t.currentTime);const r=t.createOscillator(),o=t.createGain();r.frequency.value=6,o.gain.value=400,r.connect(o),o.connect(e.frequency),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.2,t.currentTime+.03),i.gain.setValueAtTime(.2,t.currentTime+.55),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.7),e.connect(i),i.connect(t.destination),r.start(),e.start(),e.stop(t.currentTime+.75),r.stop(t.currentTime+.75),setTimeout(()=>t.close(),1500)}catch{}}function Mk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(180,t.currentTime),e.frequency.exponentialRampToValueAtTime(60,t.currentTime+.1),i.gain.setValueAtTime(.12,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.1),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.15),setTimeout(()=>t.close(),500)}catch{}}function Vk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(80,t.currentTime),e.frequency.linearRampToValueAtTime(200,t.currentTime+.3),e.frequency.linearRampToValueAtTime(120,t.currentTime+.5),e.frequency.linearRampToValueAtTime(250,t.currentTime+.7),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.06,t.currentTime+.05),i.gain.setValueAtTime(.06,t.currentTime+.6),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.8),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.85),setTimeout(()=>t.close(),1500)}catch{}}function Lk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(55,t.currentTime),e.frequency.linearRampToValueAtTime(110,t.currentTime+.3),e.frequency.setValueAtTime(110,t.currentTime+.8),e.frequency.linearRampToValueAtTime(75,t.currentTime+1),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.08,t.currentTime+.1),i.gain.setValueAtTime(.08,t.currentTime+.8),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+1);const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=4,o.gain.value=.03,e.connect(i),i.connect(t.destination),r.connect(o),o.connect(t.destination),e.start(),r.start(),e.stop(t.currentTime+1.1),r.stop(t.currentTime+1.1),setTimeout(()=>t.close(),2e3)}catch{}}function Hk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=Math.floor(t.sampleRate*.6),i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let m=0;m<e;m++)r[m]=Math.random()*2-1;const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="bandpass",u.frequency.setValueAtTime(600,t.currentTime),u.frequency.linearRampToValueAtTime(300,t.currentTime+.6),u.Q.value=1;const h=t.createGain();h.gain.setValueAtTime(0,t.currentTime),h.gain.linearRampToValueAtTime(.12,t.currentTime+.08),h.gain.setValueAtTime(.12,t.currentTime+.35),h.gain.exponentialRampToValueAtTime(.01,t.currentTime+.6),o.connect(u),u.connect(h),h.connect(t.destination),o.start(),setTimeout(()=>t.close(),1500)}catch{}}function xk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[0,.15,.32],i=[.15,.08,.03];for(let r=0;r<e.length;r++){const o=t.createOscillator(),u=t.createGain();o.type="sine",o.frequency.setValueAtTime(1800,t.currentTime+e[r]),o.frequency.exponentialRampToValueAtTime(600,t.currentTime+e[r]+.1),u.gain.setValueAtTime(i[r],t.currentTime+e[r]),u.gain.exponentialRampToValueAtTime(.001,t.currentTime+e[r]+.15),o.connect(u),u.connect(t.destination),o.start(t.currentTime+e[r]),o.stop(t.currentTime+e[r]+.18)}setTimeout(()=>t.close(),1500)}catch{}}function Pk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(40,t.currentTime),e.frequency.linearRampToValueAtTime(55,t.currentTime+.3),e.frequency.linearRampToValueAtTime(35,t.currentTime+.8),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.25,t.currentTime+.1),i.gain.setValueAtTime(.25,t.currentTime+.5),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.8),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.85),setTimeout(()=>t.close(),1500)}catch{}}function zk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:523.25,start:0,dur:.15},{freq:659.25,start:.18,dur:.15},{freq:783.99,start:.36,dur:.15},{freq:1046.5,start:.54,dur:.4},{freq:783.99,start:1,dur:.12},{freq:1046.5,start:1.15,dur:.6}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="triangle",r.frequency.value=i.freq,o.gain.setValueAtTime(0,t.currentTime+i.start),o.gain.linearRampToValueAtTime(.3,t.currentTime+i.start+.03),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.05)}setTimeout(()=>t.close(),3e3)}catch{}}function Uk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:400,start:0,dur:.08},{freq:520,start:.09,dur:.07},{freq:620,start:.17,dur:.07},{freq:500,start:.25,dur:.07},{freq:680,start:.33,dur:.09},{freq:560,start:.44,dur:.07},{freq:720,start:.52,dur:.12}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sine",r.frequency.setValueAtTime(i.freq,t.currentTime+i.start),o.gain.setValueAtTime(0,t.currentTime+i.start),o.gain.linearRampToValueAtTime(.15,t.currentTime+i.start+.01),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),1500)}catch{}}function Bk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:660,start:0,dur:.08},{freq:880,start:.1,dur:.08},{freq:1100,start:.2,dur:.15}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(0,t.currentTime+i.start),o.gain.linearRampToValueAtTime(.12,t.currentTime+i.start+.01),o.gain.exponentialRampToValueAtTime(.01,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.02)}setTimeout(()=>t.close(),800)}catch{}}function Gk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(120,t.currentTime),e.frequency.linearRampToValueAtTime(80,t.currentTime+.25),i.gain.setValueAtTime(.15,t.currentTime),i.gain.linearRampToValueAtTime(.08,t.currentTime+.15),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.3),e.connect(i),i.connect(t.destination),e.start(t.currentTime),e.stop(t.currentTime+.35);const r=t.sampleRate*.15,o=t.createBuffer(1,r,t.sampleRate),u=o.getChannelData(0);for(let _=0;_<r;_++)u[_]=(Math.random()*2-1)*.3;const h=t.createBufferSource(),m=t.createGain();h.buffer=o,m.gain.setValueAtTime(.06,t.currentTime),m.gain.exponentialRampToValueAtTime(.01,t.currentTime+.15),h.connect(m),m.connect(t.destination),h.start(t.currentTime),setTimeout(()=>t.close(),600)}catch{}}function qk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(1200,t.currentTime),e.frequency.exponentialRampToValueAtTime(1e3,t.currentTime+.1),i.gain.setValueAtTime(.3,t.currentTime),i.gain.exponentialRampToValueAtTime(.01,t.currentTime+.6),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.65),setTimeout(()=>t.close(),1e3)}catch{}}function Yk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.sampleRate*.15,i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let p=0;p<e;p++)r[p]=(Math.random()*2-1)*Math.exp(-p/(t.sampleRate*.03));const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="lowpass",u.frequency.value=600;const h=t.createGain();h.gain.setValueAtTime(.5,t.currentTime),o.connect(u),u.connect(h),h.connect(t.destination),o.start();const m=t.createOscillator();m.type="square",m.frequency.setValueAtTime(180,t.currentTime+.1),m.frequency.linearRampToValueAtTime(120,t.currentTime+.25);const _=t.createGain();_.gain.setValueAtTime(0,t.currentTime),_.gain.setValueAtTime(.15,t.currentTime+.1),_.gain.exponentialRampToValueAtTime(.01,t.currentTime+.3),m.connect(_),_.connect(t.destination),m.start(),m.stop(t.currentTime+.35),setTimeout(()=>t.close(),800)}catch{}}function jk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(60,t.currentTime),e.frequency.linearRampToValueAtTime(140,t.currentTime+.2),e.frequency.linearRampToValueAtTime(80,t.currentTime+.35),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.05,t.currentTime+.05),i.gain.setValueAtTime(.05,t.currentTime+.3),i.gain.exponentialRampToValueAtTime(.001,t.currentTime+.45),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.5);const r=t.createOscillator(),o=t.createGain();r.type="sawtooth",r.frequency.setValueAtTime(90,t.currentTime+.5),r.frequency.linearRampToValueAtTime(180,t.currentTime+.65),r.frequency.linearRampToValueAtTime(100,t.currentTime+.8),o.gain.setValueAtTime(0,t.currentTime+.5),o.gain.linearRampToValueAtTime(.04,t.currentTime+.55),o.gain.setValueAtTime(.04,t.currentTime+.75),o.gain.exponentialRampToValueAtTime(.001,t.currentTime+.9),r.connect(o),o.connect(t.destination),r.start(t.currentTime+.5),r.stop(t.currentTime+.95),setTimeout(()=>t.close(),1500)}catch{}}function Fk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.sampleRate*.06,i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let p=0;p<e;p++){const y=p/e,v=y<.05?y/.05:Math.exp(-30*(y-.05));r[p]=(Math.random()*2-1)*v}const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="bandpass",u.frequency.value=3e3,u.Q.value=1.5;const h=t.createGain();h.gain.value=.25,o.connect(u),u.connect(h),h.connect(t.destination),o.start();const m=t.createOscillator(),_=t.createGain();m.type="sine",m.frequency.setValueAtTime(1200,t.currentTime+.03),m.frequency.exponentialRampToValueAtTime(600,t.currentTime+.08),_.gain.setValueAtTime(.08,t.currentTime+.03),_.gain.exponentialRampToValueAtTime(.001,t.currentTime+.1),m.connect(_),_.connect(t.destination),m.start(t.currentTime+.03),m.stop(t.currentTime+.12),setTimeout(()=>t.close(),500)}catch{}}function Wk(){try{const t=new(window.AudioContext||window.webkitAudioContext);for(let e=0;e<2;e++){const i=e*.22,r=Math.floor(t.sampleRate*.15),o=t.createBuffer(1,r,t.sampleRate),u=o.getChannelData(0);for(let p=0;p<r;p++){const y=p/r,v=y<.1?y/.1:Math.exp(-8*(y-.1));u[p]=(Math.random()*2-1)*v}const h=t.createBufferSource();h.buffer=o;const m=t.createBiquadFilter();m.type="bandpass",m.frequency.value=1800,m.Q.value=.8;const _=t.createGain();_.gain.value=.1,h.connect(m),m.connect(_),_.connect(t.destination),h.start(t.currentTime+i)}setTimeout(()=>t.close(),1e3)}catch{}}function Xk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sawtooth",e.frequency.setValueAtTime(100,t.currentTime),e.frequency.linearRampToValueAtTime(160,t.currentTime+.15),e.frequency.linearRampToValueAtTime(90,t.currentTime+.25),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.04,t.currentTime+.03),i.gain.setValueAtTime(.04,t.currentTime+.2),i.gain.exponentialRampToValueAtTime(.001,t.currentTime+.3),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.35),setTimeout(()=>t.close(),700)}catch{}}function Kk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:2200,start:0,dur:.3},{freq:2600,start:.12,dur:.35}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sine",r.frequency.value=i.freq,o.gain.setValueAtTime(.12,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.001,t.currentTime+i.start+i.dur),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+i.dur+.05)}setTimeout(()=>t.close(),1e3)}catch{}}function Qk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[220,330],i=[0,.08];for(let r=0;r<e.length;r++){const o=t.createOscillator(),u=t.createGain();o.type="sine",o.frequency.value=e[r],u.gain.setValueAtTime(0,t.currentTime+i[r]),u.gain.linearRampToValueAtTime(.08,t.currentTime+i[r]+.05),u.gain.exponentialRampToValueAtTime(.001,t.currentTime+i[r]+.6),o.connect(u),u.connect(t.destination),o.start(t.currentTime+i[r]),o.stop(t.currentTime+i[r]+.65)}setTimeout(()=>t.close(),1500)}catch{}}function Zk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=[{freq:2400,start:0,vol:.12},{freq:1800,start:.25,vol:.08},{freq:2100,start:.45,vol:.06}];for(const i of e){const r=t.createOscillator(),o=t.createGain();r.type="sine",r.frequency.setValueAtTime(i.freq,t.currentTime+i.start),r.frequency.exponentialRampToValueAtTime(i.freq*.5,t.currentTime+i.start+.08),o.gain.setValueAtTime(i.vol,t.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.001,t.currentTime+i.start+.12),r.connect(o),o.connect(t.destination),r.start(t.currentTime+i.start),r.stop(t.currentTime+i.start+.15)}setTimeout(()=>t.close(),1200)}catch{}}function $k(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=t.createOscillator(),i=t.createGain();e.type="sine",e.frequency.setValueAtTime(120,t.currentTime),e.frequency.linearRampToValueAtTime(180,t.currentTime+.4),e.frequency.linearRampToValueAtTime(140,t.currentTime+.7),i.gain.setValueAtTime(0,t.currentTime),i.gain.linearRampToValueAtTime(.06,t.currentTime+.1),i.gain.setValueAtTime(.06,t.currentTime+.5),i.gain.exponentialRampToValueAtTime(.001,t.currentTime+.7),e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.75),setTimeout(()=>t.close(),1200)}catch{}}function Jk(){try{const t=new(window.AudioContext||window.webkitAudioContext),e=Math.floor(t.sampleRate*.5),i=t.createBuffer(1,e,t.sampleRate),r=i.getChannelData(0);for(let m=0;m<e;m++){const _=m/t.sampleRate,p=.5+.5*Math.sin(_*8*Math.PI)*Math.sin(_*3*Math.PI);r[m]=(Math.random()*2-1)*p}const o=t.createBufferSource();o.buffer=i;const u=t.createBiquadFilter();u.type="bandpass",u.frequency.value=400,u.Q.value=2;const h=t.createGain();h.gain.setValueAtTime(0,t.currentTime),h.gain.linearRampToValueAtTime(.04,t.currentTime+.05),h.gain.setValueAtTime(.04,t.currentTime+.35),h.gain.exponentialRampToValueAtTime(.001,t.currentTime+.5),o.connect(u),u.connect(h),h.connect(t.destination),o.start(),setTimeout(()=>t.close(),1e3)}catch{}}function eO(){try{const t=new(window.AudioContext||window.webkitAudioContext);for(let e=0;e<3;e++){const i=e*.15,r=t.sampleRate*.12,o=t.createBuffer(1,r,t.sampleRate),u=o.getChannelData(0);for(let p=0;p<r;p++){const y=p/r,v=Math.sin(y*Math.PI);u[p]=(Math.random()*2-1)*v}const h=t.createBufferSource();h.buffer=o;const m=t.createBiquadFilter();m.type="highpass",m.frequency.value=2e3+e*800;const _=t.createGain();_.gain.value=.08,h.connect(m),m.connect(_),_.connect(t.destination),h.start(t.currentTime+i)}setTimeout(()=>t.close(),1e3)}catch{}}function tO(t){const i={whistle:Ck,footstep:Mk,creak_door:Vk,lift_motor:Lk,wind:Hk,cave_echo:xk,vault_rumble:Pk,kid_laugh:Uk,victory:zk,arcade_start:Bk,angry_grunt:Gk,bell:qk,unlock:Yk,rocking_chair:jk,camera_click:Fk,bag_rummage:eO,snow_crunch:Wk,wood_floor:Xk,store_bell:Kk,chapel_echo:Qk,tunnel_drip:Zk,observatory_hum:$k,lobby_chatter:Jk}[t];i&&i()}function nO({playerInfo:t,onRestart:e}){const{gameState:i,processCommand:r,dispatch:o}=Nk(t.name,t.mode),u=oe.useRef(0);oe.useEffect(()=>{Y2()},[]),oe.useEffect(()=>{const p=i.output.slice(u.current);u.current=i.output.length;for(const y of p)y.type==="sound"&&tO(y.sound)},[i.output]);const h=oe.useCallback(p=>{o({type:"SLALOM_RESULT",payload:p})},[o]),m=oe.useCallback(p=>{o({type:"DEFEND_RESULT",payload:p})},[o]),_=oe.useCallback(p=>{o({type:"SNOWBALL_RESULT",payload:p})},[o]);return oe.useEffect(()=>{if(i.gameRestart){const p=setTimeout(()=>{e()},1e3);return()=>clearTimeout(p)}},[i.gameRestart,e]),i.launchSlalom?C.jsx(Xm,{standalone:!1,onGameOver:h}):i.launchDefend?C.jsx(Qm,{standalone:!1,onGameOver:m}):i.launchSnowball?C.jsx(Zm,{standalone:!1,onGameOver:_}):C.jsx("div",{className:"terminal",children:C.jsx(v2,{output:i.output,onCommand:r,gameOver:i.gameOver,mode:t.mode,gameState:i})})}function iO(){const[t,e]=oe.useState(null),[i,r]=oe.useState(window.location.hash);return oe.useEffect(()=>{const o=()=>r(window.location.hash);return window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[]),i==="#slalom"?C.jsx(Xm,{standalone:!0}):i==="#defend"?C.jsx(Qm,{standalone:!0}):i==="#snowball"?C.jsx(Zm,{standalone:!0}):t?t.mode==="bonus"?C.jsx(gk,{onBack:()=>e(null)}):C.jsx(nO,{playerInfo:t,onRestart:()=>e(null)}):C.jsx("div",{className:"terminal",children:C.jsx(A2,{onSubmit:e})})}Vw.createRoot(document.getElementById("root")).render(C.jsx(iO,{}));

(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=i(o);fetch(o.href,u)}})();var Cd={exports:{}},kl={};var Ly;function Zw(){if(Ly)return kl;Ly=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(r,o,u){var c=null;if(u!==void 0&&(c=""+u),o.key!==void 0&&(c=""+o.key),"key"in o){u={};for(var m in o)m!=="key"&&(u[m]=o[m])}else u=o;return o=u.ref,{$$typeof:e,type:r,key:c,ref:o!==void 0?o:null,props:u}}return kl.Fragment=t,kl.jsx=i,kl.jsxs=i,kl}var Hy;function Jw(){return Hy||(Hy=1,Cd.exports=Zw()),Cd.exports}var S=Jw(),Nd={exports:{}},Dl={},Md={exports:{}},Vd={};var Py;function eb(){return Py||(Py=1,(function(e){function t($,ue){var Ee=$.length;$.push(ue);e:for(;0<Ee;){var Xe=Ee-1>>>1,nt=$[Xe];if(0<o(nt,ue))$[Xe]=ue,$[Ee]=nt,Ee=Xe;else break e}}function i($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var ue=$[0],Ee=$.pop();if(Ee!==ue){$[0]=Ee;e:for(var Xe=0,nt=$.length,x=nt>>>1;Xe<x;){var ne=2*(Xe+1)-1,ce=$[ne],de=ne+1,Re=$[de];if(0>o(ce,Ee))de<nt&&0>o(Re,ce)?($[Xe]=Re,$[de]=Ee,Xe=de):($[Xe]=ce,$[ne]=Ee,Xe=ne);else if(de<nt&&0>o(Re,Ee))$[Xe]=Re,$[de]=Ee,Xe=de;else break e}}return ue}function o($,ue){var Ee=$.sortIndex-ue.sortIndex;return Ee!==0?Ee:$.id-ue.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var c=Date,m=c.now();e.unstable_now=function(){return c.now()-m}}var _=[],p=[],y=1,v=null,w=3,R=!1,M=!1,V=!1,L=!1,O=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;function re($){for(var ue=i(p);ue!==null;){if(ue.callback===null)r(p);else if(ue.startTime<=$)r(p),ue.sortIndex=ue.expirationTime,t(_,ue);else break;ue=i(p)}}function Ce($){if(V=!1,re($),!M)if(i(_)!==null)M=!0,we||(we=!0,B());else{var ue=i(p);ue!==null&&qt(Ce,ue.startTime-$)}}var we=!1,k=-1,I=5,D=-1;function z(){return L?!0:!(e.unstable_now()-D<I)}function H(){if(L=!1,we){var $=e.unstable_now();D=$;var ue=!0;try{e:{M=!1,V&&(V=!1,G(k),k=-1),R=!0;var Ee=w;try{t:{for(re($),v=i(_);v!==null&&!(v.expirationTime>$&&z());){var Xe=v.callback;if(typeof Xe=="function"){v.callback=null,w=v.priorityLevel;var nt=Xe(v.expirationTime<=$);if($=e.unstable_now(),typeof nt=="function"){v.callback=nt,re($),ue=!0;break t}v===i(_)&&r(_),re($)}else r(_);v=i(_)}if(v!==null)ue=!0;else{var x=i(p);x!==null&&qt(Ce,x.startTime-$),ue=!1}}break e}finally{v=null,w=Ee,R=!1}ue=void 0}}finally{ue?B():we=!1}}}var B;if(typeof J=="function")B=function(){J(H)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,yt=C.port2;C.port1.onmessage=H,B=function(){yt.postMessage(null)}}else B=function(){O(H,0)};function qt($,ue){k=O(function(){$(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return w},e.unstable_next=function($){switch(w){case 1:case 2:case 3:var ue=3;break;default:ue=w}var Ee=w;w=ue;try{return $()}finally{w=Ee}},e.unstable_requestPaint=function(){L=!0},e.unstable_runWithPriority=function($,ue){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Ee=w;w=$;try{return ue()}finally{w=Ee}},e.unstable_scheduleCallback=function($,ue,Ee){var Xe=e.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Xe+Ee:Xe):Ee=Xe,$){case 1:var nt=-1;break;case 2:nt=250;break;case 5:nt=1073741823;break;case 4:nt=1e4;break;default:nt=5e3}return nt=Ee+nt,$={id:y++,callback:ue,priorityLevel:$,startTime:Ee,expirationTime:nt,sortIndex:-1},Ee>Xe?($.sortIndex=Ee,t(p,$),i(_)===null&&$===i(p)&&(V?(G(k),k=-1):V=!0,qt(Ce,Ee-Xe))):($.sortIndex=nt,t(_,$),M||R||(M=!0,we||(we=!0,B()))),$},e.unstable_shouldYield=z,e.unstable_wrapCallback=function($){var ue=w;return function(){var Ee=w;w=ue;try{return $.apply(this,arguments)}finally{w=Ee}}}})(Vd)),Vd}var xy;function tb(){return xy||(xy=1,Md.exports=eb()),Md.exports}var Ld={exports:{}},ke={};var zy;function nb(){if(zy)return ke;zy=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),w=Symbol.iterator;function R(x){return x===null||typeof x!="object"?null:(x=w&&x[w]||x["@@iterator"],typeof x=="function"?x:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,L={};function O(x,ne,ce){this.props=x,this.context=ne,this.refs=L,this.updater=ce||M}O.prototype.isReactComponent={},O.prototype.setState=function(x,ne){if(typeof x!="object"&&typeof x!="function"&&x!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,x,ne,"setState")},O.prototype.forceUpdate=function(x){this.updater.enqueueForceUpdate(this,x,"forceUpdate")};function G(){}G.prototype=O.prototype;function J(x,ne,ce){this.props=x,this.context=ne,this.refs=L,this.updater=ce||M}var re=J.prototype=new G;re.constructor=J,V(re,O.prototype),re.isPureReactComponent=!0;var Ce=Array.isArray;function we(){}var k={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function D(x,ne,ce){var de=ce.ref;return{$$typeof:e,type:x,key:ne,ref:de!==void 0?de:null,props:ce}}function z(x,ne){return D(x.type,ne,x.props)}function H(x){return typeof x=="object"&&x!==null&&x.$$typeof===e}function B(x){var ne={"=":"=0",":":"=2"};return"$"+x.replace(/[=:]/g,function(ce){return ne[ce]})}var C=/\/+/g;function yt(x,ne){return typeof x=="object"&&x!==null&&x.key!=null?B(""+x.key):ne.toString(36)}function qt(x){switch(x.status){case"fulfilled":return x.value;case"rejected":throw x.reason;default:switch(typeof x.status=="string"?x.then(we,we):(x.status="pending",x.then(function(ne){x.status==="pending"&&(x.status="fulfilled",x.value=ne)},function(ne){x.status==="pending"&&(x.status="rejected",x.reason=ne)})),x.status){case"fulfilled":return x.value;case"rejected":throw x.reason}}throw x}function $(x,ne,ce,de,Re){var Le=typeof x;(Le==="undefined"||Le==="boolean")&&(x=null);var qe=!1;if(x===null)qe=!0;else switch(Le){case"bigint":case"string":case"number":qe=!0;break;case"object":switch(x.$$typeof){case e:case t:qe=!0;break;case y:return qe=x._init,$(qe(x._payload),ne,ce,de,Re)}}if(qe)return Re=Re(x),qe=de===""?"."+yt(x,0):de,Ce(Re)?(ce="",qe!=null&&(ce=qe.replace(C,"$&/")+"/"),$(Re,ne,ce,"",function(Tr){return Tr})):Re!=null&&(H(Re)&&(Re=z(Re,ce+(Re.key==null||x&&x.key===Re.key?"":(""+Re.key).replace(C,"$&/")+"/")+qe)),ne.push(Re)),1;qe=0;var Yt=de===""?".":de+":";if(Ce(x))for(var Tt=0;Tt<x.length;Tt++)de=x[Tt],Le=Yt+yt(de,Tt),qe+=$(de,ne,ce,Le,Re);else if(Tt=R(x),typeof Tt=="function")for(x=Tt.call(x),Tt=0;!(de=x.next()).done;)de=de.value,Le=Yt+yt(de,Tt++),qe+=$(de,ne,ce,Le,Re);else if(Le==="object"){if(typeof x.then=="function")return $(qt(x),ne,ce,de,Re);throw ne=String(x),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return qe}function ue(x,ne,ce){if(x==null)return x;var de=[],Re=0;return $(x,de,"","",function(Le){return ne.call(ce,Le,Re++)}),de}function Ee(x){if(x._status===-1){var ne=x._result;ne=ne(),ne.then(function(ce){(x._status===0||x._status===-1)&&(x._status=1,x._result=ce)},function(ce){(x._status===0||x._status===-1)&&(x._status=2,x._result=ce)}),x._status===-1&&(x._status=0,x._result=ne)}if(x._status===1)return x._result.default;throw x._result}var Xe=typeof reportError=="function"?reportError:function(x){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof x=="object"&&x!==null&&typeof x.message=="string"?String(x.message):String(x),error:x});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",x);return}console.error(x)},nt={map:ue,forEach:function(x,ne,ce){ue(x,function(){ne.apply(this,arguments)},ce)},count:function(x){var ne=0;return ue(x,function(){ne++}),ne},toArray:function(x){return ue(x,function(ne){return ne})||[]},only:function(x){if(!H(x))throw Error("React.Children.only expected to receive a single React element child.");return x}};return ke.Activity=v,ke.Children=nt,ke.Component=O,ke.Fragment=i,ke.Profiler=o,ke.PureComponent=J,ke.StrictMode=r,ke.Suspense=_,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,ke.__COMPILER_RUNTIME={__proto__:null,c:function(x){return k.H.useMemoCache(x)}},ke.cache=function(x){return function(){return x.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(x,ne,ce){if(x==null)throw Error("The argument must be a React element, but you passed "+x+".");var de=V({},x.props),Re=x.key;if(ne!=null)for(Le in ne.key!==void 0&&(Re=""+ne.key),ne)!I.call(ne,Le)||Le==="key"||Le==="__self"||Le==="__source"||Le==="ref"&&ne.ref===void 0||(de[Le]=ne[Le]);var Le=arguments.length-2;if(Le===1)de.children=ce;else if(1<Le){for(var qe=Array(Le),Yt=0;Yt<Le;Yt++)qe[Yt]=arguments[Yt+2];de.children=qe}return D(x.type,Re,de)},ke.createContext=function(x){return x={$$typeof:c,_currentValue:x,_currentValue2:x,_threadCount:0,Provider:null,Consumer:null},x.Provider=x,x.Consumer={$$typeof:u,_context:x},x},ke.createElement=function(x,ne,ce){var de,Re={},Le=null;if(ne!=null)for(de in ne.key!==void 0&&(Le=""+ne.key),ne)I.call(ne,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(Re[de]=ne[de]);var qe=arguments.length-2;if(qe===1)Re.children=ce;else if(1<qe){for(var Yt=Array(qe),Tt=0;Tt<qe;Tt++)Yt[Tt]=arguments[Tt+2];Re.children=Yt}if(x&&x.defaultProps)for(de in qe=x.defaultProps,qe)Re[de]===void 0&&(Re[de]=qe[de]);return D(x,Le,Re)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(x){return{$$typeof:m,render:x}},ke.isValidElement=H,ke.lazy=function(x){return{$$typeof:y,_payload:{_status:-1,_result:x},_init:Ee}},ke.memo=function(x,ne){return{$$typeof:p,type:x,compare:ne===void 0?null:ne}},ke.startTransition=function(x){var ne=k.T,ce={};k.T=ce;try{var de=x(),Re=k.S;Re!==null&&Re(ce,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(we,Xe)}catch(Le){Xe(Le)}finally{ne!==null&&ce.types!==null&&(ne.types=ce.types),k.T=ne}},ke.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},ke.use=function(x){return k.H.use(x)},ke.useActionState=function(x,ne,ce){return k.H.useActionState(x,ne,ce)},ke.useCallback=function(x,ne){return k.H.useCallback(x,ne)},ke.useContext=function(x){return k.H.useContext(x)},ke.useDebugValue=function(){},ke.useDeferredValue=function(x,ne){return k.H.useDeferredValue(x,ne)},ke.useEffect=function(x,ne){return k.H.useEffect(x,ne)},ke.useEffectEvent=function(x){return k.H.useEffectEvent(x)},ke.useId=function(){return k.H.useId()},ke.useImperativeHandle=function(x,ne,ce){return k.H.useImperativeHandle(x,ne,ce)},ke.useInsertionEffect=function(x,ne){return k.H.useInsertionEffect(x,ne)},ke.useLayoutEffect=function(x,ne){return k.H.useLayoutEffect(x,ne)},ke.useMemo=function(x,ne){return k.H.useMemo(x,ne)},ke.useOptimistic=function(x,ne){return k.H.useOptimistic(x,ne)},ke.useReducer=function(x,ne,ce){return k.H.useReducer(x,ne,ce)},ke.useRef=function(x){return k.H.useRef(x)},ke.useState=function(x){return k.H.useState(x)},ke.useSyncExternalStore=function(x,ne,ce){return k.H.useSyncExternalStore(x,ne,ce)},ke.useTransition=function(){return k.H.useTransition()},ke.version="19.2.4",ke}var Uy;function bm(){return Uy||(Uy=1,Ld.exports=nb()),Ld.exports}var Hd={exports:{}},pn={};var By;function ib(){if(By)return pn;By=1;var e=bm();function t(_){var p="https://react.dev/errors/"+_;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+_+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var r={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(_,p,y){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:_,containerInfo:p,implementation:y}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(_,p){if(_==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,pn.createPortal=function(_,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(t(299));return u(_,p,null,y)},pn.flushSync=function(_){var p=c.T,y=r.p;try{if(c.T=null,r.p=2,_)return _()}finally{c.T=p,r.p=y,r.d.f()}},pn.preconnect=function(_,p){typeof _=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(_,p))},pn.prefetchDNS=function(_){typeof _=="string"&&r.d.D(_)},pn.preinit=function(_,p){if(typeof _=="string"&&p&&typeof p.as=="string"){var y=p.as,v=m(y,p.crossOrigin),w=typeof p.integrity=="string"?p.integrity:void 0,R=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;y==="style"?r.d.S(_,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:w,fetchPriority:R}):y==="script"&&r.d.X(_,{crossOrigin:v,integrity:w,fetchPriority:R,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},pn.preinitModule=function(_,p){if(typeof _=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var y=m(p.as,p.crossOrigin);r.d.M(_,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(_)},pn.preload=function(_,p){if(typeof _=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var y=p.as,v=m(y,p.crossOrigin);r.d.L(_,y,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},pn.preloadModule=function(_,p){if(typeof _=="string")if(p){var y=m(p.as,p.crossOrigin);r.d.m(_,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(_)},pn.requestFormReset=function(_){r.d.r(_)},pn.unstable_batchedUpdates=function(_,p){return _(p)},pn.useFormState=function(_,p,y){return c.H.useFormState(_,p,y)},pn.useFormStatus=function(){return c.H.useHostTransitionStatus()},pn.version="19.2.4",pn}var Gy;function ab(){if(Gy)return Hd.exports;Gy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Hd.exports=ib(),Hd.exports}var jy;function rb(){if(jy)return Dl;jy=1;var e=tb(),t=bm(),i=ab();function r(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)a+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var a=n,s=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(s=a.return),n=a.return;while(n)}return a.tag===3?s:null}function c(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function m(n){if(n.tag===31){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function _(n){if(u(n)!==n)throw Error(r(188))}function p(n){var a=n.alternate;if(!a){if(a=u(n),a===null)throw Error(r(188));return a!==n?null:n}for(var s=n,l=a;;){var f=s.return;if(f===null)break;var d=f.alternate;if(d===null){if(l=f.return,l!==null){s=l;continue}break}if(f.child===d.child){for(d=f.child;d;){if(d===s)return _(f),n;if(d===l)return _(f),a;d=d.sibling}throw Error(r(188))}if(s.return!==l.return)s=f,l=d;else{for(var T=!1,b=f.child;b;){if(b===s){T=!0,s=f,l=d;break}if(b===l){T=!0,l=f,s=d;break}b=b.sibling}if(!T){for(b=d.child;b;){if(b===s){T=!0,s=d,l=f;break}if(b===l){T=!0,l=d,s=f;break}b=b.sibling}if(!T)throw Error(r(189))}}if(s.alternate!==l)throw Error(r(190))}if(s.tag!==3)throw Error(r(188));return s.stateNode.current===s?n:a}function y(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=y(n),a!==null)return a;n=n.sibling}return null}var v=Object.assign,w=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),J=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),Ce=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function B(n){return n===null||typeof n!="object"?null:(n=H&&n[H]||n["@@iterator"],typeof n=="function"?n:null)}var C=Symbol.for("react.client.reference");function yt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===C?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V:return"Fragment";case O:return"Profiler";case L:return"StrictMode";case Ce:return"Suspense";case we:return"SuspenseList";case D:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case M:return"Portal";case J:return n.displayName||"Context";case G:return(n._context.displayName||"Context")+".Consumer";case re:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case k:return a=n.displayName||null,a!==null?a:yt(n.type)||"Memo";case I:a=n._payload,n=n._init;try{return yt(n(a))}catch{}}return null}var qt=Array.isArray,$=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},Xe=[],nt=-1;function x(n){return{current:n}}function ne(n){0>nt||(n.current=Xe[nt],Xe[nt]=null,nt--)}function ce(n,a){nt++,Xe[nt]=n.current,n.current=a}var de=x(null),Re=x(null),Le=x(null),qe=x(null);function Yt(n,a){switch(ce(Le,a),ce(Re,n),ce(de,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?ay(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=ay(a),n=ry(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ne(de),ce(de,n)}function Tt(){ne(de),ne(Re),ne(Le)}function Tr(n){n.memoizedState!==null&&ce(qe,n);var a=de.current,s=ry(a,n.type);a!==s&&(ce(Re,n),ce(de,s))}function rs(n){Re.current===n&&(ne(de),ne(Re)),qe.current===n&&(ne(qe),Al._currentValue=Ee)}var ss,os;function Ii(n){if(ss===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\n( *(at )?)/);ss=a&&a[1]||"",os=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ss+n+os}var Ao=!1;function Er(n,a){if(!n||Ao)return"";Ao=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(a){var ee=function(){throw Error()};if(Object.defineProperty(ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ee,[])}catch(X){var F=X}Reflect.construct(n,[],ee)}else{try{ee.call()}catch(X){F=X}n.call(ee.prototype)}}else{try{throw Error()}catch(X){F=X}(ee=n())&&typeof ee.catch=="function"&&ee.catch(function(){})}}catch(X){if(X&&F&&typeof X.stack=="string")return[X.stack,F.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=l.DetermineComponentFrameRoot(),T=d[0],b=d[1];if(T&&b){var N=T.split(`
`),Y=b.split(`
`);for(f=l=0;l<N.length&&!N[l].includes("DetermineComponentFrameRoot");)l++;for(;f<Y.length&&!Y[f].includes("DetermineComponentFrameRoot");)f++;if(l===N.length||f===Y.length)for(l=N.length-1,f=Y.length-1;1<=l&&0<=f&&N[l]!==Y[f];)f--;for(;1<=l&&0<=f;l--,f--)if(N[l]!==Y[f]){if(l!==1||f!==1)do if(l--,f--,0>f||N[l]!==Y[f]){var Q=`
`+N[l].replace(" at new "," at ");return n.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",n.displayName)),Q}while(1<=l&&0<=f);break}}}finally{Ao=!1,Error.prepareStackTrace=s}return(s=n?n.displayName||n.name:"")?Ii(s):""}function So(n,a){switch(n.tag){case 26:case 27:case 5:return Ii(n.type);case 16:return Ii("Lazy");case 13:return n.child!==a&&a!==null?Ii("Suspense Fallback"):Ii("Suspense");case 19:return Ii("SuspenseList");case 0:case 15:return Er(n.type,!1);case 11:return Er(n.type.render,!1);case 1:return Er(n.type,!0);case 31:return Ii("Activity");default:return""}}function Ro(n){try{var a="",s=null;do a+=So(n,s),s=n,n=n.return;while(n);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Nt=Object.prototype.hasOwnProperty,Ft=e.unstable_scheduleCallback,Sa=e.unstable_cancelCallback,Nh=e.unstable_shouldYield,su=e.unstable_requestPaint,En=e.unstable_now,vr=e.unstable_getCurrentPriorityLevel,Io=e.unstable_ImmediatePriority,ko=e.unstable_UserBlockingPriority,Ra=e.unstable_NormalPriority,Mh=e.unstable_LowPriority,ou=e.unstable_IdlePriority,lu=e.log,uu=e.unstable_setDisableYieldValue,ui=null,an=null;function Yn(n){if(typeof lu=="function"&&uu(n),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(ui,n)}catch{}}var It=Math.clz32?Math.clz32:hu,cu=Math.log,ls=Math.LN2;function hu(n){return n>>>=0,n===0?32:31-(cu(n)/ls|0)|0}var ki=256,wr=262144,Mt=4194304;function Di(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Oi(n,a,s){var l=n.pendingLanes;if(l===0)return 0;var f=0,d=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var b=l&134217727;return b!==0?(l=b&~d,l!==0?f=Di(l):(T&=b,T!==0?f=Di(T):s||(s=b&~n,s!==0&&(f=Di(s))))):(b=l&~d,b!==0?f=Di(b):T!==0?f=Di(T):s||(s=l&~n,s!==0&&(f=Di(s)))),f===0?0:a!==0&&a!==f&&(a&d)===0&&(d=f&-f,s=a&-a,d>=s||d===32&&(s&4194048)!==0)?a:f}function ci(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function Vh(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fu(){var n=Mt;return Mt<<=1,(Mt&62914560)===0&&(Mt=4194304),n}function Ci(n){for(var a=[],s=0;31>s;s++)a.push(n);return a}function br(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Lh(n,a,s,l,f,d){var T=n.pendingLanes;n.pendingLanes=s,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=s,n.entangledLanes&=s,n.errorRecoveryDisabledLanes&=s,n.shellSuspendCounter=0;var b=n.entanglements,N=n.expirationTimes,Y=n.hiddenUpdates;for(s=T&~s;0<s;){var Q=31-It(s),ee=1<<Q;b[Q]=0,N[Q]=-1;var F=Y[Q];if(F!==null)for(Y[Q]=null,Q=0;Q<F.length;Q++){var X=F[Q];X!==null&&(X.lane&=-536870913)}s&=~ee}l!==0&&Ar(n,l,0),d!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=d&~(T&~a))}function Ar(n,a,s){n.pendingLanes|=a,n.suspendedLanes&=~a;var l=31-It(a);n.entangledLanes|=a,n.entanglements[l]=n.entanglements[l]|1073741824|s&261930}function Do(n,a){var s=n.entangledLanes|=a;for(n=n.entanglements;s;){var l=31-It(s),f=1<<l;f&a|n[l]&a&&(n[l]|=a),s&=~f}}function Oo(n,a){var s=a&-a;return s=(s&42)!==0?1:Sr(s),(s&(n.suspendedLanes|a))!==0?0:s}function Sr(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function na(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function du(){var n=ue.p;return n!==0?n:(n=window.event,n===void 0?32:ky(n.type))}function hi(n,a){var s=ue.p;try{return ue.p=n,a()}finally{ue.p=s}}var fi=Math.random().toString(36).slice(2),Vt="__reactFiber$"+fi,Qt="__reactProps$"+fi,Ni="__reactContainer$"+fi,us="__reactEvents$"+fi,Hh="__reactListeners$"+fi,mu="__reactHandles$"+fi,_u="__reactResources$"+fi,Mi="__reactMarker$"+fi;function cs(n){delete n[Vt],delete n[Qt],delete n[us],delete n[Hh],delete n[mu]}function Vi(n){var a=n[Vt];if(a)return a;for(var s=n.parentNode;s;){if(a=s[Ni]||s[Vt]){if(s=a.alternate,a.child!==null||s!==null&&s.child!==null)for(n=fy(n);n!==null;){if(s=n[Vt])return s;n=fy(n)}return a}n=s,s=n.parentNode}return null}function Fn(n){if(n=n[Vt]||n[Ni]){var a=n.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return n}return null}function Hn(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(r(33))}function Li(n){var a=n[_u];return a||(a=n[_u]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Lt(n){n[Mi]=!0}var Co=new Set,No={};function Hi(n,a){Pi(n,a),Pi(n+"Capture",a)}function Pi(n,a){for(No[n]=a,n=0;n<a.length;n++)Co.add(a[n])}var Mo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vo={},Lo={};function pu(n){return Nt.call(Lo,n)?!0:Nt.call(Vo,n)?!1:Mo.test(n)?Lo[n]=!0:(Vo[n]=!0,!1)}function hs(n,a,s){if(pu(a))if(s===null)n.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var l=a.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+s)}}function Pn(n,a,s){if(s===null)n.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+s)}}function Ht(n,a,s,l){if(l===null)n.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttributeNS(a,s,""+l)}}function $t(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ia(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ho(n,a,s){var l=Object.getOwnPropertyDescriptor(n.constructor.prototype,a);if(!n.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,d=l.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return f.call(this)},set:function(T){s=""+T,d.call(this,T)}}),Object.defineProperty(n,a,{enumerable:l.enumerable}),{getValue:function(){return s},setValue:function(T){s=""+T},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function it(n){if(!n._valueTracker){var a=Ia(n)?"checked":"value";n._valueTracker=Ho(n,a,""+n[a])}}function Rr(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var s=a.getValue(),l="";return n&&(l=Ia(n)?n.checked?"true":"false":n.value),n=l,n!==s?(a.setValue(n),!0):!1}function xi(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ir=/[\n"\\]/g;function bn(n){return n.replace(Ir,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function fs(n,a,s,l,f,d,T,b){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),a!=null?T==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+$t(a)):n.value!==""+$t(a)&&(n.value=""+$t(a)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),a!=null?Po(n,T,$t(a)):s!=null?Po(n,T,$t(s)):l!=null&&n.removeAttribute("value"),f==null&&d!=null&&(n.defaultChecked=!!d),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?n.name=""+$t(b):n.removeAttribute("name")}function gu(n,a,s,l,f,d,T,b){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(n.type=d),a!=null||s!=null){if(!(d!=="submit"&&d!=="reset"||a!=null)){it(n);return}s=s!=null?""+$t(s):"",a=a!=null?""+$t(a):s,b||a===n.value||(n.value=a),n.defaultValue=a}l=l??f,l=typeof l!="function"&&typeof l!="symbol"&&!!l,n.checked=b?n.checked:!!l,n.defaultChecked=!!l,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),it(n)}function Po(n,a,s){a==="number"&&xi(n.ownerDocument)===n||n.defaultValue===""+s||(n.defaultValue=""+s)}function ka(n,a,s,l){if(n=n.options,a){a={};for(var f=0;f<s.length;f++)a["$"+s[f]]=!0;for(s=0;s<n.length;s++)f=a.hasOwnProperty("$"+n[s].value),n[s].selected!==f&&(n[s].selected=f),f&&l&&(n[s].defaultSelected=!0)}else{for(s=""+$t(s),a=null,f=0;f<n.length;f++){if(n[f].value===s){n[f].selected=!0,l&&(n[f].defaultSelected=!0);return}a!==null||n[f].disabled||(a=n[f])}a!==null&&(a.selected=!0)}}function yu(n,a,s){if(a!=null&&(a=""+$t(a),a!==n.value&&(n.value=a),s==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=s!=null?""+$t(s):""}function Da(n,a,s,l){if(a==null){if(l!=null){if(s!=null)throw Error(r(92));if(qt(l)){if(1<l.length)throw Error(r(93));l=l[0]}s=l}s==null&&(s=""),a=s}s=$t(a),n.defaultValue=s,l=n.textContent,l===s&&l!==""&&l!==null&&(n.value=l),it(n)}function An(n,a){if(a){var s=n.firstChild;if(s&&s===n.lastChild&&s.nodeType===3){s.nodeValue=a;return}}n.textContent=a}var Tu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xo(n,a,s){var l=a.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?l?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":l?n.setProperty(a,s):typeof s!="number"||s===0||Tu.has(a)?a==="float"?n.cssFloat=s:n[a]=(""+s).trim():n[a]=s+"px"}function zo(n,a,s){if(a!=null&&typeof a!="object")throw Error(r(62));if(n=n.style,s!=null){for(var l in s)!s.hasOwnProperty(l)||a!=null&&a.hasOwnProperty(l)||(l.indexOf("--")===0?n.setProperty(l,""):l==="float"?n.cssFloat="":n[l]="");for(var f in a)l=a[f],a.hasOwnProperty(f)&&s[f]!==l&&xo(n,f,l)}else for(var d in a)a.hasOwnProperty(d)&&xo(n,d,a[d])}function ds(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Oa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(n){return Oa.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function di(){}var Uo=null;function Wn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ca=null,zi=null;function kr(n){var a=Fn(n);if(a&&(n=a.stateNode)){var s=n[Qt]||null;e:switch(n=a.stateNode,a.type){case"input":if(fs(n,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),a=s.name,s.type==="radio"&&a!=null){for(s=n;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+bn(""+a)+'"][type="radio"]'),a=0;a<s.length;a++){var l=s[a];if(l!==n&&l.form===n.form){var f=l[Qt]||null;if(!f)throw Error(r(90));fs(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(a=0;a<s.length;a++)l=s[a],l.form===n.form&&Rr(l)}break e;case"textarea":yu(n,s.value,s.defaultValue);break e;case"select":a=s.value,a!=null&&ka(n,!!s.multiple,a,!1)}}}var _s=!1;function Na(n,a,s){if(_s)return n(a,s);_s=!0;try{var l=n(a);return l}finally{if(_s=!1,(Ca!==null||zi!==null)&&(dc(),Ca&&(a=Ca,n=zi,zi=Ca=null,kr(a),n)))for(a=0;a<n.length;a++)kr(n[a])}}function mi(n,a){var s=n.stateNode;if(s===null)return null;var l=s[Qt]||null;if(l===null)return null;s=l[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(n=n.type,l=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!l;break e;default:n=!1}if(n)return null;if(s&&typeof s!="function")throw Error(r(231,a,typeof s));return s}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dr=!1;if(Xn)try{var st={};Object.defineProperty(st,"passive",{get:function(){Dr=!0}}),window.addEventListener("test",st,st),window.removeEventListener("test",st,st)}catch{Dr=!1}var Ui=null,Bo=null,Or=null;function Go(){if(Or)return Or;var n,a=Bo,s=a.length,l,f="value"in Ui?Ui.value:Ui.textContent,d=f.length;for(n=0;n<s&&a[n]===f[n];n++);var T=s-n;for(l=1;l<=T&&a[s-l]===f[d-l];l++);return Or=f.slice(n,1<l?1-l:void 0)}function Cr(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function ia(){return!0}function _i(){return!1}function rn(n){function a(s,l,f,d,T){this._reactName=s,this._targetInst=f,this.type=l,this.nativeEvent=d,this.target=T,this.currentTarget=null;for(var b in n)n.hasOwnProperty(b)&&(s=n[b],this[b]=s?s(d):d[b]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?ia:_i,this.isPropagationStopped=_i,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=ia)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=ia)},persist:function(){},isPersistent:ia}),a}var aa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bi=rn(aa),Ma=v({},aa,{view:0,detail:0}),jo=rn(Ma),Va,ps,Gi,gs=v({},Ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:La,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Gi&&(Gi&&n.type==="mousemove"?(Va=n.screenX-Gi.screenX,ps=n.screenY-Gi.screenY):ps=Va=0,Gi=n),Va)},movementY:function(n){return"movementY"in n?n.movementY:ps}}),qo=rn(gs),Nr=v({},gs,{dataTransfer:0}),vu=rn(Nr),wu=v({},Ma,{relatedTarget:0}),Mr=rn(wu),Yo=v({},aa,{animationName:0,elapsedTime:0,pseudoElement:0}),bu=rn(Yo),ys=v({},aa,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Au=rn(ys),Su=v({},aa,{data:0}),ji=rn(Su),Ru={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Iu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ku={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Du(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=ku[n])?!!a[n]:!1}function La(){return Du}var vn=v({},Ma,{key:function(n){if(n.key){var a=Ru[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Cr(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Iu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:La,charCode:function(n){return n.type==="keypress"?Cr(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Cr(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ou=rn(vn),Cu=v({},gs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ra=rn(Cu),h=v({},Ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:La}),g=rn(h),E=v({},aa,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=rn(E),j=v({},gs,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),W=rn(j),le=v({},aa,{newState:0,oldState:0}),Ne=rn(le),kt=[9,13,27,32],Je=Xn&&"CompositionEvent"in window,Et=null;Xn&&"documentMode"in document&&(Et=document.documentMode);var Kn=Xn&&"TextEvent"in window&&!Et,qi=Xn&&(!Je||Et&&8<Et&&11>=Et),pi=" ",gi=!1;function Vr(n,a){switch(n){case"keyup":return kt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ts(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Es=!1;function wv(n,a){switch(n){case"compositionend":return Ts(a);case"keypress":return a.which!==32?null:(gi=!0,pi);case"textInput":return n=a.data,n===pi&&gi?null:n;default:return null}}function bv(n,a){if(Es)return n==="compositionend"||!Je&&Vr(n,a)?(n=Go(),Or=Bo=Ui=null,Es=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return qi&&a.locale!=="ko"?null:a.data;default:return null}}var Av={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function __(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!Av[n.type]:a==="textarea"}function p_(n,a,s,l){Ca?zi?zi.push(l):zi=[l]:Ca=l,a=Ec(a,"onChange"),0<a.length&&(s=new Bi("onChange","change",null,s,l),n.push({event:s,listeners:a}))}var Fo=null,Wo=null;function Sv(n){Zg(n,0)}function Nu(n){var a=Hn(n);if(Rr(a))return n}function g_(n,a){if(n==="change")return a}var y_=!1;if(Xn){var Ph;if(Xn){var xh="oninput"in document;if(!xh){var T_=document.createElement("div");T_.setAttribute("oninput","return;"),xh=typeof T_.oninput=="function"}Ph=xh}else Ph=!1;y_=Ph&&(!document.documentMode||9<document.documentMode)}function E_(){Fo&&(Fo.detachEvent("onpropertychange",v_),Wo=Fo=null)}function v_(n){if(n.propertyName==="value"&&Nu(Wo)){var a=[];p_(a,Wo,n,Wn(n)),Na(Sv,a)}}function Rv(n,a,s){n==="focusin"?(E_(),Fo=a,Wo=s,Fo.attachEvent("onpropertychange",v_)):n==="focusout"&&E_()}function Iv(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Nu(Wo)}function kv(n,a){if(n==="click")return Nu(a)}function Dv(n,a){if(n==="input"||n==="change")return Nu(a)}function Ov(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var xn=typeof Object.is=="function"?Object.is:Ov;function Xo(n,a){if(xn(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var s=Object.keys(n),l=Object.keys(a);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var f=s[l];if(!Nt.call(a,f)||!xn(n[f],a[f]))return!1}return!0}function w_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function b_(n,a){var s=w_(n);n=0;for(var l;s;){if(s.nodeType===3){if(l=n+s.textContent.length,n<=a&&l>=a)return{node:s,offset:a-n};n=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=w_(s)}}function A_(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?A_(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function S_(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=xi(n.document);a instanceof n.HTMLIFrameElement;){try{var s=typeof a.contentWindow.location.href=="string"}catch{s=!1}if(s)n=a.contentWindow;else break;a=xi(n.document)}return a}function zh(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var Cv=Xn&&"documentMode"in document&&11>=document.documentMode,vs=null,Uh=null,Ko=null,Bh=!1;function R_(n,a,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Bh||vs==null||vs!==xi(l)||(l=vs,"selectionStart"in l&&zh(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ko&&Xo(Ko,l)||(Ko=l,l=Ec(Uh,"onSelect"),0<l.length&&(a=new Bi("onSelect","select",null,a,s),n.push({event:a,listeners:l}),a.target=vs)))}function Lr(n,a){var s={};return s[n.toLowerCase()]=a.toLowerCase(),s["Webkit"+n]="webkit"+a,s["Moz"+n]="moz"+a,s}var ws={animationend:Lr("Animation","AnimationEnd"),animationiteration:Lr("Animation","AnimationIteration"),animationstart:Lr("Animation","AnimationStart"),transitionrun:Lr("Transition","TransitionRun"),transitionstart:Lr("Transition","TransitionStart"),transitioncancel:Lr("Transition","TransitionCancel"),transitionend:Lr("Transition","TransitionEnd")},Gh={},I_={};Xn&&(I_=document.createElement("div").style,"AnimationEvent"in window||(delete ws.animationend.animation,delete ws.animationiteration.animation,delete ws.animationstart.animation),"TransitionEvent"in window||delete ws.transitionend.transition);function Hr(n){if(Gh[n])return Gh[n];if(!ws[n])return n;var a=ws[n],s;for(s in a)if(a.hasOwnProperty(s)&&s in I_)return Gh[n]=a[s];return n}var k_=Hr("animationend"),D_=Hr("animationiteration"),O_=Hr("animationstart"),Nv=Hr("transitionrun"),Mv=Hr("transitionstart"),Vv=Hr("transitioncancel"),C_=Hr("transitionend"),N_=new Map,jh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jh.push("scrollEnd");function yi(n,a){N_.set(n,a),Hi(a,[n])}var Mu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Qn=[],bs=0,qh=0;function Vu(){for(var n=bs,a=qh=bs=0;a<n;){var s=Qn[a];Qn[a++]=null;var l=Qn[a];Qn[a++]=null;var f=Qn[a];Qn[a++]=null;var d=Qn[a];if(Qn[a++]=null,l!==null&&f!==null){var T=l.pending;T===null?f.next=f:(f.next=T.next,T.next=f),l.pending=f}d!==0&&M_(s,f,d)}}function Lu(n,a,s,l){Qn[bs++]=n,Qn[bs++]=a,Qn[bs++]=s,Qn[bs++]=l,qh|=l,n.lanes|=l,n=n.alternate,n!==null&&(n.lanes|=l)}function Yh(n,a,s,l){return Lu(n,a,s,l),Hu(n)}function Pr(n,a){return Lu(n,null,null,a),Hu(n)}function M_(n,a,s){n.lanes|=s;var l=n.alternate;l!==null&&(l.lanes|=s);for(var f=!1,d=n.return;d!==null;)d.childLanes|=s,l=d.alternate,l!==null&&(l.childLanes|=s),d.tag===22&&(n=d.stateNode,n===null||n._visibility&1||(f=!0)),n=d,d=d.return;return n.tag===3?(d=n.stateNode,f&&a!==null&&(f=31-It(s),n=d.hiddenUpdates,l=n[f],l===null?n[f]=[a]:l.push(a),a.lane=s|536870912),d):null}function Hu(n){if(50<gl)throw gl=0,td=null,Error(r(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var As={};function Lv(n,a,s,l){this.tag=n,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(n,a,s,l){return new Lv(n,a,s,l)}function Fh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function sa(n,a){var s=n.alternate;return s===null?(s=zn(n.tag,a,n.key,n.mode),s.elementType=n.elementType,s.type=n.type,s.stateNode=n.stateNode,s.alternate=n,n.alternate=s):(s.pendingProps=a,s.type=n.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=n.flags&65011712,s.childLanes=n.childLanes,s.lanes=n.lanes,s.child=n.child,s.memoizedProps=n.memoizedProps,s.memoizedState=n.memoizedState,s.updateQueue=n.updateQueue,a=n.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},s.sibling=n.sibling,s.index=n.index,s.ref=n.ref,s.refCleanup=n.refCleanup,s}function V_(n,a){n.flags&=65011714;var s=n.alternate;return s===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,a=s.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function Pu(n,a,s,l,f,d){var T=0;if(l=n,typeof n=="function")Fh(n)&&(T=1);else if(typeof n=="string")T=Uw(n,s,de.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case D:return n=zn(31,s,a,f),n.elementType=D,n.lanes=d,n;case V:return xr(s.children,f,d,a);case L:T=8,f|=24;break;case O:return n=zn(12,s,a,f|2),n.elementType=O,n.lanes=d,n;case Ce:return n=zn(13,s,a,f),n.elementType=Ce,n.lanes=d,n;case we:return n=zn(19,s,a,f),n.elementType=we,n.lanes=d,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case J:T=10;break e;case G:T=9;break e;case re:T=11;break e;case k:T=14;break e;case I:T=16,l=null;break e}T=29,s=Error(r(130,n===null?"null":typeof n,"")),l=null}return a=zn(T,s,a,f),a.elementType=n,a.type=l,a.lanes=d,a}function xr(n,a,s,l){return n=zn(7,n,l,a),n.lanes=s,n}function Wh(n,a,s){return n=zn(6,n,null,a),n.lanes=s,n}function L_(n){var a=zn(18,null,null,0);return a.stateNode=n,a}function Xh(n,a,s){return a=zn(4,n.children!==null?n.children:[],n.key,a),a.lanes=s,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var H_=new WeakMap;function $n(n,a){if(typeof n=="object"&&n!==null){var s=H_.get(n);return s!==void 0?s:(a={value:n,source:a,stack:Ro(a)},H_.set(n,a),a)}return{value:n,source:a,stack:Ro(a)}}var Ss=[],Rs=0,xu=null,Qo=0,Zn=[],Jn=0,Ha=null,Yi=1,Fi="";function oa(n,a){Ss[Rs++]=Qo,Ss[Rs++]=xu,xu=n,Qo=a}function P_(n,a,s){Zn[Jn++]=Yi,Zn[Jn++]=Fi,Zn[Jn++]=Ha,Ha=n;var l=Yi;n=Fi;var f=32-It(l)-1;l&=~(1<<f),s+=1;var d=32-It(a)+f;if(30<d){var T=f-f%5;d=(l&(1<<T)-1).toString(32),l>>=T,f-=T,Yi=1<<32-It(a)+f|s<<f|l,Fi=d+n}else Yi=1<<d|s<<f|l,Fi=n}function Kh(n){n.return!==null&&(oa(n,1),P_(n,1,0))}function Qh(n){for(;n===xu;)xu=Ss[--Rs],Ss[Rs]=null,Qo=Ss[--Rs],Ss[Rs]=null;for(;n===Ha;)Ha=Zn[--Jn],Zn[Jn]=null,Fi=Zn[--Jn],Zn[Jn]=null,Yi=Zn[--Jn],Zn[Jn]=null}function x_(n,a){Zn[Jn++]=Yi,Zn[Jn++]=Fi,Zn[Jn++]=Ha,Yi=a.id,Fi=a.overflow,Ha=n}var sn=null,mt=null,je=!1,Pa=null,ei=!1,$h=Error(r(519));function xa(n){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw $o($n(a,n)),$h}function z_(n){var a=n.stateNode,s=n.type,l=n.memoizedProps;switch(a[Vt]=n,a[Qt]=l,s){case"dialog":xe("cancel",a),xe("close",a);break;case"iframe":case"object":case"embed":xe("load",a);break;case"video":case"audio":for(s=0;s<Tl.length;s++)xe(Tl[s],a);break;case"source":xe("error",a);break;case"img":case"image":case"link":xe("error",a),xe("load",a);break;case"details":xe("toggle",a);break;case"input":xe("invalid",a),gu(a,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":xe("invalid",a);break;case"textarea":xe("invalid",a),Da(a,l.value,l.defaultValue,l.children)}s=l.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||a.textContent===""+s||l.suppressHydrationWarning===!0||ny(a.textContent,s)?(l.popover!=null&&(xe("beforetoggle",a),xe("toggle",a)),l.onScroll!=null&&xe("scroll",a),l.onScrollEnd!=null&&xe("scrollend",a),l.onClick!=null&&(a.onclick=di),a=!0):a=!1,a||xa(n,!0)}function U_(n){for(sn=n.return;sn;)switch(sn.tag){case 5:case 31:case 13:ei=!1;return;case 27:case 3:ei=!0;return;default:sn=sn.return}}function Is(n){if(n!==sn)return!1;if(!je)return U_(n),je=!0,!1;var a=n.tag,s;if((s=a!==3&&a!==27)&&((s=a===5)&&(s=n.type,s=!(s!=="form"&&s!=="button")||pd(n.type,n.memoizedProps)),s=!s),s&&mt&&xa(n),U_(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));mt=hy(n)}else if(a===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));mt=hy(n)}else a===27?(a=mt,Za(n.type)?(n=vd,vd=null,mt=n):mt=a):mt=sn?ni(n.stateNode.nextSibling):null;return!0}function zr(){mt=sn=null,je=!1}function Zh(){var n=Pa;return n!==null&&(kn===null?kn=n:kn.push.apply(kn,n),Pa=null),n}function $o(n){Pa===null?Pa=[n]:Pa.push(n)}var Jh=x(null),Ur=null,la=null;function za(n,a,s){ce(Jh,a._currentValue),a._currentValue=s}function ua(n){n._currentValue=Jh.current,ne(Jh)}function ef(n,a,s){for(;n!==null;){var l=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,l!==null&&(l.childLanes|=a)):l!==null&&(l.childLanes&a)!==a&&(l.childLanes|=a),n===s)break;n=n.return}}function tf(n,a,s,l){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var d=f.dependencies;if(d!==null){var T=f.child;d=d.firstContext;e:for(;d!==null;){var b=d;d=f;for(var N=0;N<a.length;N++)if(b.context===a[N]){d.lanes|=s,b=d.alternate,b!==null&&(b.lanes|=s),ef(d.return,s,n),l||(T=null);break e}d=b.next}}else if(f.tag===18){if(T=f.return,T===null)throw Error(r(341));T.lanes|=s,d=T.alternate,d!==null&&(d.lanes|=s),ef(T,s,n),T=null}else T=f.child;if(T!==null)T.return=f;else for(T=f;T!==null;){if(T===n){T=null;break}if(f=T.sibling,f!==null){f.return=T.return,T=f;break}T=T.return}f=T}}function ks(n,a,s,l){n=null;for(var f=a,d=!1;f!==null;){if(!d){if((f.flags&524288)!==0)d=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var T=f.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var b=f.type;xn(f.pendingProps.value,T.value)||(n!==null?n.push(b):n=[b])}}else if(f===qe.current){if(T=f.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Al):n=[Al])}f=f.return}n!==null&&tf(a,n,s,l),a.flags|=262144}function zu(n){for(n=n.firstContext;n!==null;){if(!xn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Br(n){Ur=n,la=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function on(n){return B_(Ur,n)}function Uu(n,a){return Ur===null&&Br(n),B_(n,a)}function B_(n,a){var s=a._currentValue;if(a={context:a,memoizedValue:s,next:null},la===null){if(n===null)throw Error(r(308));la=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else la=la.next=a;return s}var Hv=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(s,l){n.push(l)}};this.abort=function(){a.aborted=!0,n.forEach(function(s){return s()})}},Pv=e.unstable_scheduleCallback,xv=e.unstable_NormalPriority,Pt={$$typeof:J,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nf(){return{controller:new Hv,data:new Map,refCount:0}}function Zo(n){n.refCount--,n.refCount===0&&Pv(xv,function(){n.controller.abort()})}var Jo=null,af=0,Ds=0,Os=null;function zv(n,a){if(Jo===null){var s=Jo=[];af=0,Ds=od(),Os={status:"pending",value:void 0,then:function(l){s.push(l)}}}return af++,a.then(G_,G_),a}function G_(){if(--af===0&&Jo!==null){Os!==null&&(Os.status="fulfilled");var n=Jo;Jo=null,Ds=0,Os=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function Uv(n,a){var s=[],l={status:"pending",value:null,reason:null,then:function(f){s.push(f)}};return n.then(function(){l.status="fulfilled",l.value=a;for(var f=0;f<s.length;f++)(0,s[f])(a)},function(f){for(l.status="rejected",l.reason=f,f=0;f<s.length;f++)(0,s[f])(void 0)}),l}var j_=$.S;$.S=function(n,a){Rg=En(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&zv(n,a),j_!==null&&j_(n,a)};var Gr=x(null);function rf(){var n=Gr.current;return n!==null?n:ht.pooledCache}function Bu(n,a){a===null?ce(Gr,Gr.current):ce(Gr,a.pool)}function q_(){var n=rf();return n===null?null:{parent:Pt._currentValue,pool:n}}var Cs=Error(r(460)),sf=Error(r(474)),Gu=Error(r(542)),ju={then:function(){}};function Y_(n){return n=n.status,n==="fulfilled"||n==="rejected"}function F_(n,a,s){switch(s=n[s],s===void 0?n.push(a):s!==a&&(a.then(di,di),a=s),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,X_(n),n;default:if(typeof a.status=="string")a.then(di,di);else{if(n=ht,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=a,n.status="pending",n.then(function(l){if(a.status==="pending"){var f=a;f.status="fulfilled",f.value=l}},function(l){if(a.status==="pending"){var f=a;f.status="rejected",f.reason=l}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,X_(n),n}throw qr=a,Cs}}function jr(n){try{var a=n._init;return a(n._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(qr=s,Cs):s}}var qr=null;function W_(){if(qr===null)throw Error(r(459));var n=qr;return qr=null,n}function X_(n){if(n===Cs||n===Gu)throw Error(r(483))}var Ns=null,el=0;function qu(n){var a=el;return el+=1,Ns===null&&(Ns=[]),F_(Ns,n,a)}function tl(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function Yu(n,a){throw a.$$typeof===w?Error(r(525)):(n=Object.prototype.toString.call(a),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function K_(n){function a(U,P){if(n){var q=U.deletions;q===null?(U.deletions=[P],U.flags|=16):q.push(P)}}function s(U,P){if(!n)return null;for(;P!==null;)a(U,P),P=P.sibling;return null}function l(U){for(var P=new Map;U!==null;)U.key!==null?P.set(U.key,U):P.set(U.index,U),U=U.sibling;return P}function f(U,P){return U=sa(U,P),U.index=0,U.sibling=null,U}function d(U,P,q){return U.index=q,n?(q=U.alternate,q!==null?(q=q.index,q<P?(U.flags|=67108866,P):q):(U.flags|=67108866,P)):(U.flags|=1048576,P)}function T(U){return n&&U.alternate===null&&(U.flags|=67108866),U}function b(U,P,q,Z){return P===null||P.tag!==6?(P=Wh(q,U.mode,Z),P.return=U,P):(P=f(P,q),P.return=U,P)}function N(U,P,q,Z){var ge=q.type;return ge===V?Q(U,P,q.props.children,Z,q.key):P!==null&&(P.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===I&&jr(ge)===P.type)?(P=f(P,q.props),tl(P,q),P.return=U,P):(P=Pu(q.type,q.key,q.props,null,U.mode,Z),tl(P,q),P.return=U,P)}function Y(U,P,q,Z){return P===null||P.tag!==4||P.stateNode.containerInfo!==q.containerInfo||P.stateNode.implementation!==q.implementation?(P=Xh(q,U.mode,Z),P.return=U,P):(P=f(P,q.children||[]),P.return=U,P)}function Q(U,P,q,Z,ge){return P===null||P.tag!==7?(P=xr(q,U.mode,Z,ge),P.return=U,P):(P=f(P,q),P.return=U,P)}function ee(U,P,q){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return P=Wh(""+P,U.mode,q),P.return=U,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case R:return q=Pu(P.type,P.key,P.props,null,U.mode,q),tl(q,P),q.return=U,q;case M:return P=Xh(P,U.mode,q),P.return=U,P;case I:return P=jr(P),ee(U,P,q)}if(qt(P)||B(P))return P=xr(P,U.mode,q,null),P.return=U,P;if(typeof P.then=="function")return ee(U,qu(P),q);if(P.$$typeof===J)return ee(U,Uu(U,P),q);Yu(U,P)}return null}function F(U,P,q,Z){var ge=P!==null?P.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return ge!==null?null:b(U,P,""+q,Z);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case R:return q.key===ge?N(U,P,q,Z):null;case M:return q.key===ge?Y(U,P,q,Z):null;case I:return q=jr(q),F(U,P,q,Z)}if(qt(q)||B(q))return ge!==null?null:Q(U,P,q,Z,null);if(typeof q.then=="function")return F(U,P,qu(q),Z);if(q.$$typeof===J)return F(U,P,Uu(U,q),Z);Yu(U,q)}return null}function X(U,P,q,Z,ge){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return U=U.get(q)||null,b(P,U,""+Z,ge);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:return U=U.get(Z.key===null?q:Z.key)||null,N(P,U,Z,ge);case M:return U=U.get(Z.key===null?q:Z.key)||null,Y(P,U,Z,ge);case I:return Z=jr(Z),X(U,P,q,Z,ge)}if(qt(Z)||B(Z))return U=U.get(q)||null,Q(P,U,Z,ge,null);if(typeof Z.then=="function")return X(U,P,q,qu(Z),ge);if(Z.$$typeof===J)return X(U,P,q,Uu(P,Z),ge);Yu(P,Z)}return null}function me(U,P,q,Z){for(var ge=null,Qe=null,pe=P,He=P=0,Ue=null;pe!==null&&He<q.length;He++){pe.index>He?(Ue=pe,pe=null):Ue=pe.sibling;var $e=F(U,pe,q[He],Z);if($e===null){pe===null&&(pe=Ue);break}n&&pe&&$e.alternate===null&&a(U,pe),P=d($e,P,He),Qe===null?ge=$e:Qe.sibling=$e,Qe=$e,pe=Ue}if(He===q.length)return s(U,pe),je&&oa(U,He),ge;if(pe===null){for(;He<q.length;He++)pe=ee(U,q[He],Z),pe!==null&&(P=d(pe,P,He),Qe===null?ge=pe:Qe.sibling=pe,Qe=pe);return je&&oa(U,He),ge}for(pe=l(pe);He<q.length;He++)Ue=X(pe,U,He,q[He],Z),Ue!==null&&(n&&Ue.alternate!==null&&pe.delete(Ue.key===null?He:Ue.key),P=d(Ue,P,He),Qe===null?ge=Ue:Qe.sibling=Ue,Qe=Ue);return n&&pe.forEach(function(ir){return a(U,ir)}),je&&oa(U,He),ge}function be(U,P,q,Z){if(q==null)throw Error(r(151));for(var ge=null,Qe=null,pe=P,He=P=0,Ue=null,$e=q.next();pe!==null&&!$e.done;He++,$e=q.next()){pe.index>He?(Ue=pe,pe=null):Ue=pe.sibling;var ir=F(U,pe,$e.value,Z);if(ir===null){pe===null&&(pe=Ue);break}n&&pe&&ir.alternate===null&&a(U,pe),P=d(ir,P,He),Qe===null?ge=ir:Qe.sibling=ir,Qe=ir,pe=Ue}if($e.done)return s(U,pe),je&&oa(U,He),ge;if(pe===null){for(;!$e.done;He++,$e=q.next())$e=ee(U,$e.value,Z),$e!==null&&(P=d($e,P,He),Qe===null?ge=$e:Qe.sibling=$e,Qe=$e);return je&&oa(U,He),ge}for(pe=l(pe);!$e.done;He++,$e=q.next())$e=X(pe,U,He,$e.value,Z),$e!==null&&(n&&$e.alternate!==null&&pe.delete($e.key===null?He:$e.key),P=d($e,P,He),Qe===null?ge=$e:Qe.sibling=$e,Qe=$e);return n&&pe.forEach(function($w){return a(U,$w)}),je&&oa(U,He),ge}function ut(U,P,q,Z){if(typeof q=="object"&&q!==null&&q.type===V&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case R:e:{for(var ge=q.key;P!==null;){if(P.key===ge){if(ge=q.type,ge===V){if(P.tag===7){s(U,P.sibling),Z=f(P,q.props.children),Z.return=U,U=Z;break e}}else if(P.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===I&&jr(ge)===P.type){s(U,P.sibling),Z=f(P,q.props),tl(Z,q),Z.return=U,U=Z;break e}s(U,P);break}else a(U,P);P=P.sibling}q.type===V?(Z=xr(q.props.children,U.mode,Z,q.key),Z.return=U,U=Z):(Z=Pu(q.type,q.key,q.props,null,U.mode,Z),tl(Z,q),Z.return=U,U=Z)}return T(U);case M:e:{for(ge=q.key;P!==null;){if(P.key===ge)if(P.tag===4&&P.stateNode.containerInfo===q.containerInfo&&P.stateNode.implementation===q.implementation){s(U,P.sibling),Z=f(P,q.children||[]),Z.return=U,U=Z;break e}else{s(U,P);break}else a(U,P);P=P.sibling}Z=Xh(q,U.mode,Z),Z.return=U,U=Z}return T(U);case I:return q=jr(q),ut(U,P,q,Z)}if(qt(q))return me(U,P,q,Z);if(B(q)){if(ge=B(q),typeof ge!="function")throw Error(r(150));return q=ge.call(q),be(U,P,q,Z)}if(typeof q.then=="function")return ut(U,P,qu(q),Z);if(q.$$typeof===J)return ut(U,P,Uu(U,q),Z);Yu(U,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,P!==null&&P.tag===6?(s(U,P.sibling),Z=f(P,q),Z.return=U,U=Z):(s(U,P),Z=Wh(q,U.mode,Z),Z.return=U,U=Z),T(U)):s(U,P)}return function(U,P,q,Z){try{el=0;var ge=ut(U,P,q,Z);return Ns=null,ge}catch(pe){if(pe===Cs||pe===Gu)throw pe;var Qe=zn(29,pe,null,U.mode);return Qe.lanes=Z,Qe.return=U,Qe}}}var Yr=K_(!0),Q_=K_(!1),Ua=!1;function of(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lf(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ba(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ga(n,a,s){var l=n.updateQueue;if(l===null)return null;if(l=l.shared,(et&2)!==0){var f=l.pending;return f===null?a.next=a:(a.next=f.next,f.next=a),l.pending=a,a=Hu(n),M_(n,null,s),a}return Lu(n,l,a,s),Hu(n)}function nl(n,a,s){if(a=a.updateQueue,a!==null&&(a=a.shared,(s&4194048)!==0)){var l=a.lanes;l&=n.pendingLanes,s|=l,a.lanes=s,Do(n,s)}}function uf(n,a){var s=n.updateQueue,l=n.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var f=null,d=null;if(s=s.firstBaseUpdate,s!==null){do{var T={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};d===null?f=d=T:d=d.next=T,s=s.next}while(s!==null);d===null?f=d=a:d=d.next=a}else f=d=a;s={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:d,shared:l.shared,callbacks:l.callbacks},n.updateQueue=s;return}n=s.lastBaseUpdate,n===null?s.firstBaseUpdate=a:n.next=a,s.lastBaseUpdate=a}var cf=!1;function il(){if(cf){var n=Os;if(n!==null)throw n}}function al(n,a,s,l){cf=!1;var f=n.updateQueue;Ua=!1;var d=f.firstBaseUpdate,T=f.lastBaseUpdate,b=f.shared.pending;if(b!==null){f.shared.pending=null;var N=b,Y=N.next;N.next=null,T===null?d=Y:T.next=Y,T=N;var Q=n.alternate;Q!==null&&(Q=Q.updateQueue,b=Q.lastBaseUpdate,b!==T&&(b===null?Q.firstBaseUpdate=Y:b.next=Y,Q.lastBaseUpdate=N))}if(d!==null){var ee=f.baseState;T=0,Q=Y=N=null,b=d;do{var F=b.lane&-536870913,X=F!==b.lane;if(X?(ze&F)===F:(l&F)===F){F!==0&&F===Ds&&(cf=!0),Q!==null&&(Q=Q.next={lane:0,tag:b.tag,payload:b.payload,callback:null,next:null});e:{var me=n,be=b;F=a;var ut=s;switch(be.tag){case 1:if(me=be.payload,typeof me=="function"){ee=me.call(ut,ee,F);break e}ee=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=be.payload,F=typeof me=="function"?me.call(ut,ee,F):me,F==null)break e;ee=v({},ee,F);break e;case 2:Ua=!0}}F=b.callback,F!==null&&(n.flags|=64,X&&(n.flags|=8192),X=f.callbacks,X===null?f.callbacks=[F]:X.push(F))}else X={lane:F,tag:b.tag,payload:b.payload,callback:b.callback,next:null},Q===null?(Y=Q=X,N=ee):Q=Q.next=X,T|=F;if(b=b.next,b===null){if(b=f.shared.pending,b===null)break;X=b,b=X.next,X.next=null,f.lastBaseUpdate=X,f.shared.pending=null}}while(!0);Q===null&&(N=ee),f.baseState=N,f.firstBaseUpdate=Y,f.lastBaseUpdate=Q,d===null&&(f.shared.lanes=0),Wa|=T,n.lanes=T,n.memoizedState=ee}}function $_(n,a){if(typeof n!="function")throw Error(r(191,n));n.call(a)}function Z_(n,a){var s=n.callbacks;if(s!==null)for(n.callbacks=null,n=0;n<s.length;n++)$_(s[n],a)}var Ms=x(null),Fu=x(0);function J_(n,a){n=ya,ce(Fu,n),ce(Ms,a),ya=n|a.baseLanes}function hf(){ce(Fu,ya),ce(Ms,Ms.current)}function ff(){ya=Fu.current,ne(Ms),ne(Fu)}var Un=x(null),ti=null;function ja(n){var a=n.alternate;ce(Dt,Dt.current&1),ce(Un,n),ti===null&&(a===null||Ms.current!==null||a.memoizedState!==null)&&(ti=n)}function df(n){ce(Dt,Dt.current),ce(Un,n),ti===null&&(ti=n)}function ep(n){n.tag===22?(ce(Dt,Dt.current),ce(Un,n),ti===null&&(ti=n)):qa()}function qa(){ce(Dt,Dt.current),ce(Un,Un.current)}function Bn(n){ne(Un),ti===n&&(ti=null),ne(Dt)}var Dt=x(0);function Wu(n){for(var a=n;a!==null;){if(a.tag===13){var s=a.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||Td(s)||Ed(s)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ca=0,Me=null,ot=null,xt=null,Xu=!1,Vs=!1,Fr=!1,Ku=0,rl=0,Ls=null,Bv=0;function At(){throw Error(r(321))}function mf(n,a){if(a===null)return!1;for(var s=0;s<a.length&&s<n.length;s++)if(!xn(n[s],a[s]))return!1;return!0}function _f(n,a,s,l,f,d){return ca=d,Me=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,$.H=n===null||n.memoizedState===null?Pp:Of,Fr=!1,d=s(l,f),Fr=!1,Vs&&(d=np(a,s,l,f)),tp(n),d}function tp(n){$.H=ll;var a=ot!==null&&ot.next!==null;if(ca=0,xt=ot=Me=null,Xu=!1,rl=0,Ls=null,a)throw Error(r(300));n===null||zt||(n=n.dependencies,n!==null&&zu(n)&&(zt=!0))}function np(n,a,s,l){Me=n;var f=0;do{if(Vs&&(Ls=null),rl=0,Vs=!1,25<=f)throw Error(r(301));if(f+=1,xt=ot=null,n.updateQueue!=null){var d=n.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}$.H=xp,d=a(s,l)}while(Vs);return d}function Gv(){var n=$.H,a=n.useState()[0];return a=typeof a.then=="function"?sl(a):a,n=n.useState()[0],(ot!==null?ot.memoizedState:null)!==n&&(Me.flags|=1024),a}function pf(){var n=Ku!==0;return Ku=0,n}function gf(n,a,s){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~s}function yf(n){if(Xu){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Xu=!1}ca=0,xt=ot=Me=null,Vs=!1,rl=Ku=0,Ls=null}function wn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?Me.memoizedState=xt=n:xt=xt.next=n,xt}function Ot(){if(ot===null){var n=Me.alternate;n=n!==null?n.memoizedState:null}else n=ot.next;var a=xt===null?Me.memoizedState:xt.next;if(a!==null)xt=a,ot=n;else{if(n===null)throw Me.alternate===null?Error(r(467)):Error(r(310));ot=n,n={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},xt===null?Me.memoizedState=xt=n:xt=xt.next=n}return xt}function Qu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sl(n){var a=rl;return rl+=1,Ls===null&&(Ls=[]),n=F_(Ls,n,a),a=Me,(xt===null?a.memoizedState:xt.next)===null&&(a=a.alternate,$.H=a===null||a.memoizedState===null?Pp:Of),n}function $u(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return sl(n);if(n.$$typeof===J)return on(n)}throw Error(r(438,String(n)))}function Tf(n){var a=null,s=Me.updateQueue;if(s!==null&&(a=s.memoCache),a==null){var l=Me.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(a={data:l.data.map(function(f){return f.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),s===null&&(s=Qu(),Me.updateQueue=s),s.memoCache=a,s=a.data[a.index],s===void 0)for(s=a.data[a.index]=Array(n),l=0;l<n;l++)s[l]=z;return a.index++,s}function ha(n,a){return typeof a=="function"?a(n):a}function Zu(n){var a=Ot();return Ef(a,ot,n)}function Ef(n,a,s){var l=n.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=s;var f=n.baseQueue,d=l.pending;if(d!==null){if(f!==null){var T=f.next;f.next=d.next,d.next=T}a.baseQueue=f=d,l.pending=null}if(d=n.baseState,f===null)n.memoizedState=d;else{a=f.next;var b=T=null,N=null,Y=a,Q=!1;do{var ee=Y.lane&-536870913;if(ee!==Y.lane?(ze&ee)===ee:(ca&ee)===ee){var F=Y.revertLane;if(F===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),ee===Ds&&(Q=!0);else if((ca&F)===F){Y=Y.next,F===Ds&&(Q=!0);continue}else ee={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},N===null?(b=N=ee,T=d):N=N.next=ee,Me.lanes|=F,Wa|=F;ee=Y.action,Fr&&s(d,ee),d=Y.hasEagerState?Y.eagerState:s(d,ee)}else F={lane:ee,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},N===null?(b=N=F,T=d):N=N.next=F,Me.lanes|=ee,Wa|=ee;Y=Y.next}while(Y!==null&&Y!==a);if(N===null?T=d:N.next=b,!xn(d,n.memoizedState)&&(zt=!0,Q&&(s=Os,s!==null)))throw s;n.memoizedState=d,n.baseState=T,n.baseQueue=N,l.lastRenderedState=d}return f===null&&(l.lanes=0),[n.memoizedState,l.dispatch]}function vf(n){var a=Ot(),s=a.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=n;var l=s.dispatch,f=s.pending,d=a.memoizedState;if(f!==null){s.pending=null;var T=f=f.next;do d=n(d,T.action),T=T.next;while(T!==f);xn(d,a.memoizedState)||(zt=!0),a.memoizedState=d,a.baseQueue===null&&(a.baseState=d),s.lastRenderedState=d}return[d,l]}function ip(n,a,s){var l=Me,f=Ot(),d=je;if(d){if(s===void 0)throw Error(r(407));s=s()}else s=a();var T=!xn((ot||f).memoizedState,s);if(T&&(f.memoizedState=s,zt=!0),f=f.queue,Af(sp.bind(null,l,f,n),[n]),f.getSnapshot!==a||T||xt!==null&&xt.memoizedState.tag&1){if(l.flags|=2048,Hs(9,{destroy:void 0},rp.bind(null,l,f,s,a),null),ht===null)throw Error(r(349));d||(ca&127)!==0||ap(l,a,s)}return s}function ap(n,a,s){n.flags|=16384,n={getSnapshot:a,value:s},a=Me.updateQueue,a===null?(a=Qu(),Me.updateQueue=a,a.stores=[n]):(s=a.stores,s===null?a.stores=[n]:s.push(n))}function rp(n,a,s,l){a.value=s,a.getSnapshot=l,op(a)&&lp(n)}function sp(n,a,s){return s(function(){op(a)&&lp(n)})}function op(n){var a=n.getSnapshot;n=n.value;try{var s=a();return!xn(n,s)}catch{return!0}}function lp(n){var a=Pr(n,2);a!==null&&Dn(a,n,2)}function wf(n){var a=wn();if(typeof n=="function"){var s=n;if(n=s(),Fr){Yn(!0);try{s()}finally{Yn(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:n},a}function up(n,a,s,l){return n.baseState=s,Ef(n,ot,typeof l=="function"?l:ha)}function jv(n,a,s,l,f){if(tc(n))throw Error(r(485));if(n=a.action,n!==null){var d={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){d.listeners.push(T)}};$.T!==null?s(!0):d.isTransition=!1,l(d),s=a.pending,s===null?(d.next=a.pending=d,cp(a,d)):(d.next=s.next,a.pending=s.next=d)}}function cp(n,a){var s=a.action,l=a.payload,f=n.state;if(a.isTransition){var d=$.T,T={};$.T=T;try{var b=s(f,l),N=$.S;N!==null&&N(T,b),hp(n,a,b)}catch(Y){bf(n,a,Y)}finally{d!==null&&T.types!==null&&(d.types=T.types),$.T=d}}else try{d=s(f,l),hp(n,a,d)}catch(Y){bf(n,a,Y)}}function hp(n,a,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(l){fp(n,a,l)},function(l){return bf(n,a,l)}):fp(n,a,s)}function fp(n,a,s){a.status="fulfilled",a.value=s,dp(a),n.state=s,a=n.pending,a!==null&&(s=a.next,s===a?n.pending=null:(s=s.next,a.next=s,cp(n,s)))}function bf(n,a,s){var l=n.pending;if(n.pending=null,l!==null){l=l.next;do a.status="rejected",a.reason=s,dp(a),a=a.next;while(a!==l)}n.action=null}function dp(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function mp(n,a){return a}function _p(n,a){if(je){var s=ht.formState;if(s!==null){e:{var l=Me;if(je){if(mt){t:{for(var f=mt,d=ei;f.nodeType!==8;){if(!d){f=null;break t}if(f=ni(f.nextSibling),f===null){f=null;break t}}d=f.data,f=d==="F!"||d==="F"?f:null}if(f){mt=ni(f.nextSibling),l=f.data==="F!";break e}}xa(l)}l=!1}l&&(a=s[0])}}return s=wn(),s.memoizedState=s.baseState=a,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mp,lastRenderedState:a},s.queue=l,s=Vp.bind(null,Me,l),l.dispatch=s,l=wf(!1),d=Df.bind(null,Me,!1,l.queue),l=wn(),f={state:a,dispatch:null,action:n,pending:null},l.queue=f,s=jv.bind(null,Me,f,d,s),f.dispatch=s,l.memoizedState=n,[a,s,!1]}function pp(n){var a=Ot();return gp(a,ot,n)}function gp(n,a,s){if(a=Ef(n,a,mp)[0],n=Zu(ha)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var l=sl(a)}catch(T){throw T===Cs?Gu:T}else l=a;a=Ot();var f=a.queue,d=f.dispatch;return s!==a.memoizedState&&(Me.flags|=2048,Hs(9,{destroy:void 0},qv.bind(null,f,s),null)),[l,d,n]}function qv(n,a){n.action=a}function yp(n){var a=Ot(),s=ot;if(s!==null)return gp(a,s,n);Ot(),a=a.memoizedState,s=Ot();var l=s.queue.dispatch;return s.memoizedState=n,[a,l,!1]}function Hs(n,a,s,l){return n={tag:n,create:s,deps:l,inst:a,next:null},a=Me.updateQueue,a===null&&(a=Qu(),Me.updateQueue=a),s=a.lastEffect,s===null?a.lastEffect=n.next=n:(l=s.next,s.next=n,n.next=l,a.lastEffect=n),n}function Tp(){return Ot().memoizedState}function Ju(n,a,s,l){var f=wn();Me.flags|=n,f.memoizedState=Hs(1|a,{destroy:void 0},s,l===void 0?null:l)}function ec(n,a,s,l){var f=Ot();l=l===void 0?null:l;var d=f.memoizedState.inst;ot!==null&&l!==null&&mf(l,ot.memoizedState.deps)?f.memoizedState=Hs(a,d,s,l):(Me.flags|=n,f.memoizedState=Hs(1|a,d,s,l))}function Ep(n,a){Ju(8390656,8,n,a)}function Af(n,a){ec(2048,8,n,a)}function Yv(n){Me.flags|=4;var a=Me.updateQueue;if(a===null)a=Qu(),Me.updateQueue=a,a.events=[n];else{var s=a.events;s===null?a.events=[n]:s.push(n)}}function vp(n){var a=Ot().memoizedState;return Yv({ref:a,nextImpl:n}),function(){if((et&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function wp(n,a){return ec(4,2,n,a)}function bp(n,a){return ec(4,4,n,a)}function Ap(n,a){if(typeof a=="function"){n=n();var s=a(n);return function(){typeof s=="function"?s():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function Sp(n,a,s){s=s!=null?s.concat([n]):null,ec(4,4,Ap.bind(null,a,n),s)}function Sf(){}function Rp(n,a){var s=Ot();a=a===void 0?null:a;var l=s.memoizedState;return a!==null&&mf(a,l[1])?l[0]:(s.memoizedState=[n,a],n)}function Ip(n,a){var s=Ot();a=a===void 0?null:a;var l=s.memoizedState;if(a!==null&&mf(a,l[1]))return l[0];if(l=n(),Fr){Yn(!0);try{n()}finally{Yn(!1)}}return s.memoizedState=[l,a],l}function Rf(n,a,s){return s===void 0||(ca&1073741824)!==0&&(ze&261930)===0?n.memoizedState=a:(n.memoizedState=s,n=kg(),Me.lanes|=n,Wa|=n,s)}function kp(n,a,s,l){return xn(s,a)?s:Ms.current!==null?(n=Rf(n,s,l),xn(n,a)||(zt=!0),n):(ca&42)===0||(ca&1073741824)!==0&&(ze&261930)===0?(zt=!0,n.memoizedState=s):(n=kg(),Me.lanes|=n,Wa|=n,a)}function Dp(n,a,s,l,f){var d=ue.p;ue.p=d!==0&&8>d?d:8;var T=$.T,b={};$.T=b,Df(n,!1,a,s);try{var N=f(),Y=$.S;if(Y!==null&&Y(b,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var Q=Uv(N,l);ol(n,a,Q,qn(n))}else ol(n,a,l,qn(n))}catch(ee){ol(n,a,{then:function(){},status:"rejected",reason:ee},qn())}finally{ue.p=d,T!==null&&b.types!==null&&(T.types=b.types),$.T=T}}function Fv(){}function If(n,a,s,l){if(n.tag!==5)throw Error(r(476));var f=Op(n).queue;Dp(n,f,a,Ee,s===null?Fv:function(){return Cp(n),s(l)})}function Op(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:Ee},next:null};var s={};return a.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:s},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function Cp(n){var a=Op(n);a.next===null&&(a=n.alternate.memoizedState),ol(n,a.next.queue,{},qn())}function kf(){return on(Al)}function Np(){return Ot().memoizedState}function Mp(){return Ot().memoizedState}function Wv(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var s=qn();n=Ba(s);var l=Ga(a,n,s);l!==null&&(Dn(l,a,s),nl(l,a,s)),a={cache:nf()},n.payload=a;return}a=a.return}}function Xv(n,a,s){var l=qn();s={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},tc(n)?Lp(a,s):(s=Yh(n,a,s,l),s!==null&&(Dn(s,n,l),Hp(s,a,l)))}function Vp(n,a,s){var l=qn();ol(n,a,s,l)}function ol(n,a,s,l){var f={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(tc(n))Lp(a,f);else{var d=n.alternate;if(n.lanes===0&&(d===null||d.lanes===0)&&(d=a.lastRenderedReducer,d!==null))try{var T=a.lastRenderedState,b=d(T,s);if(f.hasEagerState=!0,f.eagerState=b,xn(b,T))return Lu(n,a,f,0),ht===null&&Vu(),!1}catch{}if(s=Yh(n,a,f,l),s!==null)return Dn(s,n,l),Hp(s,a,l),!0}return!1}function Df(n,a,s,l){if(l={lane:2,revertLane:od(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},tc(n)){if(a)throw Error(r(479))}else a=Yh(n,s,l,2),a!==null&&Dn(a,n,2)}function tc(n){var a=n.alternate;return n===Me||a!==null&&a===Me}function Lp(n,a){Vs=Xu=!0;var s=n.pending;s===null?a.next=a:(a.next=s.next,s.next=a),n.pending=a}function Hp(n,a,s){if((s&4194048)!==0){var l=a.lanes;l&=n.pendingLanes,s|=l,a.lanes=s,Do(n,s)}}var ll={readContext:on,use:$u,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useLayoutEffect:At,useInsertionEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useSyncExternalStore:At,useId:At,useHostTransitionStatus:At,useFormState:At,useActionState:At,useOptimistic:At,useMemoCache:At,useCacheRefresh:At};ll.useEffectEvent=At;var Pp={readContext:on,use:$u,useCallback:function(n,a){return wn().memoizedState=[n,a===void 0?null:a],n},useContext:on,useEffect:Ep,useImperativeHandle:function(n,a,s){s=s!=null?s.concat([n]):null,Ju(4194308,4,Ap.bind(null,a,n),s)},useLayoutEffect:function(n,a){return Ju(4194308,4,n,a)},useInsertionEffect:function(n,a){Ju(4,2,n,a)},useMemo:function(n,a){var s=wn();a=a===void 0?null:a;var l=n();if(Fr){Yn(!0);try{n()}finally{Yn(!1)}}return s.memoizedState=[l,a],l},useReducer:function(n,a,s){var l=wn();if(s!==void 0){var f=s(a);if(Fr){Yn(!0);try{s(a)}finally{Yn(!1)}}}else f=a;return l.memoizedState=l.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},l.queue=n,n=n.dispatch=Xv.bind(null,Me,n),[l.memoizedState,n]},useRef:function(n){var a=wn();return n={current:n},a.memoizedState=n},useState:function(n){n=wf(n);var a=n.queue,s=Vp.bind(null,Me,a);return a.dispatch=s,[n.memoizedState,s]},useDebugValue:Sf,useDeferredValue:function(n,a){var s=wn();return Rf(s,n,a)},useTransition:function(){var n=wf(!1);return n=Dp.bind(null,Me,n.queue,!0,!1),wn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,s){var l=Me,f=wn();if(je){if(s===void 0)throw Error(r(407));s=s()}else{if(s=a(),ht===null)throw Error(r(349));(ze&127)!==0||ap(l,a,s)}f.memoizedState=s;var d={value:s,getSnapshot:a};return f.queue=d,Ep(sp.bind(null,l,d,n),[n]),l.flags|=2048,Hs(9,{destroy:void 0},rp.bind(null,l,d,s,a),null),s},useId:function(){var n=wn(),a=ht.identifierPrefix;if(je){var s=Fi,l=Yi;s=(l&~(1<<32-It(l)-1)).toString(32)+s,a="_"+a+"R_"+s,s=Ku++,0<s&&(a+="H"+s.toString(32)),a+="_"}else s=Bv++,a="_"+a+"r_"+s.toString(32)+"_";return n.memoizedState=a},useHostTransitionStatus:kf,useFormState:_p,useActionState:_p,useOptimistic:function(n){var a=wn();a.memoizedState=a.baseState=n;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=s,a=Df.bind(null,Me,!0,s),s.dispatch=a,[n,a]},useMemoCache:Tf,useCacheRefresh:function(){return wn().memoizedState=Wv.bind(null,Me)},useEffectEvent:function(n){var a=wn(),s={impl:n};return a.memoizedState=s,function(){if((et&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}},Of={readContext:on,use:$u,useCallback:Rp,useContext:on,useEffect:Af,useImperativeHandle:Sp,useInsertionEffect:wp,useLayoutEffect:bp,useMemo:Ip,useReducer:Zu,useRef:Tp,useState:function(){return Zu(ha)},useDebugValue:Sf,useDeferredValue:function(n,a){var s=Ot();return kp(s,ot.memoizedState,n,a)},useTransition:function(){var n=Zu(ha)[0],a=Ot().memoizedState;return[typeof n=="boolean"?n:sl(n),a]},useSyncExternalStore:ip,useId:Np,useHostTransitionStatus:kf,useFormState:pp,useActionState:pp,useOptimistic:function(n,a){var s=Ot();return up(s,ot,n,a)},useMemoCache:Tf,useCacheRefresh:Mp};Of.useEffectEvent=vp;var xp={readContext:on,use:$u,useCallback:Rp,useContext:on,useEffect:Af,useImperativeHandle:Sp,useInsertionEffect:wp,useLayoutEffect:bp,useMemo:Ip,useReducer:vf,useRef:Tp,useState:function(){return vf(ha)},useDebugValue:Sf,useDeferredValue:function(n,a){var s=Ot();return ot===null?Rf(s,n,a):kp(s,ot.memoizedState,n,a)},useTransition:function(){var n=vf(ha)[0],a=Ot().memoizedState;return[typeof n=="boolean"?n:sl(n),a]},useSyncExternalStore:ip,useId:Np,useHostTransitionStatus:kf,useFormState:yp,useActionState:yp,useOptimistic:function(n,a){var s=Ot();return ot!==null?up(s,ot,n,a):(s.baseState=n,[n,s.queue.dispatch])},useMemoCache:Tf,useCacheRefresh:Mp};xp.useEffectEvent=vp;function Cf(n,a,s,l){a=n.memoizedState,s=s(l,a),s=s==null?a:v({},a,s),n.memoizedState=s,n.lanes===0&&(n.updateQueue.baseState=s)}var Nf={enqueueSetState:function(n,a,s){n=n._reactInternals;var l=qn(),f=Ba(l);f.payload=a,s!=null&&(f.callback=s),a=Ga(n,f,l),a!==null&&(Dn(a,n,l),nl(a,n,l))},enqueueReplaceState:function(n,a,s){n=n._reactInternals;var l=qn(),f=Ba(l);f.tag=1,f.payload=a,s!=null&&(f.callback=s),a=Ga(n,f,l),a!==null&&(Dn(a,n,l),nl(a,n,l))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var s=qn(),l=Ba(s);l.tag=2,a!=null&&(l.callback=a),a=Ga(n,l,s),a!==null&&(Dn(a,n,s),nl(a,n,s))}};function zp(n,a,s,l,f,d,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(l,d,T):a.prototype&&a.prototype.isPureReactComponent?!Xo(s,l)||!Xo(f,d):!0}function Up(n,a,s,l){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(s,l),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(s,l),a.state!==n&&Nf.enqueueReplaceState(a,a.state,null)}function Wr(n,a){var s=a;if("ref"in a){s={};for(var l in a)l!=="ref"&&(s[l]=a[l])}if(n=n.defaultProps){s===a&&(s=v({},s));for(var f in n)s[f]===void 0&&(s[f]=n[f])}return s}function Bp(n){Mu(n)}function Gp(n){console.error(n)}function jp(n){Mu(n)}function nc(n,a){try{var s=n.onUncaughtError;s(a.value,{componentStack:a.stack})}catch(l){setTimeout(function(){throw l})}}function qp(n,a,s){try{var l=n.onCaughtError;l(s.value,{componentStack:s.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Mf(n,a,s){return s=Ba(s),s.tag=3,s.payload={element:null},s.callback=function(){nc(n,a)},s}function Yp(n){return n=Ba(n),n.tag=3,n}function Fp(n,a,s,l){var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var d=l.value;n.payload=function(){return f(d)},n.callback=function(){qp(a,s,l)}}var T=s.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){qp(a,s,l),typeof f!="function"&&(Xa===null?Xa=new Set([this]):Xa.add(this));var b=l.stack;this.componentDidCatch(l.value,{componentStack:b!==null?b:""})})}function Kv(n,a,s,l,f){if(s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(a=s.alternate,a!==null&&ks(a,s,f,!0),s=Un.current,s!==null){switch(s.tag){case 31:case 13:return ti===null?mc():s.alternate===null&&St===0&&(St=3),s.flags&=-257,s.flags|=65536,s.lanes=f,l===ju?s.flags|=16384:(a=s.updateQueue,a===null?s.updateQueue=new Set([l]):a.add(l),ad(n,l,f)),!1;case 22:return s.flags|=65536,l===ju?s.flags|=16384:(a=s.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([l])},s.updateQueue=a):(s=a.retryQueue,s===null?a.retryQueue=new Set([l]):s.add(l)),ad(n,l,f)),!1}throw Error(r(435,s.tag))}return ad(n,l,f),mc(),!1}if(je)return a=Un.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=f,l!==$h&&(n=Error(r(422),{cause:l}),$o($n(n,s)))):(l!==$h&&(a=Error(r(423),{cause:l}),$o($n(a,s))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,l=$n(l,s),f=Mf(n.stateNode,l,f),uf(n,f),St!==4&&(St=2)),!1;var d=Error(r(520),{cause:l});if(d=$n(d,s),pl===null?pl=[d]:pl.push(d),St!==4&&(St=2),a===null)return!0;l=$n(l,s),s=a;do{switch(s.tag){case 3:return s.flags|=65536,n=f&-f,s.lanes|=n,n=Mf(s.stateNode,l,n),uf(s,n),!1;case 1:if(a=s.type,d=s.stateNode,(s.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(Xa===null||!Xa.has(d))))return s.flags|=65536,f&=-f,s.lanes|=f,f=Yp(f),Fp(f,n,s,l),uf(s,f),!1}s=s.return}while(s!==null);return!1}var Vf=Error(r(461)),zt=!1;function ln(n,a,s,l){a.child=n===null?Q_(a,null,s,l):Yr(a,n.child,s,l)}function Wp(n,a,s,l,f){s=s.render;var d=a.ref;if("ref"in l){var T={};for(var b in l)b!=="ref"&&(T[b]=l[b])}else T=l;return Br(a),l=_f(n,a,s,T,d,f),b=pf(),n!==null&&!zt?(gf(n,a,f),fa(n,a,f)):(je&&b&&Kh(a),a.flags|=1,ln(n,a,l,f),a.child)}function Xp(n,a,s,l,f){if(n===null){var d=s.type;return typeof d=="function"&&!Fh(d)&&d.defaultProps===void 0&&s.compare===null?(a.tag=15,a.type=d,Kp(n,a,d,l,f)):(n=Pu(s.type,null,l,a,a.mode,f),n.ref=a.ref,n.return=a,a.child=n)}if(d=n.child,!Gf(n,f)){var T=d.memoizedProps;if(s=s.compare,s=s!==null?s:Xo,s(T,l)&&n.ref===a.ref)return fa(n,a,f)}return a.flags|=1,n=sa(d,l),n.ref=a.ref,n.return=a,a.child=n}function Kp(n,a,s,l,f){if(n!==null){var d=n.memoizedProps;if(Xo(d,l)&&n.ref===a.ref)if(zt=!1,a.pendingProps=l=d,Gf(n,f))(n.flags&131072)!==0&&(zt=!0);else return a.lanes=n.lanes,fa(n,a,f)}return Lf(n,a,s,l,f)}function Qp(n,a,s,l){var f=l.children,d=n!==null?n.memoizedState:null;if(n===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((a.flags&128)!==0){if(d=d!==null?d.baseLanes|s:s,n!==null){for(l=a.child=n.child,f=0;l!==null;)f=f|l.lanes|l.childLanes,l=l.sibling;l=f&~d}else l=0,a.child=null;return $p(n,a,d,s,l)}if((s&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&Bu(a,d!==null?d.cachePool:null),d!==null?J_(a,d):hf(),ep(a);else return l=a.lanes=536870912,$p(n,a,d!==null?d.baseLanes|s:s,s,l)}else d!==null?(Bu(a,d.cachePool),J_(a,d),qa(),a.memoizedState=null):(n!==null&&Bu(a,null),hf(),qa());return ln(n,a,f,s),a.child}function ul(n,a){return n!==null&&n.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function $p(n,a,s,l,f){var d=rf();return d=d===null?null:{parent:Pt._currentValue,pool:d},a.memoizedState={baseLanes:s,cachePool:d},n!==null&&Bu(a,null),hf(),ep(a),n!==null&&ks(n,a,l,!0),a.childLanes=f,null}function ic(n,a){return a=rc({mode:a.mode,children:a.children},n.mode),a.ref=n.ref,n.child=a,a.return=n,a}function Zp(n,a,s){return Yr(a,n.child,null,s),n=ic(a,a.pendingProps),n.flags|=2,Bn(a),a.memoizedState=null,n}function Qv(n,a,s){var l=a.pendingProps,f=(a.flags&128)!==0;if(a.flags&=-129,n===null){if(je){if(l.mode==="hidden")return n=ic(a,l),a.lanes=536870912,ul(null,n);if(df(a),(n=mt)?(n=cy(n,ei),n=n!==null&&n.data==="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:Ha!==null?{id:Yi,overflow:Fi}:null,retryLane:536870912,hydrationErrors:null},s=L_(n),s.return=a,a.child=s,sn=a,mt=null)):n=null,n===null)throw xa(a);return a.lanes=536870912,null}return ic(a,l)}var d=n.memoizedState;if(d!==null){var T=d.dehydrated;if(df(a),f)if(a.flags&256)a.flags&=-257,a=Zp(n,a,s);else if(a.memoizedState!==null)a.child=n.child,a.flags|=128,a=null;else throw Error(r(558));else if(zt||ks(n,a,s,!1),f=(s&n.childLanes)!==0,zt||f){if(l=ht,l!==null&&(T=Oo(l,s),T!==0&&T!==d.retryLane))throw d.retryLane=T,Pr(n,T),Dn(l,n,T),Vf;mc(),a=Zp(n,a,s)}else n=d.treeContext,mt=ni(T.nextSibling),sn=a,je=!0,Pa=null,ei=!1,n!==null&&x_(a,n),a=ic(a,l),a.flags|=4096;return a}return n=sa(n.child,{mode:l.mode,children:l.children}),n.ref=a.ref,a.child=n,n.return=a,n}function ac(n,a){var s=a.ref;if(s===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(r(284));(n===null||n.ref!==s)&&(a.flags|=4194816)}}function Lf(n,a,s,l,f){return Br(a),s=_f(n,a,s,l,void 0,f),l=pf(),n!==null&&!zt?(gf(n,a,f),fa(n,a,f)):(je&&l&&Kh(a),a.flags|=1,ln(n,a,s,f),a.child)}function Jp(n,a,s,l,f,d){return Br(a),a.updateQueue=null,s=np(a,l,s,f),tp(n),l=pf(),n!==null&&!zt?(gf(n,a,d),fa(n,a,d)):(je&&l&&Kh(a),a.flags|=1,ln(n,a,s,d),a.child)}function eg(n,a,s,l,f){if(Br(a),a.stateNode===null){var d=As,T=s.contextType;typeof T=="object"&&T!==null&&(d=on(T)),d=new s(l,d),a.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Nf,a.stateNode=d,d._reactInternals=a,d=a.stateNode,d.props=l,d.state=a.memoizedState,d.refs={},of(a),T=s.contextType,d.context=typeof T=="object"&&T!==null?on(T):As,d.state=a.memoizedState,T=s.getDerivedStateFromProps,typeof T=="function"&&(Cf(a,s,T,l),d.state=a.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(T=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),T!==d.state&&Nf.enqueueReplaceState(d,d.state,null),al(a,l,d,f),il(),d.state=a.memoizedState),typeof d.componentDidMount=="function"&&(a.flags|=4194308),l=!0}else if(n===null){d=a.stateNode;var b=a.memoizedProps,N=Wr(s,b);d.props=N;var Y=d.context,Q=s.contextType;T=As,typeof Q=="object"&&Q!==null&&(T=on(Q));var ee=s.getDerivedStateFromProps;Q=typeof ee=="function"||typeof d.getSnapshotBeforeUpdate=="function",b=a.pendingProps!==b,Q||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(b||Y!==T)&&Up(a,d,l,T),Ua=!1;var F=a.memoizedState;d.state=F,al(a,l,d,f),il(),Y=a.memoizedState,b||F!==Y||Ua?(typeof ee=="function"&&(Cf(a,s,ee,l),Y=a.memoizedState),(N=Ua||zp(a,s,N,l,F,Y,T))?(Q||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(a.flags|=4194308)):(typeof d.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=l,a.memoizedState=Y),d.props=l,d.state=Y,d.context=T,l=N):(typeof d.componentDidMount=="function"&&(a.flags|=4194308),l=!1)}else{d=a.stateNode,lf(n,a),T=a.memoizedProps,Q=Wr(s,T),d.props=Q,ee=a.pendingProps,F=d.context,Y=s.contextType,N=As,typeof Y=="object"&&Y!==null&&(N=on(Y)),b=s.getDerivedStateFromProps,(Y=typeof b=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(T!==ee||F!==N)&&Up(a,d,l,N),Ua=!1,F=a.memoizedState,d.state=F,al(a,l,d,f),il();var X=a.memoizedState;T!==ee||F!==X||Ua||n!==null&&n.dependencies!==null&&zu(n.dependencies)?(typeof b=="function"&&(Cf(a,s,b,l),X=a.memoizedState),(Q=Ua||zp(a,s,Q,l,F,X,N)||n!==null&&n.dependencies!==null&&zu(n.dependencies))?(Y||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(l,X,N),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(l,X,N)),typeof d.componentDidUpdate=="function"&&(a.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof d.componentDidUpdate!="function"||T===n.memoizedProps&&F===n.memoizedState||(a.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&F===n.memoizedState||(a.flags|=1024),a.memoizedProps=l,a.memoizedState=X),d.props=l,d.state=X,d.context=N,l=Q):(typeof d.componentDidUpdate!="function"||T===n.memoizedProps&&F===n.memoizedState||(a.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&F===n.memoizedState||(a.flags|=1024),l=!1)}return d=l,ac(n,a),l=(a.flags&128)!==0,d||l?(d=a.stateNode,s=l&&typeof s.getDerivedStateFromError!="function"?null:d.render(),a.flags|=1,n!==null&&l?(a.child=Yr(a,n.child,null,f),a.child=Yr(a,null,s,f)):ln(n,a,s,f),a.memoizedState=d.state,n=a.child):n=fa(n,a,f),n}function tg(n,a,s,l){return zr(),a.flags|=256,ln(n,a,s,l),a.child}var Hf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pf(n){return{baseLanes:n,cachePool:q_()}}function xf(n,a,s){return n=n!==null?n.childLanes&~s:0,a&&(n|=jn),n}function ng(n,a,s){var l=a.pendingProps,f=!1,d=(a.flags&128)!==0,T;if((T=d)||(T=n!==null&&n.memoizedState===null?!1:(Dt.current&2)!==0),T&&(f=!0,a.flags&=-129),T=(a.flags&32)!==0,a.flags&=-33,n===null){if(je){if(f?ja(a):qa(),(n=mt)?(n=cy(n,ei),n=n!==null&&n.data!=="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:Ha!==null?{id:Yi,overflow:Fi}:null,retryLane:536870912,hydrationErrors:null},s=L_(n),s.return=a,a.child=s,sn=a,mt=null)):n=null,n===null)throw xa(a);return Ed(n)?a.lanes=32:a.lanes=536870912,null}var b=l.children;return l=l.fallback,f?(qa(),f=a.mode,b=rc({mode:"hidden",children:b},f),l=xr(l,f,s,null),b.return=a,l.return=a,b.sibling=l,a.child=b,l=a.child,l.memoizedState=Pf(s),l.childLanes=xf(n,T,s),a.memoizedState=Hf,ul(null,l)):(ja(a),zf(a,b))}var N=n.memoizedState;if(N!==null&&(b=N.dehydrated,b!==null)){if(d)a.flags&256?(ja(a),a.flags&=-257,a=Uf(n,a,s)):a.memoizedState!==null?(qa(),a.child=n.child,a.flags|=128,a=null):(qa(),b=l.fallback,f=a.mode,l=rc({mode:"visible",children:l.children},f),b=xr(b,f,s,null),b.flags|=2,l.return=a,b.return=a,l.sibling=b,a.child=l,Yr(a,n.child,null,s),l=a.child,l.memoizedState=Pf(s),l.childLanes=xf(n,T,s),a.memoizedState=Hf,a=ul(null,l));else if(ja(a),Ed(b)){if(T=b.nextSibling&&b.nextSibling.dataset,T)var Y=T.dgst;T=Y,l=Error(r(419)),l.stack="",l.digest=T,$o({value:l,source:null,stack:null}),a=Uf(n,a,s)}else if(zt||ks(n,a,s,!1),T=(s&n.childLanes)!==0,zt||T){if(T=ht,T!==null&&(l=Oo(T,s),l!==0&&l!==N.retryLane))throw N.retryLane=l,Pr(n,l),Dn(T,n,l),Vf;Td(b)||mc(),a=Uf(n,a,s)}else Td(b)?(a.flags|=192,a.child=n.child,a=null):(n=N.treeContext,mt=ni(b.nextSibling),sn=a,je=!0,Pa=null,ei=!1,n!==null&&x_(a,n),a=zf(a,l.children),a.flags|=4096);return a}return f?(qa(),b=l.fallback,f=a.mode,N=n.child,Y=N.sibling,l=sa(N,{mode:"hidden",children:l.children}),l.subtreeFlags=N.subtreeFlags&65011712,Y!==null?b=sa(Y,b):(b=xr(b,f,s,null),b.flags|=2),b.return=a,l.return=a,l.sibling=b,a.child=l,ul(null,l),l=a.child,b=n.child.memoizedState,b===null?b=Pf(s):(f=b.cachePool,f!==null?(N=Pt._currentValue,f=f.parent!==N?{parent:N,pool:N}:f):f=q_(),b={baseLanes:b.baseLanes|s,cachePool:f}),l.memoizedState=b,l.childLanes=xf(n,T,s),a.memoizedState=Hf,ul(n.child,l)):(ja(a),s=n.child,n=s.sibling,s=sa(s,{mode:"visible",children:l.children}),s.return=a,s.sibling=null,n!==null&&(T=a.deletions,T===null?(a.deletions=[n],a.flags|=16):T.push(n)),a.child=s,a.memoizedState=null,s)}function zf(n,a){return a=rc({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function rc(n,a){return n=zn(22,n,null,a),n.lanes=0,n}function Uf(n,a,s){return Yr(a,n.child,null,s),n=zf(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function ig(n,a,s){n.lanes|=a;var l=n.alternate;l!==null&&(l.lanes|=a),ef(n.return,a,s)}function Bf(n,a,s,l,f,d){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:f,treeForkCount:d}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=l,T.tail=s,T.tailMode=f,T.treeForkCount=d)}function ag(n,a,s){var l=a.pendingProps,f=l.revealOrder,d=l.tail;l=l.children;var T=Dt.current,b=(T&2)!==0;if(b?(T=T&1|2,a.flags|=128):T&=1,ce(Dt,T),ln(n,a,l,s),l=je?Qo:0,!b&&n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ig(n,s,a);else if(n.tag===19)ig(n,s,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(s=a.child,f=null;s!==null;)n=s.alternate,n!==null&&Wu(n)===null&&(f=s),s=s.sibling;s=f,s===null?(f=a.child,a.child=null):(f=s.sibling,s.sibling=null),Bf(a,!1,f,s,d,l);break;case"backwards":case"unstable_legacy-backwards":for(s=null,f=a.child,a.child=null;f!==null;){if(n=f.alternate,n!==null&&Wu(n)===null){a.child=f;break}n=f.sibling,f.sibling=s,s=f,f=n}Bf(a,!0,s,null,d,l);break;case"together":Bf(a,!1,null,null,void 0,l);break;default:a.memoizedState=null}return a.child}function fa(n,a,s){if(n!==null&&(a.dependencies=n.dependencies),Wa|=a.lanes,(s&a.childLanes)===0)if(n!==null){if(ks(n,a,s,!1),(s&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(r(153));if(a.child!==null){for(n=a.child,s=sa(n,n.pendingProps),a.child=s,s.return=a;n.sibling!==null;)n=n.sibling,s=s.sibling=sa(n,n.pendingProps),s.return=a;s.sibling=null}return a.child}function Gf(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&zu(n)))}function $v(n,a,s){switch(a.tag){case 3:Yt(a,a.stateNode.containerInfo),za(a,Pt,n.memoizedState.cache),zr();break;case 27:case 5:Tr(a);break;case 4:Yt(a,a.stateNode.containerInfo);break;case 10:za(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,df(a),null;break;case 13:var l=a.memoizedState;if(l!==null)return l.dehydrated!==null?(ja(a),a.flags|=128,null):(s&a.child.childLanes)!==0?ng(n,a,s):(ja(a),n=fa(n,a,s),n!==null?n.sibling:null);ja(a);break;case 19:var f=(n.flags&128)!==0;if(l=(s&a.childLanes)!==0,l||(ks(n,a,s,!1),l=(s&a.childLanes)!==0),f){if(l)return ag(n,a,s);a.flags|=128}if(f=a.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ce(Dt,Dt.current),l)break;return null;case 22:return a.lanes=0,Qp(n,a,s,a.pendingProps);case 24:za(a,Pt,n.memoizedState.cache)}return fa(n,a,s)}function rg(n,a,s){if(n!==null)if(n.memoizedProps!==a.pendingProps)zt=!0;else{if(!Gf(n,s)&&(a.flags&128)===0)return zt=!1,$v(n,a,s);zt=(n.flags&131072)!==0}else zt=!1,je&&(a.flags&1048576)!==0&&P_(a,Qo,a.index);switch(a.lanes=0,a.tag){case 16:e:{var l=a.pendingProps;if(n=jr(a.elementType),a.type=n,typeof n=="function")Fh(n)?(l=Wr(n,l),a.tag=1,a=eg(null,a,n,l,s)):(a.tag=0,a=Lf(null,a,n,l,s));else{if(n!=null){var f=n.$$typeof;if(f===re){a.tag=11,a=Wp(null,a,n,l,s);break e}else if(f===k){a.tag=14,a=Xp(null,a,n,l,s);break e}}throw a=yt(n)||n,Error(r(306,a,""))}}return a;case 0:return Lf(n,a,a.type,a.pendingProps,s);case 1:return l=a.type,f=Wr(l,a.pendingProps),eg(n,a,l,f,s);case 3:e:{if(Yt(a,a.stateNode.containerInfo),n===null)throw Error(r(387));l=a.pendingProps;var d=a.memoizedState;f=d.element,lf(n,a),al(a,l,null,s);var T=a.memoizedState;if(l=T.cache,za(a,Pt,l),l!==d.cache&&tf(a,[Pt],s,!0),il(),l=T.element,d.isDehydrated)if(d={element:l,isDehydrated:!1,cache:T.cache},a.updateQueue.baseState=d,a.memoizedState=d,a.flags&256){a=tg(n,a,l,s);break e}else if(l!==f){f=$n(Error(r(424)),a),$o(f),a=tg(n,a,l,s);break e}else for(n=a.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,mt=ni(n.firstChild),sn=a,je=!0,Pa=null,ei=!0,s=Q_(a,null,l,s),a.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(zr(),l===f){a=fa(n,a,s);break e}ln(n,a,l,s)}a=a.child}return a;case 26:return ac(n,a),n===null?(s=py(a.type,null,a.pendingProps,null))?a.memoizedState=s:je||(s=a.type,n=a.pendingProps,l=vc(Le.current).createElement(s),l[Vt]=a,l[Qt]=n,un(l,s,n),Lt(l),a.stateNode=l):a.memoizedState=py(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return Tr(a),n===null&&je&&(l=a.stateNode=dy(a.type,a.pendingProps,Le.current),sn=a,ei=!0,f=mt,Za(a.type)?(vd=f,mt=ni(l.firstChild)):mt=f),ln(n,a,a.pendingProps.children,s),ac(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&je&&((f=l=mt)&&(l=Iw(l,a.type,a.pendingProps,ei),l!==null?(a.stateNode=l,sn=a,mt=ni(l.firstChild),ei=!1,f=!0):f=!1),f||xa(a)),Tr(a),f=a.type,d=a.pendingProps,T=n!==null?n.memoizedProps:null,l=d.children,pd(f,d)?l=null:T!==null&&pd(f,T)&&(a.flags|=32),a.memoizedState!==null&&(f=_f(n,a,Gv,null,null,s),Al._currentValue=f),ac(n,a),ln(n,a,l,s),a.child;case 6:return n===null&&je&&((n=s=mt)&&(s=kw(s,a.pendingProps,ei),s!==null?(a.stateNode=s,sn=a,mt=null,n=!0):n=!1),n||xa(a)),null;case 13:return ng(n,a,s);case 4:return Yt(a,a.stateNode.containerInfo),l=a.pendingProps,n===null?a.child=Yr(a,null,l,s):ln(n,a,l,s),a.child;case 11:return Wp(n,a,a.type,a.pendingProps,s);case 7:return ln(n,a,a.pendingProps,s),a.child;case 8:return ln(n,a,a.pendingProps.children,s),a.child;case 12:return ln(n,a,a.pendingProps.children,s),a.child;case 10:return l=a.pendingProps,za(a,a.type,l.value),ln(n,a,l.children,s),a.child;case 9:return f=a.type._context,l=a.pendingProps.children,Br(a),f=on(f),l=l(f),a.flags|=1,ln(n,a,l,s),a.child;case 14:return Xp(n,a,a.type,a.pendingProps,s);case 15:return Kp(n,a,a.type,a.pendingProps,s);case 19:return ag(n,a,s);case 31:return Qv(n,a,s);case 22:return Qp(n,a,s,a.pendingProps);case 24:return Br(a),l=on(Pt),n===null?(f=rf(),f===null&&(f=ht,d=nf(),f.pooledCache=d,d.refCount++,d!==null&&(f.pooledCacheLanes|=s),f=d),a.memoizedState={parent:l,cache:f},of(a),za(a,Pt,f)):((n.lanes&s)!==0&&(lf(n,a),al(a,null,null,s),il()),f=n.memoizedState,d=a.memoizedState,f.parent!==l?(f={parent:l,cache:l},a.memoizedState=f,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=f),za(a,Pt,l)):(l=d.cache,za(a,Pt,l),l!==f.cache&&tf(a,[Pt],s,!0))),ln(n,a,a.pendingProps.children,s),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function da(n){n.flags|=4}function jf(n,a,s,l,f){if((a=(n.mode&32)!==0)&&(a=!1),a){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(Ng())n.flags|=8192;else throw qr=ju,sf}else n.flags&=-16777217}function sg(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!vy(a))if(Ng())n.flags|=8192;else throw qr=ju,sf}function sc(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?fu():536870912,n.lanes|=a,Us|=a)}function cl(n,a){if(!je)switch(n.tailMode){case"hidden":a=n.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?n.tail=null:s.sibling=null;break;case"collapsed":s=n.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:l.sibling=null}}function _t(n){var a=n.alternate!==null&&n.alternate.child===n.child,s=0,l=0;if(a)for(var f=n.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags&65011712,l|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=l,n.childLanes=s,a}function Zv(n,a,s){var l=a.pendingProps;switch(Qh(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(a),null;case 1:return _t(a),null;case 3:return s=a.stateNode,l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),ua(Pt),Tt(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Is(a)?da(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Zh())),_t(a),null;case 26:var f=a.type,d=a.memoizedState;return n===null?(da(a),d!==null?(_t(a),sg(a,d)):(_t(a),jf(a,f,null,l,s))):d?d!==n.memoizedState?(da(a),_t(a),sg(a,d)):(_t(a),a.flags&=-16777217):(n=n.memoizedProps,n!==l&&da(a),_t(a),jf(a,f,n,l,s)),null;case 27:if(rs(a),s=Le.current,f=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==l&&da(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return _t(a),null}n=de.current,Is(a)?z_(a):(n=dy(f,l,s),a.stateNode=n,da(a))}return _t(a),null;case 5:if(rs(a),f=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==l&&da(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return _t(a),null}if(d=de.current,Is(a))z_(a);else{var T=vc(Le.current);switch(d){case 1:d=T.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:d=T.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":d=T.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":d=T.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":d=T.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof l.is=="string"?T.createElement("select",{is:l.is}):T.createElement("select"),l.multiple?d.multiple=!0:l.size&&(d.size=l.size);break;default:d=typeof l.is=="string"?T.createElement(f,{is:l.is}):T.createElement(f)}}d[Vt]=a,d[Qt]=l;e:for(T=a.child;T!==null;){if(T.tag===5||T.tag===6)d.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===a)break e;for(;T.sibling===null;){if(T.return===null||T.return===a)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}a.stateNode=d;e:switch(un(d,f,l),f){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&da(a)}}return _t(a),jf(a,a.type,n===null?null:n.memoizedProps,a.pendingProps,s),null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==l&&da(a);else{if(typeof l!="string"&&a.stateNode===null)throw Error(r(166));if(n=Le.current,Is(a)){if(n=a.stateNode,s=a.memoizedProps,l=null,f=sn,f!==null)switch(f.tag){case 27:case 5:l=f.memoizedProps}n[Vt]=a,n=!!(n.nodeValue===s||l!==null&&l.suppressHydrationWarning===!0||ny(n.nodeValue,s)),n||xa(a,!0)}else n=vc(n).createTextNode(l),n[Vt]=a,a.stateNode=n}return _t(a),null;case 31:if(s=a.memoizedState,n===null||n.memoizedState!==null){if(l=Is(a),s!==null){if(n===null){if(!l)throw Error(r(318));if(n=a.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Vt]=a}else zr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;_t(a),n=!1}else s=Zh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=s),n=!0;if(!n)return a.flags&256?(Bn(a),a):(Bn(a),null);if((a.flags&128)!==0)throw Error(r(558))}return _t(a),null;case 13:if(l=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Is(a),l!==null&&l.dehydrated!==null){if(n===null){if(!f)throw Error(r(318));if(f=a.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Vt]=a}else zr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;_t(a),f=!1}else f=Zh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return a.flags&256?(Bn(a),a):(Bn(a),null)}return Bn(a),(a.flags&128)!==0?(a.lanes=s,a):(s=l!==null,n=n!==null&&n.memoizedState!==null,s&&(l=a.child,f=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(f=l.alternate.memoizedState.cachePool.pool),d=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),d!==f&&(l.flags|=2048)),s!==n&&s&&(a.child.flags|=8192),sc(a,a.updateQueue),_t(a),null);case 4:return Tt(),n===null&&hd(a.stateNode.containerInfo),_t(a),null;case 10:return ua(a.type),_t(a),null;case 19:if(ne(Dt),l=a.memoizedState,l===null)return _t(a),null;if(f=(a.flags&128)!==0,d=l.rendering,d===null)if(f)cl(l,!1);else{if(St!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(d=Wu(n),d!==null){for(a.flags|=128,cl(l,!1),n=d.updateQueue,a.updateQueue=n,sc(a,n),a.subtreeFlags=0,n=s,s=a.child;s!==null;)V_(s,n),s=s.sibling;return ce(Dt,Dt.current&1|2),je&&oa(a,l.treeForkCount),a.child}n=n.sibling}l.tail!==null&&En()>hc&&(a.flags|=128,f=!0,cl(l,!1),a.lanes=4194304)}else{if(!f)if(n=Wu(d),n!==null){if(a.flags|=128,f=!0,n=n.updateQueue,a.updateQueue=n,sc(a,n),cl(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!je)return _t(a),null}else 2*En()-l.renderingStartTime>hc&&s!==536870912&&(a.flags|=128,f=!0,cl(l,!1),a.lanes=4194304);l.isBackwards?(d.sibling=a.child,a.child=d):(n=l.last,n!==null?n.sibling=d:a.child=d,l.last=d)}return l.tail!==null?(n=l.tail,l.rendering=n,l.tail=n.sibling,l.renderingStartTime=En(),n.sibling=null,s=Dt.current,ce(Dt,f?s&1|2:s&1),je&&oa(a,l.treeForkCount),n):(_t(a),null);case 22:case 23:return Bn(a),ff(),l=a.memoizedState!==null,n!==null?n.memoizedState!==null!==l&&(a.flags|=8192):l&&(a.flags|=8192),l?(s&536870912)!==0&&(a.flags&128)===0&&(_t(a),a.subtreeFlags&6&&(a.flags|=8192)):_t(a),s=a.updateQueue,s!==null&&sc(a,s.retryQueue),s=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(s=n.memoizedState.cachePool.pool),l=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),l!==s&&(a.flags|=2048),n!==null&&ne(Gr),null;case 24:return s=null,n!==null&&(s=n.memoizedState.cache),a.memoizedState.cache!==s&&(a.flags|=2048),ua(Pt),_t(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function Jv(n,a){switch(Qh(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return ua(Pt),Tt(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return rs(a),null;case 31:if(a.memoizedState!==null){if(Bn(a),a.alternate===null)throw Error(r(340));zr()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 13:if(Bn(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(r(340));zr()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return ne(Dt),null;case 4:return Tt(),null;case 10:return ua(a.type),null;case 22:case 23:return Bn(a),ff(),n!==null&&ne(Gr),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return ua(Pt),null;case 25:return null;default:return null}}function og(n,a){switch(Qh(a),a.tag){case 3:ua(Pt),Tt();break;case 26:case 27:case 5:rs(a);break;case 4:Tt();break;case 31:a.memoizedState!==null&&Bn(a);break;case 13:Bn(a);break;case 19:ne(Dt);break;case 10:ua(a.type);break;case 22:case 23:Bn(a),ff(),n!==null&&ne(Gr);break;case 24:ua(Pt)}}function hl(n,a){try{var s=a.updateQueue,l=s!==null?s.lastEffect:null;if(l!==null){var f=l.next;s=f;do{if((s.tag&n)===n){l=void 0;var d=s.create,T=s.inst;l=d(),T.destroy=l}s=s.next}while(s!==f)}}catch(b){rt(a,a.return,b)}}function Ya(n,a,s){try{var l=a.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var d=f.next;l=d;do{if((l.tag&n)===n){var T=l.inst,b=T.destroy;if(b!==void 0){T.destroy=void 0,f=a;var N=s,Y=b;try{Y()}catch(Q){rt(f,N,Q)}}}l=l.next}while(l!==d)}}catch(Q){rt(a,a.return,Q)}}function lg(n){var a=n.updateQueue;if(a!==null){var s=n.stateNode;try{Z_(a,s)}catch(l){rt(n,n.return,l)}}}function ug(n,a,s){s.props=Wr(n.type,n.memoizedProps),s.state=n.memoizedState;try{s.componentWillUnmount()}catch(l){rt(n,a,l)}}function fl(n,a){try{var s=n.ref;if(s!==null){switch(n.tag){case 26:case 27:case 5:var l=n.stateNode;break;case 30:l=n.stateNode;break;default:l=n.stateNode}typeof s=="function"?n.refCleanup=s(l):s.current=l}}catch(f){rt(n,a,f)}}function Wi(n,a){var s=n.ref,l=n.refCleanup;if(s!==null)if(typeof l=="function")try{l()}catch(f){rt(n,a,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(f){rt(n,a,f)}else s.current=null}function cg(n){var a=n.type,s=n.memoizedProps,l=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":s.autoFocus&&l.focus();break e;case"img":s.src?l.src=s.src:s.srcSet&&(l.srcset=s.srcSet)}}catch(f){rt(n,n.return,f)}}function qf(n,a,s){try{var l=n.stateNode;vw(l,n.type,s,a),l[Qt]=a}catch(f){rt(n,n.return,f)}}function hg(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Za(n.type)||n.tag===4}function Yf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||hg(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Za(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Ff(n,a,s){var l=n.tag;if(l===5||l===6)n=n.stateNode,a?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(n,a):(a=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.appendChild(n),s=s._reactRootContainer,s!=null||a.onclick!==null||(a.onclick=di));else if(l!==4&&(l===27&&Za(n.type)&&(s=n.stateNode,a=null),n=n.child,n!==null))for(Ff(n,a,s),n=n.sibling;n!==null;)Ff(n,a,s),n=n.sibling}function oc(n,a,s){var l=n.tag;if(l===5||l===6)n=n.stateNode,a?s.insertBefore(n,a):s.appendChild(n);else if(l!==4&&(l===27&&Za(n.type)&&(s=n.stateNode),n=n.child,n!==null))for(oc(n,a,s),n=n.sibling;n!==null;)oc(n,a,s),n=n.sibling}function fg(n){var a=n.stateNode,s=n.memoizedProps;try{for(var l=n.type,f=a.attributes;f.length;)a.removeAttributeNode(f[0]);un(a,l,s),a[Vt]=n,a[Qt]=s}catch(d){rt(n,n.return,d)}}var ma=!1,Ut=!1,Wf=!1,dg=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function ew(n,a){if(n=n.containerInfo,md=kc,n=S_(n),zh(n)){if("selectionStart"in n)var s={start:n.selectionStart,end:n.selectionEnd};else e:{s=(s=n.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var f=l.anchorOffset,d=l.focusNode;l=l.focusOffset;try{s.nodeType,d.nodeType}catch{s=null;break e}var T=0,b=-1,N=-1,Y=0,Q=0,ee=n,F=null;t:for(;;){for(var X;ee!==s||f!==0&&ee.nodeType!==3||(b=T+f),ee!==d||l!==0&&ee.nodeType!==3||(N=T+l),ee.nodeType===3&&(T+=ee.nodeValue.length),(X=ee.firstChild)!==null;)F=ee,ee=X;for(;;){if(ee===n)break t;if(F===s&&++Y===f&&(b=T),F===d&&++Q===l&&(N=T),(X=ee.nextSibling)!==null)break;ee=F,F=ee.parentNode}ee=X}s=b===-1||N===-1?null:{start:b,end:N}}else s=null}s=s||{start:0,end:0}}else s=null;for(_d={focusedElem:n,selectionRange:s},kc=!1,Zt=a;Zt!==null;)if(a=Zt,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Zt=n;else for(;Zt!==null;){switch(a=Zt,d=a.alternate,n=a.flags,a.tag){case 0:if((n&4)!==0&&(n=a.updateQueue,n=n!==null?n.events:null,n!==null))for(s=0;s<n.length;s++)f=n[s],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&d!==null){n=void 0,s=a,f=d.memoizedProps,d=d.memoizedState,l=s.stateNode;try{var me=Wr(s.type,f);n=l.getSnapshotBeforeUpdate(me,d),l.__reactInternalSnapshotBeforeUpdate=n}catch(be){rt(s,s.return,be)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,s=n.nodeType,s===9)yd(n);else if(s===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":yd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=a.sibling,n!==null){n.return=a.return,Zt=n;break}Zt=a.return}}function mg(n,a,s){var l=s.flags;switch(s.tag){case 0:case 11:case 15:pa(n,s),l&4&&hl(5,s);break;case 1:if(pa(n,s),l&4)if(n=s.stateNode,a===null)try{n.componentDidMount()}catch(T){rt(s,s.return,T)}else{var f=Wr(s.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(f,a,n.__reactInternalSnapshotBeforeUpdate)}catch(T){rt(s,s.return,T)}}l&64&&lg(s),l&512&&fl(s,s.return);break;case 3:if(pa(n,s),l&64&&(n=s.updateQueue,n!==null)){if(a=null,s.child!==null)switch(s.child.tag){case 27:case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}try{Z_(n,a)}catch(T){rt(s,s.return,T)}}break;case 27:a===null&&l&4&&fg(s);case 26:case 5:pa(n,s),a===null&&l&4&&cg(s),l&512&&fl(s,s.return);break;case 12:pa(n,s);break;case 31:pa(n,s),l&4&&gg(n,s);break;case 13:pa(n,s),l&4&&yg(n,s),l&64&&(n=s.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(s=uw.bind(null,s),Dw(n,s))));break;case 22:if(l=s.memoizedState!==null||ma,!l){a=a!==null&&a.memoizedState!==null||Ut,f=ma;var d=Ut;ma=l,(Ut=a)&&!d?ga(n,s,(s.subtreeFlags&8772)!==0):pa(n,s),ma=f,Ut=d}break;case 30:break;default:pa(n,s)}}function _g(n){var a=n.alternate;a!==null&&(n.alternate=null,_g(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&cs(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var vt=null,Sn=!1;function _a(n,a,s){for(s=s.child;s!==null;)pg(n,a,s),s=s.sibling}function pg(n,a,s){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(ui,s)}catch{}switch(s.tag){case 26:Ut||Wi(s,a),_a(n,a,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:Ut||Wi(s,a);var l=vt,f=Sn;Za(s.type)&&(vt=s.stateNode,Sn=!1),_a(n,a,s),vl(s.stateNode),vt=l,Sn=f;break;case 5:Ut||Wi(s,a);case 6:if(l=vt,f=Sn,vt=null,_a(n,a,s),vt=l,Sn=f,vt!==null)if(Sn)try{(vt.nodeType===9?vt.body:vt.nodeName==="HTML"?vt.ownerDocument.body:vt).removeChild(s.stateNode)}catch(d){rt(s,a,d)}else try{vt.removeChild(s.stateNode)}catch(d){rt(s,a,d)}break;case 18:vt!==null&&(Sn?(n=vt,ly(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,s.stateNode),Xs(n)):ly(vt,s.stateNode));break;case 4:l=vt,f=Sn,vt=s.stateNode.containerInfo,Sn=!0,_a(n,a,s),vt=l,Sn=f;break;case 0:case 11:case 14:case 15:Ya(2,s,a),Ut||Ya(4,s,a),_a(n,a,s);break;case 1:Ut||(Wi(s,a),l=s.stateNode,typeof l.componentWillUnmount=="function"&&ug(s,a,l)),_a(n,a,s);break;case 21:_a(n,a,s);break;case 22:Ut=(l=Ut)||s.memoizedState!==null,_a(n,a,s),Ut=l;break;default:_a(n,a,s)}}function gg(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Xs(n)}catch(s){rt(a,a.return,s)}}}function yg(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Xs(n)}catch(s){rt(a,a.return,s)}}function tw(n){switch(n.tag){case 31:case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new dg),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new dg),a;default:throw Error(r(435,n.tag))}}function lc(n,a){var s=tw(n);a.forEach(function(l){if(!s.has(l)){s.add(l);var f=cw.bind(null,n,l);l.then(f,f)}})}function Rn(n,a){var s=a.deletions;if(s!==null)for(var l=0;l<s.length;l++){var f=s[l],d=n,T=a,b=T;e:for(;b!==null;){switch(b.tag){case 27:if(Za(b.type)){vt=b.stateNode,Sn=!1;break e}break;case 5:vt=b.stateNode,Sn=!1;break e;case 3:case 4:vt=b.stateNode.containerInfo,Sn=!0;break e}b=b.return}if(vt===null)throw Error(r(160));pg(d,T,f),vt=null,Sn=!1,d=f.alternate,d!==null&&(d.return=null),f.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Tg(a,n),a=a.sibling}var Ti=null;function Tg(n,a){var s=n.alternate,l=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Rn(a,n),In(n),l&4&&(Ya(3,n,n.return),hl(3,n),Ya(5,n,n.return));break;case 1:Rn(a,n),In(n),l&512&&(Ut||s===null||Wi(s,s.return)),l&64&&ma&&(n=n.updateQueue,n!==null&&(l=n.callbacks,l!==null&&(s=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=s===null?l:s.concat(l))));break;case 26:var f=Ti;if(Rn(a,n),In(n),l&512&&(Ut||s===null||Wi(s,s.return)),l&4){var d=s!==null?s.memoizedState:null;if(l=n.memoizedState,s===null)if(l===null)if(n.stateNode===null){e:{l=n.type,s=n.memoizedProps,f=f.ownerDocument||f;t:switch(l){case"title":d=f.getElementsByTagName("title")[0],(!d||d[Mi]||d[Vt]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=f.createElement(l),f.head.insertBefore(d,f.querySelector("head > title"))),un(d,l,s),d[Vt]=n,Lt(d),l=d;break e;case"link":var T=Ty("link","href",f).get(l+(s.href||""));if(T){for(var b=0;b<T.length;b++)if(d=T[b],d.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&d.getAttribute("rel")===(s.rel==null?null:s.rel)&&d.getAttribute("title")===(s.title==null?null:s.title)&&d.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){T.splice(b,1);break t}}d=f.createElement(l),un(d,l,s),f.head.appendChild(d);break;case"meta":if(T=Ty("meta","content",f).get(l+(s.content||""))){for(b=0;b<T.length;b++)if(d=T[b],d.getAttribute("content")===(s.content==null?null:""+s.content)&&d.getAttribute("name")===(s.name==null?null:s.name)&&d.getAttribute("property")===(s.property==null?null:s.property)&&d.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&d.getAttribute("charset")===(s.charSet==null?null:s.charSet)){T.splice(b,1);break t}}d=f.createElement(l),un(d,l,s),f.head.appendChild(d);break;default:throw Error(r(468,l))}d[Vt]=n,Lt(d),l=d}n.stateNode=l}else Ey(f,n.type,n.stateNode);else n.stateNode=yy(f,l,n.memoizedProps);else d!==l?(d===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):d.count--,l===null?Ey(f,n.type,n.stateNode):yy(f,l,n.memoizedProps)):l===null&&n.stateNode!==null&&qf(n,n.memoizedProps,s.memoizedProps)}break;case 27:Rn(a,n),In(n),l&512&&(Ut||s===null||Wi(s,s.return)),s!==null&&l&4&&qf(n,n.memoizedProps,s.memoizedProps);break;case 5:if(Rn(a,n),In(n),l&512&&(Ut||s===null||Wi(s,s.return)),n.flags&32){f=n.stateNode;try{An(f,"")}catch(me){rt(n,n.return,me)}}l&4&&n.stateNode!=null&&(f=n.memoizedProps,qf(n,f,s!==null?s.memoizedProps:f)),l&1024&&(Wf=!0);break;case 6:if(Rn(a,n),In(n),l&4){if(n.stateNode===null)throw Error(r(162));l=n.memoizedProps,s=n.stateNode;try{s.nodeValue=l}catch(me){rt(n,n.return,me)}}break;case 3:if(Ac=null,f=Ti,Ti=wc(a.containerInfo),Rn(a,n),Ti=f,In(n),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Xs(a.containerInfo)}catch(me){rt(n,n.return,me)}Wf&&(Wf=!1,Eg(n));break;case 4:l=Ti,Ti=wc(n.stateNode.containerInfo),Rn(a,n),In(n),Ti=l;break;case 12:Rn(a,n),In(n);break;case 31:Rn(a,n),In(n),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,lc(n,l)));break;case 13:Rn(a,n),In(n),n.child.flags&8192&&n.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(cc=En()),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,lc(n,l)));break;case 22:f=n.memoizedState!==null;var N=s!==null&&s.memoizedState!==null,Y=ma,Q=Ut;if(ma=Y||f,Ut=Q||N,Rn(a,n),Ut=Q,ma=Y,In(n),l&8192)e:for(a=n.stateNode,a._visibility=f?a._visibility&-2:a._visibility|1,f&&(s===null||N||ma||Ut||Xr(n)),s=null,a=n;;){if(a.tag===5||a.tag===26){if(s===null){N=s=a;try{if(d=N.stateNode,f)T=d.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{b=N.stateNode;var ee=N.memoizedProps.style,F=ee!=null&&ee.hasOwnProperty("display")?ee.display:null;b.style.display=F==null||typeof F=="boolean"?"":(""+F).trim()}}catch(me){rt(N,N.return,me)}}}else if(a.tag===6){if(s===null){N=a;try{N.stateNode.nodeValue=f?"":N.memoizedProps}catch(me){rt(N,N.return,me)}}}else if(a.tag===18){if(s===null){N=a;try{var X=N.stateNode;f?uy(X,!0):uy(N.stateNode,!1)}catch(me){rt(N,N.return,me)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;s===a&&(s=null),a=a.return}s===a&&(s=null),a.sibling.return=a.return,a=a.sibling}l&4&&(l=n.updateQueue,l!==null&&(s=l.retryQueue,s!==null&&(l.retryQueue=null,lc(n,s))));break;case 19:Rn(a,n),In(n),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,lc(n,l)));break;case 30:break;case 21:break;default:Rn(a,n),In(n)}}function In(n){var a=n.flags;if(a&2){try{for(var s,l=n.return;l!==null;){if(hg(l)){s=l;break}l=l.return}if(s==null)throw Error(r(160));switch(s.tag){case 27:var f=s.stateNode,d=Yf(n);oc(n,d,f);break;case 5:var T=s.stateNode;s.flags&32&&(An(T,""),s.flags&=-33);var b=Yf(n);oc(n,b,T);break;case 3:case 4:var N=s.stateNode.containerInfo,Y=Yf(n);Ff(n,Y,N);break;default:throw Error(r(161))}}catch(Q){rt(n,n.return,Q)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Eg(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;Eg(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function pa(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)mg(n,a.alternate,a),a=a.sibling}function Xr(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:Ya(4,a,a.return),Xr(a);break;case 1:Wi(a,a.return);var s=a.stateNode;typeof s.componentWillUnmount=="function"&&ug(a,a.return,s),Xr(a);break;case 27:vl(a.stateNode);case 26:case 5:Wi(a,a.return),Xr(a);break;case 22:a.memoizedState===null&&Xr(a);break;case 30:Xr(a);break;default:Xr(a)}n=n.sibling}}function ga(n,a,s){for(s=s&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var l=a.alternate,f=n,d=a,T=d.flags;switch(d.tag){case 0:case 11:case 15:ga(f,d,s),hl(4,d);break;case 1:if(ga(f,d,s),l=d,f=l.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Y){rt(l,l.return,Y)}if(l=d,f=l.updateQueue,f!==null){var b=l.stateNode;try{var N=f.shared.hiddenCallbacks;if(N!==null)for(f.shared.hiddenCallbacks=null,f=0;f<N.length;f++)$_(N[f],b)}catch(Y){rt(l,l.return,Y)}}s&&T&64&&lg(d),fl(d,d.return);break;case 27:fg(d);case 26:case 5:ga(f,d,s),s&&l===null&&T&4&&cg(d),fl(d,d.return);break;case 12:ga(f,d,s);break;case 31:ga(f,d,s),s&&T&4&&gg(f,d);break;case 13:ga(f,d,s),s&&T&4&&yg(f,d);break;case 22:d.memoizedState===null&&ga(f,d,s),fl(d,d.return);break;case 30:break;default:ga(f,d,s)}a=a.sibling}}function Xf(n,a){var s=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(s=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==s&&(n!=null&&n.refCount++,s!=null&&Zo(s))}function Kf(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Zo(n))}function Ei(n,a,s,l){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)vg(n,a,s,l),a=a.sibling}function vg(n,a,s,l){var f=a.flags;switch(a.tag){case 0:case 11:case 15:Ei(n,a,s,l),f&2048&&hl(9,a);break;case 1:Ei(n,a,s,l);break;case 3:Ei(n,a,s,l),f&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Zo(n)));break;case 12:if(f&2048){Ei(n,a,s,l),n=a.stateNode;try{var d=a.memoizedProps,T=d.id,b=d.onPostCommit;typeof b=="function"&&b(T,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(N){rt(a,a.return,N)}}else Ei(n,a,s,l);break;case 31:Ei(n,a,s,l);break;case 13:Ei(n,a,s,l);break;case 23:break;case 22:d=a.stateNode,T=a.alternate,a.memoizedState!==null?d._visibility&2?Ei(n,a,s,l):dl(n,a):d._visibility&2?Ei(n,a,s,l):(d._visibility|=2,Ps(n,a,s,l,(a.subtreeFlags&10256)!==0||!1)),f&2048&&Xf(T,a);break;case 24:Ei(n,a,s,l),f&2048&&Kf(a.alternate,a);break;default:Ei(n,a,s,l)}}function Ps(n,a,s,l,f){for(f=f&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var d=n,T=a,b=s,N=l,Y=T.flags;switch(T.tag){case 0:case 11:case 15:Ps(d,T,b,N,f),hl(8,T);break;case 23:break;case 22:var Q=T.stateNode;T.memoizedState!==null?Q._visibility&2?Ps(d,T,b,N,f):dl(d,T):(Q._visibility|=2,Ps(d,T,b,N,f)),f&&Y&2048&&Xf(T.alternate,T);break;case 24:Ps(d,T,b,N,f),f&&Y&2048&&Kf(T.alternate,T);break;default:Ps(d,T,b,N,f)}a=a.sibling}}function dl(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var s=n,l=a,f=l.flags;switch(l.tag){case 22:dl(s,l),f&2048&&Xf(l.alternate,l);break;case 24:dl(s,l),f&2048&&Kf(l.alternate,l);break;default:dl(s,l)}a=a.sibling}}var ml=8192;function xs(n,a,s){if(n.subtreeFlags&ml)for(n=n.child;n!==null;)wg(n,a,s),n=n.sibling}function wg(n,a,s){switch(n.tag){case 26:xs(n,a,s),n.flags&ml&&n.memoizedState!==null&&Bw(s,Ti,n.memoizedState,n.memoizedProps);break;case 5:xs(n,a,s);break;case 3:case 4:var l=Ti;Ti=wc(n.stateNode.containerInfo),xs(n,a,s),Ti=l;break;case 22:n.memoizedState===null&&(l=n.alternate,l!==null&&l.memoizedState!==null?(l=ml,ml=16777216,xs(n,a,s),ml=l):xs(n,a,s));break;default:xs(n,a,s)}}function bg(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function _l(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];Zt=l,Sg(l,n)}bg(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ag(n),n=n.sibling}function Ag(n){switch(n.tag){case 0:case 11:case 15:_l(n),n.flags&2048&&Ya(9,n,n.return);break;case 3:_l(n);break;case 12:_l(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,uc(n)):_l(n);break;default:_l(n)}}function uc(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];Zt=l,Sg(l,n)}bg(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:Ya(8,a,a.return),uc(a);break;case 22:s=a.stateNode,s._visibility&2&&(s._visibility&=-3,uc(a));break;default:uc(a)}n=n.sibling}}function Sg(n,a){for(;Zt!==null;){var s=Zt;switch(s.tag){case 0:case 11:case 15:Ya(8,s,a);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var l=s.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Zo(s.memoizedState.cache)}if(l=s.child,l!==null)l.return=s,Zt=l;else e:for(s=n;Zt!==null;){l=Zt;var f=l.sibling,d=l.return;if(_g(l),l===s){Zt=null;break e}if(f!==null){f.return=d,Zt=f;break e}Zt=d}}}var nw={getCacheForType:function(n){var a=on(Pt),s=a.data.get(n);return s===void 0&&(s=n(),a.data.set(n,s)),s},cacheSignal:function(){return on(Pt).controller.signal}},iw=typeof WeakMap=="function"?WeakMap:Map,et=0,ht=null,Pe=null,ze=0,at=0,Gn=null,Fa=!1,zs=!1,Qf=!1,ya=0,St=0,Wa=0,Kr=0,$f=0,jn=0,Us=0,pl=null,kn=null,Zf=!1,cc=0,Rg=0,hc=1/0,fc=null,Xa=null,Wt=0,Ka=null,Bs=null,Ta=0,Jf=0,ed=null,Ig=null,gl=0,td=null;function qn(){return(et&2)!==0&&ze!==0?ze&-ze:$.T!==null?od():du()}function kg(){if(jn===0)if((ze&536870912)===0||je){var n=wr;wr<<=1,(wr&3932160)===0&&(wr=262144),jn=n}else jn=536870912;return n=Un.current,n!==null&&(n.flags|=32),jn}function Dn(n,a,s){(n===ht&&(at===2||at===9)||n.cancelPendingCommit!==null)&&(Gs(n,0),Qa(n,ze,jn,!1)),br(n,s),((et&2)===0||n!==ht)&&(n===ht&&((et&2)===0&&(Kr|=s),St===4&&Qa(n,ze,jn,!1)),Xi(n))}function Dg(n,a,s){if((et&6)!==0)throw Error(r(327));var l=!s&&(a&127)===0&&(a&n.expiredLanes)===0||ci(n,a),f=l?sw(n,a):id(n,a,!0),d=l;do{if(f===0){zs&&!l&&Qa(n,a,0,!1);break}else{if(s=n.current.alternate,d&&!aw(s)){f=id(n,a,!1),d=!1;continue}if(f===2){if(d=a,n.errorRecoveryDisabledLanes&d)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){a=T;e:{var b=n;f=pl;var N=b.current.memoizedState.isDehydrated;if(N&&(Gs(b,T).flags|=256),T=id(b,T,!1),T!==2){if(Qf&&!N){b.errorRecoveryDisabledLanes|=d,Kr|=d,f=4;break e}d=kn,kn=f,d!==null&&(kn===null?kn=d:kn.push.apply(kn,d))}f=T}if(d=!1,f!==2)continue}}if(f===1){Gs(n,0),Qa(n,a,0,!0);break}e:{switch(l=n,d=f,d){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:Qa(l,a,jn,!Fa);break e;case 2:kn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(f=cc+300-En(),10<f)){if(Qa(l,a,jn,!Fa),Oi(l,0,!0)!==0)break e;Ta=a,l.timeoutHandle=sy(Og.bind(null,l,s,kn,fc,Zf,a,jn,Kr,Us,Fa,d,"Throttled",-0,0),f);break e}Og(l,s,kn,fc,Zf,a,jn,Kr,Us,Fa,d,null,-0,0)}}break}while(!0);Xi(n)}function Og(n,a,s,l,f,d,T,b,N,Y,Q,ee,F,X){if(n.timeoutHandle=-1,ee=a.subtreeFlags,ee&8192||(ee&16785408)===16785408){ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:di},wg(a,d,ee);var me=(d&62914560)===d?cc-En():(d&4194048)===d?Rg-En():0;if(me=Gw(ee,me),me!==null){Ta=d,n.cancelPendingCommit=me(xg.bind(null,n,a,d,s,l,f,T,b,N,Q,ee,null,F,X)),Qa(n,d,T,!Y);return}}xg(n,a,d,s,l,f,T,b,N)}function aw(n){for(var a=n;;){var s=a.tag;if((s===0||s===11||s===15)&&a.flags&16384&&(s=a.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var l=0;l<s.length;l++){var f=s[l],d=f.getSnapshot;f=f.value;try{if(!xn(d(),f))return!1}catch{return!1}}if(s=a.child,a.subtreeFlags&16384&&s!==null)s.return=a,a=s;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Qa(n,a,s,l){a&=~$f,a&=~Kr,n.suspendedLanes|=a,n.pingedLanes&=~a,l&&(n.warmLanes|=a),l=n.expirationTimes;for(var f=a;0<f;){var d=31-It(f),T=1<<d;l[d]=-1,f&=~T}s!==0&&Ar(n,s,a)}function dc(){return(et&6)===0?(yl(0),!1):!0}function nd(){if(Pe!==null){if(at===0)var n=Pe.return;else n=Pe,la=Ur=null,yf(n),Ns=null,el=0,n=Pe;for(;n!==null;)og(n.alternate,n),n=n.return;Pe=null}}function Gs(n,a){var s=n.timeoutHandle;s!==-1&&(n.timeoutHandle=-1,Aw(s)),s=n.cancelPendingCommit,s!==null&&(n.cancelPendingCommit=null,s()),Ta=0,nd(),ht=n,Pe=s=sa(n.current,null),ze=a,at=0,Gn=null,Fa=!1,zs=ci(n,a),Qf=!1,Us=jn=$f=Kr=Wa=St=0,kn=pl=null,Zf=!1,(a&8)!==0&&(a|=a&32);var l=n.entangledLanes;if(l!==0)for(n=n.entanglements,l&=a;0<l;){var f=31-It(l),d=1<<f;a|=n[f],l&=~d}return ya=a,Vu(),s}function Cg(n,a){Me=null,$.H=ll,a===Cs||a===Gu?(a=W_(),at=3):a===sf?(a=W_(),at=4):at=a===Vf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Gn=a,Pe===null&&(St=1,nc(n,$n(a,n.current)))}function Ng(){var n=Un.current;return n===null?!0:(ze&4194048)===ze?ti===null:(ze&62914560)===ze||(ze&536870912)!==0?n===ti:!1}function Mg(){var n=$.H;return $.H=ll,n===null?ll:n}function Vg(){var n=$.A;return $.A=nw,n}function mc(){St=4,Fa||(ze&4194048)!==ze&&Un.current!==null||(zs=!0),(Wa&134217727)===0&&(Kr&134217727)===0||ht===null||Qa(ht,ze,jn,!1)}function id(n,a,s){var l=et;et|=2;var f=Mg(),d=Vg();(ht!==n||ze!==a)&&(fc=null,Gs(n,a)),a=!1;var T=St;e:do try{if(at!==0&&Pe!==null){var b=Pe,N=Gn;switch(at){case 8:nd(),T=6;break e;case 3:case 2:case 9:case 6:Un.current===null&&(a=!0);var Y=at;if(at=0,Gn=null,js(n,b,N,Y),s&&zs){T=0;break e}break;default:Y=at,at=0,Gn=null,js(n,b,N,Y)}}rw(),T=St;break}catch(Q){Cg(n,Q)}while(!0);return a&&n.shellSuspendCounter++,la=Ur=null,et=l,$.H=f,$.A=d,Pe===null&&(ht=null,ze=0,Vu()),T}function rw(){for(;Pe!==null;)Lg(Pe)}function sw(n,a){var s=et;et|=2;var l=Mg(),f=Vg();ht!==n||ze!==a?(fc=null,hc=En()+500,Gs(n,a)):zs=ci(n,a);e:do try{if(at!==0&&Pe!==null){a=Pe;var d=Gn;t:switch(at){case 1:at=0,Gn=null,js(n,a,d,1);break;case 2:case 9:if(Y_(d)){at=0,Gn=null,Hg(a);break}a=function(){at!==2&&at!==9||ht!==n||(at=7),Xi(n)},d.then(a,a);break e;case 3:at=7;break e;case 4:at=5;break e;case 7:Y_(d)?(at=0,Gn=null,Hg(a)):(at=0,Gn=null,js(n,a,d,7));break;case 5:var T=null;switch(Pe.tag){case 26:T=Pe.memoizedState;case 5:case 27:var b=Pe;if(T?vy(T):b.stateNode.complete){at=0,Gn=null;var N=b.sibling;if(N!==null)Pe=N;else{var Y=b.return;Y!==null?(Pe=Y,_c(Y)):Pe=null}break t}}at=0,Gn=null,js(n,a,d,5);break;case 6:at=0,Gn=null,js(n,a,d,6);break;case 8:nd(),St=6;break e;default:throw Error(r(462))}}ow();break}catch(Q){Cg(n,Q)}while(!0);return la=Ur=null,$.H=l,$.A=f,et=s,Pe!==null?0:(ht=null,ze=0,Vu(),St)}function ow(){for(;Pe!==null&&!Nh();)Lg(Pe)}function Lg(n){var a=rg(n.alternate,n,ya);n.memoizedProps=n.pendingProps,a===null?_c(n):Pe=a}function Hg(n){var a=n,s=a.alternate;switch(a.tag){case 15:case 0:a=Jp(s,a,a.pendingProps,a.type,void 0,ze);break;case 11:a=Jp(s,a,a.pendingProps,a.type.render,a.ref,ze);break;case 5:yf(a);default:og(s,a),a=Pe=V_(a,ya),a=rg(s,a,ya)}n.memoizedProps=n.pendingProps,a===null?_c(n):Pe=a}function js(n,a,s,l){la=Ur=null,yf(a),Ns=null,el=0;var f=a.return;try{if(Kv(n,f,a,s,ze)){St=1,nc(n,$n(s,n.current)),Pe=null;return}}catch(d){if(f!==null)throw Pe=f,d;St=1,nc(n,$n(s,n.current)),Pe=null;return}a.flags&32768?(je||l===1?n=!0:zs||(ze&536870912)!==0?n=!1:(Fa=n=!0,(l===2||l===9||l===3||l===6)&&(l=Un.current,l!==null&&l.tag===13&&(l.flags|=16384))),Pg(a,n)):_c(a)}function _c(n){var a=n;do{if((a.flags&32768)!==0){Pg(a,Fa);return}n=a.return;var s=Zv(a.alternate,a,ya);if(s!==null){Pe=s;return}if(a=a.sibling,a!==null){Pe=a;return}Pe=a=n}while(a!==null);St===0&&(St=5)}function Pg(n,a){do{var s=Jv(n.alternate,n);if(s!==null){s.flags&=32767,Pe=s;return}if(s=n.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!a&&(n=n.sibling,n!==null)){Pe=n;return}Pe=n=s}while(n!==null);St=6,Pe=null}function xg(n,a,s,l,f,d,T,b,N){n.cancelPendingCommit=null;do pc();while(Wt!==0);if((et&6)!==0)throw Error(r(327));if(a!==null){if(a===n.current)throw Error(r(177));if(d=a.lanes|a.childLanes,d|=qh,Lh(n,s,d,T,b,N),n===ht&&(Pe=ht=null,ze=0),Bs=a,Ka=n,Ta=s,Jf=d,ed=f,Ig=l,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,hw(Ra,function(){return jg(),null})):(n.callbackNode=null,n.callbackPriority=0),l=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||l){l=$.T,$.T=null,f=ue.p,ue.p=2,T=et,et|=4;try{ew(n,a,s)}finally{et=T,ue.p=f,$.T=l}}Wt=1,zg(),Ug(),Bg()}}function zg(){if(Wt===1){Wt=0;var n=Ka,a=Bs,s=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||s){s=$.T,$.T=null;var l=ue.p;ue.p=2;var f=et;et|=4;try{Tg(a,n);var d=_d,T=S_(n.containerInfo),b=d.focusedElem,N=d.selectionRange;if(T!==b&&b&&b.ownerDocument&&A_(b.ownerDocument.documentElement,b)){if(N!==null&&zh(b)){var Y=N.start,Q=N.end;if(Q===void 0&&(Q=Y),"selectionStart"in b)b.selectionStart=Y,b.selectionEnd=Math.min(Q,b.value.length);else{var ee=b.ownerDocument||document,F=ee&&ee.defaultView||window;if(F.getSelection){var X=F.getSelection(),me=b.textContent.length,be=Math.min(N.start,me),ut=N.end===void 0?be:Math.min(N.end,me);!X.extend&&be>ut&&(T=ut,ut=be,be=T);var U=b_(b,be),P=b_(b,ut);if(U&&P&&(X.rangeCount!==1||X.anchorNode!==U.node||X.anchorOffset!==U.offset||X.focusNode!==P.node||X.focusOffset!==P.offset)){var q=ee.createRange();q.setStart(U.node,U.offset),X.removeAllRanges(),be>ut?(X.addRange(q),X.extend(P.node,P.offset)):(q.setEnd(P.node,P.offset),X.addRange(q))}}}}for(ee=[],X=b;X=X.parentNode;)X.nodeType===1&&ee.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<ee.length;b++){var Z=ee[b];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}kc=!!md,_d=md=null}finally{et=f,ue.p=l,$.T=s}}n.current=a,Wt=2}}function Ug(){if(Wt===2){Wt=0;var n=Ka,a=Bs,s=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||s){s=$.T,$.T=null;var l=ue.p;ue.p=2;var f=et;et|=4;try{mg(n,a.alternate,a)}finally{et=f,ue.p=l,$.T=s}}Wt=3}}function Bg(){if(Wt===4||Wt===3){Wt=0,su();var n=Ka,a=Bs,s=Ta,l=Ig;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Wt=5:(Wt=0,Bs=Ka=null,Gg(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Xa=null),na(s),a=a.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(ui,a,void 0,(a.current.flags&128)===128)}catch{}if(l!==null){a=$.T,f=ue.p,ue.p=2,$.T=null;try{for(var d=n.onRecoverableError,T=0;T<l.length;T++){var b=l[T];d(b.value,{componentStack:b.stack})}}finally{$.T=a,ue.p=f}}(Ta&3)!==0&&pc(),Xi(n),f=n.pendingLanes,(s&261930)!==0&&(f&42)!==0?n===td?gl++:(gl=0,td=n):gl=0,yl(0)}}function Gg(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,Zo(a)))}function pc(){return zg(),Ug(),Bg(),jg()}function jg(){if(Wt!==5)return!1;var n=Ka,a=Jf;Jf=0;var s=na(Ta),l=$.T,f=ue.p;try{ue.p=32>s?32:s,$.T=null,s=ed,ed=null;var d=Ka,T=Ta;if(Wt=0,Bs=Ka=null,Ta=0,(et&6)!==0)throw Error(r(331));var b=et;if(et|=4,Ag(d.current),vg(d,d.current,T,s),et=b,yl(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(ui,d)}catch{}return!0}finally{ue.p=f,$.T=l,Gg(n,a)}}function qg(n,a,s){a=$n(s,a),a=Mf(n.stateNode,a,2),n=Ga(n,a,2),n!==null&&(br(n,2),Xi(n))}function rt(n,a,s){if(n.tag===3)qg(n,n,s);else for(;a!==null;){if(a.tag===3){qg(a,n,s);break}else if(a.tag===1){var l=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Xa===null||!Xa.has(l))){n=$n(s,n),s=Yp(2),l=Ga(a,s,2),l!==null&&(Fp(s,l,a,n),br(l,2),Xi(l));break}}a=a.return}}function ad(n,a,s){var l=n.pingCache;if(l===null){l=n.pingCache=new iw;var f=new Set;l.set(a,f)}else f=l.get(a),f===void 0&&(f=new Set,l.set(a,f));f.has(s)||(Qf=!0,f.add(s),n=lw.bind(null,n,a,s),a.then(n,n))}function lw(n,a,s){var l=n.pingCache;l!==null&&l.delete(a),n.pingedLanes|=n.suspendedLanes&s,n.warmLanes&=~s,ht===n&&(ze&s)===s&&(St===4||St===3&&(ze&62914560)===ze&&300>En()-cc?(et&2)===0&&Gs(n,0):$f|=s,Us===ze&&(Us=0)),Xi(n)}function Yg(n,a){a===0&&(a=fu()),n=Pr(n,a),n!==null&&(br(n,a),Xi(n))}function uw(n){var a=n.memoizedState,s=0;a!==null&&(s=a.retryLane),Yg(n,s)}function cw(n,a){var s=0;switch(n.tag){case 31:case 13:var l=n.stateNode,f=n.memoizedState;f!==null&&(s=f.retryLane);break;case 19:l=n.stateNode;break;case 22:l=n.stateNode._retryCache;break;default:throw Error(r(314))}l!==null&&l.delete(a),Yg(n,s)}function hw(n,a){return Ft(n,a)}var gc=null,qs=null,rd=!1,yc=!1,sd=!1,$a=0;function Xi(n){n!==qs&&n.next===null&&(qs===null?gc=qs=n:qs=qs.next=n),yc=!0,rd||(rd=!0,dw())}function yl(n,a){if(!sd&&yc){sd=!0;do for(var s=!1,l=gc;l!==null;){if(n!==0){var f=l.pendingLanes;if(f===0)var d=0;else{var T=l.suspendedLanes,b=l.pingedLanes;d=(1<<31-It(42|n)+1)-1,d&=f&~(T&~b),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(s=!0,Kg(l,d))}else d=ze,d=Oi(l,l===ht?d:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(d&3)===0||ci(l,d)||(s=!0,Kg(l,d));l=l.next}while(s);sd=!1}}function fw(){Fg()}function Fg(){yc=rd=!1;var n=0;$a!==0&&bw()&&(n=$a);for(var a=En(),s=null,l=gc;l!==null;){var f=l.next,d=Wg(l,a);d===0?(l.next=null,s===null?gc=f:s.next=f,f===null&&(qs=s)):(s=l,(n!==0||(d&3)!==0)&&(yc=!0)),l=f}Wt!==0&&Wt!==5||yl(n),$a!==0&&($a=0)}function Wg(n,a){for(var s=n.suspendedLanes,l=n.pingedLanes,f=n.expirationTimes,d=n.pendingLanes&-62914561;0<d;){var T=31-It(d),b=1<<T,N=f[T];N===-1?((b&s)===0||(b&l)!==0)&&(f[T]=Vh(b,a)):N<=a&&(n.expiredLanes|=b),d&=~b}if(a=ht,s=ze,s=Oi(n,n===a?s:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),l=n.callbackNode,s===0||n===a&&(at===2||at===9)||n.cancelPendingCommit!==null)return l!==null&&l!==null&&Sa(l),n.callbackNode=null,n.callbackPriority=0;if((s&3)===0||ci(n,s)){if(a=s&-s,a===n.callbackPriority)return a;switch(l!==null&&Sa(l),na(s)){case 2:case 8:s=ko;break;case 32:s=Ra;break;case 268435456:s=ou;break;default:s=Ra}return l=Xg.bind(null,n),s=Ft(s,l),n.callbackPriority=a,n.callbackNode=s,a}return l!==null&&l!==null&&Sa(l),n.callbackPriority=2,n.callbackNode=null,2}function Xg(n,a){if(Wt!==0&&Wt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var s=n.callbackNode;if(pc()&&n.callbackNode!==s)return null;var l=ze;return l=Oi(n,n===ht?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),l===0?null:(Dg(n,l,a),Wg(n,En()),n.callbackNode!=null&&n.callbackNode===s?Xg.bind(null,n):null)}function Kg(n,a){if(pc())return null;Dg(n,a,!0)}function dw(){Sw(function(){(et&6)!==0?Ft(Io,fw):Fg()})}function od(){if($a===0){var n=Ds;n===0&&(n=ki,ki<<=1,(ki&261888)===0&&(ki=256)),$a=n}return $a}function Qg(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ms(""+n)}function $g(n,a){var s=a.ownerDocument.createElement("input");return s.name=a.name,s.value=a.value,n.id&&s.setAttribute("form",n.id),a.parentNode.insertBefore(s,a),n=new FormData(n),s.parentNode.removeChild(s),n}function mw(n,a,s,l,f){if(a==="submit"&&s&&s.stateNode===f){var d=Qg((f[Qt]||null).action),T=l.submitter;T&&(a=(a=T[Qt]||null)?Qg(a.formAction):T.getAttribute("formAction"),a!==null&&(d=a,T=null));var b=new Bi("action","action",null,l,f);n.push({event:b,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if($a!==0){var N=T?$g(f,T):new FormData(f);If(s,{pending:!0,data:N,method:f.method,action:d},null,N)}}else typeof d=="function"&&(b.preventDefault(),N=T?$g(f,T):new FormData(f),If(s,{pending:!0,data:N,method:f.method,action:d},d,N))},currentTarget:f}]})}}for(var ld=0;ld<jh.length;ld++){var ud=jh[ld],_w=ud.toLowerCase(),pw=ud[0].toUpperCase()+ud.slice(1);yi(_w,"on"+pw)}yi(k_,"onAnimationEnd"),yi(D_,"onAnimationIteration"),yi(O_,"onAnimationStart"),yi("dblclick","onDoubleClick"),yi("focusin","onFocus"),yi("focusout","onBlur"),yi(Nv,"onTransitionRun"),yi(Mv,"onTransitionStart"),yi(Vv,"onTransitionCancel"),yi(C_,"onTransitionEnd"),Pi("onMouseEnter",["mouseout","mouseover"]),Pi("onMouseLeave",["mouseout","mouseover"]),Pi("onPointerEnter",["pointerout","pointerover"]),Pi("onPointerLeave",["pointerout","pointerover"]),Hi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tl));function Zg(n,a){a=(a&4)!==0;for(var s=0;s<n.length;s++){var l=n[s],f=l.event;l=l.listeners;e:{var d=void 0;if(a)for(var T=l.length-1;0<=T;T--){var b=l[T],N=b.instance,Y=b.currentTarget;if(b=b.listener,N!==d&&f.isPropagationStopped())break e;d=b,f.currentTarget=Y;try{d(f)}catch(Q){Mu(Q)}f.currentTarget=null,d=N}else for(T=0;T<l.length;T++){if(b=l[T],N=b.instance,Y=b.currentTarget,b=b.listener,N!==d&&f.isPropagationStopped())break e;d=b,f.currentTarget=Y;try{d(f)}catch(Q){Mu(Q)}f.currentTarget=null,d=N}}}}function xe(n,a){var s=a[us];s===void 0&&(s=a[us]=new Set);var l=n+"__bubble";s.has(l)||(Jg(a,n,2,!1),s.add(l))}function cd(n,a,s){var l=0;a&&(l|=4),Jg(s,n,l,a)}var Tc="_reactListening"+Math.random().toString(36).slice(2);function hd(n){if(!n[Tc]){n[Tc]=!0,Co.forEach(function(s){s!=="selectionchange"&&(gw.has(s)||cd(s,!1,n),cd(s,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[Tc]||(a[Tc]=!0,cd("selectionchange",!1,a))}}function Jg(n,a,s,l){switch(ky(a)){case 2:var f=Yw;break;case 8:f=Fw;break;default:f=Rd}s=f.bind(null,a,s,n),f=void 0,!Dr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(f=!0),l?f!==void 0?n.addEventListener(a,s,{capture:!0,passive:f}):n.addEventListener(a,s,!0):f!==void 0?n.addEventListener(a,s,{passive:f}):n.addEventListener(a,s,!1)}function fd(n,a,s,l,f){var d=l;if((a&1)===0&&(a&2)===0&&l!==null)e:for(;;){if(l===null)return;var T=l.tag;if(T===3||T===4){var b=l.stateNode.containerInfo;if(b===f)break;if(T===4)for(T=l.return;T!==null;){var N=T.tag;if((N===3||N===4)&&T.stateNode.containerInfo===f)return;T=T.return}for(;b!==null;){if(T=Vi(b),T===null)return;if(N=T.tag,N===5||N===6||N===26||N===27){l=d=T;continue e}b=b.parentNode}}l=l.return}Na(function(){var Y=d,Q=Wn(s),ee=[];e:{var F=N_.get(n);if(F!==void 0){var X=Bi,me=n;switch(n){case"keypress":if(Cr(s)===0)break e;case"keydown":case"keyup":X=Ou;break;case"focusin":me="focus",X=Mr;break;case"focusout":me="blur",X=Mr;break;case"beforeblur":case"afterblur":X=Mr;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=vu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=g;break;case k_:case D_:case O_:X=bu;break;case C_:X=A;break;case"scroll":case"scrollend":X=jo;break;case"wheel":X=W;break;case"copy":case"cut":case"paste":X=Au;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=ra;break;case"toggle":case"beforetoggle":X=Ne}var be=(a&4)!==0,ut=!be&&(n==="scroll"||n==="scrollend"),U=be?F!==null?F+"Capture":null:F;be=[];for(var P=Y,q;P!==null;){var Z=P;if(q=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||q===null||U===null||(Z=mi(P,U),Z!=null&&be.push(El(P,Z,q))),ut)break;P=P.return}0<be.length&&(F=new X(F,me,null,s,Q),ee.push({event:F,listeners:be}))}}if((a&7)===0){e:{if(F=n==="mouseover"||n==="pointerover",X=n==="mouseout"||n==="pointerout",F&&s!==Uo&&(me=s.relatedTarget||s.fromElement)&&(Vi(me)||me[Ni]))break e;if((X||F)&&(F=Q.window===Q?Q:(F=Q.ownerDocument)?F.defaultView||F.parentWindow:window,X?(me=s.relatedTarget||s.toElement,X=Y,me=me?Vi(me):null,me!==null&&(ut=u(me),be=me.tag,me!==ut||be!==5&&be!==27&&be!==6)&&(me=null)):(X=null,me=Y),X!==me)){if(be=qo,Z="onMouseLeave",U="onMouseEnter",P="mouse",(n==="pointerout"||n==="pointerover")&&(be=ra,Z="onPointerLeave",U="onPointerEnter",P="pointer"),ut=X==null?F:Hn(X),q=me==null?F:Hn(me),F=new be(Z,P+"leave",X,s,Q),F.target=ut,F.relatedTarget=q,Z=null,Vi(Q)===Y&&(be=new be(U,P+"enter",me,s,Q),be.target=q,be.relatedTarget=ut,Z=be),ut=Z,X&&me)t:{for(be=yw,U=X,P=me,q=0,Z=U;Z;Z=be(Z))q++;Z=0;for(var ge=P;ge;ge=be(ge))Z++;for(;0<q-Z;)U=be(U),q--;for(;0<Z-q;)P=be(P),Z--;for(;q--;){if(U===P||P!==null&&U===P.alternate){be=U;break t}U=be(U),P=be(P)}be=null}else be=null;X!==null&&ey(ee,F,X,be,!1),me!==null&&ut!==null&&ey(ee,ut,me,be,!0)}}e:{if(F=Y?Hn(Y):window,X=F.nodeName&&F.nodeName.toLowerCase(),X==="select"||X==="input"&&F.type==="file")var Qe=g_;else if(__(F))if(y_)Qe=Dv;else{Qe=Iv;var pe=Rv}else X=F.nodeName,!X||X.toLowerCase()!=="input"||F.type!=="checkbox"&&F.type!=="radio"?Y&&ds(Y.elementType)&&(Qe=g_):Qe=kv;if(Qe&&(Qe=Qe(n,Y))){p_(ee,Qe,s,Q);break e}pe&&pe(n,F,Y),n==="focusout"&&Y&&F.type==="number"&&Y.memoizedProps.value!=null&&Po(F,"number",F.value)}switch(pe=Y?Hn(Y):window,n){case"focusin":(__(pe)||pe.contentEditable==="true")&&(vs=pe,Uh=Y,Ko=null);break;case"focusout":Ko=Uh=vs=null;break;case"mousedown":Bh=!0;break;case"contextmenu":case"mouseup":case"dragend":Bh=!1,R_(ee,s,Q);break;case"selectionchange":if(Cv)break;case"keydown":case"keyup":R_(ee,s,Q)}var He;if(Je)e:{switch(n){case"compositionstart":var Ue="onCompositionStart";break e;case"compositionend":Ue="onCompositionEnd";break e;case"compositionupdate":Ue="onCompositionUpdate";break e}Ue=void 0}else Es?Vr(n,s)&&(Ue="onCompositionEnd"):n==="keydown"&&s.keyCode===229&&(Ue="onCompositionStart");Ue&&(qi&&s.locale!=="ko"&&(Es||Ue!=="onCompositionStart"?Ue==="onCompositionEnd"&&Es&&(He=Go()):(Ui=Q,Bo="value"in Ui?Ui.value:Ui.textContent,Es=!0)),pe=Ec(Y,Ue),0<pe.length&&(Ue=new ji(Ue,n,null,s,Q),ee.push({event:Ue,listeners:pe}),He?Ue.data=He:(He=Ts(s),He!==null&&(Ue.data=He)))),(He=Kn?wv(n,s):bv(n,s))&&(Ue=Ec(Y,"onBeforeInput"),0<Ue.length&&(pe=new ji("onBeforeInput","beforeinput",null,s,Q),ee.push({event:pe,listeners:Ue}),pe.data=He)),mw(ee,n,Y,s,Q)}Zg(ee,a)})}function El(n,a,s){return{instance:n,listener:a,currentTarget:s}}function Ec(n,a){for(var s=a+"Capture",l=[];n!==null;){var f=n,d=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||d===null||(f=mi(n,s),f!=null&&l.unshift(El(n,f,d)),f=mi(n,a),f!=null&&l.push(El(n,f,d))),n.tag===3)return l;n=n.return}return[]}function yw(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function ey(n,a,s,l,f){for(var d=a._reactName,T=[];s!==null&&s!==l;){var b=s,N=b.alternate,Y=b.stateNode;if(b=b.tag,N!==null&&N===l)break;b!==5&&b!==26&&b!==27||Y===null||(N=Y,f?(Y=mi(s,d),Y!=null&&T.unshift(El(s,Y,N))):f||(Y=mi(s,d),Y!=null&&T.push(El(s,Y,N)))),s=s.return}T.length!==0&&n.push({event:a,listeners:T})}var Tw=/\r\n?/g,Ew=/\u0000|\uFFFD/g;function ty(n){return(typeof n=="string"?n:""+n).replace(Tw,`
`).replace(Ew,"")}function ny(n,a){return a=ty(a),ty(n)===a}function lt(n,a,s,l,f,d){switch(s){case"children":typeof l=="string"?a==="body"||a==="textarea"&&l===""||An(n,l):(typeof l=="number"||typeof l=="bigint")&&a!=="body"&&An(n,""+l);break;case"className":Pn(n,"class",l);break;case"tabIndex":Pn(n,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Pn(n,s,l);break;case"style":zo(n,l,d);break;case"data":if(a!=="object"){Pn(n,"data",l);break}case"src":case"href":if(l===""&&(a!=="a"||s!=="href")){n.removeAttribute(s);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){n.removeAttribute(s);break}l=ms(""+l),n.setAttribute(s,l);break;case"action":case"formAction":if(typeof l=="function"){n.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(s==="formAction"?(a!=="input"&&lt(n,a,"name",f.name,f,null),lt(n,a,"formEncType",f.formEncType,f,null),lt(n,a,"formMethod",f.formMethod,f,null),lt(n,a,"formTarget",f.formTarget,f,null)):(lt(n,a,"encType",f.encType,f,null),lt(n,a,"method",f.method,f,null),lt(n,a,"target",f.target,f,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){n.removeAttribute(s);break}l=ms(""+l),n.setAttribute(s,l);break;case"onClick":l!=null&&(n.onclick=di);break;case"onScroll":l!=null&&xe("scroll",n);break;case"onScrollEnd":l!=null&&xe("scrollend",n);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(s=l.__html,s!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=s}}break;case"multiple":n.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":n.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){n.removeAttribute("xlink:href");break}s=ms(""+l),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(s,""+l):n.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(s,""):n.removeAttribute(s);break;case"capture":case"download":l===!0?n.setAttribute(s,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(s,l):n.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?n.setAttribute(s,l):n.removeAttribute(s);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?n.removeAttribute(s):n.setAttribute(s,l);break;case"popover":xe("beforetoggle",n),xe("toggle",n),hs(n,"popover",l);break;case"xlinkActuate":Ht(n,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Ht(n,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Ht(n,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Ht(n,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Ht(n,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Ht(n,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Ht(n,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Ht(n,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Ht(n,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":hs(n,"is",l);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=Eu.get(s)||s,hs(n,s,l))}}function dd(n,a,s,l,f,d){switch(s){case"style":zo(n,l,d);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(s=l.__html,s!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=s}}break;case"children":typeof l=="string"?An(n,l):(typeof l=="number"||typeof l=="bigint")&&An(n,""+l);break;case"onScroll":l!=null&&xe("scroll",n);break;case"onScrollEnd":l!=null&&xe("scrollend",n);break;case"onClick":l!=null&&(n.onclick=di);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!No.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(f=s.endsWith("Capture"),a=s.slice(2,f?s.length-7:void 0),d=n[Qt]||null,d=d!=null?d[s]:null,typeof d=="function"&&n.removeEventListener(a,d,f),typeof l=="function")){typeof d!="function"&&d!==null&&(s in n?n[s]=null:n.hasAttribute(s)&&n.removeAttribute(s)),n.addEventListener(a,l,f);break e}s in n?n[s]=l:l===!0?n.setAttribute(s,""):hs(n,s,l)}}}function un(n,a,s){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xe("error",n),xe("load",n);var l=!1,f=!1,d;for(d in s)if(s.hasOwnProperty(d)){var T=s[d];if(T!=null)switch(d){case"src":l=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:lt(n,a,d,T,s,null)}}f&&lt(n,a,"srcSet",s.srcSet,s,null),l&&lt(n,a,"src",s.src,s,null);return;case"input":xe("invalid",n);var b=d=T=f=null,N=null,Y=null;for(l in s)if(s.hasOwnProperty(l)){var Q=s[l];if(Q!=null)switch(l){case"name":f=Q;break;case"type":T=Q;break;case"checked":N=Q;break;case"defaultChecked":Y=Q;break;case"value":d=Q;break;case"defaultValue":b=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(r(137,a));break;default:lt(n,a,l,Q,s,null)}}gu(n,d,b,N,Y,T,f,!1);return;case"select":xe("invalid",n),l=T=d=null;for(f in s)if(s.hasOwnProperty(f)&&(b=s[f],b!=null))switch(f){case"value":d=b;break;case"defaultValue":T=b;break;case"multiple":l=b;default:lt(n,a,f,b,s,null)}a=d,s=T,n.multiple=!!l,a!=null?ka(n,!!l,a,!1):s!=null&&ka(n,!!l,s,!0);return;case"textarea":xe("invalid",n),d=f=l=null;for(T in s)if(s.hasOwnProperty(T)&&(b=s[T],b!=null))switch(T){case"value":l=b;break;case"defaultValue":f=b;break;case"children":d=b;break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:lt(n,a,T,b,s,null)}Da(n,l,f,d);return;case"option":for(N in s)s.hasOwnProperty(N)&&(l=s[N],l!=null)&&(N==="selected"?n.selected=l&&typeof l!="function"&&typeof l!="symbol":lt(n,a,N,l,s,null));return;case"dialog":xe("beforetoggle",n),xe("toggle",n),xe("cancel",n),xe("close",n);break;case"iframe":case"object":xe("load",n);break;case"video":case"audio":for(l=0;l<Tl.length;l++)xe(Tl[l],n);break;case"image":xe("error",n),xe("load",n);break;case"details":xe("toggle",n);break;case"embed":case"source":case"link":xe("error",n),xe("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in s)if(s.hasOwnProperty(Y)&&(l=s[Y],l!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:lt(n,a,Y,l,s,null)}return;default:if(ds(a)){for(Q in s)s.hasOwnProperty(Q)&&(l=s[Q],l!==void 0&&dd(n,a,Q,l,s,void 0));return}}for(b in s)s.hasOwnProperty(b)&&(l=s[b],l!=null&&lt(n,a,b,l,s,null))}function vw(n,a,s,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,d=null,T=null,b=null,N=null,Y=null,Q=null;for(X in s){var ee=s[X];if(s.hasOwnProperty(X)&&ee!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":N=ee;default:l.hasOwnProperty(X)||lt(n,a,X,null,l,ee)}}for(var F in l){var X=l[F];if(ee=s[F],l.hasOwnProperty(F)&&(X!=null||ee!=null))switch(F){case"type":d=X;break;case"name":f=X;break;case"checked":Y=X;break;case"defaultChecked":Q=X;break;case"value":T=X;break;case"defaultValue":b=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,a));break;default:X!==ee&&lt(n,a,F,X,l,ee)}}fs(n,T,b,N,Y,Q,d,f);return;case"select":X=T=b=F=null;for(d in s)if(N=s[d],s.hasOwnProperty(d)&&N!=null)switch(d){case"value":break;case"multiple":X=N;default:l.hasOwnProperty(d)||lt(n,a,d,null,l,N)}for(f in l)if(d=l[f],N=s[f],l.hasOwnProperty(f)&&(d!=null||N!=null))switch(f){case"value":F=d;break;case"defaultValue":b=d;break;case"multiple":T=d;default:d!==N&&lt(n,a,f,d,l,N)}a=b,s=T,l=X,F!=null?ka(n,!!s,F,!1):!!l!=!!s&&(a!=null?ka(n,!!s,a,!0):ka(n,!!s,s?[]:"",!1));return;case"textarea":X=F=null;for(b in s)if(f=s[b],s.hasOwnProperty(b)&&f!=null&&!l.hasOwnProperty(b))switch(b){case"value":break;case"children":break;default:lt(n,a,b,null,l,f)}for(T in l)if(f=l[T],d=s[T],l.hasOwnProperty(T)&&(f!=null||d!=null))switch(T){case"value":F=f;break;case"defaultValue":X=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==d&&lt(n,a,T,f,l,d)}yu(n,F,X);return;case"option":for(var me in s)F=s[me],s.hasOwnProperty(me)&&F!=null&&!l.hasOwnProperty(me)&&(me==="selected"?n.selected=!1:lt(n,a,me,null,l,F));for(N in l)F=l[N],X=s[N],l.hasOwnProperty(N)&&F!==X&&(F!=null||X!=null)&&(N==="selected"?n.selected=F&&typeof F!="function"&&typeof F!="symbol":lt(n,a,N,F,l,X));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var be in s)F=s[be],s.hasOwnProperty(be)&&F!=null&&!l.hasOwnProperty(be)&&lt(n,a,be,null,l,F);for(Y in l)if(F=l[Y],X=s[Y],l.hasOwnProperty(Y)&&F!==X&&(F!=null||X!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(137,a));break;default:lt(n,a,Y,F,l,X)}return;default:if(ds(a)){for(var ut in s)F=s[ut],s.hasOwnProperty(ut)&&F!==void 0&&!l.hasOwnProperty(ut)&&dd(n,a,ut,void 0,l,F);for(Q in l)F=l[Q],X=s[Q],!l.hasOwnProperty(Q)||F===X||F===void 0&&X===void 0||dd(n,a,Q,F,l,X);return}}for(var U in s)F=s[U],s.hasOwnProperty(U)&&F!=null&&!l.hasOwnProperty(U)&&lt(n,a,U,null,l,F);for(ee in l)F=l[ee],X=s[ee],!l.hasOwnProperty(ee)||F===X||F==null&&X==null||lt(n,a,ee,F,l,X)}function iy(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ww(){if(typeof performance.getEntriesByType=="function"){for(var n=0,a=0,s=performance.getEntriesByType("resource"),l=0;l<s.length;l++){var f=s[l],d=f.transferSize,T=f.initiatorType,b=f.duration;if(d&&b&&iy(T)){for(T=0,b=f.responseEnd,l+=1;l<s.length;l++){var N=s[l],Y=N.startTime;if(Y>b)break;var Q=N.transferSize,ee=N.initiatorType;Q&&iy(ee)&&(N=N.responseEnd,T+=Q*(N<b?1:(b-Y)/(N-Y)))}if(--l,a+=8*(d+T)/(f.duration/1e3),n++,10<n)break}}if(0<n)return a/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var md=null,_d=null;function vc(n){return n.nodeType===9?n:n.ownerDocument}function ay(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ry(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function pd(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var gd=null;function bw(){var n=window.event;return n&&n.type==="popstate"?n===gd?!1:(gd=n,!0):(gd=null,!1)}var sy=typeof setTimeout=="function"?setTimeout:void 0,Aw=typeof clearTimeout=="function"?clearTimeout:void 0,oy=typeof Promise=="function"?Promise:void 0,Sw=typeof queueMicrotask=="function"?queueMicrotask:typeof oy<"u"?function(n){return oy.resolve(null).then(n).catch(Rw)}:sy;function Rw(n){setTimeout(function(){throw n})}function Za(n){return n==="head"}function ly(n,a){var s=a,l=0;do{var f=s.nextSibling;if(n.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"||s==="/&"){if(l===0){n.removeChild(f),Xs(a);return}l--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")l++;else if(s==="html")vl(n.ownerDocument.documentElement);else if(s==="head"){s=n.ownerDocument.head,vl(s);for(var d=s.firstChild;d;){var T=d.nextSibling,b=d.nodeName;d[Mi]||b==="SCRIPT"||b==="STYLE"||b==="LINK"&&d.rel.toLowerCase()==="stylesheet"||s.removeChild(d),d=T}}else s==="body"&&vl(n.ownerDocument.body);s=f}while(s);Xs(a)}function uy(n,a){var s=n;n=0;do{var l=s.nextSibling;if(s.nodeType===1?a?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(a?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(n===0)break;n--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||n++;s=l}while(s)}function yd(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var s=a;switch(a=a.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":yd(s),cs(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}n.removeChild(s)}}function Iw(n,a,s,l){for(;n.nodeType===1;){var f=s;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!l&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(l){if(!n[Mi])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(d=n.getAttribute("rel"),d==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(d!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(d=n.getAttribute("src"),(d!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&d&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var d=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===d)return n}else return n;if(n=ni(n.nextSibling),n===null)break}return null}function kw(n,a,s){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=ni(n.nextSibling),n===null))return null;return n}function cy(n,a){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!a||(n=ni(n.nextSibling),n===null))return null;return n}function Td(n){return n.data==="$?"||n.data==="$~"}function Ed(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function Dw(n,a){var s=n.ownerDocument;if(n.data==="$~")n._reactRetry=a;else if(n.data!=="$?"||s.readyState!=="loading")a();else{var l=function(){a(),s.removeEventListener("DOMContentLoaded",l)};s.addEventListener("DOMContentLoaded",l),n._reactRetry=l}}function ni(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return n}var vd=null;function hy(n){n=n.nextSibling;for(var a=0;n;){if(n.nodeType===8){var s=n.data;if(s==="/$"||s==="/&"){if(a===0)return ni(n.nextSibling);a--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||a++}n=n.nextSibling}return null}function fy(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var s=n.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(a===0)return n;a--}else s!=="/$"&&s!=="/&"||a++}n=n.previousSibling}return null}function dy(n,a,s){switch(a=vc(s),n){case"html":if(n=a.documentElement,!n)throw Error(r(452));return n;case"head":if(n=a.head,!n)throw Error(r(453));return n;case"body":if(n=a.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function vl(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);cs(n)}var ii=new Map,my=new Set;function wc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ea=ue.d;ue.d={f:Ow,r:Cw,D:Nw,C:Mw,L:Vw,m:Lw,X:Pw,S:Hw,M:xw};function Ow(){var n=Ea.f(),a=dc();return n||a}function Cw(n){var a=Fn(n);a!==null&&a.tag===5&&a.type==="form"?Cp(a):Ea.r(n)}var Ys=typeof document>"u"?null:document;function _y(n,a,s){var l=Ys;if(l&&typeof a=="string"&&a){var f=bn(a);f='link[rel="'+n+'"][href="'+f+'"]',typeof s=="string"&&(f+='[crossorigin="'+s+'"]'),my.has(f)||(my.add(f),n={rel:n,crossOrigin:s,href:a},l.querySelector(f)===null&&(a=l.createElement("link"),un(a,"link",n),Lt(a),l.head.appendChild(a)))}}function Nw(n){Ea.D(n),_y("dns-prefetch",n,null)}function Mw(n,a){Ea.C(n,a),_y("preconnect",n,a)}function Vw(n,a,s){Ea.L(n,a,s);var l=Ys;if(l&&n&&a){var f='link[rel="preload"][as="'+bn(a)+'"]';a==="image"&&s&&s.imageSrcSet?(f+='[imagesrcset="'+bn(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(f+='[imagesizes="'+bn(s.imageSizes)+'"]')):f+='[href="'+bn(n)+'"]';var d=f;switch(a){case"style":d=Fs(n);break;case"script":d=Ws(n)}ii.has(d)||(n=v({rel:"preload",href:a==="image"&&s&&s.imageSrcSet?void 0:n,as:a},s),ii.set(d,n),l.querySelector(f)!==null||a==="style"&&l.querySelector(wl(d))||a==="script"&&l.querySelector(bl(d))||(a=l.createElement("link"),un(a,"link",n),Lt(a),l.head.appendChild(a)))}}function Lw(n,a){Ea.m(n,a);var s=Ys;if(s&&n){var l=a&&typeof a.as=="string"?a.as:"script",f='link[rel="modulepreload"][as="'+bn(l)+'"][href="'+bn(n)+'"]',d=f;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=Ws(n)}if(!ii.has(d)&&(n=v({rel:"modulepreload",href:n},a),ii.set(d,n),s.querySelector(f)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(bl(d)))return}l=s.createElement("link"),un(l,"link",n),Lt(l),s.head.appendChild(l)}}}function Hw(n,a,s){Ea.S(n,a,s);var l=Ys;if(l&&n){var f=Li(l).hoistableStyles,d=Fs(n);a=a||"default";var T=f.get(d);if(!T){var b={loading:0,preload:null};if(T=l.querySelector(wl(d)))b.loading=5;else{n=v({rel:"stylesheet",href:n,"data-precedence":a},s),(s=ii.get(d))&&wd(n,s);var N=T=l.createElement("link");Lt(N),un(N,"link",n),N._p=new Promise(function(Y,Q){N.onload=Y,N.onerror=Q}),N.addEventListener("load",function(){b.loading|=1}),N.addEventListener("error",function(){b.loading|=2}),b.loading|=4,bc(T,a,l)}T={type:"stylesheet",instance:T,count:1,state:b},f.set(d,T)}}}function Pw(n,a){Ea.X(n,a);var s=Ys;if(s&&n){var l=Li(s).hoistableScripts,f=Ws(n),d=l.get(f);d||(d=s.querySelector(bl(f)),d||(n=v({src:n,async:!0},a),(a=ii.get(f))&&bd(n,a),d=s.createElement("script"),Lt(d),un(d,"link",n),s.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},l.set(f,d))}}function xw(n,a){Ea.M(n,a);var s=Ys;if(s&&n){var l=Li(s).hoistableScripts,f=Ws(n),d=l.get(f);d||(d=s.querySelector(bl(f)),d||(n=v({src:n,async:!0,type:"module"},a),(a=ii.get(f))&&bd(n,a),d=s.createElement("script"),Lt(d),un(d,"link",n),s.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},l.set(f,d))}}function py(n,a,s,l){var f=(f=Le.current)?wc(f):null;if(!f)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(a=Fs(s.href),s=Li(f).hoistableStyles,l=s.get(a),l||(l={type:"style",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){n=Fs(s.href);var d=Li(f).hoistableStyles,T=d.get(n);if(T||(f=f.ownerDocument||f,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(n,T),(d=f.querySelector(wl(n)))&&!d._p&&(T.instance=d,T.state.loading=5),ii.has(n)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},ii.set(n,s),d||zw(f,n,s,T.state))),a&&l===null)throw Error(r(528,""));return T}if(a&&l!==null)throw Error(r(529,""));return null;case"script":return a=s.async,s=s.src,typeof s=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ws(s),s=Li(f).hoistableScripts,l=s.get(a),l||(l={type:"script",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function Fs(n){return'href="'+bn(n)+'"'}function wl(n){return'link[rel="stylesheet"]['+n+"]"}function gy(n){return v({},n,{"data-precedence":n.precedence,precedence:null})}function zw(n,a,s,l){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=n.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),un(a,"link",s),Lt(a),n.head.appendChild(a))}function Ws(n){return'[src="'+bn(n)+'"]'}function bl(n){return"script[async]"+n}function yy(n,a,s){if(a.count++,a.instance===null)switch(a.type){case"style":var l=n.querySelector('style[data-href~="'+bn(s.href)+'"]');if(l)return a.instance=l,Lt(l),l;var f=v({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return l=(n.ownerDocument||n).createElement("style"),Lt(l),un(l,"style",f),bc(l,s.precedence,n),a.instance=l;case"stylesheet":f=Fs(s.href);var d=n.querySelector(wl(f));if(d)return a.state.loading|=4,a.instance=d,Lt(d),d;l=gy(s),(f=ii.get(f))&&wd(l,f),d=(n.ownerDocument||n).createElement("link"),Lt(d);var T=d;return T._p=new Promise(function(b,N){T.onload=b,T.onerror=N}),un(d,"link",l),a.state.loading|=4,bc(d,s.precedence,n),a.instance=d;case"script":return d=Ws(s.src),(f=n.querySelector(bl(d)))?(a.instance=f,Lt(f),f):(l=s,(f=ii.get(d))&&(l=v({},s),bd(l,f)),n=n.ownerDocument||n,f=n.createElement("script"),Lt(f),un(f,"link",l),n.head.appendChild(f),a.instance=f);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(l=a.instance,a.state.loading|=4,bc(l,s.precedence,n));return a.instance}function bc(n,a,s){for(var l=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=l.length?l[l.length-1]:null,d=f,T=0;T<l.length;T++){var b=l[T];if(b.dataset.precedence===a)d=b;else if(d!==f)break}d?d.parentNode.insertBefore(n,d.nextSibling):(a=s.nodeType===9?s.head:s,a.insertBefore(n,a.firstChild))}function wd(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function bd(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var Ac=null;function Ty(n,a,s){if(Ac===null){var l=new Map,f=Ac=new Map;f.set(s,l)}else f=Ac,l=f.get(s),l||(l=new Map,f.set(s,l));if(l.has(n))return l;for(l.set(n,null),s=s.getElementsByTagName(n),f=0;f<s.length;f++){var d=s[f];if(!(d[Mi]||d[Vt]||n==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var T=d.getAttribute(a)||"";T=n+T;var b=l.get(T);b?b.push(d):l.set(T,[d])}}return l}function Ey(n,a,s){n=n.ownerDocument||n,n.head.insertBefore(s,a==="title"?n.querySelector("head > title"):null)}function Uw(n,a,s){if(s===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(n=a.disabled,typeof a.precedence=="string"&&n==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function vy(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function Bw(n,a,s,l){if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var f=Fs(l.href),d=a.querySelector(wl(f));if(d){a=d._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(n.count++,n=Sc.bind(n),a.then(n,n)),s.state.loading|=4,s.instance=d,Lt(d);return}d=a.ownerDocument||a,l=gy(l),(f=ii.get(f))&&wd(l,f),d=d.createElement("link"),Lt(d);var T=d;T._p=new Promise(function(b,N){T.onload=b,T.onerror=N}),un(d,"link",l),s.instance=d}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(n.count++,s=Sc.bind(n),a.addEventListener("load",s),a.addEventListener("error",s))}}var Ad=0;function Gw(n,a){return n.stylesheets&&n.count===0&&Ic(n,n.stylesheets),0<n.count||0<n.imgCount?function(s){var l=setTimeout(function(){if(n.stylesheets&&Ic(n,n.stylesheets),n.unsuspend){var d=n.unsuspend;n.unsuspend=null,d()}},6e4+a);0<n.imgBytes&&Ad===0&&(Ad=62500*ww());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Ic(n,n.stylesheets),n.unsuspend)){var d=n.unsuspend;n.unsuspend=null,d()}},(n.imgBytes>Ad?50:800)+a);return n.unsuspend=s,function(){n.unsuspend=null,clearTimeout(l),clearTimeout(f)}}:null}function Sc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ic(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Rc=null;function Ic(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Rc=new Map,a.forEach(jw,n),Rc=null,Sc.call(n))}function jw(n,a){if(!(a.state.loading&4)){var s=Rc.get(n);if(s)var l=s.get(null);else{s=new Map,Rc.set(n,s);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<f.length;d++){var T=f[d];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(s.set(T.dataset.precedence,T),l=T)}l&&s.set(null,l)}f=a.instance,T=f.getAttribute("data-precedence"),d=s.get(T)||l,d===l&&s.set(null,f),s.set(T,f),this.count++,l=Sc.bind(this),f.addEventListener("load",l),f.addEventListener("error",l),d?d.parentNode.insertBefore(f,d.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),a.state.loading|=4}}var Al={$$typeof:J,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function qw(n,a,s,l,f,d,T,b,N){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ci(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ci(0),this.hiddenUpdates=Ci(null),this.identifierPrefix=l,this.onUncaughtError=f,this.onCaughtError=d,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function wy(n,a,s,l,f,d,T,b,N,Y,Q,ee){return n=new qw(n,a,s,T,N,Y,Q,ee,b),a=1,d===!0&&(a|=24),d=zn(3,null,null,a),n.current=d,d.stateNode=n,a=nf(),a.refCount++,n.pooledCache=a,a.refCount++,d.memoizedState={element:l,isDehydrated:s,cache:a},of(d),n}function by(n){return n?(n=As,n):As}function Ay(n,a,s,l,f,d){f=by(f),l.context===null?l.context=f:l.pendingContext=f,l=Ba(a),l.payload={element:s},d=d===void 0?null:d,d!==null&&(l.callback=d),s=Ga(n,l,a),s!==null&&(Dn(s,n,a),nl(s,n,a))}function Sy(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var s=n.retryLane;n.retryLane=s!==0&&s<a?s:a}}function Sd(n,a){Sy(n,a),(n=n.alternate)&&Sy(n,a)}function Ry(n){if(n.tag===13||n.tag===31){var a=Pr(n,67108864);a!==null&&Dn(a,n,67108864),Sd(n,67108864)}}function Iy(n){if(n.tag===13||n.tag===31){var a=qn();a=Sr(a);var s=Pr(n,a);s!==null&&Dn(s,n,a),Sd(n,a)}}var kc=!0;function Yw(n,a,s,l){var f=$.T;$.T=null;var d=ue.p;try{ue.p=2,Rd(n,a,s,l)}finally{ue.p=d,$.T=f}}function Fw(n,a,s,l){var f=$.T;$.T=null;var d=ue.p;try{ue.p=8,Rd(n,a,s,l)}finally{ue.p=d,$.T=f}}function Rd(n,a,s,l){if(kc){var f=Id(l);if(f===null)fd(n,a,l,Dc,s),Dy(n,l);else if(Xw(f,n,a,s,l))l.stopPropagation();else if(Dy(n,l),a&4&&-1<Ww.indexOf(n)){for(;f!==null;){var d=Fn(f);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var T=Di(d.pendingLanes);if(T!==0){var b=d;for(b.pendingLanes|=2,b.entangledLanes|=2;T;){var N=1<<31-It(T);b.entanglements[1]|=N,T&=~N}Xi(d),(et&6)===0&&(hc=En()+500,yl(0))}}break;case 31:case 13:b=Pr(d,2),b!==null&&Dn(b,d,2),dc(),Sd(d,2)}if(d=Id(l),d===null&&fd(n,a,l,Dc,s),d===f)break;f=d}f!==null&&l.stopPropagation()}else fd(n,a,l,null,s)}}function Id(n){return n=Wn(n),kd(n)}var Dc=null;function kd(n){if(Dc=null,n=Vi(n),n!==null){var a=u(n);if(a===null)n=null;else{var s=a.tag;if(s===13){if(n=c(a),n!==null)return n;n=null}else if(s===31){if(n=m(a),n!==null)return n;n=null}else if(s===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return Dc=n,null}function ky(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vr()){case Io:return 2;case ko:return 8;case Ra:case Mh:return 32;case ou:return 268435456;default:return 32}default:return 32}}var Dd=!1,Ja=null,er=null,tr=null,Sl=new Map,Rl=new Map,nr=[],Ww="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dy(n,a){switch(n){case"focusin":case"focusout":Ja=null;break;case"dragenter":case"dragleave":er=null;break;case"mouseover":case"mouseout":tr=null;break;case"pointerover":case"pointerout":Sl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rl.delete(a.pointerId)}}function Il(n,a,s,l,f,d){return n===null||n.nativeEvent!==d?(n={blockedOn:a,domEventName:s,eventSystemFlags:l,nativeEvent:d,targetContainers:[f]},a!==null&&(a=Fn(a),a!==null&&Ry(a)),n):(n.eventSystemFlags|=l,a=n.targetContainers,f!==null&&a.indexOf(f)===-1&&a.push(f),n)}function Xw(n,a,s,l,f){switch(a){case"focusin":return Ja=Il(Ja,n,a,s,l,f),!0;case"dragenter":return er=Il(er,n,a,s,l,f),!0;case"mouseover":return tr=Il(tr,n,a,s,l,f),!0;case"pointerover":var d=f.pointerId;return Sl.set(d,Il(Sl.get(d)||null,n,a,s,l,f)),!0;case"gotpointercapture":return d=f.pointerId,Rl.set(d,Il(Rl.get(d)||null,n,a,s,l,f)),!0}return!1}function Oy(n){var a=Vi(n.target);if(a!==null){var s=u(a);if(s!==null){if(a=s.tag,a===13){if(a=c(s),a!==null){n.blockedOn=a,hi(n.priority,function(){Iy(s)});return}}else if(a===31){if(a=m(s),a!==null){n.blockedOn=a,hi(n.priority,function(){Iy(s)});return}}else if(a===3&&s.stateNode.current.memoizedState.isDehydrated){n.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Oc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var s=Id(n.nativeEvent);if(s===null){s=n.nativeEvent;var l=new s.constructor(s.type,s);Uo=l,s.target.dispatchEvent(l),Uo=null}else return a=Fn(s),a!==null&&Ry(a),n.blockedOn=s,!1;a.shift()}return!0}function Cy(n,a,s){Oc(n)&&s.delete(a)}function Kw(){Dd=!1,Ja!==null&&Oc(Ja)&&(Ja=null),er!==null&&Oc(er)&&(er=null),tr!==null&&Oc(tr)&&(tr=null),Sl.forEach(Cy),Rl.forEach(Cy)}function Cc(n,a){n.blockedOn===a&&(n.blockedOn=null,Dd||(Dd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Kw)))}var Nc=null;function Ny(n){Nc!==n&&(Nc=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Nc===n&&(Nc=null);for(var a=0;a<n.length;a+=3){var s=n[a],l=n[a+1],f=n[a+2];if(typeof l!="function"){if(kd(l||s)===null)continue;break}var d=Fn(s);d!==null&&(n.splice(a,3),a-=3,If(d,{pending:!0,data:f,method:s.method,action:l},l,f))}}))}function Xs(n){function a(N){return Cc(N,n)}Ja!==null&&Cc(Ja,n),er!==null&&Cc(er,n),tr!==null&&Cc(tr,n),Sl.forEach(a),Rl.forEach(a);for(var s=0;s<nr.length;s++){var l=nr[s];l.blockedOn===n&&(l.blockedOn=null)}for(;0<nr.length&&(s=nr[0],s.blockedOn===null);)Oy(s),s.blockedOn===null&&nr.shift();if(s=(n.ownerDocument||n).$$reactFormReplay,s!=null)for(l=0;l<s.length;l+=3){var f=s[l],d=s[l+1],T=f[Qt]||null;if(typeof d=="function")T||Ny(s);else if(T){var b=null;if(d&&d.hasAttribute("formAction")){if(f=d,T=d[Qt]||null)b=T.formAction;else if(kd(f)!==null)continue}else b=T.action;typeof b=="function"?s[l+1]=b:(s.splice(l,3),l-=3),Ny(s)}}}function My(){function n(d){d.canIntercept&&d.info==="react-transition"&&d.intercept({handler:function(){return new Promise(function(T){return f=T})},focusReset:"manual",scroll:"manual"})}function a(){f!==null&&(f(),f=null),l||setTimeout(s,20)}function s(){if(!l&&!navigation.transition){var d=navigation.currentEntry;d&&d.url!=null&&navigation.navigate(d.url,{state:d.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(s,100),function(){l=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),f!==null&&(f(),f=null)}}}function Od(n){this._internalRoot=n}Mc.prototype.render=Od.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(r(409));var s=a.current,l=qn();Ay(s,l,n,a,null,null)},Mc.prototype.unmount=Od.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Ay(n.current,2,null,n,null,null),dc(),a[Ni]=null}};function Mc(n){this._internalRoot=n}Mc.prototype.unstable_scheduleHydration=function(n){if(n){var a=du();n={blockedOn:null,target:n,priority:a};for(var s=0;s<nr.length&&a!==0&&a<nr[s].priority;s++);nr.splice(s,0,n),s===0&&Oy(n)}};var Vy=t.version;if(Vy!=="19.2.4")throw Error(r(527,Vy,"19.2.4"));ue.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=p(a),n=n!==null?y(n):null,n=n===null?null:n.stateNode,n};var Qw={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vc.isDisabled&&Vc.supportsFiber)try{ui=Vc.inject(Qw),an=Vc}catch{}}return Dl.createRoot=function(n,a){if(!o(n))throw Error(r(299));var s=!1,l="",f=Bp,d=Gp,T=jp;return a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(d=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError)),a=wy(n,1,!1,null,null,s,l,null,f,d,T,My),n[Ni]=a.current,hd(n),new Od(a)},Dl.hydrateRoot=function(n,a,s){if(!o(n))throw Error(r(299));var l=!1,f="",d=Bp,T=Gp,b=jp,N=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(d=s.onUncaughtError),s.onCaughtError!==void 0&&(T=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError),s.formState!==void 0&&(N=s.formState)),a=wy(n,1,!0,a,s??null,l,f,N,d,T,b,My),a.context=by(null),s=a.current,l=qn(),l=Sr(l),f=Ba(l),f.callback=null,Ga(s,f,l),s=l,a.current.lanes=s,br(a,s),Xi(a),n[Ni]=a.current,hd(n),new Mc(a)},Dl.version="19.2.4",Dl}var qy;function sb(){if(qy)return Nd.exports;qy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Nd.exports=rb(),Nd.exports}var ob=sb(),ae=bm();const lb=[{text:"",type:"normal"},{text:"",type:"title"},{text:"|       THE SECRET OF SNOWPEAK RESORT:       |",type:"title"},{text:"|       A Zork-Style Text Adventure.         |",type:"title"},{text:"",type:"title"},{text:"",type:"normal"},{text:'You arrive at Snowpeak Resort on a cold winter morning, ready for your first ski vacation. The brochure promised "world-class slopes and luxury accommodations." The reality... is somewhat different.',type:"normal"},{text:"",type:"normal"},{text:"The resort is nearly abandoned. The ski lift is broken. Most of the shops are boarded up. But three fellow beginner skiers are here with you, each as bewildered as the last. And there are whispers of a secret hidden somewhere on this mountain -- a treasure left behind by the resort's eccentric founder, Tobias Snowpeak.",type:"normal"},{text:"",type:"normal"},{text:"Maybe this trip won't be so boring after all...",type:"normal"},{text:"",type:"normal"},{text:'Type "help" for a list of commands, or "look" to examine your surroundings.',type:"system"},{text:"",type:"normal"}],ub=[{text:"",type:"normal"},{text:"    CONGRATULATIONS!    ",type:"victory"},{text:"",type:"normal"},{text:"You have discovered THE SECRET OF SNOWPEAK RESORT!",type:"victory"},{text:"",type:"normal"},{text:"With the help of your fellow beginner skiers -- even the angry one -- you uncovered the hidden treasure of Tobias Snowpeak. The Golden Ski Trophy is yours!",type:"victory"},{text:"",type:"normal"},{text:"Thank you for playing!",type:"victory"}],cb="1.9.2",hb=[{text:"--- AVAILABLE COMMANDS ---",type:"system"},{text:"",type:"normal"},{text:"Movement:    north (n), south (s), east (e), west (w), up (u), down (d)",type:"system"},{text:"Look:        look / look at <thing> -- examine your surroundings or an object",type:"system"},{text:"Take:        take <item> -- pick up an item",type:"system"},{text:"Drop:        drop <item> -- drop an item from your inventory",type:"system"},{text:"Use:         use <item> -- use an item (context-sensitive)",type:"system"},{text:"Talk:        talk to <character> -- speak with someone",type:"system"},{text:"Give:        give <item> to <character> -- offer an item to someone",type:"system"},{text:"Inventory:   inventory (i) -- check what you're carrying",type:"system"},{text:"Read:        read <item> -- read a readable item",type:"system"},{text:"Scores:      scores -- view the high score leaderboard",type:"system"},{text:"Quit:        quit / restart -- return to mode selection",type:"system"},{text:"Help:        help -- show this message",type:"system"},{text:"",type:"normal"},{text:`The Secret of Snowpeak Resort v${cb}`,type:"system"},{text:"",type:"normal"}],fb=()=>{};var Yy={};const wT=function(e){const t=[];let i=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);o<128?t[i++]=o:o<2048?(t[i++]=o>>6|192,t[i++]=o&63|128):(o&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++r)&1023),t[i++]=o>>18|240,t[i++]=o>>12&63|128,t[i++]=o>>6&63|128,t[i++]=o&63|128):(t[i++]=o>>12|224,t[i++]=o>>6&63|128,t[i++]=o&63|128)}return t},db=function(e){const t=[];let i=0,r=0;for(;i<e.length;){const o=e[i++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){const u=e[i++];t[r++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=e[i++],c=e[i++],m=e[i++],_=((o&7)<<18|(u&63)<<12|(c&63)<<6|m&63)-65536;t[r++]=String.fromCharCode(55296+(_>>10)),t[r++]=String.fromCharCode(56320+(_&1023))}else{const u=e[i++],c=e[i++];t[r++]=String.fromCharCode((o&15)<<12|(u&63)<<6|c&63)}}return t.join("")},bT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<e.length;o+=3){const u=e[o],c=o+1<e.length,m=c?e[o+1]:0,_=o+2<e.length,p=_?e[o+2]:0,y=u>>2,v=(u&3)<<4|m>>4;let w=(m&15)<<2|p>>6,R=p&63;_||(R=64,c||(w=64)),r.push(i[y],i[v],i[w],i[R])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(wT(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):db(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const i=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<e.length;){const u=i[e.charAt(o++)],m=o<e.length?i[e.charAt(o)]:0;++o;const p=o<e.length?i[e.charAt(o)]:64;++o;const v=o<e.length?i[e.charAt(o)]:64;if(++o,u==null||m==null||p==null||v==null)throw new mb;const w=u<<2|m>>4;if(r.push(w),p!==64){const R=m<<4&240|p>>2;if(r.push(R),v!==64){const M=p<<6&192|v;r.push(M)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class mb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _b=function(e){const t=wT(e);return bT.encodeByteArray(t,!0)},$c=function(e){return _b(e).replace(/\./g,"")},pb=function(e){try{return bT.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function gb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const yb=()=>gb().__FIREBASE_DEFAULTS__,Tb=()=>{if(typeof process>"u"||typeof Yy>"u")return;const e=Yy.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Eb=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&pb(e[1]);return t&&JSON.parse(t)},Am=()=>{try{return fb()||yb()||Tb()||Eb()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},vb=e=>Am()?.emulatorHosts?.[e],wb=e=>{const t=vb(e);if(!t)return;const i=t.lastIndexOf(":");if(i<=0||i+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(i+1),10);return t[0]==="["?[t.substring(1,i-1),r]:[t.substring(0,i),r]},AT=()=>Am()?.config;class bb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,i)=>{this.resolve=t,this.reject=i})}wrapCallback(t){return(i,r)=>{i?this.reject(i):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(i):t(i,r))}}}function Sm(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ab(e){return(await fetch(e,{credentials:"include"})).ok}function Sb(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},r=t||"demo-project",o=e.iat||0,u=e.sub||e.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...e};return[$c(JSON.stringify(i)),$c(JSON.stringify(c)),""].join(".")}const Vl={};function Rb(){const e={prod:[],emulator:[]};for(const t of Object.keys(Vl))Vl[t]?e.emulator.push(t):e.prod.push(t);return e}function Ib(e){let t=document.getElementById(e),i=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),i=!0),{created:i,element:t}}let Fy=!1;function kb(e,t){if(typeof window>"u"||typeof document>"u"||!Sm(window.location.host)||Vl[e]===t||Vl[e]||Fy)return;Vl[e]=t;function i(w){return`__firebase__banner__${w}`}const r="__firebase__banner",u=Rb().prod.length>0;function c(){const w=document.getElementById(r);w&&w.remove()}function m(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function _(w,R){w.setAttribute("width","24"),w.setAttribute("id",R),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function p(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{Fy=!0,c()},w}function y(w,R){w.setAttribute("id",R),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function v(){const w=Ib(r),R=i("text"),M=document.getElementById(R)||document.createElement("span"),V=i("learnmore"),L=document.getElementById(V)||document.createElement("a"),O=i("preprendIcon"),G=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const J=w.element;m(J),y(L,V);const re=p();_(G,O),J.append(G,M,L,re),document.body.appendChild(J)}u?(M.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Db(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ob(){const e=Am()?.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Cb(){return!Ob()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Nb(){try{return typeof indexedDB=="object"}catch{return!1}}function Mb(){return new Promise((e,t)=>{try{let i=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),i||self.indexedDB.deleteDatabase(r),e(!0)},o.onupgradeneeded=()=>{i=!1},o.onerror=()=>{t(o.error?.message||"")}}catch(i){t(i)}})}const Vb="FirebaseError";class po extends Error{constructor(t,i,r){super(i),this.code=t,this.customData=r,this.name=Vb,Object.setPrototypeOf(this,po.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ST.prototype.create)}}class ST{constructor(t,i,r){this.service=t,this.serviceName=i,this.errors=r}create(t,...i){const r=i[0]||{},o=`${this.service}/${t}`,u=this.errors[t],c=u?Lb(u,r):"Error",m=`${this.serviceName}: ${c} (${o}).`;return new po(o,m,r)}}function Lb(e,t){return e.replace(Hb,(i,r)=>{const o=t[r];return o!=null?String(o):`<${r}?>`})}const Hb=/\{\$([^}]+)}/g;function Zc(e,t){if(e===t)return!0;const i=Object.keys(e),r=Object.keys(t);for(const o of i){if(!r.includes(o))return!1;const u=e[o],c=t[o];if(Wy(u)&&Wy(c)){if(!Zc(u,c))return!1}else if(u!==c)return!1}for(const o of r)if(!i.includes(o))return!1;return!0}function Wy(e){return e!==null&&typeof e=="object"}function lo(e){return e&&e._delegate?e._delegate:e}class Bl{constructor(t,i,r){this.name=t,this.instanceFactory=i,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Qr="[DEFAULT]";class Pb{constructor(t,i){this.name=t,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const i=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(i)){const r=new bb;if(this.instancesDeferred.set(i,r),this.isInitialized(i)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:i});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(t){const i=this.normalizeInstanceIdentifier(t?.identifier),r=t?.optional??!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(zb(t))try{this.getOrInitializeService({instanceIdentifier:Qr})}catch{}for(const[i,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);try{const u=this.getOrInitializeService({instanceIdentifier:o});r.resolve(u)}catch{}}}}clearInstance(t=Qr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...t.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Qr){return this.instances.has(t)}getOptions(t=Qr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:i={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:i});for(const[u,c]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(u);r===m&&c.resolve(o)}return o}onInit(t,i){const r=this.normalizeInstanceIdentifier(i),o=this.onInitCallbacks.get(r)??new Set;o.add(t),this.onInitCallbacks.set(r,o);const u=this.instances.get(r);return u&&t(u,r),()=>{o.delete(t)}}invokeOnInitCallbacks(t,i){const r=this.onInitCallbacks.get(i);if(r)for(const o of r)try{o(t,i)}catch{}}getOrInitializeService({instanceIdentifier:t,options:i={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xb(t),options:i}),this.instances.set(t,r),this.instancesOptions.set(t,i),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Qr){return this.component?this.component.multipleInstances?t:Qr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xb(e){return e===Qr?void 0:e}function zb(e){return e.instantiationMode==="EAGER"}class Ub{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const i=this.getProvider(t.name);if(i.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);i.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const i=new Pb(t,this);return this.providers.set(t,i),i}getProviders(){return Array.from(this.providers.values())}}var Fe;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Fe||(Fe={}));const Bb={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},Gb=Fe.INFO,jb={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},qb=(e,t,...i)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),o=jb[t];if(o)console[o](`[${r}]  ${e.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class RT{constructor(t){this.name=t,this._logLevel=Gb,this._logHandler=qb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Fe))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Bb[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...t),this._logHandler(this,Fe.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...t),this._logHandler(this,Fe.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...t),this._logHandler(this,Fe.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...t),this._logHandler(this,Fe.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...t),this._logHandler(this,Fe.ERROR,...t)}}const Yb=(e,t)=>t.some(i=>e instanceof i);let Xy,Ky;function Fb(){return Xy||(Xy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wb(){return Ky||(Ky=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const IT=new WeakMap,Zd=new WeakMap,kT=new WeakMap,Pd=new WeakMap,Rm=new WeakMap;function Xb(e){const t=new Promise((i,r)=>{const o=()=>{e.removeEventListener("success",u),e.removeEventListener("error",c)},u=()=>{i(or(e.result)),o()},c=()=>{r(e.error),o()};e.addEventListener("success",u),e.addEventListener("error",c)});return t.then(i=>{i instanceof IDBCursor&&IT.set(i,e)}).catch(()=>{}),Rm.set(t,e),t}function Kb(e){if(Zd.has(e))return;const t=new Promise((i,r)=>{const o=()=>{e.removeEventListener("complete",u),e.removeEventListener("error",c),e.removeEventListener("abort",c)},u=()=>{i(),o()},c=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",u),e.addEventListener("error",c),e.addEventListener("abort",c)});Zd.set(e,t)}let Jd={get(e,t,i){if(e instanceof IDBTransaction){if(t==="done")return Zd.get(e);if(t==="objectStoreNames")return e.objectStoreNames||kT.get(e);if(t==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return or(e[t])},set(e,t,i){return e[t]=i,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Qb(e){Jd=e(Jd)}function $b(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...i){const r=e.call(xd(this),t,...i);return kT.set(r,t.sort?t.sort():[t]),or(r)}:Wb().includes(e)?function(...t){return e.apply(xd(this),t),or(IT.get(this))}:function(...t){return or(e.apply(xd(this),t))}}function Zb(e){return typeof e=="function"?$b(e):(e instanceof IDBTransaction&&Kb(e),Yb(e,Fb())?new Proxy(e,Jd):e)}function or(e){if(e instanceof IDBRequest)return Xb(e);if(Pd.has(e))return Pd.get(e);const t=Zb(e);return t!==e&&(Pd.set(e,t),Rm.set(t,e)),t}const xd=e=>Rm.get(e);function Jb(e,t,{blocked:i,upgrade:r,blocking:o,terminated:u}={}){const c=indexedDB.open(e,t),m=or(c);return r&&c.addEventListener("upgradeneeded",_=>{r(or(c.result),_.oldVersion,_.newVersion,or(c.transaction),_)}),i&&c.addEventListener("blocked",_=>i(_.oldVersion,_.newVersion,_)),m.then(_=>{u&&_.addEventListener("close",()=>u()),o&&_.addEventListener("versionchange",p=>o(p.oldVersion,p.newVersion,p))}).catch(()=>{}),m}const eA=["get","getKey","getAll","getAllKeys","count"],tA=["put","add","delete","clear"],zd=new Map;function Qy(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(zd.get(t))return zd.get(t);const i=t.replace(/FromIndex$/,""),r=t!==i,o=tA.includes(i);if(!(i in(r?IDBIndex:IDBObjectStore).prototype)||!(o||eA.includes(i)))return;const u=async function(c,...m){const _=this.transaction(c,o?"readwrite":"readonly");let p=_.store;return r&&(p=p.index(m.shift())),(await Promise.all([p[i](...m),o&&_.done]))[0]};return zd.set(t,u),u}Qb(e=>({...e,get:(t,i,r)=>Qy(t,i)||e.get(t,i,r),has:(t,i)=>!!Qy(t,i)||e.has(t,i)}));class nA{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(iA(i)){const r=i.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(i=>i).join(" ")}}function iA(e){return e.getComponent()?.type==="VERSION"}const em="@firebase/app",$y="0.14.8";const wa=new RT("@firebase/app"),aA="@firebase/app-compat",rA="@firebase/analytics-compat",sA="@firebase/analytics",oA="@firebase/app-check-compat",lA="@firebase/app-check",uA="@firebase/auth",cA="@firebase/auth-compat",hA="@firebase/database",fA="@firebase/data-connect",dA="@firebase/database-compat",mA="@firebase/functions",_A="@firebase/functions-compat",pA="@firebase/installations",gA="@firebase/installations-compat",yA="@firebase/messaging",TA="@firebase/messaging-compat",EA="@firebase/performance",vA="@firebase/performance-compat",wA="@firebase/remote-config",bA="@firebase/remote-config-compat",AA="@firebase/storage",SA="@firebase/storage-compat",RA="@firebase/firestore",IA="@firebase/ai",kA="@firebase/firestore-compat",DA="firebase",OA="12.9.0";const tm="[DEFAULT]",CA={[em]:"fire-core",[aA]:"fire-core-compat",[sA]:"fire-analytics",[rA]:"fire-analytics-compat",[lA]:"fire-app-check",[oA]:"fire-app-check-compat",[uA]:"fire-auth",[cA]:"fire-auth-compat",[hA]:"fire-rtdb",[fA]:"fire-data-connect",[dA]:"fire-rtdb-compat",[mA]:"fire-fn",[_A]:"fire-fn-compat",[pA]:"fire-iid",[gA]:"fire-iid-compat",[yA]:"fire-fcm",[TA]:"fire-fcm-compat",[EA]:"fire-perf",[vA]:"fire-perf-compat",[wA]:"fire-rc",[bA]:"fire-rc-compat",[AA]:"fire-gcs",[SA]:"fire-gcs-compat",[RA]:"fire-fst",[kA]:"fire-fst-compat",[IA]:"fire-vertex","fire-js":"fire-js",[DA]:"fire-js-all"};const Jc=new Map,NA=new Map,nm=new Map;function Zy(e,t){try{e.container.addComponent(t)}catch(i){wa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,i)}}function eh(e){const t=e.name;if(nm.has(t))return wa.debug(`There were multiple attempts to register component ${t}.`),!1;nm.set(t,e);for(const i of Jc.values())Zy(i,e);for(const i of NA.values())Zy(i,e);return!0}function MA(e,t){const i=e.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),e.container.getProvider(t)}function VA(e){return e==null?!1:e.settings!==void 0}const LA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},lr=new ST("app","Firebase",LA);class HA{constructor(t,i,r){this._isDeleted=!1,this._options={...t},this._config={...i},this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Bl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw lr.create("app-deleted",{appName:this._name})}}const PA=OA;function DT(e,t={}){let i=e;typeof t!="object"&&(t={name:t});const r={name:tm,automaticDataCollectionEnabled:!0,...t},o=r.name;if(typeof o!="string"||!o)throw lr.create("bad-app-name",{appName:String(o)});if(i||(i=AT()),!i)throw lr.create("no-options");const u=Jc.get(o);if(u){if(Zc(i,u.options)&&Zc(r,u.config))return u;throw lr.create("duplicate-app",{appName:o})}const c=new Ub(o);for(const _ of nm.values())c.addComponent(_);const m=new HA(i,r,c);return Jc.set(o,m),m}function xA(e=tm){const t=Jc.get(e);if(!t&&e===tm&&AT())return DT();if(!t)throw lr.create("no-app",{appName:e});return t}function to(e,t,i){let r=CA[e]??e;i&&(r+=`-${i}`);const o=r.match(/\s|\//),u=t.match(/\s|\//);if(o||u){const c=[`Unable to register library "${r}" with version "${t}":`];o&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&u&&c.push("and"),u&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),wa.warn(c.join(" "));return}eh(new Bl(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const zA="firebase-heartbeat-database",UA=1,Gl="firebase-heartbeat-store";let Ud=null;function OT(){return Ud||(Ud=Jb(zA,UA,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Gl)}catch(i){console.warn(i)}}}}).catch(e=>{throw lr.create("idb-open",{originalErrorMessage:e.message})})),Ud}async function BA(e){try{const i=(await OT()).transaction(Gl),r=await i.objectStore(Gl).get(CT(e));return await i.done,r}catch(t){if(t instanceof po)wa.warn(t.message);else{const i=lr.create("idb-get",{originalErrorMessage:t?.message});wa.warn(i.message)}}}async function Jy(e,t){try{const r=(await OT()).transaction(Gl,"readwrite");await r.objectStore(Gl).put(t,CT(e)),await r.done}catch(i){if(i instanceof po)wa.warn(i.message);else{const r=lr.create("idb-set",{originalErrorMessage:i?.message});wa.warn(r.message)}}}function CT(e){return`${e.name}!${e.options.appId}`}const GA=1024,jA=30;class qA{constructor(t){this.container=t,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new FA(i),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=e0();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>jA){const o=WA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){wa.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=e0(),{heartbeatsToSend:i,unsentEntries:r}=YA(this._heartbeatsCache.heartbeats),o=$c(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return wa.warn(t),""}}}function e0(){return new Date().toISOString().substring(0,10)}function YA(e,t=GA){const i=[];let r=e.slice();for(const o of e){const u=i.find(c=>c.agent===o.agent);if(u){if(u.dates.push(o.date),t0(i)>t){u.dates.pop();break}}else if(i.push({agent:o.agent,dates:[o.date]}),t0(i)>t){i.pop();break}r=r.slice(1)}return{heartbeatsToSend:i,unsentEntries:r}}class FA{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Nb()?Mb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const i=await BA(this.app);return i?.heartbeats?i:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return Jy(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return Jy(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function t0(e){return $c(JSON.stringify({version:2,heartbeats:e})).length}function WA(e){if(e.length===0)return-1;let t=0,i=e[0].date;for(let r=1;r<e.length;r++)e[r].date<i&&(i=e[r].date,t=r);return t}function XA(e){eh(new Bl("platform-logger",t=>new nA(t),"PRIVATE")),eh(new Bl("heartbeat",t=>new qA(t),"PRIVATE")),to(em,$y,e),to(em,$y,"esm2020"),to("fire-js","")}XA("");var KA="firebase",QA="12.9.0";to(KA,QA,"app");var n0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ur,NT;(function(){var e;function t(k,I){function D(){}D.prototype=I.prototype,k.F=I.prototype,k.prototype=new D,k.prototype.constructor=k,k.D=function(z,H,B){for(var C=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)C[yt-2]=arguments[yt];return I.prototype[H].apply(z,C)}}function i(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,i),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(k,I,D){D||(D=0);const z=Array(16);if(typeof I=="string")for(var H=0;H<16;++H)z[H]=I.charCodeAt(D++)|I.charCodeAt(D++)<<8|I.charCodeAt(D++)<<16|I.charCodeAt(D++)<<24;else for(H=0;H<16;++H)z[H]=I[D++]|I[D++]<<8|I[D++]<<16|I[D++]<<24;I=k.g[0],D=k.g[1],H=k.g[2];let B=k.g[3],C;C=I+(B^D&(H^B))+z[0]+3614090360&4294967295,I=D+(C<<7&4294967295|C>>>25),C=B+(H^I&(D^H))+z[1]+3905402710&4294967295,B=I+(C<<12&4294967295|C>>>20),C=H+(D^B&(I^D))+z[2]+606105819&4294967295,H=B+(C<<17&4294967295|C>>>15),C=D+(I^H&(B^I))+z[3]+3250441966&4294967295,D=H+(C<<22&4294967295|C>>>10),C=I+(B^D&(H^B))+z[4]+4118548399&4294967295,I=D+(C<<7&4294967295|C>>>25),C=B+(H^I&(D^H))+z[5]+1200080426&4294967295,B=I+(C<<12&4294967295|C>>>20),C=H+(D^B&(I^D))+z[6]+2821735955&4294967295,H=B+(C<<17&4294967295|C>>>15),C=D+(I^H&(B^I))+z[7]+4249261313&4294967295,D=H+(C<<22&4294967295|C>>>10),C=I+(B^D&(H^B))+z[8]+1770035416&4294967295,I=D+(C<<7&4294967295|C>>>25),C=B+(H^I&(D^H))+z[9]+2336552879&4294967295,B=I+(C<<12&4294967295|C>>>20),C=H+(D^B&(I^D))+z[10]+4294925233&4294967295,H=B+(C<<17&4294967295|C>>>15),C=D+(I^H&(B^I))+z[11]+2304563134&4294967295,D=H+(C<<22&4294967295|C>>>10),C=I+(B^D&(H^B))+z[12]+1804603682&4294967295,I=D+(C<<7&4294967295|C>>>25),C=B+(H^I&(D^H))+z[13]+4254626195&4294967295,B=I+(C<<12&4294967295|C>>>20),C=H+(D^B&(I^D))+z[14]+2792965006&4294967295,H=B+(C<<17&4294967295|C>>>15),C=D+(I^H&(B^I))+z[15]+1236535329&4294967295,D=H+(C<<22&4294967295|C>>>10),C=I+(H^B&(D^H))+z[1]+4129170786&4294967295,I=D+(C<<5&4294967295|C>>>27),C=B+(D^H&(I^D))+z[6]+3225465664&4294967295,B=I+(C<<9&4294967295|C>>>23),C=H+(I^D&(B^I))+z[11]+643717713&4294967295,H=B+(C<<14&4294967295|C>>>18),C=D+(B^I&(H^B))+z[0]+3921069994&4294967295,D=H+(C<<20&4294967295|C>>>12),C=I+(H^B&(D^H))+z[5]+3593408605&4294967295,I=D+(C<<5&4294967295|C>>>27),C=B+(D^H&(I^D))+z[10]+38016083&4294967295,B=I+(C<<9&4294967295|C>>>23),C=H+(I^D&(B^I))+z[15]+3634488961&4294967295,H=B+(C<<14&4294967295|C>>>18),C=D+(B^I&(H^B))+z[4]+3889429448&4294967295,D=H+(C<<20&4294967295|C>>>12),C=I+(H^B&(D^H))+z[9]+568446438&4294967295,I=D+(C<<5&4294967295|C>>>27),C=B+(D^H&(I^D))+z[14]+3275163606&4294967295,B=I+(C<<9&4294967295|C>>>23),C=H+(I^D&(B^I))+z[3]+4107603335&4294967295,H=B+(C<<14&4294967295|C>>>18),C=D+(B^I&(H^B))+z[8]+1163531501&4294967295,D=H+(C<<20&4294967295|C>>>12),C=I+(H^B&(D^H))+z[13]+2850285829&4294967295,I=D+(C<<5&4294967295|C>>>27),C=B+(D^H&(I^D))+z[2]+4243563512&4294967295,B=I+(C<<9&4294967295|C>>>23),C=H+(I^D&(B^I))+z[7]+1735328473&4294967295,H=B+(C<<14&4294967295|C>>>18),C=D+(B^I&(H^B))+z[12]+2368359562&4294967295,D=H+(C<<20&4294967295|C>>>12),C=I+(D^H^B)+z[5]+4294588738&4294967295,I=D+(C<<4&4294967295|C>>>28),C=B+(I^D^H)+z[8]+2272392833&4294967295,B=I+(C<<11&4294967295|C>>>21),C=H+(B^I^D)+z[11]+1839030562&4294967295,H=B+(C<<16&4294967295|C>>>16),C=D+(H^B^I)+z[14]+4259657740&4294967295,D=H+(C<<23&4294967295|C>>>9),C=I+(D^H^B)+z[1]+2763975236&4294967295,I=D+(C<<4&4294967295|C>>>28),C=B+(I^D^H)+z[4]+1272893353&4294967295,B=I+(C<<11&4294967295|C>>>21),C=H+(B^I^D)+z[7]+4139469664&4294967295,H=B+(C<<16&4294967295|C>>>16),C=D+(H^B^I)+z[10]+3200236656&4294967295,D=H+(C<<23&4294967295|C>>>9),C=I+(D^H^B)+z[13]+681279174&4294967295,I=D+(C<<4&4294967295|C>>>28),C=B+(I^D^H)+z[0]+3936430074&4294967295,B=I+(C<<11&4294967295|C>>>21),C=H+(B^I^D)+z[3]+3572445317&4294967295,H=B+(C<<16&4294967295|C>>>16),C=D+(H^B^I)+z[6]+76029189&4294967295,D=H+(C<<23&4294967295|C>>>9),C=I+(D^H^B)+z[9]+3654602809&4294967295,I=D+(C<<4&4294967295|C>>>28),C=B+(I^D^H)+z[12]+3873151461&4294967295,B=I+(C<<11&4294967295|C>>>21),C=H+(B^I^D)+z[15]+530742520&4294967295,H=B+(C<<16&4294967295|C>>>16),C=D+(H^B^I)+z[2]+3299628645&4294967295,D=H+(C<<23&4294967295|C>>>9),C=I+(H^(D|~B))+z[0]+4096336452&4294967295,I=D+(C<<6&4294967295|C>>>26),C=B+(D^(I|~H))+z[7]+1126891415&4294967295,B=I+(C<<10&4294967295|C>>>22),C=H+(I^(B|~D))+z[14]+2878612391&4294967295,H=B+(C<<15&4294967295|C>>>17),C=D+(B^(H|~I))+z[5]+4237533241&4294967295,D=H+(C<<21&4294967295|C>>>11),C=I+(H^(D|~B))+z[12]+1700485571&4294967295,I=D+(C<<6&4294967295|C>>>26),C=B+(D^(I|~H))+z[3]+2399980690&4294967295,B=I+(C<<10&4294967295|C>>>22),C=H+(I^(B|~D))+z[10]+4293915773&4294967295,H=B+(C<<15&4294967295|C>>>17),C=D+(B^(H|~I))+z[1]+2240044497&4294967295,D=H+(C<<21&4294967295|C>>>11),C=I+(H^(D|~B))+z[8]+1873313359&4294967295,I=D+(C<<6&4294967295|C>>>26),C=B+(D^(I|~H))+z[15]+4264355552&4294967295,B=I+(C<<10&4294967295|C>>>22),C=H+(I^(B|~D))+z[6]+2734768916&4294967295,H=B+(C<<15&4294967295|C>>>17),C=D+(B^(H|~I))+z[13]+1309151649&4294967295,D=H+(C<<21&4294967295|C>>>11),C=I+(H^(D|~B))+z[4]+4149444226&4294967295,I=D+(C<<6&4294967295|C>>>26),C=B+(D^(I|~H))+z[11]+3174756917&4294967295,B=I+(C<<10&4294967295|C>>>22),C=H+(I^(B|~D))+z[2]+718787259&4294967295,H=B+(C<<15&4294967295|C>>>17),C=D+(B^(H|~I))+z[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(H+(C<<21&4294967295|C>>>11))&4294967295,k.g[2]=k.g[2]+H&4294967295,k.g[3]=k.g[3]+B&4294967295}r.prototype.v=function(k,I){I===void 0&&(I=k.length);const D=I-this.blockSize,z=this.C;let H=this.h,B=0;for(;B<I;){if(H==0)for(;B<=D;)o(this,k,B),B+=this.blockSize;if(typeof k=="string"){for(;B<I;)if(z[H++]=k.charCodeAt(B++),H==this.blockSize){o(this,z),H=0;break}}else for(;B<I;)if(z[H++]=k[B++],H==this.blockSize){o(this,z),H=0;break}}this.h=H,this.o+=I},r.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;I=this.o*8;for(var D=k.length-8;D<k.length;++D)k[D]=I&255,I/=256;for(this.v(k),k=Array(16),I=0,D=0;D<4;++D)for(let z=0;z<32;z+=8)k[I++]=this.g[D]>>>z&255;return k};function u(k,I){var D=m;return Object.prototype.hasOwnProperty.call(D,k)?D[k]:D[k]=I(k)}function c(k,I){this.h=I;const D=[];let z=!0;for(let H=k.length-1;H>=0;H--){const B=k[H]|0;z&&B==I||(D[H]=B,z=!1)}this.g=D}var m={};function _(k){return-128<=k&&k<128?u(k,function(I){return new c([I|0],I<0?-1:0)}):new c([k|0],k<0?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return v;if(k<0)return L(p(-k));const I=[];let D=1;for(let z=0;k>=D;z++)I[z]=k/D|0,D*=4294967296;return new c(I,0)}function y(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return L(y(k.substring(1),I));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=p(Math.pow(I,8));let z=v;for(let B=0;B<k.length;B+=8){var H=Math.min(8,k.length-B);const C=parseInt(k.substring(B,B+H),I);H<8?(H=p(Math.pow(I,H)),z=z.j(H).add(p(C))):(z=z.j(D),z=z.add(p(C)))}return z}var v=_(0),w=_(1),R=_(16777216);e=c.prototype,e.m=function(){if(V(this))return-L(this).m();let k=0,I=1;for(let D=0;D<this.g.length;D++){const z=this.i(D);k+=(z>=0?z:4294967296+z)*I,I*=4294967296}return k},e.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(M(this))return"0";if(V(this))return"-"+L(this).toString(k);const I=p(Math.pow(k,6));var D=this;let z="";for(;;){const H=re(D,I).g;D=O(D,H.j(I));let B=((D.g.length>0?D.g[0]:D.h)>>>0).toString(k);if(D=H,M(D))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},e.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function M(k){if(k.h!=0)return!1;for(let I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function V(k){return k.h==-1}e.l=function(k){return k=O(this,k),V(k)?-1:M(k)?0:1};function L(k){const I=k.g.length,D=[];for(let z=0;z<I;z++)D[z]=~k.g[z];return new c(D,~k.h).add(w)}e.abs=function(){return V(this)?L(this):this},e.add=function(k){const I=Math.max(this.g.length,k.g.length),D=[];let z=0;for(let H=0;H<=I;H++){let B=z+(this.i(H)&65535)+(k.i(H)&65535),C=(B>>>16)+(this.i(H)>>>16)+(k.i(H)>>>16);z=C>>>16,B&=65535,C&=65535,D[H]=C<<16|B}return new c(D,D[D.length-1]&-2147483648?-1:0)};function O(k,I){return k.add(L(I))}e.j=function(k){if(M(this)||M(k))return v;if(V(this))return V(k)?L(this).j(L(k)):L(L(this).j(k));if(V(k))return L(this.j(L(k)));if(this.l(R)<0&&k.l(R)<0)return p(this.m()*k.m());const I=this.g.length+k.g.length,D=[];for(var z=0;z<2*I;z++)D[z]=0;for(z=0;z<this.g.length;z++)for(let H=0;H<k.g.length;H++){const B=this.i(z)>>>16,C=this.i(z)&65535,yt=k.i(H)>>>16,qt=k.i(H)&65535;D[2*z+2*H]+=C*qt,G(D,2*z+2*H),D[2*z+2*H+1]+=B*qt,G(D,2*z+2*H+1),D[2*z+2*H+1]+=C*yt,G(D,2*z+2*H+1),D[2*z+2*H+2]+=B*yt,G(D,2*z+2*H+2)}for(k=0;k<I;k++)D[k]=D[2*k+1]<<16|D[2*k];for(k=I;k<2*I;k++)D[k]=0;return new c(D,0)};function G(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function J(k,I){this.g=k,this.h=I}function re(k,I){if(M(I))throw Error("division by zero");if(M(k))return new J(v,v);if(V(k))return I=re(L(k),I),new J(L(I.g),L(I.h));if(V(I))return I=re(k,L(I)),new J(L(I.g),I.h);if(k.g.length>30){if(V(k)||V(I))throw Error("slowDivide_ only works with positive integers.");for(var D=w,z=I;z.l(k)<=0;)D=Ce(D),z=Ce(z);var H=we(D,1),B=we(z,1);for(z=we(z,2),D=we(D,2);!M(z);){var C=B.add(z);C.l(k)<=0&&(H=H.add(D),B=C),z=we(z,1),D=we(D,1)}return I=O(k,H.j(I)),new J(H,I)}for(H=v;k.l(I)>=0;){for(D=Math.max(1,Math.floor(k.m()/I.m())),z=Math.ceil(Math.log(D)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=p(D),C=B.j(I);V(C)||C.l(k)>0;)D-=z,B=p(D),C=B.j(I);M(B)&&(B=w),H=H.add(B),k=O(k,C)}return new J(H,k)}e.B=function(k){return re(this,k).h},e.and=function(k){const I=Math.max(this.g.length,k.g.length),D=[];for(let z=0;z<I;z++)D[z]=this.i(z)&k.i(z);return new c(D,this.h&k.h)},e.or=function(k){const I=Math.max(this.g.length,k.g.length),D=[];for(let z=0;z<I;z++)D[z]=this.i(z)|k.i(z);return new c(D,this.h|k.h)},e.xor=function(k){const I=Math.max(this.g.length,k.g.length),D=[];for(let z=0;z<I;z++)D[z]=this.i(z)^k.i(z);return new c(D,this.h^k.h)};function Ce(k){const I=k.g.length+1,D=[];for(let z=0;z<I;z++)D[z]=k.i(z)<<1|k.i(z-1)>>>31;return new c(D,k.h)}function we(k,I){const D=I>>5;I%=32;const z=k.g.length-D,H=[];for(let B=0;B<z;B++)H[B]=I>0?k.i(B+D)>>>I|k.i(B+D+1)<<32-I:k.i(B+D);return new c(H,k.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,NT=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=y,ur=c}).apply(typeof n0<"u"?n0:typeof self<"u"?self:typeof window<"u"?window:{});var Lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var MT,Cl,VT,Yc,im,LT,HT,PT;(function(){var e,t=Object.defineProperty;function i(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lc=="object"&&Lc];for(var g=0;g<h.length;++g){var E=h[g];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=i(this);function o(h,g){if(g)e:{var E=r;h=h.split(".");for(var A=0;A<h.length-1;A++){var j=h[A];if(!(j in E))break e;E=E[j]}h=h[h.length-1],A=E[h],g=g(A),g!=A&&g!=null&&t(E,h,{configurable:!0,writable:!0,value:g})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(g){var E=[],A;for(A in g)Object.prototype.hasOwnProperty.call(g,A)&&E.push([A,g[A]]);return E}});var u=u||{},c=this||self;function m(h){var g=typeof h;return g=="object"&&h!=null||g=="function"}function _(h,g,E){return h.call.apply(h.bind,arguments)}function p(h,g,E){return p=_,p.apply(null,arguments)}function y(h,g){var E=Array.prototype.slice.call(arguments,1);return function(){var A=E.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function v(h,g){function E(){}E.prototype=g.prototype,h.Z=g.prototype,h.prototype=new E,h.prototype.constructor=h,h.Ob=function(A,j,W){for(var le=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)le[Ne-2]=arguments[Ne];return g.prototype[j].apply(A,le)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const g=h.length;if(g>0){const E=Array(g);for(let A=0;A<g;A++)E[A]=h[A];return E}return[]}function M(h,g){for(let A=1;A<arguments.length;A++){const j=arguments[A];var E=typeof j;if(E=E!="object"?E:j?Array.isArray(j)?"array":E:"null",E=="array"||E=="object"&&typeof j.length=="number"){E=h.length||0;const W=j.length||0;h.length=E+W;for(let le=0;le<W;le++)h[E+le]=j[le]}else h.push(j)}}class V{constructor(g,E){this.i=g,this.j=E,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function L(h){c.setTimeout(()=>{throw h},0)}function O(){var h=k;let g=null;return h.g&&(g=h.g,h.g=h.g.next,h.g||(h.h=null),g.next=null),g}class G{constructor(){this.h=this.g=null}add(g,E){const A=J.get();A.set(g,E),this.h?this.h.next=A:this.g=A,this.h=A}}var J=new V(()=>new re,h=>h.reset());class re{constructor(){this.next=this.g=this.h=null}set(g,E){this.h=g,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,we=!1,k=new G,I=()=>{const h=Promise.resolve(void 0);Ce=()=>{h.then(D)}};function D(){for(var h;h=O();){try{h.h.call(h.g)}catch(E){L(E)}var g=J;g.j(h),g.h<100&&(g.h++,h.next=g.g,g.g=h)}we=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(h,g){this.type=h,this.g=this.target=g,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var h=!1,g=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};c.addEventListener("test",E,g),c.removeEventListener("test",E,g)}catch{}return h})();function C(h){return/^[\s\xa0]*$/.test(h)}function yt(h,g){H.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,g)}v(yt,H),yt.prototype.init=function(h,g){const E=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=g,g=h.relatedTarget,g||(E=="mouseover"?g=h.fromElement:E=="mouseout"&&(g=h.toElement)),this.relatedTarget=g,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&yt.Z.h.call(this)},yt.prototype.h=function(){yt.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var qt="closure_listenable_"+(Math.random()*1e6|0),$=0;function ue(h,g,E,A,j){this.listener=h,this.proxy=null,this.src=g,this.type=E,this.capture=!!A,this.ha=j,this.key=++$,this.da=this.fa=!1}function Ee(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Xe(h,g,E){for(const A in h)g.call(E,h[A],A,h)}function nt(h,g){for(const E in h)g.call(void 0,h[E],E,h)}function x(h){const g={};for(const E in h)g[E]=h[E];return g}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ce(h,g){let E,A;for(let j=1;j<arguments.length;j++){A=arguments[j];for(E in A)h[E]=A[E];for(let W=0;W<ne.length;W++)E=ne[W],Object.prototype.hasOwnProperty.call(A,E)&&(h[E]=A[E])}}function de(h){this.src=h,this.g={},this.h=0}de.prototype.add=function(h,g,E,A,j){const W=h.toString();h=this.g[W],h||(h=this.g[W]=[],this.h++);const le=Le(h,g,A,j);return le>-1?(g=h[le],E||(g.fa=!1)):(g=new ue(g,this.src,W,!!A,j),g.fa=E,h.push(g)),g};function Re(h,g){const E=g.type;if(E in h.g){var A=h.g[E],j=Array.prototype.indexOf.call(A,g,void 0),W;(W=j>=0)&&Array.prototype.splice.call(A,j,1),W&&(Ee(g),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Le(h,g,E,A){for(let j=0;j<h.length;++j){const W=h[j];if(!W.da&&W.listener==g&&W.capture==!!E&&W.ha==A)return j}return-1}var qe="closure_lm_"+(Math.random()*1e6|0),Yt={};function Tt(h,g,E,A,j){if(Array.isArray(g)){for(let W=0;W<g.length;W++)Tt(h,g[W],E,A,j);return null}return E=Ro(E),h&&h[qt]?h.J(g,E,m(A)?!!A.capture:!1,j):Tr(h,g,E,!1,A,j)}function Tr(h,g,E,A,j,W){if(!g)throw Error("Invalid event type");const le=m(j)?!!j.capture:!!j;let Ne=Er(h);if(Ne||(h[qe]=Ne=new de(h)),E=Ne.add(g,E,A,le,W),E.proxy)return E;if(A=rs(),E.proxy=A,A.src=h,A.listener=E,h.addEventListener)B||(j=le),j===void 0&&(j=!1),h.addEventListener(g.toString(),A,j);else if(h.attachEvent)h.attachEvent(Ii(g.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return E}function rs(){function h(E){return g.call(h.src,h.listener,E)}const g=Ao;return h}function ss(h,g,E,A,j){if(Array.isArray(g))for(var W=0;W<g.length;W++)ss(h,g[W],E,A,j);else A=m(A)?!!A.capture:!!A,E=Ro(E),h&&h[qt]?(h=h.i,W=String(g).toString(),W in h.g&&(g=h.g[W],E=Le(g,E,A,j),E>-1&&(Ee(g[E]),Array.prototype.splice.call(g,E,1),g.length==0&&(delete h.g[W],h.h--)))):h&&(h=Er(h))&&(g=h.g[g.toString()],h=-1,g&&(h=Le(g,E,A,j)),(E=h>-1?g[h]:null)&&os(E))}function os(h){if(typeof h!="number"&&h&&!h.da){var g=h.src;if(g&&g[qt])Re(g.i,h);else{var E=h.type,A=h.proxy;g.removeEventListener?g.removeEventListener(E,A,h.capture):g.detachEvent?g.detachEvent(Ii(E),A):g.addListener&&g.removeListener&&g.removeListener(A),(E=Er(g))?(Re(E,h),E.h==0&&(E.src=null,g[qe]=null)):Ee(h)}}}function Ii(h){return h in Yt?Yt[h]:Yt[h]="on"+h}function Ao(h,g){if(h.da)h=!0;else{g=new yt(g,this);const E=h.listener,A=h.ha||h.src;h.fa&&os(h),h=E.call(A,g)}return h}function Er(h){return h=h[qe],h instanceof de?h:null}var So="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ro(h){return typeof h=="function"?h:(h[So]||(h[So]=function(g){return h.handleEvent(g)}),h[So])}function Nt(){z.call(this),this.i=new de(this),this.M=this,this.G=null}v(Nt,z),Nt.prototype[qt]=!0,Nt.prototype.removeEventListener=function(h,g,E,A){ss(this,h,g,E,A)};function Ft(h,g){var E,A=h.G;if(A)for(E=[];A;A=A.G)E.push(A);if(h=h.M,A=g.type||g,typeof g=="string")g=new H(g,h);else if(g instanceof H)g.target=g.target||h;else{var j=g;g=new H(A,h),ce(g,j)}j=!0;let W,le;if(E)for(le=E.length-1;le>=0;le--)W=g.g=E[le],j=Sa(W,A,!0,g)&&j;if(W=g.g=h,j=Sa(W,A,!0,g)&&j,j=Sa(W,A,!1,g)&&j,E)for(le=0;le<E.length;le++)W=g.g=E[le],j=Sa(W,A,!1,g)&&j}Nt.prototype.N=function(){if(Nt.Z.N.call(this),this.i){var h=this.i;for(const g in h.g){const E=h.g[g];for(let A=0;A<E.length;A++)Ee(E[A]);delete h.g[g],h.h--}}this.G=null},Nt.prototype.J=function(h,g,E,A){return this.i.add(String(h),g,!1,E,A)},Nt.prototype.K=function(h,g,E,A){return this.i.add(String(h),g,!0,E,A)};function Sa(h,g,E,A){if(g=h.i.g[String(g)],!g)return!0;g=g.concat();let j=!0;for(let W=0;W<g.length;++W){const le=g[W];if(le&&!le.da&&le.capture==E){const Ne=le.listener,kt=le.ha||le.src;le.fa&&Re(h.i,le),j=Ne.call(kt,A)!==!1&&j}}return j&&!A.defaultPrevented}function Nh(h,g){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:c.setTimeout(h,g||0)}function su(h){h.g=Nh(()=>{h.g=null,h.i&&(h.i=!1,su(h))},h.l);const g=h.h;h.h=null,h.m.apply(null,g)}class En extends z{constructor(g,E){super(),this.m=g,this.l=E,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:su(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vr(h){z.call(this),this.h=h,this.g={}}v(vr,z);var Io=[];function ko(h){Xe(h.g,function(g,E){this.g.hasOwnProperty(E)&&os(g)},h),h.g={}}vr.prototype.N=function(){vr.Z.N.call(this),ko(this)},vr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ra=c.JSON.stringify,Mh=c.JSON.parse,ou=class{stringify(h){return c.JSON.stringify(h,void 0)}parse(h){return c.JSON.parse(h,void 0)}};function lu(){}function uu(){}var ui={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function an(){H.call(this,"d")}v(an,H);function Yn(){H.call(this,"c")}v(Yn,H);var It={},cu=null;function ls(){return cu=cu||new Nt}It.Ia="serverreachability";function hu(h){H.call(this,It.Ia,h)}v(hu,H);function ki(h){const g=ls();Ft(g,new hu(g))}It.STAT_EVENT="statevent";function wr(h,g){H.call(this,It.STAT_EVENT,h),this.stat=g}v(wr,H);function Mt(h){const g=ls();Ft(g,new wr(g,h))}It.Ja="timingevent";function Di(h,g){H.call(this,It.Ja,h),this.size=g}v(Di,H);function Oi(h,g){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){h()},g)}function ci(){this.g=!0}ci.prototype.ua=function(){this.g=!1};function Vh(h,g,E,A,j,W){h.info(function(){if(h.g)if(W){var le="",Ne=W.split("&");for(let Je=0;Je<Ne.length;Je++){var kt=Ne[Je].split("=");if(kt.length>1){const Et=kt[0];kt=kt[1];const Kn=Et.split("_");le=Kn.length>=2&&Kn[1]=="type"?le+(Et+"="+kt+"&"):le+(Et+"=redacted&")}}}else le=null;else le=W;return"XMLHTTP REQ ("+A+") [attempt "+j+"]: "+g+`
`+E+`
`+le})}function fu(h,g,E,A,j,W,le){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+j+"]: "+g+`
`+E+`
`+W+" "+le})}function Ci(h,g,E,A){h.info(function(){return"XMLHTTP TEXT ("+g+"): "+Lh(h,E)+(A?" "+A:"")})}function br(h,g){h.info(function(){return"TIMEOUT: "+g})}ci.prototype.info=function(){};function Lh(h,g){if(!h.g)return g;if(!g)return null;try{const W=JSON.parse(g);if(W){for(h=0;h<W.length;h++)if(Array.isArray(W[h])){var E=W[h];if(!(E.length<2)){var A=E[1];if(Array.isArray(A)&&!(A.length<1)){var j=A[0];if(j!="noop"&&j!="stop"&&j!="close")for(let le=1;le<A.length;le++)A[le]=""}}}}return Ra(W)}catch{return g}}var Ar={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Do={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Oo;function Sr(){}v(Sr,lu),Sr.prototype.g=function(){return new XMLHttpRequest},Oo=new Sr;function na(h){return encodeURIComponent(String(h))}function du(h){var g=1;h=h.split(":");const E=[];for(;g>0&&h.length;)E.push(h.shift()),g--;return h.length&&E.push(h.join(":")),E}function hi(h,g,E,A){this.j=h,this.i=g,this.l=E,this.S=A||1,this.V=new vr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fi}function fi(){this.i=null,this.g="",this.h=!1}var Vt={},Qt={};function Ni(h,g,E){h.M=1,h.A=Rr(Ht(g)),h.u=E,h.R=!0,us(h,null)}function us(h,g){h.F=Date.now(),Mi(h),h.B=Ht(h.A);var E=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),ds(E.i,"t",A),h.C=0,E=h.j.L,h.h=new fi,h.g=ku(h.j,E?g:null,!h.u),h.P>0&&(h.O=new En(p(h.Y,h,h.g),h.P)),g=h.V,E=h.g,A=h.ba;var j="readystatechange";Array.isArray(j)||(j&&(Io[0]=j.toString()),j=Io);for(let W=0;W<j.length;W++){const le=Tt(E,j[W],A||g.handleEvent,!1,g.h||g);if(!le)break;g.g[le.key]=le}g=h.J?x(h.J):{},h.u?(h.v||(h.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,g)):(h.v="GET",h.g.ea(h.B,h.v,null,g)),ki(),Vh(h.i,h.v,h.B,h.l,h.S,h.u)}hi.prototype.ba=function(h){h=h.target;const g=this.O;g&&_i(h)==3?g.j():this.Y(h)},hi.prototype.Y=function(h){try{if(h==this.g)e:{const Ne=_i(this.g),kt=this.g.ya(),Je=this.g.ca();if(!(Ne<3)&&(Ne!=3||this.g&&(this.h.h||this.g.la()||rn(this.g)))){this.K||Ne!=4||kt==7||(kt==8||Je<=0?ki(3):ki(2)),Vi(this);var g=this.g.ca();this.X=g;var E=Hh(this);if(this.o=g==200,fu(this.i,this.v,this.B,this.l,this.S,Ne,g),this.o){if(this.U&&!this.L){t:{if(this.g){var A,j=this.g;if((A=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(A)){var W=A;break t}}W=null}if(h=W)Ci(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Li(this,h);else{this.o=!1,this.m=3,Mt(12),Hn(this),Fn(this);break e}}if(this.R){h=!0;let Et;for(;!this.K&&this.C<E.length;)if(Et=_u(this,E),Et==Qt){Ne==4&&(this.m=4,Mt(14),h=!1),Ci(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Vt){this.m=4,Mt(15),Ci(this.i,this.l,E,"[Invalid Chunk]"),h=!1;break}else Ci(this.i,this.l,Et,null),Li(this,Et);if(mu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ne!=4||E.length!=0||this.h.h||(this.m=1,Mt(16),h=!1),this.o=this.o&&h,!h)Ci(this.i,this.l,E,"[Invalid Chunked Response]"),Hn(this),Fn(this);else if(E.length>0&&!this.W){this.W=!0;var le=this.j;le.g==this&&le.aa&&!le.P&&(le.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),Yo(le),le.P=!0,Mt(11))}}else Ci(this.i,this.l,E,null),Li(this,E);Ne==4&&Hn(this),this.o&&!this.K&&(Ne==4?Au(this.j,this):(this.o=!1,Mi(this)))}else aa(this.g),g==400&&E.indexOf("Unknown SID")>0?(this.m=3,Mt(12)):(this.m=0,Mt(13)),Hn(this),Fn(this)}}}catch{}};function Hh(h){if(!mu(h))return h.g.la();const g=rn(h.g);if(g==="")return"";let E="";const A=g.length,j=_i(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Hn(h),Fn(h),"";h.h.i=new c.TextDecoder}for(let W=0;W<A;W++)h.h.h=!0,E+=h.h.i.decode(g[W],{stream:!(j&&W==A-1)});return g.length=0,h.h.g+=E,h.C=0,h.h.g}function mu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function _u(h,g){var E=h.C,A=g.indexOf(`
`,E);return A==-1?Qt:(E=Number(g.substring(E,A)),isNaN(E)?Vt:(A+=1,A+E>g.length?Qt:(g=g.slice(A,A+E),h.C=A+E,g)))}hi.prototype.cancel=function(){this.K=!0,Hn(this)};function Mi(h){h.T=Date.now()+h.H,cs(h,h.H)}function cs(h,g){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Oi(p(h.aa,h),g)}function Vi(h){h.D&&(c.clearTimeout(h.D),h.D=null)}hi.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(br(this.i,this.B),this.M!=2&&(ki(),Mt(17)),Hn(this),this.m=2,Fn(this)):cs(this,this.T-h)};function Fn(h){h.j.I==0||h.K||Au(h.j,h)}function Hn(h){Vi(h);var g=h.O;g&&typeof g.dispose=="function"&&g.dispose(),h.O=null,ko(h.V),h.g&&(g=h.g,h.g=null,g.abort(),g.dispose())}function Li(h,g){try{var E=h.j;if(E.I!=0&&(E.g==h||Pi(E.h,h))){if(!h.L&&Pi(E.h,h)&&E.I==3){try{var A=E.Ba.g.parse(g)}catch{A=null}if(Array.isArray(A)&&A.length==3){var j=A;if(j[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<h.F)ys(E),Va(E);else break e;Mr(E),Mt(18)}}else E.xa=j[1],0<E.xa-E.K&&j[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Oi(p(E.Va,E),6e3));Hi(E.h)<=1&&E.ta&&(E.ta=void 0)}else ji(E,11)}else if((h.L||E.g==h)&&ys(E),!C(g))for(j=E.Ba.g.parse(g),g=0;g<j.length;g++){let Je=j[g];const Et=Je[0];if(!(Et<=E.K))if(E.K=Et,Je=Je[1],E.I==2)if(Je[0]=="c"){E.M=Je[1],E.ba=Je[2];const Kn=Je[3];Kn!=null&&(E.ka=Kn,E.j.info("VER="+E.ka));const qi=Je[4];qi!=null&&(E.za=qi,E.j.info("SVER="+E.za));const pi=Je[5];pi!=null&&typeof pi=="number"&&pi>0&&(A=1.5*pi,E.O=A,E.j.info("backChannelRequestTimeoutMs_="+A)),A=E;const gi=h.g;if(gi){const Vr=gi.g?gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vr){var W=A.h;W.g||Vr.indexOf("spdy")==-1&&Vr.indexOf("quic")==-1&&Vr.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Mo(W,W.h),W.h=null))}if(A.G){const Ts=gi.g?gi.g.getResponseHeader("X-HTTP-Session-Id"):null;Ts&&(A.wa=Ts,it(A.J,A.G,Ts))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-h.F,E.j.info("Handshake RTT: "+E.T+"ms")),A=E;var le=h;if(A.na=Iu(A,A.L?A.ba:null,A.W),le.L){Vo(A.h,le);var Ne=le,kt=A.O;kt&&(Ne.H=kt),Ne.D&&(Vi(Ne),Mi(Ne)),A.g=le}else wu(A);E.i.length>0&&Gi(E)}else Je[0]!="stop"&&Je[0]!="close"||ji(E,7);else E.I==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?ji(E,7):jo(E):Je[0]!="noop"&&E.l&&E.l.qa(Je),E.A=0)}}ki(4)}catch{}}var Lt=class{constructor(h,g){this.g=h,this.map=g}};function Co(h){this.l=h||10,c.PerformanceNavigationTiming?(h=c.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function No(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Hi(h){return h.h?1:h.g?h.g.size:0}function Pi(h,g){return h.h?h.h==g:h.g?h.g.has(g):!1}function Mo(h,g){h.g?h.g.add(g):h.h=g}function Vo(h,g){h.h&&h.h==g?h.h=null:h.g&&h.g.has(g)&&h.g.delete(g)}Co.prototype.cancel=function(){if(this.i=Lo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Lo(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let g=h.i;for(const E of h.g.values())g=g.concat(E.G);return g}return R(h.i)}var pu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hs(h,g){if(h){h=h.split("&");for(let E=0;E<h.length;E++){const A=h[E].indexOf("=");let j,W=null;A>=0?(j=h[E].substring(0,A),W=h[E].substring(A+1)):j=h[E],g(j,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Pn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;h instanceof Pn?(this.l=h.l,$t(this,h.j),this.o=h.o,this.g=h.g,Ia(this,h.u),this.h=h.h,Ho(this,Eu(h.i)),this.m=h.m):h&&(g=String(h).match(pu))?(this.l=!1,$t(this,g[1]||"",!0),this.o=xi(g[2]||""),this.g=xi(g[3]||"",!0),Ia(this,g[4]),this.h=xi(g[5]||"",!0),Ho(this,g[6]||"",!0),this.m=xi(g[7]||"")):(this.l=!1,this.i=new Da(null,this.l))}Pn.prototype.toString=function(){const h=[];var g=this.j;g&&h.push(Ir(g,fs,!0),":");var E=this.g;return(E||g=="file")&&(h.push("//"),(g=this.o)&&h.push(Ir(g,fs,!0),"@"),h.push(na(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&h.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Ir(E,E.charAt(0)=="/"?Po:gu,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Ir(E,yu)),h.join("")},Pn.prototype.resolve=function(h){const g=Ht(this);let E=!!h.j;E?$t(g,h.j):E=!!h.o,E?g.o=h.o:E=!!h.g,E?g.g=h.g:E=h.u!=null;var A=h.h;if(E)Ia(g,h.u);else if(E=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var j=g.h.lastIndexOf("/");j!=-1&&(A=g.h.slice(0,j+1)+A)}if(j=A,j==".."||j==".")A="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){A=j.lastIndexOf("/",0)==0,j=j.split("/");const W=[];for(let le=0;le<j.length;){const Ne=j[le++];Ne=="."?A&&le==j.length&&W.push(""):Ne==".."?((W.length>1||W.length==1&&W[0]!="")&&W.pop(),A&&le==j.length&&W.push("")):(W.push(Ne),A=!0)}A=W.join("/")}else A=j}return E?g.h=A:E=h.i.toString()!=="",E?Ho(g,Eu(h.i)):E=!!h.m,E&&(g.m=h.m),g};function Ht(h){return new Pn(h)}function $t(h,g,E){h.j=E?xi(g,!0):g,h.j&&(h.j=h.j.replace(/:$/,""))}function Ia(h,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);h.u=g}else h.u=null}function Ho(h,g,E){g instanceof Da?(h.i=g,ms(h.i,h.l)):(E||(g=Ir(g,ka)),h.i=new Da(g,h.l))}function it(h,g,E){h.i.set(g,E)}function Rr(h){return it(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function xi(h,g){return h?g?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ir(h,g,E){return typeof h=="string"?(h=encodeURI(h).replace(g,bn),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function bn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var fs=/[#\/\?@]/g,gu=/[#\?:]/g,Po=/[#\?]/g,ka=/[#\?@]/g,yu=/#/g;function Da(h,g){this.h=this.g=null,this.i=h||null,this.j=!!g}function An(h){h.g||(h.g=new Map,h.h=0,h.i&&hs(h.i,function(g,E){h.add(decodeURIComponent(g.replace(/\+/g," ")),E)}))}e=Da.prototype,e.add=function(h,g){An(this),this.i=null,h=Oa(this,h);let E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(g),this.h+=1,this};function Tu(h,g){An(h),g=Oa(h,g),h.g.has(g)&&(h.i=null,h.h-=h.g.get(g).length,h.g.delete(g))}function xo(h,g){return An(h),g=Oa(h,g),h.g.has(g)}e.forEach=function(h,g){An(this),this.g.forEach(function(E,A){E.forEach(function(j){h.call(g,j,A,this)},this)},this)};function zo(h,g){An(h);let E=[];if(typeof g=="string")xo(h,g)&&(E=E.concat(h.g.get(Oa(h,g))));else for(h=Array.from(h.g.values()),g=0;g<h.length;g++)E=E.concat(h[g]);return E}e.set=function(h,g){return An(this),this.i=null,h=Oa(this,h),xo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[g]),this.h+=1,this},e.get=function(h,g){return h?(h=zo(this,h),h.length>0?String(h[0]):g):g};function ds(h,g,E){Tu(h,g),E.length>0&&(h.i=null,h.g.set(Oa(h,g),R(E)),h.h+=E.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],g=Array.from(this.g.keys());for(let A=0;A<g.length;A++){var E=g[A];const j=na(E);E=zo(this,E);for(let W=0;W<E.length;W++){let le=j;E[W]!==""&&(le+="="+na(E[W])),h.push(le)}}return this.i=h.join("&")};function Eu(h){const g=new Da;return g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),g}function Oa(h,g){return g=String(g),h.j&&(g=g.toLowerCase()),g}function ms(h,g){g&&!h.j&&(An(h),h.i=null,h.g.forEach(function(E,A){const j=A.toLowerCase();A!=j&&(Tu(this,A),ds(this,j,E))},h)),h.j=g}function di(h,g){const E=new ci;if(c.Image){const A=new Image;A.onload=y(Wn,E,"TestLoadImage: loaded",!0,g,A),A.onerror=y(Wn,E,"TestLoadImage: error",!1,g,A),A.onabort=y(Wn,E,"TestLoadImage: abort",!1,g,A),A.ontimeout=y(Wn,E,"TestLoadImage: timeout",!1,g,A),c.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else g(!1)}function Uo(h,g){const E=new ci,A=new AbortController,j=setTimeout(()=>{A.abort(),Wn(E,"TestPingServer: timeout",!1,g)},1e4);fetch(h,{signal:A.signal}).then(W=>{clearTimeout(j),W.ok?Wn(E,"TestPingServer: ok",!0,g):Wn(E,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(j),Wn(E,"TestPingServer: error",!1,g)})}function Wn(h,g,E,A,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),A(E)}catch{}}function Ca(){this.g=new ou}function zi(h){this.i=h.Sb||null,this.h=h.ab||!1}v(zi,lu),zi.prototype.g=function(){return new kr(this.i,this.h)};function kr(h,g){Nt.call(this),this.H=h,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(kr,Nt),e=kr.prototype,e.open=function(h,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=g,this.readyState=1,mi(this)},e.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(g.body=h),(this.H||c).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Na(this)),this.readyState=0},e.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,mi(this)),this.g&&(this.readyState=3,mi(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;_s(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function _s(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}e.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var g=h.value?h.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!h.done}))&&(this.response=this.responseText+=g)}h.done?Na(this):mi(this),this.readyState==3&&_s(this)}},e.Oa=function(h){this.g&&(this.response=this.responseText=h,Na(this))},e.Na=function(h){this.g&&(this.response=h,Na(this))},e.ga=function(){this.g&&Na(this)};function Na(h){h.readyState=4,h.l=null,h.j=null,h.B=null,mi(h)}e.setRequestHeader=function(h,g){this.A.append(h,g)},e.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],g=this.h.entries();for(var E=g.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=g.next();return h.join(`\r
`)};function mi(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(kr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Xn(h){let g="";return Xe(h,function(E,A){g+=A,g+=":",g+=E,g+=`\r
`}),g}function Dr(h,g,E){e:{for(A in E){var A=!1;break e}A=!0}A||(E=Xn(E),typeof h=="string"?E!=null&&na(E):it(h,g,E))}function st(h){Nt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(st,Nt);var Ui=/^https?$/i,Bo=["POST","PUT"];e=st.prototype,e.Fa=function(h){this.H=h},e.ea=function(h,g,E,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);g=g?g.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Oo.g(),this.g.onreadystatechange=w(p(this.Ca,this));try{this.B=!0,this.g.open(g,String(h),!0),this.B=!1}catch(W){Or(this,W);return}if(h=E||"",E=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var j in A)E.set(j,A[j]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const W of A.keys())E.set(W,A.get(W));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(E.keys()).find(W=>W.toLowerCase()=="content-type"),j=c.FormData&&h instanceof c.FormData,!(Array.prototype.indexOf.call(Bo,g,void 0)>=0)||A||j||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,le]of E)this.g.setRequestHeader(W,le);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(W){Or(this,W)}};function Or(h,g){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=g,h.o=5,Go(h),ia(h)}function Go(h){h.A||(h.A=!0,Ft(h,"complete"),Ft(h,"error"))}e.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ft(this,"complete"),Ft(this,"abort"),ia(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ia(this,!0)),st.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Cr(this):this.Xa())},e.Xa=function(){Cr(this)};function Cr(h){if(h.h&&typeof u<"u"){if(h.v&&_i(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ft(h,"readystatechange"),_i(h)==4){h.h=!1;try{const W=h.ca();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var E;if(!(E=g)){var A;if(A=W===0){let le=String(h.D).match(pu)[1]||null;!le&&c.self&&c.self.location&&(le=c.self.location.protocol.slice(0,-1)),A=!Ui.test(le?le.toLowerCase():"")}E=A}if(E)Ft(h,"complete"),Ft(h,"success");else{h.o=6;try{var j=_i(h)>2?h.g.statusText:""}catch{j=""}h.l=j+" ["+h.ca()+"]",Go(h)}}finally{ia(h)}}}}function ia(h,g){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const E=h.g;h.g=null,g||Ft(h,"ready");try{E.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function _i(h){return h.g?h.g.readyState:0}e.ca=function(){try{return _i(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.La=function(h){if(this.g){var g=this.g.responseText;return h&&g.indexOf(h)==0&&(g=g.substring(h.length)),Mh(g)}};function rn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function aa(h){const g={};h=(h.g&&_i(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(C(h[A]))continue;var E=du(h[A]);const j=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const W=g[j]||[];g[j]=W,W.push(E)}nt(g,function(A){return A.join(", ")})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bi(h,g,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||g}function Ma(h){this.za=0,this.i=[],this.j=new ci,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bi("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bi("baseRetryDelayMs",5e3,h),this.Za=Bi("retryDelaySeedMs",1e4,h),this.Ta=Bi("forwardChannelMaxRetries",2,h),this.va=Bi("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Co(h&&h.concurrentRequestLimit),this.Ba=new Ca,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=Ma.prototype,e.ka=8,e.I=1,e.connect=function(h,g,E,A){Mt(0),this.W=h,this.H=g||{},E&&A!==void 0&&(this.H.OSID=E,this.H.OAID=A),this.F=this.X,this.J=Iu(this,null,this.W),Gi(this)};function jo(h){if(ps(h),h.I==3){var g=h.V++,E=Ht(h.J);if(it(E,"SID",h.M),it(E,"RID",g),it(E,"TYPE","terminate"),Nr(h,E),g=new hi(h,h.j,g),g.M=2,g.A=Rr(Ht(E)),E=!1,c.navigator&&c.navigator.sendBeacon)try{E=c.navigator.sendBeacon(g.A.toString(),"")}catch{}!E&&c.Image&&(new Image().src=g.A,E=!0),E||(g.g=ku(g.j,null),g.g.ea(g.A)),g.F=Date.now(),Mi(g)}Ru(h)}function Va(h){h.g&&(Yo(h),h.g.cancel(),h.g=null)}function ps(h){Va(h),h.v&&(c.clearTimeout(h.v),h.v=null),ys(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&c.clearTimeout(h.m),h.m=null)}function Gi(h){if(!No(h.h)&&!h.m){h.m=!0;var g=h.Ea;Ce||I(),we||(Ce(),we=!0),k.add(g,h),h.D=0}}function gs(h,g){return Hi(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=g.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Oi(p(h.Ea,h,g),Su(h,h.D)),h.D++,!0)}e.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const j=new hi(this,this.j,h);let W=this.o;if(this.U&&(W?(W=x(W),ce(W,this.U)):W=this.U),this.u!==null||this.R||(j.J=W,W=null),this.S)e:{for(var g=0,E=0;E<this.i.length;E++){t:{var A=this.i[E];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(g+=A,g>4096){g=E;break e}if(g===4096||E===this.i.length-1){g=E+1;break e}}g=1e3}else g=1e3;g=vu(this,j,g),E=Ht(this.J),it(E,"RID",h),it(E,"CVER",22),this.G&&it(E,"X-HTTP-Session-Id",this.G),Nr(this,E),W&&(this.R?g="headers="+na(Xn(W))+"&"+g:this.u&&Dr(E,this.u,W)),Mo(this.h,j),this.Ra&&it(E,"TYPE","init"),this.S?(it(E,"$req",g),it(E,"SID","null"),j.U=!0,Ni(j,E,null)):Ni(j,E,g),this.I=2}}else this.I==3&&(h?qo(this,h):this.i.length==0||No(this.h)||qo(this))};function qo(h,g){var E;g?E=g.l:E=h.V++;const A=Ht(h.J);it(A,"SID",h.M),it(A,"RID",E),it(A,"AID",h.K),Nr(h,A),h.u&&h.o&&Dr(A,h.u,h.o),E=new hi(h,h.j,E,h.D+1),h.u===null&&(E.J=h.o),g&&(h.i=g.G.concat(h.i)),g=vu(h,E,1e3),E.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Mo(h.h,E),Ni(E,A,g)}function Nr(h,g){h.H&&Xe(h.H,function(E,A){it(g,A,E)}),h.l&&Xe({},function(E,A){it(g,A,E)})}function vu(h,g,E){E=Math.min(h.i.length,E);const A=h.l?p(h.l.Ka,h.l,h):null;e:{var j=h.i;let Ne=-1;for(;;){const kt=["count="+E];Ne==-1?E>0?(Ne=j[0].g,kt.push("ofs="+Ne)):Ne=0:kt.push("ofs="+Ne);let Je=!0;for(let Et=0;Et<E;Et++){var W=j[Et].g;const Kn=j[Et].map;if(W-=Ne,W<0)Ne=Math.max(0,j[Et].g-100),Je=!1;else try{W="req"+W+"_"||"";try{var le=Kn instanceof Map?Kn:Object.entries(Kn);for(const[qi,pi]of le){let gi=pi;m(pi)&&(gi=Ra(pi)),kt.push(W+qi+"="+encodeURIComponent(gi))}}catch(qi){throw kt.push(W+"type="+encodeURIComponent("_badmap")),qi}}catch{A&&A(Kn)}}if(Je){le=kt.join("&");break e}}le=void 0}return h=h.i.splice(0,E),g.G=h,le}function wu(h){if(!h.g&&!h.v){h.Y=1;var g=h.Da;Ce||I(),we||(Ce(),we=!0),k.add(g,h),h.A=0}}function Mr(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Oi(p(h.Da,h),Su(h,h.A)),h.A++,!0)}e.Da=function(){if(this.v=null,bu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Oi(p(this.Wa,this),h)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Mt(10),Va(this),bu(this))};function Yo(h){h.B!=null&&(c.clearTimeout(h.B),h.B=null)}function bu(h){h.g=new hi(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var g=Ht(h.na);it(g,"RID","rpc"),it(g,"SID",h.M),it(g,"AID",h.K),it(g,"CI",h.F?"0":"1"),!h.F&&h.ia&&it(g,"TO",h.ia),it(g,"TYPE","xmlhttp"),Nr(h,g),h.u&&h.o&&Dr(g,h.u,h.o),h.O&&(h.g.H=h.O);var E=h.g;h=h.ba,E.M=1,E.A=Rr(Ht(g)),E.u=null,E.R=!0,us(E,h)}e.Va=function(){this.C!=null&&(this.C=null,Va(this),Mr(this),Mt(19))};function ys(h){h.C!=null&&(c.clearTimeout(h.C),h.C=null)}function Au(h,g){var E=null;if(h.g==g){ys(h),Yo(h),h.g=null;var A=2}else if(Pi(h.h,g))E=g.G,Vo(h.h,g),A=1;else return;if(h.I!=0){if(g.o)if(A==1){E=g.u?g.u.length:0,g=Date.now()-g.F;var j=h.D;A=ls(),Ft(A,new Di(A,E)),Gi(h)}else wu(h);else if(j=g.m,j==3||j==0&&g.X>0||!(A==1&&gs(h,g)||A==2&&Mr(h)))switch(E&&E.length>0&&(g=h.h,g.i=g.i.concat(E)),j){case 1:ji(h,5);break;case 4:ji(h,10);break;case 3:ji(h,6);break;default:ji(h,2)}}}function Su(h,g){let E=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(E*=2),E*g}function ji(h,g){if(h.j.info("Error code "+g),g==2){var E=p(h.bb,h),A=h.Ua;const j=!A;A=new Pn(A||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||$t(A,"https"),Rr(A),j?di(A.toString(),E):Uo(A.toString(),E)}else Mt(2);h.I=0,h.l&&h.l.pa(g),Ru(h),ps(h)}e.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function Ru(h){if(h.I=0,h.ja=[],h.l){const g=Lo(h.h);(g.length!=0||h.i.length!=0)&&(M(h.ja,g),M(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function Iu(h,g,E){var A=E instanceof Pn?Ht(E):new Pn(E);if(A.g!="")g&&(A.g=g+"."+A.g),Ia(A,A.u);else{var j=c.location;A=j.protocol,g=g?g+"."+j.hostname:j.hostname,j=+j.port;const W=new Pn(null);A&&$t(W,A),g&&(W.g=g),j&&Ia(W,j),E&&(W.h=E),A=W}return E=h.G,g=h.wa,E&&g&&it(A,E,g),it(A,"VER",h.ka),Nr(h,A),A}function ku(h,g,E){if(g&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=h.Aa&&!h.ma?new st(new zi({ab:E})):new st(h.ma),g.Fa(h.L),g}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Du(){}e=Du.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function La(){}La.prototype.g=function(h,g){return new vn(h,g)};function vn(h,g){Nt.call(this),this.g=new Ma(g),this.l=h,this.h=g&&g.messageUrlParams||null,h=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(h?h["X-WebChannel-Content-Type"]=g.messageContentType:h={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(h?h["X-WebChannel-Client-Profile"]=g.sa:h={"X-WebChannel-Client-Profile":g.sa}),this.g.U=h,(h=g&&g.Qb)&&!C(h)&&(this.g.u=h),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!C(g)&&(this.g.G=g,h=this.h,h!==null&&g in h&&(h=this.h,g in h&&delete h[g])),this.j=new ra(this)}v(vn,Nt),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){jo(this.g)},vn.prototype.o=function(h){var g=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.v&&(E={},E.__data__=Ra(h),h=E);g.i.push(new Lt(g.Ya++,h)),g.I==3&&Gi(g)},vn.prototype.N=function(){this.g.l=null,delete this.j,jo(this.g),delete this.g,vn.Z.N.call(this)};function Ou(h){an.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var g=h.__sm__;if(g){e:{for(const E in g){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,g=g!==null&&h in g?g[h]:void 0),this.data=g}else this.data=h}v(Ou,an);function Cu(){Yn.call(this),this.status=1}v(Cu,Yn);function ra(h){this.g=h}v(ra,Du),ra.prototype.ra=function(){Ft(this.g,"a")},ra.prototype.qa=function(h){Ft(this.g,new Ou(h))},ra.prototype.pa=function(h){Ft(this.g,new Cu)},ra.prototype.oa=function(){Ft(this.g,"b")},La.prototype.createWebChannel=La.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,PT=function(){return new La},HT=function(){return ls()},LT=It,im={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ar.NO_ERROR=0,Ar.TIMEOUT=8,Ar.HTTP_ERROR=6,Yc=Ar,Do.COMPLETE="complete",VT=Do,uu.EventType=ui,ui.OPEN="a",ui.CLOSE="b",ui.ERROR="c",ui.MESSAGE="d",Nt.prototype.listen=Nt.prototype.J,Cl=uu,st.prototype.listenOnce=st.prototype.K,st.prototype.getLastError=st.prototype.Ha,st.prototype.getLastErrorCode=st.prototype.ya,st.prototype.getStatus=st.prototype.ca,st.prototype.getResponseJson=st.prototype.La,st.prototype.getResponseText=st.prototype.la,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Fa,MT=st}).apply(typeof Lc<"u"?Lc:typeof self<"u"?self:typeof window<"u"?window:{});class yn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");let go="12.9.0";function $A(e){go=e}const Zr=new RT("@firebase/firestore");function Qs(){return Zr.logLevel}function fe(e,...t){if(Zr.logLevel<=Fe.DEBUG){const i=t.map(Im);Zr.debug(`Firestore (${go}): ${e}`,...i)}}function ba(e,...t){if(Zr.logLevel<=Fe.ERROR){const i=t.map(Im);Zr.error(`Firestore (${go}): ${e}`,...i)}}function Jr(e,...t){if(Zr.logLevel<=Fe.WARN){const i=t.map(Im);Zr.warn(`Firestore (${go}): ${e}`,...i)}}function Im(e){if(typeof e=="string")return e;try{return(function(i){return JSON.stringify(i)})(e)}catch{return e}}function Se(e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,xT(e,r,i)}function xT(e,t,i){let r=`FIRESTORE (${go}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(i!==void 0)try{r+=" CONTEXT: "+JSON.stringify(i)}catch{r+=" CONTEXT: "+i}throw ba(r),new Error(r)}function tt(e,t,i,r){let o="Unexpected state";typeof i=="string"?o=i:r=i,e||xT(t,o,r)}function Oe(e,t){return e}const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends po{constructor(t,i){super(t,i),this.code=t,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cr{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}}class zT{constructor(t,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ZA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,i){t.enqueueRetryable((()=>i(yn.UNAUTHENTICATED)))}shutdown(){}}class JA{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,i){this.changeListener=i,t.enqueueRetryable((()=>i(this.token.user)))}shutdown(){this.changeListener=null}}class eS{constructor(t){this.t=t,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,i){tt(this.o===void 0,42304);let r=this.i;const o=_=>this.i!==r?(r=this.i,i(_)):Promise.resolve();let u=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new cr,t.enqueueRetryable((()=>o(this.currentUser)))};const c=()=>{const _=u;t.enqueueRetryable((async()=>{await _.promise,await o(this.currentUser)}))},m=_=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=_,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((_=>m(_))),setTimeout((()=>{if(!this.auth){const _=this.t.getImmediate({optional:!0});_?m(_):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new cr)}}),0),c()}getToken(){const t=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then((r=>this.i!==t?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(tt(typeof r.accessToken=="string",31837,{l:r}),new zT(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return tt(t===null||typeof t=="string",2055,{h:t}),new yn(t)}}class tS{constructor(t,i,r){this.P=t,this.T=i,this.I=r,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class nS{constructor(t,i,r){this.P=t,this.T=i,this.I=r}getToken(){return Promise.resolve(new tS(this.P,this.T,this.I))}start(t,i){t.enqueueRetryable((()=>i(yn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class i0{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iS{constructor(t,i){this.V=i,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,VA(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,i){tt(this.o===void 0,3512);const r=u=>{u.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const c=u.token!==this.m;return this.m=u.token,fe("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?i(u.token):Promise.resolve()};this.o=u=>{t.enqueueRetryable((()=>r(u)))};const o=u=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>o(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?o(u):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new i0(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((i=>i?(tt(typeof i.token=="string",44558,{tokenResult:i}),this.m=i.token,new i0(i.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function aS(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),i=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(i);else for(let r=0;r<e;r++)i[r]=Math.floor(256*Math.random());return i}class km{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=aS(40);for(let u=0;u<o.length;++u)r.length<20&&o[u]<i&&(r+=t.charAt(o[u]%62))}return r}}function Be(e,t){return e<t?-1:e>t?1:0}function am(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const o=e.charAt(r),u=t.charAt(r);if(o!==u)return Bd(o)===Bd(u)?Be(o,u):Bd(o)?1:-1}return Be(e.length,t.length)}const rS=55296,sS=57343;function Bd(e){const t=e.charCodeAt(0);return t>=rS&&t<=sS}function uo(e,t,i){return e.length===t.length&&e.every(((r,o)=>i(r,t[o])))}const a0="__name__";class Qi{constructor(t,i,r){i===void 0?i=0:i>t.length&&Se(637,{offset:i,range:t.length}),r===void 0?r=t.length-i:r>t.length-i&&Se(1746,{length:r,range:t.length-i}),this.segments=t,this.offset=i,this.len=r}get length(){return this.len}isEqual(t){return Qi.comparator(this,t)===0}child(t){const i=this.segments.slice(this.offset,this.limit());return t instanceof Qi?t.forEach((r=>{i.push(r)})):i.push(t),this.construct(i)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==t.get(i))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==t.get(i))return!1;return!0}forEach(t){for(let i=this.offset,r=this.limit();i<r;i++)t(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,i){const r=Math.min(t.length,i.length);for(let o=0;o<r;o++){const u=Qi.compareSegments(t.get(o),i.get(o));if(u!==0)return u}return Be(t.length,i.length)}static compareSegments(t,i){const r=Qi.isNumericId(t),o=Qi.isNumericId(i);return r&&!o?-1:!r&&o?1:r&&o?Qi.extractNumericId(t).compare(Qi.extractNumericId(i)):am(t,i)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return ur.fromString(t.substring(4,t.length-2))}}class dt extends Qi{construct(t,i,r){return new dt(t,i,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const i=[];for(const r of t){if(r.indexOf("//")>=0)throw new he(te.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);i.push(...r.split("/").filter((o=>o.length>0)))}return new dt(i)}static emptyPath(){return new dt([])}}const oS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends Qi{construct(t,i,r){return new dn(t,i,r)}static isValidIdentifier(t){return oS.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===a0}static keyField(){return new dn([a0])}static fromServerFormat(t){const i=[];let r="",o=0;const u=()=>{if(r.length===0)throw new he(te.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(r),r=""};let c=!1;for(;o<t.length;){const m=t[o];if(m==="\\"){if(o+1===t.length)throw new he(te.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const _=t[o+1];if(_!=="\\"&&_!=="."&&_!=="`")throw new he(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=_,o+=2}else m==="`"?(c=!c,o++):m!=="."||c?(r+=m,o++):(u(),o++)}if(u(),c)throw new he(te.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new dn(i)}static emptyPath(){return new dn([])}}class Te{constructor(t){this.path=t}static fromPath(t){return new Te(dt.fromString(t))}static fromName(t){return new Te(dt.fromString(t).popFirst(5))}static empty(){return new Te(dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&dt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,i){return dt.comparator(t.path,i.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Te(new dt(t.slice()))}}function UT(e,t,i){if(!i)throw new he(te.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function lS(e,t,i,r){if(t===!0&&r===!0)throw new he(te.INVALID_ARGUMENT,`${e} and ${i} cannot be used together.`)}function r0(e){if(!Te.isDocumentKey(e))throw new he(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function s0(e){if(Te.isDocumentKey(e))throw new he(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function BT(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function mh(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=(function(r){return r.constructor?r.constructor.name:null})(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Se(12329,{type:typeof e})}function jl(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new he(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=mh(e);throw new he(te.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${i}`)}}return e}function uS(e,t){if(t<=0)throw new he(te.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function jt(e,t){const i={typeString:e};return t&&(i.value=t),i}function tu(e,t){if(!BT(e))throw new he(te.INVALID_ARGUMENT,"JSON must be an object");let i;for(const r in t)if(t[r]){const o=t[r].typeString,u="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){i=`JSON missing required field: '${r}'`;break}const c=e[r];if(o&&typeof c!==o){i=`JSON field '${r}' must be a ${o}.`;break}if(u!==void 0&&c!==u.value){i=`Expected '${r}' field to equal '${u.value}'`;break}}if(i)throw new he(te.INVALID_ARGUMENT,i);return!0}const o0=-62135596800,l0=1e6;class gt{static now(){return gt.fromMillis(Date.now())}static fromDate(t){return gt.fromMillis(t.getTime())}static fromMillis(t){const i=Math.floor(t/1e3),r=Math.floor((t-1e3*i)*l0);return new gt(i,r)}constructor(t,i){if(this.seconds=t,this.nanoseconds=i,i<0)throw new he(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new he(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(t<o0)throw new he(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new he(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l0}_compareTo(t){return this.seconds===t.seconds?Be(this.nanoseconds,t.nanoseconds):Be(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(tu(t,gt._jsonSchema))return new gt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-o0;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gt._jsonSchemaVersion="firestore/timestamp/1.0",gt._jsonSchema={type:jt("string",gt._jsonSchemaVersion),seconds:jt("number"),nanoseconds:jt("number")};class Ie{static fromTimestamp(t){return new Ie(t)}static min(){return new Ie(new gt(0,0))}static max(){return new Ie(new gt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ql=-1;function cS(e,t){const i=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,o=Ie.fromTimestamp(r===1e9?new gt(i+1,0):new gt(i,r));return new fr(o,Te.empty(),t)}function hS(e){return new fr(e.readTime,e.key,ql)}class fr{constructor(t,i,r){this.readTime=t,this.documentKey=i,this.largestBatchId=r}static min(){return new fr(Ie.min(),Te.empty(),ql)}static max(){return new fr(Ie.max(),Te.empty(),ql)}}function fS(e,t){let i=e.readTime.compareTo(t.readTime);return i!==0?i:(i=Te.comparator(e.documentKey,t.documentKey),i!==0?i:Be(e.largestBatchId,t.largestBatchId))}const dS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function yo(e){if(e.code!==te.FAILED_PRECONDITION||e.message!==dS)throw e;fe("LocalStore","Unexpectedly lost primary lease")}class ie{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)}),(i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)}))}catch(t){return this.next(void 0,t)}next(t,i){return this.callbackAttached&&Se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(t,this.result):new ie(((r,o)=>{this.nextCallback=u=>{this.wrapSuccess(t,u).next(r,o)},this.catchCallback=u=>{this.wrapFailure(i,u).next(r,o)}}))}toPromise(){return new Promise(((t,i)=>{this.next(t,i)}))}wrapUserFunction(t){try{const i=t();return i instanceof ie?i:ie.resolve(i)}catch(i){return ie.reject(i)}}wrapSuccess(t,i){return t?this.wrapUserFunction((()=>t(i))):ie.resolve(i)}wrapFailure(t,i){return t?this.wrapUserFunction((()=>t(i))):ie.reject(i)}static resolve(t){return new ie(((i,r)=>{i(t)}))}static reject(t){return new ie(((i,r)=>{r(t)}))}static waitFor(t){return new ie(((i,r)=>{let o=0,u=0,c=!1;t.forEach((m=>{++o,m.next((()=>{++u,c&&u===o&&i()}),(_=>r(_)))})),c=!0,u===o&&i()}))}static or(t){let i=ie.resolve(!1);for(const r of t)i=i.next((o=>o?ie.resolve(o):r()));return i}static forEach(t,i){const r=[];return t.forEach(((o,u)=>{r.push(i.call(this,o,u))})),this.waitFor(r)}static mapArray(t,i){return new ie(((r,o)=>{const u=t.length,c=new Array(u);let m=0;for(let _=0;_<u;_++){const p=_;i(t[p]).next((y=>{c[p]=y,++m,m===u&&r(c)}),(y=>o(y)))}}))}static doWhile(t,i){return new ie(((r,o)=>{const u=()=>{t()===!0?i().next((()=>{u()}),o):r()};u()}))}}function _S(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}function To(e){return e.name==="IndexedDbTransactionError"}class _h{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>i.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}_h.ce=-1;const Dm=-1;function ph(e){return e==null}function th(e){return e===0&&1/e==-1/0}function pS(e){return typeof e=="number"&&Number.isInteger(e)&&!th(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const GT="";function gS(e){let t="";for(let i=0;i<e.length;i++)t.length>0&&(t=u0(t)),t=yS(e.get(i),t);return u0(t)}function yS(e,t){let i=t;const r=e.length;for(let o=0;o<r;o++){const u=e.charAt(o);switch(u){case"\0":i+="";break;case GT:i+="";break;default:i+=u}}return i}function u0(e){return e+GT+""}function c0(e){let t=0;for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&t++;return t}function ts(e,t){for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&t(i,e[i])}function jT(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class bt{constructor(t,i){this.comparator=t,this.root=i||cn.EMPTY}insert(t,i){return new bt(this.comparator,this.root.insert(t,i,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(t){return new bt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,cn.BLACK,null,null))}get(t){let i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return i.value;r<0?i=i.left:r>0&&(i=i.right)}return null}indexOf(t){let i=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(t,r.key);if(o===0)return i+r.left.size;o<0?r=r.left:(i+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((i,r)=>(t(i,r),!1)))}toString(){const t=[];return this.inorderTraversal(((i,r)=>(t.push(`${i}:${r}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Hc(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Hc(this.root,t,this.comparator,!1)}getReverseIterator(){return new Hc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Hc(this.root,t,this.comparator,!0)}}class Hc{constructor(t,i,r,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!t.isEmpty();)if(u=i?r(t.key,i):1,i&&o&&(u*=-1),u<0)t=this.isReverse?t.left:t.right;else{if(u===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const i={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class cn{constructor(t,i,r,o,u){this.key=t,this.value=i,this.color=r??cn.RED,this.left=o??cn.EMPTY,this.right=u??cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,i,r,o,u){return new cn(t??this.key,i??this.value,r??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let o=this;const u=r(t,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(t,i,r),null):u===0?o.copy(null,i,null,null,null):o.copy(null,null,null,null,o.right.insert(t,i,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return cn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,i){let r,o=this;if(i(t,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(t,i),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),i(t,o.key)===0){if(o.right.isEmpty())return cn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(t,i))}return o.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Se(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Se(27949);return t+(this.isRed()?0:1)}}cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw Se(57766)}get value(){throw Se(16141)}get color(){throw Se(16727)}get left(){throw Se(29726)}get right(){throw Se(36894)}copy(t,i,r,o,u){return this}insert(t,i,r){return new cn(t,i)}remove(t,i){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Kt{constructor(t){this.comparator=t,this.data=new bt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((i,r)=>(t(i),!1)))}forEachInRange(t,i){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,t[1])>=0)return;i(o.key)}}forEachWhile(t,i){let r;for(r=i!==void 0?this.data.getIteratorFrom(i):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const i=this.data.getIteratorFrom(t);return i.hasNext()?i.getNext().key:null}getIterator(){return new h0(this.data.getIterator())}getIteratorFrom(t){return new h0(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let i=this;return i.size<t.size&&(i=t,t=this),t.forEach((r=>{i=i.add(r)})),i}isEqual(t){if(!(t instanceof Kt)||this.size!==t.size)return!1;const i=this.data.getIterator(),r=t.data.getIterator();for(;i.hasNext();){const o=i.getNext().key,u=r.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((i=>{t.push(i)})),t}toString(){const t=[];return this.forEach((i=>t.push(i))),"SortedSet("+t.toString()+")"}copy(t){const i=new Kt(this.comparator);return i.data=t,i}}class h0{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class bi{constructor(t){this.fields=t,t.sort(dn.comparator)}static empty(){return new bi([])}unionWith(t){let i=new Kt(dn.comparator);for(const r of this.fields)i=i.add(r);for(const r of t)i=i.add(r);return new bi(i.toArray())}covers(t){for(const i of this.fields)if(i.isPrefixOf(t))return!0;return!1}isEqual(t){return uo(this.fields,t.fields,((i,r)=>i.isEqual(r)))}}class qT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _n{constructor(t){this.binaryString=t}static fromBase64String(t){const i=(function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new qT("Invalid base64 string: "+u):u}})(t);return new _n(i)}static fromUint8Array(t){const i=(function(o){let u="";for(let c=0;c<o.length;++c)u+=String.fromCharCode(o[c]);return u})(t);return new _n(i)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(i){return btoa(i)})(this.binaryString)}toUint8Array(){return(function(i){const r=new Uint8Array(i.length);for(let o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Be(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const TS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dr(e){if(tt(!!e,39018),typeof e=="string"){let t=0;const i=TS.exec(e);if(tt(!!i,46558,{timestamp:e}),i[1]){let o=i[1];o=(o+"000000000").substr(0,9),t=Number(o)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ct(e.seconds),nanos:Ct(e.nanos)}}function Ct(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function mr(e){return typeof e=="string"?_n.fromBase64String(e):_n.fromUint8Array(e)}const YT="server_timestamp",FT="__type__",WT="__previous_value__",XT="__local_write_time__";function Om(e){return(e?.mapValue?.fields||{})[FT]?.stringValue===YT}function gh(e){const t=e.mapValue.fields[WT];return Om(t)?gh(t):t}function Yl(e){const t=dr(e.mapValue.fields[XT].timestampValue);return new gt(t.seconds,t.nanos)}class ES{constructor(t,i,r,o,u,c,m,_,p,y,v){this.databaseId=t,this.appId=i,this.persistenceKey=r,this.host=o,this.ssl=u,this.forceLongPolling=c,this.autoDetectLongPolling=m,this.longPollingOptions=_,this.useFetchStreams=p,this.isUsingEmulator=y,this.apiKey=v}}const nh="(default)";class Fl{constructor(t,i){this.projectId=t,this.database=i||nh}static empty(){return new Fl("","")}get isDefaultDatabase(){return this.database===nh}isEqual(t){return t instanceof Fl&&t.projectId===this.projectId&&t.database===this.database}}function vS(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new he(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fl(e.options.projectId,t)}const KT="__type__",wS="__max__",Pc={mapValue:{}},QT="__vector__",ih="value";function _r(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Om(e)?4:AS(e)?9007199254740991:bS(e)?10:11:Se(28295,{value:e})}function ta(e,t){if(e===t)return!0;const i=_r(e);if(i!==_r(t))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Yl(e).isEqual(Yl(t));case 3:return(function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const c=dr(o.timestampValue),m=dr(u.timestampValue);return c.seconds===m.seconds&&c.nanos===m.nanos})(e,t);case 5:return e.stringValue===t.stringValue;case 6:return(function(o,u){return mr(o.bytesValue).isEqual(mr(u.bytesValue))})(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return(function(o,u){return Ct(o.geoPointValue.latitude)===Ct(u.geoPointValue.latitude)&&Ct(o.geoPointValue.longitude)===Ct(u.geoPointValue.longitude)})(e,t);case 2:return(function(o,u){if("integerValue"in o&&"integerValue"in u)return Ct(o.integerValue)===Ct(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const c=Ct(o.doubleValue),m=Ct(u.doubleValue);return c===m?th(c)===th(m):isNaN(c)&&isNaN(m)}return!1})(e,t);case 9:return uo(e.arrayValue.values||[],t.arrayValue.values||[],ta);case 10:case 11:return(function(o,u){const c=o.mapValue.fields||{},m=u.mapValue.fields||{};if(c0(c)!==c0(m))return!1;for(const _ in c)if(c.hasOwnProperty(_)&&(m[_]===void 0||!ta(c[_],m[_])))return!1;return!0})(e,t);default:return Se(52216,{left:e})}}function Wl(e,t){return(e.values||[]).find((i=>ta(i,t)))!==void 0}function co(e,t){if(e===t)return 0;const i=_r(e),r=_r(t);if(i!==r)return Be(i,r);switch(i){case 0:case 9007199254740991:return 0;case 1:return Be(e.booleanValue,t.booleanValue);case 2:return(function(u,c){const m=Ct(u.integerValue||u.doubleValue),_=Ct(c.integerValue||c.doubleValue);return m<_?-1:m>_?1:m===_?0:isNaN(m)?isNaN(_)?0:-1:1})(e,t);case 3:return f0(e.timestampValue,t.timestampValue);case 4:return f0(Yl(e),Yl(t));case 5:return am(e.stringValue,t.stringValue);case 6:return(function(u,c){const m=mr(u),_=mr(c);return m.compareTo(_)})(e.bytesValue,t.bytesValue);case 7:return(function(u,c){const m=u.split("/"),_=c.split("/");for(let p=0;p<m.length&&p<_.length;p++){const y=Be(m[p],_[p]);if(y!==0)return y}return Be(m.length,_.length)})(e.referenceValue,t.referenceValue);case 8:return(function(u,c){const m=Be(Ct(u.latitude),Ct(c.latitude));return m!==0?m:Be(Ct(u.longitude),Ct(c.longitude))})(e.geoPointValue,t.geoPointValue);case 9:return d0(e.arrayValue,t.arrayValue);case 10:return(function(u,c){const m=u.fields||{},_=c.fields||{},p=m[ih]?.arrayValue,y=_[ih]?.arrayValue,v=Be(p?.values?.length||0,y?.values?.length||0);return v!==0?v:d0(p,y)})(e.mapValue,t.mapValue);case 11:return(function(u,c){if(u===Pc.mapValue&&c===Pc.mapValue)return 0;if(u===Pc.mapValue)return 1;if(c===Pc.mapValue)return-1;const m=u.fields||{},_=Object.keys(m),p=c.fields||{},y=Object.keys(p);_.sort(),y.sort();for(let v=0;v<_.length&&v<y.length;++v){const w=am(_[v],y[v]);if(w!==0)return w;const R=co(m[_[v]],p[y[v]]);if(R!==0)return R}return Be(_.length,y.length)})(e.mapValue,t.mapValue);default:throw Se(23264,{he:i})}}function f0(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Be(e,t);const i=dr(e),r=dr(t),o=Be(i.seconds,r.seconds);return o!==0?o:Be(i.nanos,r.nanos)}function d0(e,t){const i=e.values||[],r=t.values||[];for(let o=0;o<i.length&&o<r.length;++o){const u=co(i[o],r[o]);if(u)return u}return Be(i.length,r.length)}function ho(e){return rm(e)}function rm(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(function(i){const r=dr(i);return`time(${r.seconds},${r.nanos})`})(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?(function(i){return mr(i).toBase64()})(e.bytesValue):"referenceValue"in e?(function(i){return Te.fromName(i).toString()})(e.referenceValue):"geoPointValue"in e?(function(i){return`geo(${i.latitude},${i.longitude})`})(e.geoPointValue):"arrayValue"in e?(function(i){let r="[",o=!0;for(const u of i.values||[])o?o=!1:r+=",",r+=rm(u);return r+"]"})(e.arrayValue):"mapValue"in e?(function(i){const r=Object.keys(i.fields||{}).sort();let o="{",u=!0;for(const c of r)u?u=!1:o+=",",o+=`${c}:${rm(i.fields[c])}`;return o+"}"})(e.mapValue):Se(61005,{value:e})}function Fc(e){switch(_r(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=gh(e);return t?16+Fc(t):16;case 5:return 2*e.stringValue.length;case 6:return mr(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,u)=>o+Fc(u)),0)})(e.arrayValue);case 10:case 11:return(function(r){let o=0;return ts(r.fields,((u,c)=>{o+=u.length+Fc(c)})),o})(e.mapValue);default:throw Se(13486,{value:e})}}function m0(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function sm(e){return!!e&&"integerValue"in e}function Cm(e){return!!e&&"arrayValue"in e}function _0(e){return!!e&&"nullValue"in e}function p0(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Wc(e){return!!e&&"mapValue"in e}function bS(e){return(e?.mapValue?.fields||{})[KT]?.stringValue===QT}function Ll(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return ts(e.mapValue.fields,((i,r)=>t.mapValue.fields[i]=Ll(r))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let i=0;i<(e.arrayValue.values||[]).length;++i)t.arrayValue.values[i]=Ll(e.arrayValue.values[i]);return t}return{...e}}function AS(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===wS}class si{constructor(t){this.value=t}static empty(){return new si({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let i=this.value;for(let r=0;r<t.length-1;++r)if(i=(i.mapValue.fields||{})[t.get(r)],!Wc(i))return null;return i=(i.mapValue.fields||{})[t.lastSegment()],i||null}}set(t,i){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ll(i)}setAll(t){let i=dn.emptyPath(),r={},o=[];t.forEach(((c,m)=>{if(!i.isImmediateParentOf(m)){const _=this.getFieldsMap(i);this.applyChanges(_,r,o),r={},o=[],i=m.popLast()}c?r[m.lastSegment()]=Ll(c):o.push(m.lastSegment())}));const u=this.getFieldsMap(i);this.applyChanges(u,r,o)}delete(t){const i=this.field(t.popLast());Wc(i)&&i.mapValue.fields&&delete i.mapValue.fields[t.lastSegment()]}isEqual(t){return ta(this.value,t.value)}getFieldsMap(t){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let r=0;r<t.length;++r){let o=i.mapValue.fields[t.get(r)];Wc(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},i.mapValue.fields[t.get(r)]=o),i=o}return i.mapValue.fields}applyChanges(t,i,r){ts(i,((o,u)=>t[o]=u));for(const o of r)delete t[o]}clone(){return new si(Ll(this.value))}}function $T(e){const t=[];return ts(e.fields,((i,r)=>{const o=new dn([i]);if(Wc(r)){const u=$T(r.mapValue).fields;if(u.length===0)t.push(o);else for(const c of u)t.push(o.child(c))}else t.push(o)})),new bi(t)}class Tn{constructor(t,i,r,o,u,c,m){this.key=t,this.documentType=i,this.version=r,this.readTime=o,this.createTime=u,this.data=c,this.documentState=m}static newInvalidDocument(t){return new Tn(t,0,Ie.min(),Ie.min(),Ie.min(),si.empty(),0)}static newFoundDocument(t,i,r,o){return new Tn(t,1,i,Ie.min(),r,o,0)}static newNoDocument(t,i){return new Tn(t,2,i,Ie.min(),Ie.min(),si.empty(),0)}static newUnknownDocument(t,i){return new Tn(t,3,i,Ie.min(),Ie.min(),si.empty(),2)}convertToFoundDocument(t,i){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=si.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Tn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ah{constructor(t,i){this.position=t,this.inclusive=i}}function g0(e,t,i){let r=0;for(let o=0;o<e.position.length;o++){const u=t[o],c=e.position[o];if(u.field.isKeyField()?r=Te.comparator(Te.fromName(c.referenceValue),i.key):r=co(c,i.data.field(u.field)),u.dir==="desc"&&(r*=-1),r!==0)break}return r}function y0(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let i=0;i<e.position.length;i++)if(!ta(e.position[i],t.position[i]))return!1;return!0}class Xl{constructor(t,i="asc"){this.field=t,this.dir=i}}function SS(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ZT{}class Gt extends ZT{constructor(t,i,r){super(),this.field=t,this.op=i,this.value=r}static create(t,i,r){return t.isKeyField()?i==="in"||i==="not-in"?this.createKeyFieldInFilter(t,i,r):new IS(t,i,r):i==="array-contains"?new OS(t,r):i==="in"?new CS(t,r):i==="not-in"?new NS(t,r):i==="array-contains-any"?new MS(t,r):new Gt(t,i,r)}static createKeyFieldInFilter(t,i,r){return i==="in"?new kS(t,r):new DS(t,r)}matches(t){const i=t.data.field(this.field);return this.op==="!="?i!==null&&i.nullValue===void 0&&this.matchesComparison(co(i,this.value)):i!==null&&_r(this.value)===_r(i)&&this.matchesComparison(co(i,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ri extends ZT{constructor(t,i){super(),this.filters=t,this.op=i,this.Pe=null}static create(t,i){return new Ri(t,i)}matches(t){return JT(this)?this.filters.find((i=>!i.matches(t)))===void 0:this.filters.find((i=>i.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,i)=>t.concat(i.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function JT(e){return e.op==="and"}function eE(e){return RS(e)&&JT(e)}function RS(e){for(const t of e.filters)if(t instanceof Ri)return!1;return!0}function om(e){if(e instanceof Gt)return e.field.canonicalString()+e.op.toString()+ho(e.value);if(eE(e))return e.filters.map((t=>om(t))).join(",");{const t=e.filters.map((i=>om(i))).join(",");return`${e.op}(${t})`}}function tE(e,t){return e instanceof Gt?(function(r,o){return o instanceof Gt&&r.op===o.op&&r.field.isEqual(o.field)&&ta(r.value,o.value)})(e,t):e instanceof Ri?(function(r,o){return o instanceof Ri&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((u,c,m)=>u&&tE(c,o.filters[m])),!0):!1})(e,t):void Se(19439)}function nE(e){return e instanceof Gt?(function(i){return`${i.field.canonicalString()} ${i.op} ${ho(i.value)}`})(e):e instanceof Ri?(function(i){return i.op.toString()+" {"+i.getFilters().map(nE).join(" ,")+"}"})(e):"Filter"}class IS extends Gt{constructor(t,i,r){super(t,i,r),this.key=Te.fromName(r.referenceValue)}matches(t){const i=Te.comparator(t.key,this.key);return this.matchesComparison(i)}}class kS extends Gt{constructor(t,i){super(t,"in",i),this.keys=iE("in",i)}matches(t){return this.keys.some((i=>i.isEqual(t.key)))}}class DS extends Gt{constructor(t,i){super(t,"not-in",i),this.keys=iE("not-in",i)}matches(t){return!this.keys.some((i=>i.isEqual(t.key)))}}function iE(e,t){return(t.arrayValue?.values||[]).map((i=>Te.fromName(i.referenceValue)))}class OS extends Gt{constructor(t,i){super(t,"array-contains",i)}matches(t){const i=t.data.field(this.field);return Cm(i)&&Wl(i.arrayValue,this.value)}}class CS extends Gt{constructor(t,i){super(t,"in",i)}matches(t){const i=t.data.field(this.field);return i!==null&&Wl(this.value.arrayValue,i)}}class NS extends Gt{constructor(t,i){super(t,"not-in",i)}matches(t){if(Wl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=t.data.field(this.field);return i!==null&&i.nullValue===void 0&&!Wl(this.value.arrayValue,i)}}class MS extends Gt{constructor(t,i){super(t,"array-contains-any",i)}matches(t){const i=t.data.field(this.field);return!(!Cm(i)||!i.arrayValue.values)&&i.arrayValue.values.some((r=>Wl(this.value.arrayValue,r)))}}class VS{constructor(t,i=null,r=[],o=[],u=null,c=null,m=null){this.path=t,this.collectionGroup=i,this.orderBy=r,this.filters=o,this.limit=u,this.startAt=c,this.endAt=m,this.Te=null}}function T0(e,t=null,i=[],r=[],o=null,u=null,c=null){return new VS(e,t,i,r,o,u,c)}function Nm(e){const t=Oe(e);if(t.Te===null){let i=t.path.canonicalString();t.collectionGroup!==null&&(i+="|cg:"+t.collectionGroup),i+="|f:",i+=t.filters.map((r=>om(r))).join(","),i+="|ob:",i+=t.orderBy.map((r=>(function(u){return u.field.canonicalString()+u.dir})(r))).join(","),ph(t.limit)||(i+="|l:",i+=t.limit),t.startAt&&(i+="|lb:",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>ho(r))).join(",")),t.endAt&&(i+="|ub:",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>ho(r))).join(",")),t.Te=i}return t.Te}function Mm(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(!SS(e.orderBy[i],t.orderBy[i]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(!tE(e.filters[i],t.filters[i]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!y0(e.startAt,t.startAt)&&y0(e.endAt,t.endAt)}function lm(e){return Te.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}class Eo{constructor(t,i=null,r=[],o=[],u=null,c="F",m=null,_=null){this.path=t,this.collectionGroup=i,this.explicitOrderBy=r,this.filters=o,this.limit=u,this.limitType=c,this.startAt=m,this.endAt=_,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function LS(e,t,i,r,o,u,c,m){return new Eo(e,t,i,r,o,u,c,m)}function aE(e){return new Eo(e)}function E0(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function HS(e){return Te.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}function rE(e){return e.collectionGroup!==null}function Hl(e){const t=Oe(e);if(t.Ie===null){t.Ie=[];const i=new Set;for(const u of t.explicitOrderBy)t.Ie.push(u),i.add(u.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(c){let m=new Kt(dn.comparator);return c.filters.forEach((_=>{_.getFlattenedFilters().forEach((p=>{p.isInequality()&&(m=m.add(p.field))}))})),m})(t).forEach((u=>{i.has(u.canonicalString())||u.isKeyField()||t.Ie.push(new Xl(u,r))})),i.has(dn.keyField().canonicalString())||t.Ie.push(new Xl(dn.keyField(),r))}return t.Ie}function $i(e){const t=Oe(e);return t.Ee||(t.Ee=PS(t,Hl(e))),t.Ee}function PS(e,t){if(e.limitType==="F")return T0(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((o=>{const u=o.dir==="desc"?"asc":"desc";return new Xl(o.field,u)}));const i=e.endAt?new ah(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ah(e.startAt.position,e.startAt.inclusive):null;return T0(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}}function um(e,t){const i=e.filters.concat([t]);return new Eo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),i,e.limit,e.limitType,e.startAt,e.endAt)}function xS(e,t){const i=e.explicitOrderBy.concat([t]);return new Eo(e.path,e.collectionGroup,i,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function rh(e,t,i){return new Eo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,i,e.startAt,e.endAt)}function yh(e,t){return Mm($i(e),$i(t))&&e.limitType===t.limitType}function sE(e){return`${Nm($i(e))}|lt:${e.limitType}`}function $s(e){return`Query(target=${(function(i){let r=i.path.canonicalString();return i.collectionGroup!==null&&(r+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(r+=`, filters: [${i.filters.map((o=>nE(o))).join(", ")}]`),ph(i.limit)||(r+=", limit: "+i.limit),i.orderBy.length>0&&(r+=`, orderBy: [${i.orderBy.map((o=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(o))).join(", ")}]`),i.startAt&&(r+=", startAt: ",r+=i.startAt.inclusive?"b:":"a:",r+=i.startAt.position.map((o=>ho(o))).join(",")),i.endAt&&(r+=", endAt: ",r+=i.endAt.inclusive?"a:":"b:",r+=i.endAt.position.map((o=>ho(o))).join(",")),`Target(${r})`})($i(e))}; limitType=${e.limitType})`}function Th(e,t){return t.isFoundDocument()&&(function(r,o){const u=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(u):Te.isDocumentKey(r.path)?r.path.isEqual(u):r.path.isImmediateParentOf(u)})(e,t)&&(function(r,o){for(const u of Hl(r))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0})(e,t)&&(function(r,o){for(const u of r.filters)if(!u.matches(o))return!1;return!0})(e,t)&&(function(r,o){return!(r.startAt&&!(function(c,m,_){const p=g0(c,m,_);return c.inclusive?p<=0:p<0})(r.startAt,Hl(r),o)||r.endAt&&!(function(c,m,_){const p=g0(c,m,_);return c.inclusive?p>=0:p>0})(r.endAt,Hl(r),o))})(e,t)}function zS(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function oE(e){return(t,i)=>{let r=!1;for(const o of Hl(e)){const u=US(o,t,i);if(u!==0)return u;r=r||o.field.isKeyField()}return 0}}function US(e,t,i){const r=e.field.isKeyField()?Te.comparator(t.key,i.key):(function(u,c,m){const _=c.data.field(u),p=m.data.field(u);return _!==null&&p!==null?co(_,p):Se(42886)})(e.field,t,i);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Se(19790,{direction:e.dir})}}class ns{constructor(t,i){this.mapKeyFn=t,this.equalsFn=i,this.inner={},this.innerSize=0}get(t){const i=this.mapKeyFn(t),r=this.inner[i];if(r!==void 0){for(const[o,u]of r)if(this.equalsFn(o,t))return u}}has(t){return this.get(t)!==void 0}set(t,i){const r=this.mapKeyFn(t),o=this.inner[r];if(o===void 0)return this.inner[r]=[[t,i]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],t))return void(o[u]=[t,i]);o.push([t,i]),this.innerSize++}delete(t){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],t))return r.length===1?delete this.inner[i]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(t){ts(this.inner,((i,r)=>{for(const[o,u]of r)t(o,u)}))}isEmpty(){return jT(this.inner)}size(){return this.innerSize}}const BS=new bt(Te.comparator);function Aa(){return BS}const lE=new bt(Te.comparator);function Nl(...e){let t=lE;for(const i of e)t=t.insert(i.key,i);return t}function uE(e){let t=lE;return e.forEach(((i,r)=>t=t.insert(i,r.overlayedDocument))),t}function $r(){return Pl()}function cE(){return Pl()}function Pl(){return new ns((e=>e.toString()),((e,t)=>e.isEqual(t)))}const GS=new bt(Te.comparator),jS=new Kt(Te.comparator);function Ge(...e){let t=jS;for(const i of e)t=t.add(i);return t}const qS=new Kt(Be);function YS(){return qS}function Vm(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:th(t)?"-0":t}}function hE(e){return{integerValue:""+e}}function FS(e,t){return pS(t)?hE(t):Vm(e,t)}class Eh{constructor(){this._=void 0}}function WS(e,t,i){return e instanceof sh?(function(o,u){const c={fields:{[FT]:{stringValue:YT},[XT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&Om(u)&&(u=gh(u)),u&&(c.fields[WT]=u),{mapValue:c}})(i,t):e instanceof Kl?dE(e,t):e instanceof Ql?mE(e,t):(function(o,u){const c=fE(o,u),m=v0(c)+v0(o.Ae);return sm(c)&&sm(o.Ae)?hE(m):Vm(o.serializer,m)})(e,t)}function XS(e,t,i){return e instanceof Kl?dE(e,t):e instanceof Ql?mE(e,t):i}function fE(e,t){return e instanceof oh?(function(r){return sm(r)||(function(u){return!!u&&"doubleValue"in u})(r)})(t)?t:{integerValue:0}:null}class sh extends Eh{}class Kl extends Eh{constructor(t){super(),this.elements=t}}function dE(e,t){const i=_E(t);for(const r of e.elements)i.some((o=>ta(o,r)))||i.push(r);return{arrayValue:{values:i}}}class Ql extends Eh{constructor(t){super(),this.elements=t}}function mE(e,t){let i=_E(t);for(const r of e.elements)i=i.filter((o=>!ta(o,r)));return{arrayValue:{values:i}}}class oh extends Eh{constructor(t,i){super(),this.serializer=t,this.Ae=i}}function v0(e){return Ct(e.integerValue||e.doubleValue)}function _E(e){return Cm(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function KS(e,t){return e.field.isEqual(t.field)&&(function(r,o){return r instanceof Kl&&o instanceof Kl||r instanceof Ql&&o instanceof Ql?uo(r.elements,o.elements,ta):r instanceof oh&&o instanceof oh?ta(r.Ae,o.Ae):r instanceof sh&&o instanceof sh})(e.transform,t.transform)}class QS{constructor(t,i){this.version=t,this.transformResults=i}}class Zi{constructor(t,i){this.updateTime=t,this.exists=i}static none(){return new Zi}static exists(t){return new Zi(void 0,t)}static updateTime(t){return new Zi(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Xc(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class vh{}function pE(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Lm(e.key,Zi.none()):new nu(e.key,e.data,Zi.none());{const i=e.data,r=si.empty();let o=new Kt(dn.comparator);for(let u of t.fields)if(!o.has(u)){let c=i.field(u);c===null&&u.length>1&&(u=u.popLast(),c=i.field(u)),c===null?r.delete(u):r.set(u,c),o=o.add(u)}return new is(e.key,r,new bi(o.toArray()),Zi.none())}}function $S(e,t,i){e instanceof nu?(function(o,u,c){const m=o.value.clone(),_=b0(o.fieldTransforms,u,c.transformResults);m.setAll(_),u.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(e,t,i):e instanceof is?(function(o,u,c){if(!Xc(o.precondition,u))return void u.convertToUnknownDocument(c.version);const m=b0(o.fieldTransforms,u,c.transformResults),_=u.data;_.setAll(gE(o)),_.setAll(m),u.convertToFoundDocument(c.version,_).setHasCommittedMutations()})(e,t,i):(function(o,u,c){u.convertToNoDocument(c.version).setHasCommittedMutations()})(0,t,i)}function xl(e,t,i,r){return e instanceof nu?(function(u,c,m,_){if(!Xc(u.precondition,c))return m;const p=u.value.clone(),y=A0(u.fieldTransforms,_,c);return p.setAll(y),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(e,t,i,r):e instanceof is?(function(u,c,m,_){if(!Xc(u.precondition,c))return m;const p=A0(u.fieldTransforms,_,c),y=c.data;return y.setAll(gE(u)),y.setAll(p),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),m===null?null:m.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((v=>v.field)))})(e,t,i,r):(function(u,c,m){return Xc(u.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):m})(e,t,i)}function ZS(e,t){let i=null;for(const r of e.fieldTransforms){const o=t.data.field(r.field),u=fE(r.transform,o||null);u!=null&&(i===null&&(i=si.empty()),i.set(r.field,u))}return i||null}function w0(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&uo(r,o,((u,c)=>KS(u,c)))})(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class nu extends vh{constructor(t,i,r,o=[]){super(),this.key=t,this.value=i,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class is extends vh{constructor(t,i,r,o,u=[]){super(),this.key=t,this.data=i,this.fieldMask=r,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function gE(e){const t=new Map;return e.fieldMask.fields.forEach((i=>{if(!i.isEmpty()){const r=e.data.field(i);t.set(i,r)}})),t}function b0(e,t,i){const r=new Map;tt(e.length===i.length,32656,{Ve:i.length,de:e.length});for(let o=0;o<i.length;o++){const u=e[o],c=u.transform,m=t.data.field(u.field);r.set(u.field,XS(c,m,i[o]))}return r}function A0(e,t,i){const r=new Map;for(const o of e){const u=o.transform,c=i.data.field(o.field);r.set(o.field,WS(u,c,t))}return r}class Lm extends vh{constructor(t,i){super(),this.key=t,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JS extends vh{constructor(t,i){super(),this.key=t,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class e1{constructor(t,i,r,o){this.batchId=t,this.localWriteTime=i,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(t,i){const r=i.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(t.key)&&$S(u,t,r[o])}}applyToLocalView(t,i){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(i=xl(r,t,i,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(i=xl(r,t,i,this.localWriteTime));return i}applyToLocalDocumentSet(t,i){const r=cE();return this.mutations.forEach((o=>{const u=t.get(o.key),c=u.overlayedDocument;let m=this.applyToLocalView(c,u.mutatedFields);m=i.has(o.key)?null:m;const _=pE(c,m);_!==null&&r.set(o.key,_),c.isValidDocument()||c.convertToNoDocument(Ie.min())})),r}keys(){return this.mutations.reduce(((t,i)=>t.add(i.key)),Ge())}isEqual(t){return this.batchId===t.batchId&&uo(this.mutations,t.mutations,((i,r)=>w0(i,r)))&&uo(this.baseMutations,t.baseMutations,((i,r)=>w0(i,r)))}}class Hm{constructor(t,i,r,o){this.batch=t,this.commitVersion=i,this.mutationResults=r,this.docVersions=o}static from(t,i,r){tt(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let o=(function(){return GS})();const u=t.mutations;for(let c=0;c<u.length;c++)o=o.insert(u[c].key,r[c].version);return new Hm(t,i,r,o)}}class t1{constructor(t,i){this.largestBatchId=t,this.mutation=i}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class n1{constructor(t,i){this.count=t,this.unchangedNames=i}}var Bt,Ye;function i1(e){switch(e){case te.OK:return Se(64938);case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0;default:return Se(15467,{code:e})}}function yE(e){if(e===void 0)return ba("GRPC error has no .code"),te.UNKNOWN;switch(e){case Bt.OK:return te.OK;case Bt.CANCELLED:return te.CANCELLED;case Bt.UNKNOWN:return te.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return te.INTERNAL;case Bt.UNAVAILABLE:return te.UNAVAILABLE;case Bt.UNAUTHENTICATED:return te.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case Bt.NOT_FOUND:return te.NOT_FOUND;case Bt.ALREADY_EXISTS:return te.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return te.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case Bt.ABORTED:return te.ABORTED;case Bt.OUT_OF_RANGE:return te.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return te.UNIMPLEMENTED;case Bt.DATA_LOSS:return te.DATA_LOSS;default:return Se(39323,{code:e})}}(Ye=Bt||(Bt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";function a1(){return new TextEncoder}const r1=new ur([4294967295,4294967295],0);function S0(e){const t=a1().encode(e),i=new NT;return i.update(t),new Uint8Array(i.digest())}function R0(e){const t=new DataView(e.buffer),i=t.getUint32(0,!0),r=t.getUint32(4,!0),o=t.getUint32(8,!0),u=t.getUint32(12,!0);return[new ur([i,r],0),new ur([o,u],0)]}class Pm{constructor(t,i,r){if(this.bitmap=t,this.padding=i,this.hashCount=r,i<0||i>=8)throw new Ml(`Invalid padding: ${i}`);if(r<0)throw new Ml(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Ml(`Invalid hash count: ${r}`);if(t.length===0&&i!==0)throw new Ml(`Invalid padding when bitmap length is 0: ${i}`);this.ge=8*t.length-i,this.pe=ur.fromNumber(this.ge)}ye(t,i,r){let o=t.add(i.multiply(ur.fromNumber(r)));return o.compare(r1)===1&&(o=new ur([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const i=S0(t),[r,o]=R0(i);for(let u=0;u<this.hashCount;u++){const c=this.ye(r,o,u);if(!this.we(c))return!1}return!0}static create(t,i,r){const o=t%8==0?0:8-t%8,u=new Uint8Array(Math.ceil(t/8)),c=new Pm(u,o,i);return r.forEach((m=>c.insert(m))),c}insert(t){if(this.ge===0)return;const i=S0(t),[r,o]=R0(i);for(let u=0;u<this.hashCount;u++){const c=this.ye(r,o,u);this.be(c)}}be(t){const i=Math.floor(t/8),r=t%8;this.bitmap[i]|=1<<r}}class Ml extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class wh{constructor(t,i,r,o,u){this.snapshotVersion=t,this.targetChanges=i,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(t,i,r){const o=new Map;return o.set(t,iu.createSynthesizedTargetChangeForCurrentChange(t,i,r)),new wh(Ie.min(),o,new bt(Be),Aa(),Ge())}}class iu{constructor(t,i,r,o,u){this.resumeToken=t,this.current=i,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(t,i,r){return new iu(r,i,Ge(),Ge(),Ge())}}class Kc{constructor(t,i,r,o){this.Se=t,this.removedTargetIds=i,this.key=r,this.De=o}}class TE{constructor(t,i){this.targetId=t,this.Ce=i}}class EE{constructor(t,i,r=_n.EMPTY_BYTE_STRING,o=null){this.state=t,this.targetIds=i,this.resumeToken=r,this.cause=o}}class I0{constructor(){this.ve=0,this.Fe=k0(),this.Me=_n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Ge(),i=Ge(),r=Ge();return this.Fe.forEach(((o,u)=>{switch(u){case 0:t=t.add(o);break;case 2:i=i.add(o);break;case 1:r=r.add(o);break;default:Se(38017,{changeType:u})}})),new iu(this.Me,this.xe,t,i,r)}Ke(){this.Oe=!1,this.Fe=k0()}qe(t,i){this.Oe=!0,this.Fe=this.Fe.insert(t,i)}Ue(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}$e(){this.ve+=1}We(){this.ve-=1,tt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class s1{constructor(t){this.Ge=t,this.ze=new Map,this.je=Aa(),this.He=xc(),this.Je=xc(),this.Ze=new bt(Be)}Xe(t){for(const i of t.Se)t.De&&t.De.isFoundDocument()?this.Ye(i,t.De):this.et(i,t.key,t.De);for(const i of t.removedTargetIds)this.et(i,t.key,t.De)}tt(t){this.forEachTarget(t,(i=>{const r=this.nt(i);switch(t.state){case 0:this.rt(i)&&r.Le(t.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(t.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(i);break;case 3:this.rt(i)&&(r.Qe(),r.Le(t.resumeToken));break;case 4:this.rt(i)&&(this.it(i),r.Le(t.resumeToken));break;default:Se(56790,{state:t.state})}}))}forEachTarget(t,i){t.targetIds.length>0?t.targetIds.forEach(i):this.ze.forEach(((r,o)=>{this.rt(o)&&i(o)}))}st(t){const i=t.targetId,r=t.Ce.count,o=this.ot(i);if(o){const u=o.target;if(lm(u))if(r===0){const c=new Te(u.path);this.et(i,c,Tn.newNoDocument(c,Ie.min()))}else tt(r===1,20013,{expectedCount:r});else{const c=this._t(i);if(c!==r){const m=this.ut(t),_=m?this.ct(m,t,c):1;if(_!==0){this.it(i);const p=_===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(i,p)}}}}}ut(t){const i=t.Ce.unchangedNames;if(!i||!i.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:u=0}=i;let c,m;try{c=mr(r).toUint8Array()}catch(_){if(_ instanceof qT)return Jr("Decoding the base64 bloom filter in existence filter failed ("+_.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw _}try{m=new Pm(c,o,u)}catch(_){return Jr(_ instanceof Ml?"BloomFilter error: ":"Applying bloom filter failed: ",_),null}return m.ge===0?null:m}ct(t,i,r){return i.Ce.count===r-this.Pt(t,i.targetId)?0:2}Pt(t,i){const r=this.Ge.getRemoteKeysForTarget(i);let o=0;return r.forEach((u=>{const c=this.Ge.ht(),m=`projects/${c.projectId}/databases/${c.database}/documents/${u.path.canonicalString()}`;t.mightContain(m)||(this.et(i,u,null),o++)})),o}Tt(t){const i=new Map;this.ze.forEach(((u,c)=>{const m=this.ot(c);if(m){if(u.current&&lm(m.target)){const _=new Te(m.target.path);this.It(_).has(c)||this.Et(c,_)||this.et(c,_,Tn.newNoDocument(_,t))}u.Be&&(i.set(c,u.ke()),u.Ke())}}));let r=Ge();this.Je.forEach(((u,c)=>{let m=!0;c.forEachWhile((_=>{const p=this.ot(_);return!p||p.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(r=r.add(u))})),this.je.forEach(((u,c)=>c.setReadTime(t)));const o=new wh(t,i,this.Ze,this.je,r);return this.je=Aa(),this.He=xc(),this.Je=xc(),this.Ze=new bt(Be),o}Ye(t,i){if(!this.rt(t))return;const r=this.Et(t,i.key)?2:0;this.nt(t).qe(i.key,r),this.je=this.je.insert(i.key,i),this.He=this.He.insert(i.key,this.It(i.key).add(t)),this.Je=this.Je.insert(i.key,this.Rt(i.key).add(t))}et(t,i,r){if(!this.rt(t))return;const o=this.nt(t);this.Et(t,i)?o.qe(i,1):o.Ue(i),this.Je=this.Je.insert(i,this.Rt(i).delete(t)),this.Je=this.Je.insert(i,this.Rt(i).add(t)),r&&(this.je=this.je.insert(i,r))}removeTarget(t){this.ze.delete(t)}_t(t){const i=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+i.addedDocuments.size-i.removedDocuments.size}$e(t){this.nt(t).$e()}nt(t){let i=this.ze.get(t);return i||(i=new I0,this.ze.set(t,i)),i}Rt(t){let i=this.Je.get(t);return i||(i=new Kt(Be),this.Je=this.Je.insert(t,i)),i}It(t){let i=this.He.get(t);return i||(i=new Kt(Be),this.He=this.He.insert(t,i)),i}rt(t){const i=this.ot(t)!==null;return i||fe("WatchChangeAggregator","Detected inactive target",t),i}ot(t){const i=this.ze.get(t);return i&&i.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new I0),this.Ge.getRemoteKeysForTarget(t).forEach((i=>{this.et(t,i,null)}))}Et(t,i){return this.Ge.getRemoteKeysForTarget(t).has(i)}}function xc(){return new bt(Te.comparator)}function k0(){return new bt(Te.comparator)}const o1={asc:"ASCENDING",desc:"DESCENDING"},l1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},u1={and:"AND",or:"OR"};class c1{constructor(t,i){this.databaseId=t,this.useProto3Json=i}}function cm(e,t){return e.useProto3Json||ph(t)?t:{value:t}}function lh(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function vE(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function h1(e,t){return lh(e,t.toTimestamp())}function Ji(e){return tt(!!e,49232),Ie.fromTimestamp((function(i){const r=dr(i);return new gt(r.seconds,r.nanos)})(e))}function xm(e,t){return hm(e,t).canonicalString()}function hm(e,t){const i=(function(o){return new dt(["projects",o.projectId,"databases",o.database])})(e).child("documents");return t===void 0?i:i.child(t)}function wE(e){const t=dt.fromString(e);return tt(IE(t),10190,{key:t.toString()}),t}function fm(e,t){return xm(e.databaseId,t.path)}function Gd(e,t){const i=wE(t);if(i.get(1)!==e.databaseId.projectId)throw new he(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+e.databaseId.projectId);if(i.get(3)!==e.databaseId.database)throw new he(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+e.databaseId.database);return new Te(AE(i))}function bE(e,t){return xm(e.databaseId,t)}function f1(e){const t=wE(e);return t.length===4?dt.emptyPath():AE(t)}function dm(e){return new dt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function AE(e){return tt(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function D0(e,t,i){return{name:fm(e,t),fields:i.value.mapValue.fields}}function d1(e,t){let i;if("targetChange"in t){t.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Se(39313,{state:p})})(t.targetChange.targetChangeType||"NO_CHANGE"),o=t.targetChange.targetIds||[],u=(function(p,y){return p.useProto3Json?(tt(y===void 0||typeof y=="string",58123),_n.fromBase64String(y||"")):(tt(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),_n.fromUint8Array(y||new Uint8Array))})(e,t.targetChange.resumeToken),c=t.targetChange.cause,m=c&&(function(p){const y=p.code===void 0?te.UNKNOWN:yE(p.code);return new he(y,p.message||"")})(c);i=new EE(r,o,u,m||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const o=Gd(e,r.document.name),u=Ji(r.document.updateTime),c=r.document.createTime?Ji(r.document.createTime):Ie.min(),m=new si({mapValue:{fields:r.document.fields}}),_=Tn.newFoundDocument(o,u,c,m),p=r.targetIds||[],y=r.removedTargetIds||[];i=new Kc(p,y,_.key,_)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const o=Gd(e,r.document),u=r.readTime?Ji(r.readTime):Ie.min(),c=Tn.newNoDocument(o,u),m=r.removedTargetIds||[];i=new Kc([],m,c.key,c)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const o=Gd(e,r.document),u=r.removedTargetIds||[];i=new Kc([],u,o,null)}else{if(!("filter"in t))return Se(11601,{Vt:t});{t.filter;const r=t.filter;r.targetId;const{count:o=0,unchangedNames:u}=r,c=new n1(o,u),m=r.targetId;i=new TE(m,c)}}return i}function m1(e,t){let i;if(t instanceof nu)i={update:D0(e,t.key,t.value)};else if(t instanceof Lm)i={delete:fm(e,t.key)};else if(t instanceof is)i={update:D0(e,t.key,t.data),updateMask:b1(t.fieldMask)};else{if(!(t instanceof JS))return Se(16599,{dt:t.type});i={verify:fm(e,t.key)}}return t.fieldTransforms.length>0&&(i.updateTransforms=t.fieldTransforms.map((r=>(function(u,c){const m=c.transform;if(m instanceof sh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Kl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Ql)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof oh)return{fieldPath:c.field.canonicalString(),increment:m.Ae};throw Se(20930,{transform:c.transform})})(0,r)))),t.precondition.isNone||(i.currentDocument=(function(o,u){return u.updateTime!==void 0?{updateTime:h1(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Se(27497)})(e,t.precondition)),i}function _1(e,t){return e&&e.length>0?(tt(t!==void 0,14353),e.map((i=>(function(o,u){let c=o.updateTime?Ji(o.updateTime):Ji(u);return c.isEqual(Ie.min())&&(c=Ji(u)),new QS(c,o.transformResults||[])})(i,t)))):[]}function p1(e,t){return{documents:[bE(e,t.path)]}}function g1(e,t){const i={structuredQuery:{}},r=t.path;let o;t.collectionGroup!==null?(o=r,i.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(o=r.popLast(),i.structuredQuery.from=[{collectionId:r.lastSegment()}]),i.parent=bE(e,o);const u=(function(p){if(p.length!==0)return RE(Ri.create(p,"and"))})(t.filters);u&&(i.structuredQuery.where=u);const c=(function(p){if(p.length!==0)return p.map((y=>(function(w){return{field:Zs(w.field),direction:E1(w.dir)}})(y)))})(t.orderBy);c&&(i.structuredQuery.orderBy=c);const m=cm(e,t.limit);return m!==null&&(i.structuredQuery.limit=m),t.startAt&&(i.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(t.startAt)),t.endAt&&(i.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(t.endAt)),{ft:i,parent:o}}function y1(e){let t=f1(e.parent);const i=e.structuredQuery,r=i.from?i.from.length:0;let o=null;if(r>0){tt(r===1,65062);const y=i.from[0];y.allDescendants?o=y.collectionId:t=t.child(y.collectionId)}let u=[];i.where&&(u=(function(v){const w=SE(v);return w instanceof Ri&&eE(w)?w.getFilters():[w]})(i.where));let c=[];i.orderBy&&(c=(function(v){return v.map((w=>(function(M){return new Xl(Js(M.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(w)))})(i.orderBy));let m=null;i.limit&&(m=(function(v){let w;return w=typeof v=="object"?v.value:v,ph(w)?null:w})(i.limit));let _=null;i.startAt&&(_=(function(v){const w=!!v.before,R=v.values||[];return new ah(R,w)})(i.startAt));let p=null;return i.endAt&&(p=(function(v){const w=!v.before,R=v.values||[];return new ah(R,w)})(i.endAt)),LS(t,o,c,u,m,"F",_,p)}function T1(e,t){const i=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se(28987,{purpose:o})}})(t.purpose);return i==null?null:{"goog-listen-tags":i}}function SE(e){return e.unaryFilter!==void 0?(function(i){switch(i.unaryFilter.op){case"IS_NAN":const r=Js(i.unaryFilter.field);return Gt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=Js(i.unaryFilter.field);return Gt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Js(i.unaryFilter.field);return Gt.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Js(i.unaryFilter.field);return Gt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Se(61313);default:return Se(60726)}})(e):e.fieldFilter!==void 0?(function(i){return Gt.create(Js(i.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Se(58110);default:return Se(50506)}})(i.fieldFilter.op),i.fieldFilter.value)})(e):e.compositeFilter!==void 0?(function(i){return Ri.create(i.compositeFilter.filters.map((r=>SE(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Se(1026)}})(i.compositeFilter.op))})(e):Se(30097,{filter:e})}function E1(e){return o1[e]}function v1(e){return l1[e]}function w1(e){return u1[e]}function Zs(e){return{fieldPath:e.canonicalString()}}function Js(e){return dn.fromServerFormat(e.fieldPath)}function RE(e){return e instanceof Gt?(function(i){if(i.op==="=="){if(p0(i.value))return{unaryFilter:{field:Zs(i.field),op:"IS_NAN"}};if(_0(i.value))return{unaryFilter:{field:Zs(i.field),op:"IS_NULL"}}}else if(i.op==="!="){if(p0(i.value))return{unaryFilter:{field:Zs(i.field),op:"IS_NOT_NAN"}};if(_0(i.value))return{unaryFilter:{field:Zs(i.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(i.field),op:v1(i.op),value:i.value}}})(e):e instanceof Ri?(function(i){const r=i.getFilters().map((o=>RE(o)));return r.length===1?r[0]:{compositeFilter:{op:w1(i.op),filters:r}}})(e):Se(54877,{filter:e})}function b1(e){const t=[];return e.fields.forEach((i=>t.push(i.canonicalString()))),{fieldPaths:t}}function IE(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}function kE(e){return!!e&&typeof e._toProto=="function"&&e._protoValueType==="ProtoValue"}class sr{constructor(t,i,r,o,u=Ie.min(),c=Ie.min(),m=_n.EMPTY_BYTE_STRING,_=null){this.target=t,this.targetId=i,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=m,this.expectedCount=_}withSequenceNumber(t){return new sr(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,i){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class A1{constructor(t){this.yt=t}}function S1(e){const t=y1({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?rh(t,t.limit,"L"):t}class R1{constructor(){this.Sn=new I1}addToCollectionParentIndex(t,i){return this.Sn.add(i),ie.resolve()}getCollectionParents(t,i){return ie.resolve(this.Sn.getEntries(i))}addFieldIndex(t,i){return ie.resolve()}deleteFieldIndex(t,i){return ie.resolve()}deleteAllFieldIndexes(t){return ie.resolve()}createTargetIndexes(t,i){return ie.resolve()}getDocumentsMatchingTarget(t,i){return ie.resolve(null)}getIndexType(t,i){return ie.resolve(0)}getFieldIndexes(t,i){return ie.resolve([])}getNextCollectionGroupToUpdate(t){return ie.resolve(null)}getMinOffset(t,i){return ie.resolve(fr.min())}getMinOffsetFromCollectionGroup(t,i){return ie.resolve(fr.min())}updateCollectionGroup(t,i,r){return ie.resolve()}updateIndexEntries(t,i){return ie.resolve()}}class I1{constructor(){this.index={}}add(t){const i=t.lastSegment(),r=t.popLast(),o=this.index[i]||new Kt(dt.comparator),u=!o.has(r);return this.index[i]=o.add(r),u}has(t){const i=t.lastSegment(),r=t.popLast(),o=this.index[i];return o&&o.has(r)}getEntries(t){return(this.index[t]||new Kt(dt.comparator)).toArray()}}const O0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DE=41943040;class Nn{static withCacheSize(t){return new Nn(t,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,i,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=i,this.maximumSequenceNumbersToCollect=r}}Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(DE,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);class fo{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new fo(0)}static ar(){return new fo(-1)}}const C0="LruGarbageCollector",k1=1048576;function N0([e,t],[i,r]){const o=Be(e,i);return o===0?Be(t,r):o}class D1{constructor(t){this.Pr=t,this.buffer=new Kt(N0),this.Tr=0}Ir(){return++this.Tr}Er(t){const i=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(i);else{const r=this.buffer.last();N0(i,r)<0&&(this.buffer=this.buffer.delete(r).add(i))}}get maxValue(){return this.buffer.last()[0]}}class O1{constructor(t,i,r){this.garbageCollector=t,this.asyncQueue=i,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){fe(C0,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(i){To(i)?fe(C0,"Ignoring IndexedDB error during garbage collection: ",i):await yo(i)}await this.Ar(3e5)}))}}class C1{constructor(t,i){this.Vr=t,this.params=i}calculateTargetCount(t,i){return this.Vr.dr(t).next((r=>Math.floor(i/100*r)))}nthSequenceNumber(t,i){if(i===0)return ie.resolve(_h.ce);const r=new D1(i);return this.Vr.forEachTarget(t,(o=>r.Er(o.sequenceNumber))).next((()=>this.Vr.mr(t,(o=>r.Er(o))))).next((()=>r.maxValue))}removeTargets(t,i,r){return this.Vr.removeTargets(t,i,r)}removeOrphanedDocuments(t,i){return this.Vr.removeOrphanedDocuments(t,i)}collect(t,i){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(O0)):this.getCacheSize(t).next((r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),O0):this.gr(t,i)))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,i){let r,o,u,c,m,_,p;const y=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,c=Date.now(),this.nthSequenceNumber(t,o)))).next((v=>(r=v,m=Date.now(),this.removeTargets(t,r,i)))).next((v=>(u=v,_=Date.now(),this.removeOrphanedDocuments(t,r)))).next((v=>(p=Date.now(),Qs()<=Fe.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-y}ms
	Determined least recently used ${o} in `+(m-c)+`ms
	Removed ${u} targets in `+(_-m)+`ms
	Removed ${v} documents in `+(p-_)+`ms
Total Duration: ${p-y}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:v}))))}}function N1(e,t){return new C1(e,t)}class M1{constructor(){this.changes=new ns((t=>t.toString()),((t,i)=>t.isEqual(i))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,i){this.assertNotApplied(),this.changes.set(t,Tn.newInvalidDocument(t).setReadTime(i))}getEntry(t,i){this.assertNotApplied();const r=this.changes.get(i);return r!==void 0?ie.resolve(r):this.getFromCache(t,i)}getEntries(t,i){return this.getAllFromCache(t,i)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class V1{constructor(t,i){this.overlayedDocument=t,this.mutatedFields=i}}class L1{constructor(t,i,r,o){this.remoteDocumentCache=t,this.mutationQueue=i,this.documentOverlayCache=r,this.indexManager=o}getDocument(t,i){let r=null;return this.documentOverlayCache.getOverlay(t,i).next((o=>(r=o,this.remoteDocumentCache.getEntry(t,i)))).next((o=>(r!==null&&xl(r.mutation,o,bi.empty(),gt.now()),o)))}getDocuments(t,i){return this.remoteDocumentCache.getEntries(t,i).next((r=>this.getLocalViewOfDocuments(t,r,Ge()).next((()=>r))))}getLocalViewOfDocuments(t,i,r=Ge()){const o=$r();return this.populateOverlays(t,o,i).next((()=>this.computeViews(t,i,o,r).next((u=>{let c=Nl();return u.forEach(((m,_)=>{c=c.insert(m,_.overlayedDocument)})),c}))))}getOverlayedDocuments(t,i){const r=$r();return this.populateOverlays(t,r,i).next((()=>this.computeViews(t,i,r,Ge())))}populateOverlays(t,i,r){const o=[];return r.forEach((u=>{i.has(u)||o.push(u)})),this.documentOverlayCache.getOverlays(t,o).next((u=>{u.forEach(((c,m)=>{i.set(c,m)}))}))}computeViews(t,i,r,o){let u=Aa();const c=Pl(),m=(function(){return Pl()})();return i.forEach(((_,p)=>{const y=r.get(p.key);o.has(p.key)&&(y===void 0||y.mutation instanceof is)?u=u.insert(p.key,p):y!==void 0?(c.set(p.key,y.mutation.getFieldMask()),xl(y.mutation,p,y.mutation.getFieldMask(),gt.now())):c.set(p.key,bi.empty())})),this.recalculateAndSaveOverlays(t,u).next((_=>(_.forEach(((p,y)=>c.set(p,y))),i.forEach(((p,y)=>m.set(p,new V1(y,c.get(p)??null)))),m)))}recalculateAndSaveOverlays(t,i){const r=Pl();let o=new bt(((c,m)=>c-m)),u=Ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,i).next((c=>{for(const m of c)m.keys().forEach((_=>{const p=i.get(_);if(p===null)return;let y=r.get(_)||bi.empty();y=m.applyToLocalView(p,y),r.set(_,y);const v=(o.get(m.batchId)||Ge()).add(_);o=o.insert(m.batchId,v)}))})).next((()=>{const c=[],m=o.getReverseIterator();for(;m.hasNext();){const _=m.getNext(),p=_.key,y=_.value,v=cE();y.forEach((w=>{if(!u.has(w)){const R=pE(i.get(w),r.get(w));R!==null&&v.set(w,R),u=u.add(w)}})),c.push(this.documentOverlayCache.saveOverlays(t,p,v))}return ie.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(t,i){return this.remoteDocumentCache.getEntries(t,i).next((r=>this.recalculateAndSaveOverlays(t,r)))}getDocumentsMatchingQuery(t,i,r,o){return HS(i)?this.getDocumentsMatchingDocumentQuery(t,i.path):rE(i)?this.getDocumentsMatchingCollectionGroupQuery(t,i,r,o):this.getDocumentsMatchingCollectionQuery(t,i,r,o)}getNextDocuments(t,i,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(t,i,r,o).next((u=>{const c=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,i,r.largestBatchId,o-u.size):ie.resolve($r());let m=ql,_=u;return c.next((p=>ie.forEach(p,((y,v)=>(m<v.largestBatchId&&(m=v.largestBatchId),u.get(y)?ie.resolve():this.remoteDocumentCache.getEntry(t,y).next((w=>{_=_.insert(y,w)}))))).next((()=>this.populateOverlays(t,p,u))).next((()=>this.computeViews(t,_,p,Ge()))).next((y=>({batchId:m,changes:uE(y)})))))}))}getDocumentsMatchingDocumentQuery(t,i){return this.getDocument(t,new Te(i)).next((r=>{let o=Nl();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(t,i,r,o){const u=i.collectionGroup;let c=Nl();return this.indexManager.getCollectionParents(t,u).next((m=>ie.forEach(m,(_=>{const p=(function(v,w){return new Eo(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(i,_.child(u));return this.getDocumentsMatchingCollectionQuery(t,p,r,o).next((y=>{y.forEach(((v,w)=>{c=c.insert(v,w)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(t,i,r,o){let u;return this.documentOverlayCache.getOverlaysForCollection(t,i.path,r.largestBatchId).next((c=>(u=c,this.remoteDocumentCache.getDocumentsMatchingQuery(t,i,r,u,o)))).next((c=>{u.forEach(((_,p)=>{const y=p.getKey();c.get(y)===null&&(c=c.insert(y,Tn.newInvalidDocument(y)))}));let m=Nl();return c.forEach(((_,p)=>{const y=u.get(_);y!==void 0&&xl(y.mutation,p,bi.empty(),gt.now()),Th(i,p)&&(m=m.insert(_,p))})),m}))}}class H1{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,i){return ie.resolve(this.Nr.get(i))}saveBundleMetadata(t,i){return this.Nr.set(i.id,(function(o){return{id:o.id,version:o.version,createTime:Ji(o.createTime)}})(i)),ie.resolve()}getNamedQuery(t,i){return ie.resolve(this.Br.get(i))}saveNamedQuery(t,i){return this.Br.set(i.name,(function(o){return{name:o.name,query:S1(o.bundledQuery),readTime:Ji(o.readTime)}})(i)),ie.resolve()}}class P1{constructor(){this.overlays=new bt(Te.comparator),this.Lr=new Map}getOverlay(t,i){return ie.resolve(this.overlays.get(i))}getOverlays(t,i){const r=$r();return ie.forEach(i,(o=>this.getOverlay(t,o).next((u=>{u!==null&&r.set(o,u)})))).next((()=>r))}saveOverlays(t,i,r){return r.forEach(((o,u)=>{this.bt(t,i,u)})),ie.resolve()}removeOverlaysForBatchId(t,i,r){const o=this.Lr.get(r);return o!==void 0&&(o.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(r)),ie.resolve()}getOverlaysForCollection(t,i,r){const o=$r(),u=i.length+1,c=new Te(i.child("")),m=this.overlays.getIteratorFrom(c);for(;m.hasNext();){const _=m.getNext().value,p=_.getKey();if(!i.isPrefixOf(p.path))break;p.path.length===u&&_.largestBatchId>r&&o.set(_.getKey(),_)}return ie.resolve(o)}getOverlaysForCollectionGroup(t,i,r,o){let u=new bt(((p,y)=>p-y));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===i&&p.largestBatchId>r){let y=u.get(p.largestBatchId);y===null&&(y=$r(),u=u.insert(p.largestBatchId,y)),y.set(p.getKey(),p)}}const m=$r(),_=u.getIterator();for(;_.hasNext()&&(_.getNext().value.forEach(((p,y)=>m.set(p,y))),!(m.size()>=o)););return ie.resolve(m)}bt(t,i,r){const o=this.overlays.get(r.key);if(o!==null){const c=this.Lr.get(o.largestBatchId).delete(r.key);this.Lr.set(o.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new t1(i,r));let u=this.Lr.get(i);u===void 0&&(u=Ge(),this.Lr.set(i,u)),this.Lr.set(i,u.add(r.key))}}class x1{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(t){return ie.resolve(this.sessionToken)}setSessionToken(t,i){return this.sessionToken=i,ie.resolve()}}class zm{constructor(){this.kr=new Kt(Jt.Kr),this.qr=new Kt(Jt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,i){const r=new Jt(t,i);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(t,i){t.forEach((r=>this.addReference(r,i)))}removeReference(t,i){this.Wr(new Jt(t,i))}Qr(t,i){t.forEach((r=>this.removeReference(r,i)))}Gr(t){const i=new Te(new dt([])),r=new Jt(i,t),o=new Jt(i,t+1),u=[];return this.qr.forEachInRange([r,o],(c=>{this.Wr(c),u.push(c.key)})),u}zr(){this.kr.forEach((t=>this.Wr(t)))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const i=new Te(new dt([])),r=new Jt(i,t),o=new Jt(i,t+1);let u=Ge();return this.qr.forEachInRange([r,o],(c=>{u=u.add(c.key)})),u}containsKey(t){const i=new Jt(t,0),r=this.kr.firstAfterOrEqual(i);return r!==null&&t.isEqual(r.key)}}class Jt{constructor(t,i){this.key=t,this.Hr=i}static Kr(t,i){return Te.comparator(t.key,i.key)||Be(t.Hr,i.Hr)}static Ur(t,i){return Be(t.Hr,i.Hr)||Te.comparator(t.key,i.key)}}class z1{constructor(t,i){this.indexManager=t,this.referenceDelegate=i,this.mutationQueue=[],this.Yn=1,this.Jr=new Kt(Jt.Kr)}checkEmpty(t){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(t,i,r,o){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new e1(u,i,r,o);this.mutationQueue.push(c);for(const m of o)this.Jr=this.Jr.add(new Jt(m.key,u)),this.indexManager.addToCollectionParentIndex(t,m.key.path.popLast());return ie.resolve(c)}lookupMutationBatch(t,i){return ie.resolve(this.Zr(i))}getNextMutationBatchAfterBatchId(t,i){const r=i+1,o=this.Xr(r),u=o<0?0:o;return ie.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?Dm:this.Yn-1)}getAllMutationBatches(t){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,i){const r=new Jt(i,0),o=new Jt(i,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([r,o],(c=>{const m=this.Zr(c.Hr);u.push(m)})),ie.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(t,i){let r=new Kt(Be);return i.forEach((o=>{const u=new Jt(o,0),c=new Jt(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,c],(m=>{r=r.add(m.Hr)}))})),ie.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(t,i){const r=i.path,o=r.length+1;let u=r;Te.isDocumentKey(u)||(u=u.child(""));const c=new Jt(new Te(u),0);let m=new Kt(Be);return this.Jr.forEachWhile((_=>{const p=_.key.path;return!!r.isPrefixOf(p)&&(p.length===o&&(m=m.add(_.Hr)),!0)}),c),ie.resolve(this.Yr(m))}Yr(t){const i=[];return t.forEach((r=>{const o=this.Zr(r);o!==null&&i.push(o)})),i}removeMutationBatch(t,i){tt(this.ei(i.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return ie.forEach(i.mutations,(o=>{const u=new Jt(o.key,i.batchId);return r=r.delete(u),this.referenceDelegate.markPotentiallyOrphaned(t,o.key)})).next((()=>{this.Jr=r}))}nr(t){}containsKey(t,i){const r=new Jt(i,0),o=this.Jr.firstAfterOrEqual(r);return ie.resolve(i.isEqual(o&&o.key))}performConsistencyCheck(t){return this.mutationQueue.length,ie.resolve()}ei(t,i){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const i=this.Xr(t);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}}class U1{constructor(t){this.ti=t,this.docs=(function(){return new bt(Te.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,i){const r=i.key,o=this.docs.get(r),u=o?o.size:0,c=this.ti(i);return this.docs=this.docs.insert(r,{document:i.mutableCopy(),size:c}),this.size+=c-u,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const i=this.docs.get(t);i&&(this.docs=this.docs.remove(t),this.size-=i.size)}getEntry(t,i){const r=this.docs.get(i);return ie.resolve(r?r.document.mutableCopy():Tn.newInvalidDocument(i))}getEntries(t,i){let r=Aa();return i.forEach((o=>{const u=this.docs.get(o);r=r.insert(o,u?u.document.mutableCopy():Tn.newInvalidDocument(o))})),ie.resolve(r)}getDocumentsMatchingQuery(t,i,r,o){let u=Aa();const c=i.path,m=new Te(c.child("__id-9223372036854775808__")),_=this.docs.getIteratorFrom(m);for(;_.hasNext();){const{key:p,value:{document:y}}=_.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||fS(hS(y),r)<=0||(o.has(y.key)||Th(i,y))&&(u=u.insert(y.key,y.mutableCopy()))}return ie.resolve(u)}getAllFromCollectionGroup(t,i,r,o){Se(9500)}ni(t,i){return ie.forEach(this.docs,(r=>i(r)))}newChangeBuffer(t){return new B1(this)}getSize(t){return ie.resolve(this.size)}}class B1 extends M1{constructor(t){super(),this.Mr=t}applyChanges(t){const i=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?i.push(this.Mr.addEntry(t,o)):this.Mr.removeEntry(r)})),ie.waitFor(i)}getFromCache(t,i){return this.Mr.getEntry(t,i)}getAllFromCache(t,i){return this.Mr.getEntries(t,i)}}class G1{constructor(t){this.persistence=t,this.ri=new ns((i=>Nm(i)),Mm),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.ii=0,this.si=new zm,this.targetCount=0,this.oi=fo._r()}forEachTarget(t,i){return this.ri.forEach(((r,o)=>i(o))),ie.resolve()}getLastRemoteSnapshotVersion(t){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ie.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(t,i,r){return r&&(this.lastRemoteSnapshotVersion=r),i>this.ii&&(this.ii=i),ie.resolve()}lr(t){this.ri.set(t.target,t);const i=t.targetId;i>this.highestTargetId&&(this.oi=new fo(i),this.highestTargetId=i),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,i){return this.lr(i),this.targetCount+=1,ie.resolve()}updateTargetData(t,i){return this.lr(i),ie.resolve()}removeTargetData(t,i){return this.ri.delete(i.target),this.si.Gr(i.targetId),this.targetCount-=1,ie.resolve()}removeTargets(t,i,r){let o=0;const u=[];return this.ri.forEach(((c,m)=>{m.sequenceNumber<=i&&r.get(m.targetId)===null&&(this.ri.delete(c),u.push(this.removeMatchingKeysForTargetId(t,m.targetId)),o++)})),ie.waitFor(u).next((()=>o))}getTargetCount(t){return ie.resolve(this.targetCount)}getTargetData(t,i){const r=this.ri.get(i)||null;return ie.resolve(r)}addMatchingKeys(t,i,r){return this.si.$r(i,r),ie.resolve()}removeMatchingKeys(t,i,r){this.si.Qr(i,r);const o=this.persistence.referenceDelegate,u=[];return o&&i.forEach((c=>{u.push(o.markPotentiallyOrphaned(t,c))})),ie.waitFor(u)}removeMatchingKeysForTargetId(t,i){return this.si.Gr(i),ie.resolve()}getMatchingKeysForTargetId(t,i){const r=this.si.jr(i);return ie.resolve(r)}containsKey(t,i){return ie.resolve(this.si.containsKey(i))}}class OE{constructor(t,i){this._i={},this.overlays={},this.ai=new _h(0),this.ui=!1,this.ui=!0,this.ci=new x1,this.referenceDelegate=t(this),this.li=new G1(this),this.indexManager=new R1,this.remoteDocumentCache=(function(o){return new U1(o)})((r=>this.referenceDelegate.hi(r))),this.serializer=new A1(i),this.Pi=new H1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let i=this.overlays[t.toKey()];return i||(i=new P1,this.overlays[t.toKey()]=i),i}getMutationQueue(t,i){let r=this._i[t.toKey()];return r||(r=new z1(i,this.referenceDelegate),this._i[t.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,i,r){fe("MemoryPersistence","Starting transaction:",t);const o=new j1(this.ai.next());return this.referenceDelegate.Ti(),r(o).next((u=>this.referenceDelegate.Ii(o).next((()=>u)))).toPromise().then((u=>(o.raiseOnCommittedEvent(),u)))}Ei(t,i){return ie.or(Object.values(this._i).map((r=>()=>r.containsKey(t,i))))}}class j1 extends mS{constructor(t){super(),this.currentSequenceNumber=t}}class Um{constructor(t){this.persistence=t,this.Ri=new zm,this.Ai=null}static Vi(t){return new Um(t)}get di(){if(this.Ai)return this.Ai;throw Se(60996)}addReference(t,i,r){return this.Ri.addReference(r,i),this.di.delete(r.toString()),ie.resolve()}removeReference(t,i,r){return this.Ri.removeReference(r,i),this.di.add(r.toString()),ie.resolve()}markPotentiallyOrphaned(t,i){return this.di.add(i.toString()),ie.resolve()}removeTarget(t,i){this.Ri.Gr(i.targetId).forEach((o=>this.di.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,i.targetId).next((o=>{o.forEach((u=>this.di.add(u.toString())))})).next((()=>r.removeTargetData(t,i)))}Ti(){this.Ai=new Set}Ii(t){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.di,(r=>{const o=Te.fromPath(r);return this.mi(t,o).next((u=>{u||i.removeEntry(o,Ie.min())}))})).next((()=>(this.Ai=null,i.apply(t))))}updateLimboDocument(t,i){return this.mi(t,i).next((r=>{r?this.di.delete(i.toString()):this.di.add(i.toString())}))}hi(t){return 0}mi(t,i){return ie.or([()=>ie.resolve(this.Ri.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(t,i),()=>this.persistence.Ei(t,i)])}}class uh{constructor(t,i){this.persistence=t,this.fi=new ns((r=>gS(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=N1(this,i)}static Vi(t,i){return new uh(t,i)}Ti(){}Ii(t){return ie.resolve()}forEachTarget(t,i){return this.persistence.getTargetCache().forEachTarget(t,i)}dr(t){const i=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next((r=>i.next((o=>r+o))))}pr(t){let i=0;return this.mr(t,(r=>{i++})).next((()=>i))}mr(t,i){return ie.forEach(this.fi,((r,o)=>this.wr(t,r,o).next((u=>u?ie.resolve():i(o)))))}removeTargets(t,i,r){return this.persistence.getTargetCache().removeTargets(t,i,r)}removeOrphanedDocuments(t,i){let r=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.ni(t,(c=>this.wr(t,c,i).next((m=>{m||(r++,u.removeEntry(c,Ie.min()))})))).next((()=>u.apply(t))).next((()=>r))}markPotentiallyOrphaned(t,i){return this.fi.set(i,t.currentSequenceNumber),ie.resolve()}removeTarget(t,i){const r=i.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,i,r){return this.fi.set(r,t.currentSequenceNumber),ie.resolve()}removeReference(t,i,r){return this.fi.set(r,t.currentSequenceNumber),ie.resolve()}updateLimboDocument(t,i){return this.fi.set(i,t.currentSequenceNumber),ie.resolve()}hi(t){let i=t.key.toString().length;return t.isFoundDocument()&&(i+=Fc(t.data.value)),i}wr(t,i,r){return ie.or([()=>this.persistence.Ei(t,i),()=>this.persistence.getTargetCache().containsKey(t,i),()=>{const o=this.fi.get(i);return ie.resolve(o!==void 0&&o>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class Bm{constructor(t,i,r,o){this.targetId=t,this.fromCache=i,this.Ts=r,this.Is=o}static Es(t,i){let r=Ge(),o=Ge();for(const u of i.docChanges)switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new Bm(t,i.fromCache,r,o)}}class q1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Y1{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return Cb()?8:_S(Db())>0?6:4})()}initialize(t,i){this.fs=t,this.indexManager=i,this.Rs=!0}getDocumentsMatchingQuery(t,i,r,o){const u={result:null};return this.gs(t,i).next((c=>{u.result=c})).next((()=>{if(!u.result)return this.ps(t,i,o,r).next((c=>{u.result=c}))})).next((()=>{if(u.result)return;const c=new q1;return this.ys(t,i,c).next((m=>{if(u.result=m,this.As)return this.ws(t,i,c,m.size)}))})).next((()=>u.result))}ws(t,i,r,o){return r.documentReadCount<this.Vs?(Qs()<=Fe.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",$s(i),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ie.resolve()):(Qs()<=Fe.DEBUG&&fe("QueryEngine","Query:",$s(i),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ds*o?(Qs()<=Fe.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",$s(i),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,$i(i))):ie.resolve())}gs(t,i){if(E0(i))return ie.resolve(null);let r=$i(i);return this.indexManager.getIndexType(t,r).next((o=>o===0?null:(i.limit!==null&&o===1&&(i=rh(i,null,"F"),r=$i(i)),this.indexManager.getDocumentsMatchingTarget(t,r).next((u=>{const c=Ge(...u);return this.fs.getDocuments(t,c).next((m=>this.indexManager.getMinOffset(t,r).next((_=>{const p=this.bs(i,m);return this.Ss(i,p,c,_.readTime)?this.gs(t,rh(i,null,"F")):this.Ds(t,p,i,_)}))))})))))}ps(t,i,r,o){return E0(i)||o.isEqual(Ie.min())?ie.resolve(null):this.fs.getDocuments(t,r).next((u=>{const c=this.bs(i,u);return this.Ss(i,c,r,o)?ie.resolve(null):(Qs()<=Fe.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),$s(i)),this.Ds(t,c,i,cS(o,ql)).next((m=>m)))}))}bs(t,i){let r=new Kt(oE(t));return i.forEach(((o,u)=>{Th(t,u)&&(r=r.add(u))})),r}Ss(t,i,r,o){if(t.limit===null)return!1;if(r.size!==i.size)return!0;const u=t.limitType==="F"?i.last():i.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}ys(t,i,r){return Qs()<=Fe.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",$s(i)),this.fs.getDocumentsMatchingQuery(t,i,fr.min(),r)}Ds(t,i,r,o){return this.fs.getDocumentsMatchingQuery(t,r,o).next((u=>(i.forEach((c=>{u=u.insert(c.key,c)})),u)))}}const Gm="LocalStore",F1=3e8;class W1{constructor(t,i,r,o){this.persistence=t,this.Cs=i,this.serializer=o,this.vs=new bt(Be),this.Fs=new ns((u=>Nm(u)),Mm),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(r)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new L1(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(i=>t.collect(i,this.vs)))}}function X1(e,t,i,r){return new W1(e,t,i,r)}async function CE(e,t){const i=Oe(e);return await i.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return i.mutationQueue.getAllMutationBatches(r).next((u=>(o=u,i.Os(t),i.mutationQueue.getAllMutationBatches(r)))).next((u=>{const c=[],m=[];let _=Ge();for(const p of o){c.push(p.batchId);for(const y of p.mutations)_=_.add(y.key)}for(const p of u){m.push(p.batchId);for(const y of p.mutations)_=_.add(y.key)}return i.localDocuments.getDocuments(r,_).next((p=>({Ns:p,removedBatchIds:c,addedBatchIds:m})))}))}))}function K1(e,t){const i=Oe(e);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const o=t.batch.keys(),u=i.xs.newChangeBuffer({trackRemovals:!0});return(function(m,_,p,y){const v=p.batch,w=v.keys();let R=ie.resolve();return w.forEach((M=>{R=R.next((()=>y.getEntry(_,M))).next((V=>{const L=p.docVersions.get(M);tt(L!==null,48541),V.version.compareTo(L)<0&&(v.applyToRemoteDocument(V,p),V.isValidDocument()&&(V.setReadTime(p.commitVersion),y.addEntry(V)))}))})),R.next((()=>m.mutationQueue.removeMutationBatch(_,v)))})(i,r,t,u).next((()=>u.apply(r))).next((()=>i.mutationQueue.performConsistencyCheck(r))).next((()=>i.documentOverlayCache.removeOverlaysForBatchId(r,o,t.batch.batchId))).next((()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(m){let _=Ge();for(let p=0;p<m.mutationResults.length;++p)m.mutationResults[p].transformResults.length>0&&(_=_.add(m.batch.mutations[p].key));return _})(t)))).next((()=>i.localDocuments.getDocuments(r,o)))}))}function NE(e){const t=Oe(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(i=>t.li.getLastRemoteSnapshotVersion(i)))}function Q1(e,t){const i=Oe(e),r=t.snapshotVersion;let o=i.vs;return i.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const c=i.xs.newChangeBuffer({trackRemovals:!0});o=i.vs;const m=[];t.targetChanges.forEach(((y,v)=>{const w=o.get(v);if(!w)return;m.push(i.li.removeMatchingKeys(u,y.removedDocuments,v).next((()=>i.li.addMatchingKeys(u,y.addedDocuments,v))));let R=w.withSequenceNumber(u.currentSequenceNumber);t.targetMismatches.get(v)!==null?R=R.withResumeToken(_n.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):y.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(y.resumeToken,r)),o=o.insert(v,R),(function(V,L,O){return V.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=F1?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(w,R,y)&&m.push(i.li.updateTargetData(u,R))}));let _=Aa(),p=Ge();if(t.documentUpdates.forEach((y=>{t.resolvedLimboDocuments.has(y)&&m.push(i.persistence.referenceDelegate.updateLimboDocument(u,y))})),m.push($1(u,c,t.documentUpdates).next((y=>{_=y.Bs,p=y.Ls}))),!r.isEqual(Ie.min())){const y=i.li.getLastRemoteSnapshotVersion(u).next((v=>i.li.setTargetsMetadata(u,u.currentSequenceNumber,r)));m.push(y)}return ie.waitFor(m).next((()=>c.apply(u))).next((()=>i.localDocuments.getLocalViewOfDocuments(u,_,p))).next((()=>_))})).then((u=>(i.vs=o,u)))}function $1(e,t,i){let r=Ge(),o=Ge();return i.forEach((u=>r=r.add(u))),t.getEntries(e,r).next((u=>{let c=Aa();return i.forEach(((m,_)=>{const p=u.get(m);_.isFoundDocument()!==p.isFoundDocument()&&(o=o.add(m)),_.isNoDocument()&&_.version.isEqual(Ie.min())?(t.removeEntry(m,_.readTime),c=c.insert(m,_)):!p.isValidDocument()||_.version.compareTo(p.version)>0||_.version.compareTo(p.version)===0&&p.hasPendingWrites?(t.addEntry(_),c=c.insert(m,_)):fe(Gm,"Ignoring outdated watch update for ",m,". Current version:",p.version," Watch version:",_.version)})),{Bs:c,Ls:o}}))}function Z1(e,t){const i=Oe(e);return i.persistence.runTransaction("Get next mutation batch","readonly",(r=>(t===void 0&&(t=Dm),i.mutationQueue.getNextMutationBatchAfterBatchId(r,t))))}function J1(e,t){const i=Oe(e);return i.persistence.runTransaction("Allocate target","readwrite",(r=>{let o;return i.li.getTargetData(r,t).next((u=>u?(o=u,ie.resolve(o)):i.li.allocateTargetId(r).next((c=>(o=new sr(t,c,"TargetPurposeListen",r.currentSequenceNumber),i.li.addTargetData(r,o).next((()=>o)))))))})).then((r=>{const o=i.vs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(i.vs=i.vs.insert(r.targetId,r),i.Fs.set(t,r.targetId)),r}))}async function mm(e,t,i){const r=Oe(e),o=r.vs.get(t),u=i?"readwrite":"readwrite-primary";try{i||await r.persistence.runTransaction("Release target",u,(c=>r.persistence.referenceDelegate.removeTarget(c,o)))}catch(c){if(!To(c))throw c;fe(Gm,`Failed to update sequence numbers for target ${t}: ${c}`)}r.vs=r.vs.remove(t),r.Fs.delete(o.target)}function M0(e,t,i){const r=Oe(e);let o=Ie.min(),u=Ge();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(_,p,y){const v=Oe(_),w=v.Fs.get(y);return w!==void 0?ie.resolve(v.vs.get(w)):v.li.getTargetData(p,y)})(r,c,$i(t)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(c,m.targetId).next((_=>{u=_}))})).next((()=>r.Cs.getDocumentsMatchingQuery(c,t,i?o:Ie.min(),i?u:Ge()))).next((m=>(eR(r,zS(t),m),{documents:m,ks:u})))))}function eR(e,t,i){let r=e.Ms.get(t)||Ie.min();i.forEach(((o,u)=>{u.readTime.compareTo(r)>0&&(r=u.readTime)})),e.Ms.set(t,r)}class V0{constructor(){this.activeTargetIds=YS()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class tR{constructor(){this.vo=new V0,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,i,r){}addLocalQueryTarget(t,i=!0){return i&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,i,r){this.Fo[t]=i}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new V0,Promise.resolve()}handleUserChange(t,i,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class nR{Mo(t){}shutdown(){}}const L0="ConnectivityMonitor";class H0{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){fe(L0,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){fe(L0,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let zc=null;function _m(){return zc===null?zc=(function(){return 268435456+Math.round(2147483648*Math.random())})():zc++,"0x"+zc.toString(16)}const jd="RestConnection",iR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class aR{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=i+"://"+t.host,this.Uo=`projects/${r}/databases/${o}`,this.$o=this.databaseId.database===nh?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Wo(t,i,r,o,u){const c=_m(),m=this.Qo(t,i.toUriEncodedString());fe(jd,`Sending RPC '${t}' ${c}:`,m,r);const _={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(_,o,u);const{host:p}=new URL(m),y=Sm(p);return this.zo(t,m,_,r,y).then((v=>(fe(jd,`Received RPC '${t}' ${c}: `,v),v)),(v=>{throw Jr(jd,`RPC '${t}' ${c} failed with error: `,v,"url: ",m,"request:",r),v}))}jo(t,i,r,o,u,c){return this.Wo(t,i,r,o,u)}Go(t,i,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+go})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,u)=>t[u]=o)),r&&r.headers.forEach(((o,u)=>t[u]=o))}Qo(t,i){const r=iR[t];let o=`${this.qo}/v1/${i}:${r}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class rR{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}const gn="WebChannelConnection",Ol=(e,t,i)=>{e.listen(t,(r=>{try{i(r)}catch(o){setTimeout((()=>{throw o}),0)}}))};class no extends aR{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!no.c_){const t=HT();Ol(t,LT.STAT_EVENT,(i=>{i.stat===im.PROXY?fe(gn,"STAT_EVENT: detected buffering proxy"):i.stat===im.NOPROXY&&fe(gn,"STAT_EVENT: detected no buffering proxy")})),no.c_=!0}}zo(t,i,r,o,u){const c=_m();return new Promise(((m,_)=>{const p=new MT;p.setWithCredentials(!0),p.listenOnce(VT.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Yc.NO_ERROR:const v=p.getResponseJson();fe(gn,`XHR for RPC '${t}' ${c} received:`,JSON.stringify(v)),m(v);break;case Yc.TIMEOUT:fe(gn,`RPC '${t}' ${c} timed out`),_(new he(te.DEADLINE_EXCEEDED,"Request time out"));break;case Yc.HTTP_ERROR:const w=p.getStatus();if(fe(gn,`RPC '${t}' ${c} failed with status:`,w,"response text:",p.getResponseText()),w>0){let R=p.getResponseJson();Array.isArray(R)&&(R=R[0]);const M=R?.error;if(M&&M.status&&M.message){const V=(function(O){const G=O.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(G)>=0?G:te.UNKNOWN})(M.status);_(new he(V,M.message))}else _(new he(te.UNKNOWN,"Server responded with status "+p.getStatus()))}else _(new he(te.UNAVAILABLE,"Connection failed."));break;default:Se(9055,{l_:t,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{fe(gn,`RPC '${t}' ${c} completed.`)}}));const y=JSON.stringify(o);fe(gn,`RPC '${t}' ${c} sending request:`,o),p.send(i,"POST",y,r,15)}))}T_(t,i,r){const o=_m(),u=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],c=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},_=this.longPollingOptions.timeoutSeconds;_!==void 0&&(m.longPollingTimeout=Math.round(1e3*_)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,i,r),m.encodeInitMessageHeaders=!0;const p=u.join("");fe(gn,`Creating RPC '${t}' stream ${o}: ${p}`,m);const y=c.createWebChannel(p,m);this.I_(y);let v=!1,w=!1;const R=new rR({Ho:M=>{w?fe(gn,`Not sending because RPC '${t}' stream ${o} is closed:`,M):(v||(fe(gn,`Opening RPC '${t}' stream ${o} transport.`),y.open(),v=!0),fe(gn,`RPC '${t}' stream ${o} sending:`,M),y.send(M))},Jo:()=>y.close()});return Ol(y,Cl.EventType.OPEN,(()=>{w||(fe(gn,`RPC '${t}' stream ${o} transport opened.`),R.i_())})),Ol(y,Cl.EventType.CLOSE,(()=>{w||(w=!0,fe(gn,`RPC '${t}' stream ${o} transport closed`),R.o_(),this.E_(y))})),Ol(y,Cl.EventType.ERROR,(M=>{w||(w=!0,Jr(gn,`RPC '${t}' stream ${o} transport errored. Name:`,M.name,"Message:",M.message),R.o_(new he(te.UNAVAILABLE,"The operation could not be completed")))})),Ol(y,Cl.EventType.MESSAGE,(M=>{if(!w){const V=M.data[0];tt(!!V,16349);const L=V,O=L?.error||L[0]?.error;if(O){fe(gn,`RPC '${t}' stream ${o} received error:`,O);const G=O.status;let J=(function(we){const k=Bt[we];if(k!==void 0)return yE(k)})(G),re=O.message;G==="NOT_FOUND"&&re.includes("database")&&re.includes("does not exist")&&re.includes(this.databaseId.database)&&Jr(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),J===void 0&&(J=te.INTERNAL,re="Unknown error status: "+G+" with message "+O.message),w=!0,R.o_(new he(J,re)),y.close()}else fe(gn,`RPC '${t}' stream ${o} received:`,V),R.__(V)}})),no.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((t=>t.close())),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter((i=>i===t))}Go(t,i,r){super.Go(t,i,r),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return PT()}}function sR(e){return new no(e)}function qd(){return typeof document<"u"?document:null}function bh(e){return new c1(e,!0)}no.c_=!1;class ME{constructor(t,i,r=1e3,o=1.5,u=6e4){this.Ci=t,this.timerId=i,this.R_=r,this.A_=o,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const i=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,i-r);o>0&&fe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${i} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),t()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const P0="PersistentStream";class VE{constructor(t,i,r,o,u,c,m,_){this.Ci=t,this.b_=r,this.S_=o,this.connection=u,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=m,this.listener=_,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ME(t,i)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,i){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():i&&i.code===te.RESOURCE_EXHAUSTED?(ba(i.toString()),ba("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):i&&i.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(i)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),i=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===i&&this.G_(r,o)}),(r=>{t((()=>{const o=new he(te.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(t,i){const r=this.Q_(this.D_);this.stream=this.j_(t,i),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return fe(P0,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return i=>{this.Ci.enqueueAndForget((()=>this.D_===t?i():(fe(P0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class oR extends VE{constructor(t,i,r,o,u,c){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,r,o,c),this.serializer=u}j_(t,i){return this.connection.T_("Listen",t,i)}H_(t){return this.onNext(t)}onNext(t){this.M_.reset();const i=d1(this.serializer,t),r=(function(u){if(!("targetChange"in u))return Ie.min();const c=u.targetChange;return c.targetIds&&c.targetIds.length?Ie.min():c.readTime?Ji(c.readTime):Ie.min()})(t);return this.listener.J_(i,r)}Z_(t){const i={};i.database=dm(this.serializer),i.addTarget=(function(u,c){let m;const _=c.target;if(m=lm(_)?{documents:p1(u,_)}:{query:g1(u,_).ft},m.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){m.resumeToken=vE(u,c.resumeToken);const p=cm(u,c.expectedCount);p!==null&&(m.expectedCount=p)}else if(c.snapshotVersion.compareTo(Ie.min())>0){m.readTime=lh(u,c.snapshotVersion.toTimestamp());const p=cm(u,c.expectedCount);p!==null&&(m.expectedCount=p)}return m})(this.serializer,t);const r=T1(this.serializer,t);r&&(i.labels=r),this.K_(i)}X_(t){const i={};i.database=dm(this.serializer),i.removeTarget=t,this.K_(i)}}class lR extends VE{constructor(t,i,r,o,u,c){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,r,o,c),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,i){return this.connection.T_("Write",t,i)}H_(t){return tt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,tt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){tt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const i=_1(t.writeResults,t.commitTime),r=Ji(t.commitTime);return this.listener.na(r,i)}ra(){const t={};t.database=dm(this.serializer),this.K_(t)}ea(t){const i={streamToken:this.lastStreamToken,writes:t.map((r=>m1(this.serializer,r)))};this.K_(i)}}class uR{}class cR extends uR{constructor(t,i,r,o){super(),this.authCredentials=t,this.appCheckCredentials=i,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new he(te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,i,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,c])=>this.connection.Wo(t,hm(i,r),o,u,c))).catch((u=>{throw u.name==="FirebaseError"?(u.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new he(te.UNKNOWN,u.toString())}))}jo(t,i,r,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,m])=>this.connection.jo(t,hm(i,r),o,c,m,u))).catch((c=>{throw c.name==="FirebaseError"?(c.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new he(te.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function hR(e,t,i,r){return new cR(e,t,i,r)}class fR{constructor(t,i){this.asyncQueue=t,this.onlineStateHandler=i,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const i=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ba(i),this.aa=!1):fe("OnlineStateTracker",i)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const es="RemoteStore";class dR{constructor(t,i,r,o,u){this.localStore=t,this.datastore=i,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((c=>{r.enqueueAndForget((async()=>{as(this)&&(fe(es,"Restarting streams for network reachability change."),await(async function(_){const p=Oe(_);p.Ea.add(4),await au(p),p.Va.set("Unknown"),p.Ea.delete(4),await Ah(p)})(this))}))})),this.Va=new fR(r,o)}}async function Ah(e){if(as(e))for(const t of e.Ra)await t(!0)}async function au(e){for(const t of e.Ra)await t(!1)}function LE(e,t){const i=Oe(e);i.Ia.has(t.targetId)||(i.Ia.set(t.targetId,t),Fm(i)?Ym(i):vo(i).O_()&&qm(i,t))}function jm(e,t){const i=Oe(e),r=vo(i);i.Ia.delete(t),r.O_()&&HE(i,t),i.Ia.size===0&&(r.O_()?r.L_():as(i)&&i.Va.set("Unknown"))}function qm(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ie.min())>0){const i=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(i)}vo(e).Z_(t)}function HE(e,t){e.da.$e(t),vo(e).X_(t)}function Ym(e){e.da=new s1({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),vo(e).start(),e.Va.ua()}function Fm(e){return as(e)&&!vo(e).x_()&&e.Ia.size>0}function as(e){return Oe(e).Ea.size===0}function PE(e){e.da=void 0}async function mR(e){e.Va.set("Online")}async function _R(e){e.Ia.forEach(((t,i)=>{qm(e,t)}))}async function pR(e,t){PE(e),Fm(e)?(e.Va.ha(t),Ym(e)):e.Va.set("Unknown")}async function gR(e,t,i){if(e.Va.set("Online"),t instanceof EE&&t.state===2&&t.cause)try{await(async function(o,u){const c=u.cause;for(const m of u.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,c),o.Ia.delete(m),o.da.removeTarget(m))})(e,t)}catch(r){fe(es,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await ch(e,r)}else if(t instanceof Kc?e.da.Xe(t):t instanceof TE?e.da.st(t):e.da.tt(t),!i.isEqual(Ie.min()))try{const r=await NE(e.localStore);i.compareTo(r)>=0&&await(function(u,c){const m=u.da.Tt(c);return m.targetChanges.forEach(((_,p)=>{if(_.resumeToken.approximateByteSize()>0){const y=u.Ia.get(p);y&&u.Ia.set(p,y.withResumeToken(_.resumeToken,c))}})),m.targetMismatches.forEach(((_,p)=>{const y=u.Ia.get(_);if(!y)return;u.Ia.set(_,y.withResumeToken(_n.EMPTY_BYTE_STRING,y.snapshotVersion)),HE(u,_);const v=new sr(y.target,_,p,y.sequenceNumber);qm(u,v)})),u.remoteSyncer.applyRemoteEvent(m)})(e,i)}catch(r){fe(es,"Failed to raise snapshot:",r),await ch(e,r)}}async function ch(e,t,i){if(!To(t))throw t;e.Ea.add(1),await au(e),e.Va.set("Offline"),i||(i=()=>NE(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{fe(es,"Retrying IndexedDB access"),await i(),e.Ea.delete(1),await Ah(e)}))}function xE(e,t){return t().catch((i=>ch(e,i,t)))}async function Sh(e){const t=Oe(e),i=pr(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Dm;for(;yR(t);)try{const o=await Z1(t.localStore,r);if(o===null){t.Ta.length===0&&i.L_();break}r=o.batchId,TR(t,o)}catch(o){await ch(t,o)}zE(t)&&UE(t)}function yR(e){return as(e)&&e.Ta.length<10}function TR(e,t){e.Ta.push(t);const i=pr(e);i.O_()&&i.Y_&&i.ea(t.mutations)}function zE(e){return as(e)&&!pr(e).x_()&&e.Ta.length>0}function UE(e){pr(e).start()}async function ER(e){pr(e).ra()}async function vR(e){const t=pr(e);for(const i of e.Ta)t.ea(i.mutations)}async function wR(e,t,i){const r=e.Ta.shift(),o=Hm.from(r,t,i);await xE(e,(()=>e.remoteSyncer.applySuccessfulWrite(o))),await Sh(e)}async function bR(e,t){t&&pr(e).Y_&&await(async function(r,o){if((function(c){return i1(c)&&c!==te.ABORTED})(o.code)){const u=r.Ta.shift();pr(r).B_(),await xE(r,(()=>r.remoteSyncer.rejectFailedWrite(u.batchId,o))),await Sh(r)}})(e,t),zE(e)&&UE(e)}async function x0(e,t){const i=Oe(e);i.asyncQueue.verifyOperationInProgress(),fe(es,"RemoteStore received new credentials");const r=as(i);i.Ea.add(3),await au(i),r&&i.Va.set("Unknown"),await i.remoteSyncer.handleCredentialChange(t),i.Ea.delete(3),await Ah(i)}async function AR(e,t){const i=Oe(e);t?(i.Ea.delete(2),await Ah(i)):t||(i.Ea.add(2),await au(i),i.Va.set("Unknown"))}function vo(e){return e.ma||(e.ma=(function(i,r,o){const u=Oe(i);return u.sa(),new oR(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(e.datastore,e.asyncQueue,{Zo:mR.bind(null,e),Yo:_R.bind(null,e),t_:pR.bind(null,e),J_:gR.bind(null,e)}),e.Ra.push((async t=>{t?(e.ma.B_(),Fm(e)?Ym(e):e.Va.set("Unknown")):(await e.ma.stop(),PE(e))}))),e.ma}function pr(e){return e.fa||(e.fa=(function(i,r,o){const u=Oe(i);return u.sa(),new lR(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),Yo:ER.bind(null,e),t_:bR.bind(null,e),ta:vR.bind(null,e),na:wR.bind(null,e)}),e.Ra.push((async t=>{t?(e.fa.B_(),await Sh(e)):(await e.fa.stop(),e.Ta.length>0&&(fe(es,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa}class Wm{constructor(t,i,r,o,u){this.asyncQueue=t,this.timerId=i,this.targetTimeMs=r,this.op=o,this.removalCallback=u,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,i,r,o,u){const c=Date.now()+r,m=new Wm(t,i,c,o,u);return m.start(r),m}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(te.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xm(e,t){if(ba("AsyncQueue",`${t}: ${e}`),To(e))return new he(te.UNAVAILABLE,`${t}: ${e}`);throw e}class io{static emptySet(t){return new io(t.comparator)}constructor(t){this.comparator=t?(i,r)=>t(i,r)||Te.comparator(i.key,r.key):(i,r)=>Te.comparator(i.key,r.key),this.keyedMap=Nl(),this.sortedSet=new bt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const i=this.keyedMap.get(t);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((i,r)=>(t(i),!1)))}add(t){const i=this.delete(t.key);return i.copy(i.keyedMap.insert(t.key,t),i.sortedSet.insert(t,null))}delete(t){const i=this.get(t);return i?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(i)):this}isEqual(t){if(!(t instanceof io)||this.size!==t.size)return!1;const i=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;i.hasNext();){const o=i.getNext().key,u=r.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const t=[];return this.forEach((i=>{t.push(i.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,i){const r=new io;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=i,r}}class z0{constructor(){this.ga=new bt(Te.comparator)}track(t){const i=t.doc.key,r=this.ga.get(i);r?t.type!==0&&r.type===3?this.ga=this.ga.insert(i,t):t.type===3&&r.type!==1?this.ga=this.ga.insert(i,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.ga=this.ga.insert(i,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.ga=this.ga.insert(i,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.ga=this.ga.remove(i):t.type===1&&r.type===2?this.ga=this.ga.insert(i,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.ga=this.ga.insert(i,{type:2,doc:t.doc}):Se(63341,{Vt:t,pa:r}):this.ga=this.ga.insert(i,t)}ya(){const t=[];return this.ga.inorderTraversal(((i,r)=>{t.push(r)})),t}}class mo{constructor(t,i,r,o,u,c,m,_,p){this.query=t,this.docs=i,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=u,this.fromCache=c,this.syncStateChanged=m,this.excludesMetadataChanges=_,this.hasCachedResults=p}static fromInitialDocuments(t,i,r,o,u){const c=[];return i.forEach((m=>{c.push({type:0,doc:m})})),new mo(t,i,io.emptySet(i),c,r,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&yh(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const i=this.docChanges,r=t.docChanges;if(i.length!==r.length)return!1;for(let o=0;o<i.length;o++)if(i[o].type!==r[o].type||!i[o].doc.isEqual(r[o].doc))return!1;return!0}}class SR{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((t=>t.Da()))}}class RR{constructor(){this.queries=U0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(i,r){const o=Oe(i),u=o.queries;o.queries=U0(),u.forEach(((c,m)=>{for(const _ of m.ba)_.onError(r)}))})(this,new he(te.ABORTED,"Firestore shutting down"))}}function U0(){return new ns((e=>sE(e)),yh)}async function IR(e,t){const i=Oe(e);let r=3;const o=t.query;let u=i.queries.get(o);u?!u.Sa()&&t.Da()&&(r=2):(u=new SR,r=t.Da()?0:1);try{switch(r){case 0:u.wa=await i.onListen(o,!0);break;case 1:u.wa=await i.onListen(o,!1);break;case 2:await i.onFirstRemoteStoreListen(o)}}catch(c){const m=Xm(c,`Initialization of query '${$s(t.query)}' failed`);return void t.onError(m)}i.queries.set(o,u),u.ba.push(t),t.va(i.onlineState),u.wa&&t.Fa(u.wa)&&Km(i)}async function kR(e,t){const i=Oe(e),r=t.query;let o=3;const u=i.queries.get(r);if(u){const c=u.ba.indexOf(t);c>=0&&(u.ba.splice(c,1),u.ba.length===0?o=t.Da()?0:1:!u.Sa()&&t.Da()&&(o=2))}switch(o){case 0:return i.queries.delete(r),i.onUnlisten(r,!0);case 1:return i.queries.delete(r),i.onUnlisten(r,!1);case 2:return i.onLastRemoteStoreUnlisten(r);default:return}}function DR(e,t){const i=Oe(e);let r=!1;for(const o of t){const u=o.query,c=i.queries.get(u);if(c){for(const m of c.ba)m.Fa(o)&&(r=!0);c.wa=o}}r&&Km(i)}function OR(e,t,i){const r=Oe(e),o=r.queries.get(t);if(o)for(const u of o.ba)u.onError(i);r.queries.delete(t)}function Km(e){e.Ca.forEach((t=>{t.next()}))}var pm,B0;(B0=pm||(pm={})).Ma="default",B0.Cache="cache";class CR{constructor(t,i,r){this.query=t,this.xa=i,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(t){if(!this.options.includeMetadataChanges){const r=[];for(const o of t.docChanges)o.type!==3&&r.push(o);t=new mo(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let i=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),i=!0):this.La(t,this.onlineState)&&(this.ka(t),i=!0),this.Na=t,i}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let i=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),i=!0),i}La(t,i){if(!t.fromCache||!this.Da())return!0;const r=i!=="Offline";return(!this.options.Ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||i==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const i=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!i)&&this.options.includeMetadataChanges===!0}ka(t){t=mo.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==pm.Cache}}class BE{constructor(t){this.key=t}}class GE{constructor(t){this.key=t}}class NR{constructor(t,i){this.query=t,this.Za=i,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ge(),this.mutatedKeys=Ge(),this.eu=oE(t),this.tu=new io(this.eu)}get nu(){return this.Za}ru(t,i){const r=i?i.iu:new z0,o=i?i.tu:this.tu;let u=i?i.mutatedKeys:this.mutatedKeys,c=o,m=!1;const _=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,p=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(t.inorderTraversal(((y,v)=>{const w=o.get(y),R=Th(this.query,v)?v:null,M=!!w&&this.mutatedKeys.has(w.key),V=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let L=!1;w&&R?w.data.isEqual(R.data)?M!==V&&(r.track({type:3,doc:R}),L=!0):this.su(w,R)||(r.track({type:2,doc:R}),L=!0,(_&&this.eu(R,_)>0||p&&this.eu(R,p)<0)&&(m=!0)):!w&&R?(r.track({type:0,doc:R}),L=!0):w&&!R&&(r.track({type:1,doc:w}),L=!0,(_||p)&&(m=!0)),L&&(R?(c=c.add(R),u=V?u.add(y):u.delete(y)):(c=c.delete(y),u=u.delete(y)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const y=this.query.limitType==="F"?c.last():c.first();c=c.delete(y.key),u=u.delete(y.key),r.track({type:1,doc:y})}return{tu:c,iu:r,Ss:m,mutatedKeys:u}}su(t,i){return t.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(t,i,r,o){const u=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const c=t.iu.ya();c.sort(((y,v)=>(function(R,M){const V=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se(20277,{Vt:L})}};return V(R)-V(M)})(y.type,v.type)||this.eu(y.doc,v.doc))),this.ou(r),o=o??!1;const m=i&&!o?this._u():[],_=this.Ya.size===0&&this.current&&!o?1:0,p=_!==this.Xa;return this.Xa=_,c.length!==0||p?{snapshot:new mo(this.query,t.tu,u,c,t.mutatedKeys,_===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new z0,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(t){return!this.Za.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((i=>this.Za=this.Za.add(i))),t.modifiedDocuments.forEach((i=>{})),t.removedDocuments.forEach((i=>this.Za=this.Za.delete(i))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Ya;this.Ya=Ge(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const i=[];return t.forEach((r=>{this.Ya.has(r)||i.push(new GE(r))})),this.Ya.forEach((r=>{t.has(r)||i.push(new BE(r))})),i}cu(t){this.Za=t.ks,this.Ya=Ge();const i=this.ru(t.documents);return this.applyChanges(i,!0)}lu(){return mo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Qm="SyncEngine";class MR{constructor(t,i,r){this.query=t,this.targetId=i,this.view=r}}class VR{constructor(t){this.key=t,this.hu=!1}}class LR{constructor(t,i,r,o,u,c){this.localStore=t,this.remoteStore=i,this.eventManager=r,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new ns((m=>sE(m)),yh),this.Iu=new Map,this.Eu=new Set,this.Ru=new bt(Te.comparator),this.Au=new Map,this.Vu=new zm,this.du={},this.mu=new Map,this.fu=fo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HR(e,t,i=!0){const r=XE(e);let o;const u=r.Tu.get(t);return u?(r.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.lu()):o=await jE(r,t,i,!0),o}async function PR(e,t){const i=XE(e);await jE(i,t,!0,!1)}async function jE(e,t,i,r){const o=await J1(e.localStore,$i(t)),u=o.targetId,c=e.sharedClientState.addLocalQueryTarget(u,i);let m;return r&&(m=await xR(e,t,u,c==="current",o.resumeToken)),e.isPrimaryClient&&i&&LE(e.remoteStore,o),m}async function xR(e,t,i,r,o){e.pu=(v,w,R)=>(async function(V,L,O,G){let J=L.view.ru(O);J.Ss&&(J=await M0(V.localStore,L.query,!1).then((({documents:k})=>L.view.ru(k,J))));const re=G&&G.targetChanges.get(L.targetId),Ce=G&&G.targetMismatches.get(L.targetId)!=null,we=L.view.applyChanges(J,V.isPrimaryClient,re,Ce);return j0(V,L.targetId,we.au),we.snapshot})(e,v,w,R);const u=await M0(e.localStore,t,!0),c=new NR(t,u.ks),m=c.ru(u.documents),_=iu.createSynthesizedTargetChangeForCurrentChange(i,r&&e.onlineState!=="Offline",o),p=c.applyChanges(m,e.isPrimaryClient,_);j0(e,i,p.au);const y=new MR(t,i,c);return e.Tu.set(t,y),e.Iu.has(i)?e.Iu.get(i).push(t):e.Iu.set(i,[t]),p.snapshot}async function zR(e,t,i){const r=Oe(e),o=r.Tu.get(t),u=r.Iu.get(o.targetId);if(u.length>1)return r.Iu.set(o.targetId,u.filter((c=>!yh(c,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await mm(r.localStore,o.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(o.targetId),i&&jm(r.remoteStore,o.targetId),gm(r,o.targetId)})).catch(yo)):(gm(r,o.targetId),await mm(r.localStore,o.targetId,!0))}async function UR(e,t){const i=Oe(e),r=i.Tu.get(t),o=i.Iu.get(r.targetId);i.isPrimaryClient&&o.length===1&&(i.sharedClientState.removeLocalQueryTarget(r.targetId),jm(i.remoteStore,r.targetId))}async function BR(e,t,i){const r=XR(e);try{const o=await(function(c,m){const _=Oe(c),p=gt.now(),y=m.reduce(((R,M)=>R.add(M.key)),Ge());let v,w;return _.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let M=Aa(),V=Ge();return _.xs.getEntries(R,y).next((L=>{M=L,M.forEach(((O,G)=>{G.isValidDocument()||(V=V.add(O))}))})).next((()=>_.localDocuments.getOverlayedDocuments(R,M))).next((L=>{v=L;const O=[];for(const G of m){const J=ZS(G,v.get(G.key).overlayedDocument);J!=null&&O.push(new is(G.key,J,$T(J.value.mapValue),Zi.exists(!0)))}return _.mutationQueue.addMutationBatch(R,p,O,m)})).next((L=>{w=L;const O=L.applyToLocalDocumentSet(v,V);return _.documentOverlayCache.saveOverlays(R,L.batchId,O)}))})).then((()=>({batchId:w.batchId,changes:uE(v)})))})(r.localStore,t);r.sharedClientState.addPendingMutation(o.batchId),(function(c,m,_){let p=c.du[c.currentUser.toKey()];p||(p=new bt(Be)),p=p.insert(m,_),c.du[c.currentUser.toKey()]=p})(r,o.batchId,i),await ru(r,o.changes),await Sh(r.remoteStore)}catch(o){const u=Xm(o,"Failed to persist write");i.reject(u)}}async function qE(e,t){const i=Oe(e);try{const r=await Q1(i.localStore,t);t.targetChanges.forEach(((o,u)=>{const c=i.Au.get(u);c&&(tt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?c.hu=!0:o.modifiedDocuments.size>0?tt(c.hu,14607):o.removedDocuments.size>0&&(tt(c.hu,42227),c.hu=!1))})),await ru(i,r,t)}catch(r){await yo(r)}}function G0(e,t,i){const r=Oe(e);if(r.isPrimaryClient&&i===0||!r.isPrimaryClient&&i===1){const o=[];r.Tu.forEach(((u,c)=>{const m=c.view.va(t);m.snapshot&&o.push(m.snapshot)})),(function(c,m){const _=Oe(c);_.onlineState=m;let p=!1;_.queries.forEach(((y,v)=>{for(const w of v.ba)w.va(m)&&(p=!0)})),p&&Km(_)})(r.eventManager,t),o.length&&r.Pu.J_(o),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function GR(e,t,i){const r=Oe(e);r.sharedClientState.updateQueryState(t,"rejected",i);const o=r.Au.get(t),u=o&&o.key;if(u){let c=new bt(Te.comparator);c=c.insert(u,Tn.newNoDocument(u,Ie.min()));const m=Ge().add(u),_=new wh(Ie.min(),new Map,new bt(Be),c,m);await qE(r,_),r.Ru=r.Ru.remove(u),r.Au.delete(t),$m(r)}else await mm(r.localStore,t,!1).then((()=>gm(r,t,i))).catch(yo)}async function jR(e,t){const i=Oe(e),r=t.batch.batchId;try{const o=await K1(i.localStore,t);FE(i,r,null),YE(i,r),i.sharedClientState.updateMutationState(r,"acknowledged"),await ru(i,o)}catch(o){await yo(o)}}async function qR(e,t,i){const r=Oe(e);try{const o=await(function(c,m){const _=Oe(c);return _.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let y;return _.mutationQueue.lookupMutationBatch(p,m).next((v=>(tt(v!==null,37113),y=v.keys(),_.mutationQueue.removeMutationBatch(p,v)))).next((()=>_.mutationQueue.performConsistencyCheck(p))).next((()=>_.documentOverlayCache.removeOverlaysForBatchId(p,y,m))).next((()=>_.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y))).next((()=>_.localDocuments.getDocuments(p,y)))}))})(r.localStore,t);FE(r,t,i),YE(r,t),r.sharedClientState.updateMutationState(t,"rejected",i),await ru(r,o)}catch(o){await yo(o)}}function YE(e,t){(e.mu.get(t)||[]).forEach((i=>{i.resolve()})),e.mu.delete(t)}function FE(e,t,i){const r=Oe(e);let o=r.du[r.currentUser.toKey()];if(o){const u=o.get(t);u&&(i?u.reject(i):u.resolve(),o=o.remove(t)),r.du[r.currentUser.toKey()]=o}}function gm(e,t,i=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),i&&e.Pu.yu(r,i);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach((r=>{e.Vu.containsKey(r)||WE(e,r)}))}function WE(e,t){e.Eu.delete(t.path.canonicalString());const i=e.Ru.get(t);i!==null&&(jm(e.remoteStore,i),e.Ru=e.Ru.remove(t),e.Au.delete(i),$m(e))}function j0(e,t,i){for(const r of i)r instanceof BE?(e.Vu.addReference(r.key,t),YR(e,r)):r instanceof GE?(fe(Qm,"Document no longer in limbo: "+r.key),e.Vu.removeReference(r.key,t),e.Vu.containsKey(r.key)||WE(e,r.key)):Se(19791,{wu:r})}function YR(e,t){const i=t.key,r=i.path.canonicalString();e.Ru.get(i)||e.Eu.has(r)||(fe(Qm,"New document in limbo: "+i),e.Eu.add(r),$m(e))}function $m(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const i=new Te(dt.fromString(t)),r=e.fu.next();e.Au.set(r,new VR(i)),e.Ru=e.Ru.insert(i,r),LE(e.remoteStore,new sr($i(aE(i.path)),r,"TargetPurposeLimboResolution",_h.ce))}}async function ru(e,t,i){const r=Oe(e),o=[],u=[],c=[];r.Tu.isEmpty()||(r.Tu.forEach(((m,_)=>{c.push(r.pu(_,t,i).then((p=>{if((p||i)&&r.isPrimaryClient){const y=p?!p.fromCache:i?.targetChanges.get(_.targetId)?.current;r.sharedClientState.updateQueryState(_.targetId,y?"current":"not-current")}if(p){o.push(p);const y=Bm.Es(_.targetId,p);u.push(y)}})))})),await Promise.all(c),r.Pu.J_(o),await(async function(_,p){const y=Oe(_);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ie.forEach(p,(w=>ie.forEach(w.Ts,(R=>y.persistence.referenceDelegate.addReference(v,w.targetId,R))).next((()=>ie.forEach(w.Is,(R=>y.persistence.referenceDelegate.removeReference(v,w.targetId,R)))))))))}catch(v){if(!To(v))throw v;fe(Gm,"Failed to update sequence numbers: "+v)}for(const v of p){const w=v.targetId;if(!v.fromCache){const R=y.vs.get(w),M=R.snapshotVersion,V=R.withLastLimboFreeSnapshotVersion(M);y.vs=y.vs.insert(w,V)}}})(r.localStore,u))}async function FR(e,t){const i=Oe(e);if(!i.currentUser.isEqual(t)){fe(Qm,"User change. New user:",t.toKey());const r=await CE(i.localStore,t);i.currentUser=t,(function(u,c){u.mu.forEach((m=>{m.forEach((_=>{_.reject(new he(te.CANCELLED,c))}))})),u.mu.clear()})(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ru(i,r.Ns)}}function WR(e,t){const i=Oe(e),r=i.Au.get(t);if(r&&r.hu)return Ge().add(r.key);{let o=Ge();const u=i.Iu.get(t);if(!u)return o;for(const c of u){const m=i.Tu.get(c);o=o.unionWith(m.view.nu)}return o}}function XE(e){const t=Oe(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=qE.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=WR.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=GR.bind(null,t),t.Pu.J_=DR.bind(null,t.eventManager),t.Pu.yu=OR.bind(null,t.eventManager),t}function XR(e){const t=Oe(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=jR.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=qR.bind(null,t),t}class hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=bh(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,i){return null}Mu(t,i){return null}vu(t){return X1(this.persistence,new Y1,t.initialUser,this.serializer)}Cu(t){return new OE(Um.Vi,this.serializer)}Du(t){return new tR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hh.provider={build:()=>new hh};class KR extends hh{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,i){tt(this.persistence.referenceDelegate instanceof uh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new O1(r,t.asyncQueue,i)}Cu(t){const i=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new OE((r=>uh.Vi(r,i)),this.serializer)}}class ym{async initialize(t,i){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>G0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=FR.bind(null,this.syncEngine),await AR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new RR})()}createDatastore(t){const i=bh(t.databaseInfo.databaseId),r=sR(t.databaseInfo);return hR(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,o,u,c,m){return new dR(r,o,u,c,m)})(this.localStore,this.datastore,t.asyncQueue,(i=>G0(this.syncEngine,i,0)),(function(){return H0.v()?new H0:new nR})())}createSyncEngine(t,i){return(function(o,u,c,m,_,p,y){const v=new LR(o,u,c,m,_,p);return y&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}async terminate(){await(async function(i){const r=Oe(i);fe(es,"RemoteStore shutting down."),r.Ea.add(5),await au(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ym.provider={build:()=>new ym};class QR{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):ba("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,i){setTimeout((()=>{this.muted||t(i)}),0)}}const gr="FirestoreClient";class $R{constructor(t,i,r,o,u){this.authCredentials=t,this.appCheckCredentials=i,this.asyncQueue=r,this._databaseInfo=o,this.user=yn.UNAUTHENTICATED,this.clientId=km.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(r,(async c=>{fe(gr,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(fe(gr,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Xm(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}async function Yd(e,t){e.asyncQueue.verifyOperationInProgress(),fe(gr,"Initializing OfflineComponentProvider");const i=e.configuration;await t.initialize(i);let r=i.initialUser;e.setCredentialChangeListener((async o=>{r.isEqual(o)||(await CE(t.localStore,o),r=o)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function q0(e,t){e.asyncQueue.verifyOperationInProgress();const i=await ZR(e);fe(gr,"Initializing OnlineComponentProvider"),await t.initialize(i,e.configuration),e.setCredentialChangeListener((r=>x0(t.remoteStore,r))),e.setAppCheckTokenChangeListener(((r,o)=>x0(t.remoteStore,o))),e._onlineComponents=t}async function ZR(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){fe(gr,"Using user provided OfflineComponentProvider");try{await Yd(e,e._uninitializedComponentsProvider._offline)}catch(t){const i=t;if(!(function(o){return o.name==="FirebaseError"?o.code===te.FAILED_PRECONDITION||o.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(i))throw i;Jr("Error using user provided cache. Falling back to memory cache: "+i),await Yd(e,new hh)}}else fe(gr,"Using default OfflineComponentProvider"),await Yd(e,new KR(void 0));return e._offlineComponents}async function KE(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(fe(gr,"Using user provided OnlineComponentProvider"),await q0(e,e._uninitializedComponentsProvider._online)):(fe(gr,"Using default OnlineComponentProvider"),await q0(e,new ym))),e._onlineComponents}function JR(e){return KE(e).then((t=>t.syncEngine))}async function e2(e){const t=await KE(e),i=t.eventManager;return i.onListen=HR.bind(null,t.syncEngine),i.onUnlisten=zR.bind(null,t.syncEngine),i.onFirstRemoteStoreListen=PR.bind(null,t.syncEngine),i.onLastRemoteStoreUnlisten=UR.bind(null,t.syncEngine),i}function t2(e,t,i={}){const r=new cr;return e.asyncQueue.enqueueAndForget((async()=>(function(u,c,m,_,p){const y=new QR({next:w=>{y.Nu(),c.enqueueAndForget((()=>kR(u,v))),w.fromCache&&_.source==="server"?p.reject(new he(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(w)},error:w=>p.reject(w)}),v=new CR(m,y,{includeMetadataChanges:!0,Ka:!0});return IR(u,v)})(await e2(e),e.asyncQueue,t,i,r))),r.promise}function n2(e,t){const i=new cr;return e.asyncQueue.enqueueAndForget((async()=>BR(await JR(e),t,i))),i.promise}function QE(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}const i2="ComponentProvider",Y0=new Map;function a2(e,t,i,r,o){return new ES(e,t,i,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,QE(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,r)}const $E="firestore.googleapis.com",F0=!0;class W0{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new he(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$E,this.ssl=F0}else this.host=t.host,this.ssl=t.ssl??F0;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=DE;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<k1)throw new he(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}lS("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QE(t.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Rh{constructor(t,i,r,o){this._authCredentials=t,this._appCheckCredentials=i,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new he(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W0(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new ZA;switch(r.type){case"firstParty":return new nS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new he(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(i){const r=Y0.get(i);r&&(fe(i2,"Removing Datastore"),Y0.delete(i),r.terminate())})(this),Promise.resolve()}}function r2(e,t,i,r={}){e=jl(e,Rh);const o=Sm(t),u=e._getSettings(),c={...u,emulatorOptions:e._getEmulatorOptions()},m=`${t}:${i}`;o&&(Ab(`https://${m}`),kb("Firestore",!0)),u.host!==$E&&u.host!==m&&Jr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const _={...u,host:m,ssl:o,emulatorOptions:r};if(!Zc(_,c)&&(e._setSettings(_),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=yn.MOCK_USER;else{p=Sb(r.mockUserToken,e._app?.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new he(te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new yn(v)}e._authCredentials=new JA(new zT(p,y))}}class yr{constructor(t,i,r){this.converter=i,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new yr(this.firestore,t,this._query)}}class nn{constructor(t,i,r){this.converter=i,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hr(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new nn(this.firestore,t,this._key)}toJSON(){return{type:nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,i,r){if(tu(i,nn._jsonSchema))return new nn(t,r||null,new Te(dt.fromString(i.referencePath)))}}nn._jsonSchemaVersion="firestore/documentReference/1.0",nn._jsonSchema={type:jt("string",nn._jsonSchemaVersion),referencePath:jt("string")};class hr extends yr{constructor(t,i,r){super(t,i,aE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new nn(this.firestore,null,new Te(t))}withConverter(t){return new hr(this.firestore,t,this._path)}}function wo(e,t,...i){if(e=lo(e),UT("collection","path",t),e instanceof Rh){const r=dt.fromString(t,...i);return s0(r),new hr(e,null,r)}{if(!(e instanceof nn||e instanceof hr))throw new he(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(dt.fromString(t,...i));return s0(r),new hr(e.firestore,null,r)}}function s2(e,t,...i){if(e=lo(e),arguments.length===1&&(t=km.newId()),UT("doc","path",t),e instanceof Rh){const r=dt.fromString(t,...i);return r0(r),new nn(e,null,new Te(r))}{if(!(e instanceof nn||e instanceof hr))throw new he(te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(dt.fromString(t,...i));return r0(r),new nn(e.firestore,e instanceof hr?e.converter:null,new Te(r))}}const X0="AsyncQueue";class K0{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ME(this,"async_queue_retry"),this._c=()=>{const r=qd();r&&fe(X0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=t;const i=qd();i&&typeof i.addEventListener=="function"&&i.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const i=qd();i&&typeof i.removeEventListener=="function"&&i.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const i=new cr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(i.resolve,i.reject),i.promise))).then((()=>i.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Yu.push(t),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!To(t))throw t;fe(X0,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const i=this.ac.then((()=>(this.rc=!0,t().catch((r=>{throw this.nc=r,this.rc=!1,ba("INTERNAL UNHANDLED ERROR: ",Q0(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=i,i}enqueueAfterDelay(t,i,r){this.uc(),this.oc.indexOf(t)>-1&&(i=0);const o=Wm.createAndSchedule(this,t,i,r,(u=>this.hc(u)));return this.tc.push(o),o}uc(){this.nc&&Se(47125,{Pc:Q0(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const i of this.tc)if(i.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((i,r)=>i.targetTimeMs-r.targetTimeMs));for(const i of this.tc)if(i.skipDelay(),t!=="all"&&i.timerId===t)break;return this.Tc()}))}Rc(t){this.oc.push(t)}hc(t){const i=this.tc.indexOf(t);this.tc.splice(i,1)}}function Q0(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class Ih extends Rh{constructor(t,i,r,o){super(t,i,r,o),this.type="firestore",this._queue=new K0,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new K0(t),this._firestoreClient=void 0,await t}}}function o2(e,t){const i=typeof e=="object"?e:xA(),r=typeof e=="string"?e:nh,o=MA(i,"firestore").getImmediate({identifier:r});if(!o._initialized){const u=wb("firestore");u&&r2(o,...u)}return o}function ZE(e){if(e._terminated)throw new he(te.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||l2(e),e._firestoreClient}function l2(e){const t=e._freezeSettings(),i=a2(e._databaseId,e._app?.options.appId||"",e._persistenceKey,e._app?.options.apiKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new $R(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&(function(o){const u=o?._online.build();return{_offline:o?._offline.build(u),_online:u}})(e._componentsProvider))}class oi{constructor(t){this._byteString=t}static fromBase64String(t){try{return new oi(_n.fromBase64String(t))}catch(i){throw new he(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(t){return new oi(_n.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:oi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(tu(t,oi._jsonSchema))return oi.fromBase64String(t.bytes)}}oi._jsonSchemaVersion="firestore/bytes/1.0",oi._jsonSchema={type:jt("string",oi._jsonSchemaVersion),bytes:jt("string")};class JE{constructor(...t){for(let i=0;i<t.length;++i)if(t[i].length===0)throw new he(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class ev{constructor(t){this._methodName=t}}class ea{constructor(t,i){if(!isFinite(t)||t<-90||t>90)throw new he(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(i)||i<-180||i>180)throw new he(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=t,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Be(this._lat,t._lat)||Be(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ea._jsonSchemaVersion}}static fromJSON(t){if(tu(t,ea._jsonSchema))return new ea(t.latitude,t.longitude)}}ea._jsonSchemaVersion="firestore/geoPoint/1.0",ea._jsonSchema={type:jt("string",ea._jsonSchemaVersion),latitude:jt("number"),longitude:jt("number")};class Si{constructor(t){this._values=(t||[]).map((i=>i))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(r,o){if(r.length!==o.length)return!1;for(let u=0;u<r.length;++u)if(r[u]!==o[u])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Si._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(tu(t,Si._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((i=>typeof i=="number")))return new Si(t.vectorValues);throw new he(te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Si._jsonSchemaVersion="firestore/vectorValue/1.0",Si._jsonSchema={type:jt("string",Si._jsonSchemaVersion),vectorValues:jt("object")};const u2=/^__.*__$/;class c2{constructor(t,i,r){this.data=t,this.fieldMask=i,this.fieldTransforms=r}toMutation(t,i){return this.fieldMask!==null?new is(t,this.data,this.fieldMask,i,this.fieldTransforms):new nu(t,this.data,i,this.fieldTransforms)}}function tv(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se(40011,{dataSource:e})}}class Zm{constructor(t,i,r,o,u,c){this.settings=t,this.databaseId=i,this.serializer=r,this.ignoreUndefinedProperties=o,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new Zm({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){const i=this.path?.child(t),r=this.contextWith({path:i,arrayElement:!1});return r.validatePathSegment(t),r}childContextForFieldPath(t){const i=this.path?.child(t),r=this.contextWith({path:i,arrayElement:!1});return r.validatePath(),r}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return fh(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find((i=>t.isPrefixOf(i)))!==void 0||this.fieldTransforms.find((i=>t.isPrefixOf(i.field)))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(tv(this.dataSource)&&u2.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class h2{constructor(t,i,r){this.databaseId=t,this.ignoreUndefinedProperties=i,this.serializer=r||bh(t)}createContext(t,i,r,o=!1){return new Zm({dataSource:t,methodName:i,targetDoc:r,path:dn.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nv(e){const t=e._freezeSettings(),i=bh(e._databaseId);return new h2(e._databaseId,!!t.ignoreUndefinedProperties,i)}function f2(e,t,i,r,o,u={}){const c=e.createContext(u.merge||u.mergeFields?2:0,t,i,o);rv("Data must be an object, but it was:",c,r);const m=iv(r,c);let _,p;if(u.merge)_=new bi(c.fieldMask),p=c.fieldTransforms;else if(u.mergeFields){const y=[];for(const v of u.mergeFields){const w=kh(t,v,i);if(!c.contains(w))throw new he(te.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);p2(y,w)||y.push(w)}_=new bi(y),p=c.fieldTransforms.filter((v=>_.covers(v.field)))}else _=null,p=c.fieldTransforms;return new c2(new si(m),_,p)}function d2(e,t,i,r=!1){return Jm(i,e.createContext(r?4:3,t))}function Jm(e,t){if(av(e=lo(e)))return rv("Unsupported field value:",t,e),iv(e,t);if(e instanceof ev)return(function(r,o){if(!tv(o.dataSource))throw o.createError(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${r._methodName}() is not currently supported inside arrays`);const u=r._toFieldTransform(o);u&&o.fieldTransforms.push(u)})(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return(function(r,o){const u=[];let c=0;for(const m of r){let _=Jm(m,o.childContextForArray(c));_==null&&(_={nullValue:"NULL_VALUE"}),u.push(_),c++}return{arrayValue:{values:u}}})(e,t)}return(function(r,o){if((r=lo(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return FS(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const u=gt.fromDate(r);return{timestampValue:lh(o.serializer,u)}}if(r instanceof gt){const u=new gt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lh(o.serializer,u)}}if(r instanceof ea)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof oi)return{bytesValue:vE(o.serializer,r._byteString)};if(r instanceof nn){const u=o.databaseId,c=r.firestore._databaseId;if(!c.isEqual(u))throw o.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:xm(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof Si)return(function(c,m){const _=c instanceof Si?c.toArray():c;return{mapValue:{fields:{[KT]:{stringValue:QT},[ih]:{arrayValue:{values:_.map((y=>{if(typeof y!="number")throw m.createError("VectorValues must only contain numeric values.");return Vm(m.serializer,y)}))}}}}}})(r,o);if(kE(r))return r._toProto(o.serializer);throw o.createError(`Unsupported field value: ${mh(r)}`)})(e,t)}function iv(e,t){const i={};return jT(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ts(e,((r,o)=>{const u=Jm(o,t.childContextForField(r));u!=null&&(i[r]=u)})),{mapValue:{fields:i}}}function av(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof gt||e instanceof ea||e instanceof oi||e instanceof nn||e instanceof ev||e instanceof Si||kE(e))}function rv(e,t,i){if(!av(i)||!BT(i)){const r=mh(i);throw r==="an object"?t.createError(e+" a custom object"):t.createError(e+" "+r)}}function kh(e,t,i){if((t=lo(t))instanceof JE)return t._internalPath;if(typeof t=="string")return _2(e,t);throw fh("Field path arguments must be of type string or ",e,!1,void 0,i)}const m2=new RegExp("[~\\*/\\[\\]]");function _2(e,t,i){if(t.search(m2)>=0)throw fh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,i);try{return new JE(...t.split("."))._internalPath}catch{throw fh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,i)}}function fh(e,t,i,r,o){const u=r&&!r.isEmpty(),c=o!==void 0;let m=`Function ${t}() called with invalid data`;i&&(m+=" (via `toFirestore()`)"),m+=". ";let _="";return(u||c)&&(_+=" (found",u&&(_+=` in field ${r}`),c&&(_+=` in document ${o}`),_+=")"),new he(te.INVALID_ARGUMENT,m+e+_)}function p2(e,t){return e.some((i=>i.isEqual(t)))}class g2{convertValue(t,i="none"){switch(_r(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ct(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,i);case 5:return t.stringValue;case 6:return this.convertBytes(mr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,i);case 11:return this.convertObject(t.mapValue,i);case 10:return this.convertVectorValue(t.mapValue);default:throw Se(62114,{value:t})}}convertObject(t,i){return this.convertObjectMap(t.fields,i)}convertObjectMap(t,i="none"){const r={};return ts(t,((o,u)=>{r[o]=this.convertValue(u,i)})),r}convertVectorValue(t){const i=t.fields?.[ih].arrayValue?.values?.map((r=>Ct(r.doubleValue)));return new Si(i)}convertGeoPoint(t){return new ea(Ct(t.latitude),Ct(t.longitude))}convertArray(t,i){return(t.values||[]).map((r=>this.convertValue(r,i)))}convertServerTimestamp(t,i){switch(i){case"previous":const r=gh(t);return r==null?null:this.convertValue(r,i);case"estimate":return this.convertTimestamp(Yl(t));default:return null}}convertTimestamp(t){const i=dr(t);return new gt(i.seconds,i.nanos)}convertDocumentKey(t,i){const r=dt.fromString(t);tt(IE(r),9688,{name:t});const o=new Fl(r.get(1),r.get(3)),u=new Te(r.popFirst(5));return o.isEqual(i)||ba(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),u}}class y2 extends g2{constructor(t){super(),this.firestore=t}convertBytes(t){return new oi(t)}convertReference(t){const i=this.convertDocumentKey(t,this.firestore._databaseId);return new nn(this.firestore,null,i)}}const $0="@firebase/firestore",Z0="4.11.0";class sv{constructor(t,i,r,o,u){this._firestore=t,this._userDataWriter=i,this._key=r,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new T2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(t){if(this._document){const i=this._document.data.field(kh("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i)}}}class T2 extends sv{data(){return super.data()}}function E2(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new he(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class e_{}class t_ extends e_{}function ov(e,t,...i){let r=[];t instanceof e_&&r.push(t),r=r.concat(i),(function(u){const c=u.filter((_=>_ instanceof i_)).length,m=u.filter((_=>_ instanceof n_)).length;if(c>1||c>0&&m>0)throw new he(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const o of r)e=o._apply(e);return e}class n_ extends t_{constructor(t,i,r){super(),this._field=t,this._op=i,this._value=r,this.type="where"}static _create(t,i,r){return new n_(t,i,r)}_apply(t){const i=this._parse(t);return cv(t._query,i),new yr(t.firestore,t.converter,um(t._query,i))}_parse(t){const i=nv(t.firestore);return(function(u,c,m,_,p,y,v){let w;if(p.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new he(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){eT(v,y);const M=[];for(const V of v)M.push(J0(_,u,V));w={arrayValue:{values:M}}}else w=J0(_,u,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||eT(v,y),w=d2(m,c,v,y==="in"||y==="not-in");return Gt.create(p,y,w)})(t._query,"where",i,t.firestore._databaseId,this._field,this._op,this._value)}}class i_ extends e_{constructor(t,i){super(),this.type=t,this._queryConstraints=i}static _create(t,i){return new i_(t,i)}_parse(t){const i=this._queryConstraints.map((r=>r._parse(t))).filter((r=>r.getFilters().length>0));return i.length===1?i[0]:Ri.create(i,this._getOperator())}_apply(t){const i=this._parse(t);return i.getFilters().length===0?t:((function(o,u){let c=o;const m=u.getFlattenedFilters();for(const _ of m)cv(c,_),c=um(c,_)})(t._query,i),new yr(t.firestore,t.converter,um(t._query,i)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class a_ extends t_{constructor(t,i){super(),this._field=t,this._direction=i,this.type="orderBy"}static _create(t,i){return new a_(t,i)}_apply(t){const i=(function(o,u,c){if(o.startAt!==null)throw new he(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new he(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xl(u,c)})(t._query,this._field,this._direction);return new yr(t.firestore,t.converter,xS(t._query,i))}}function lv(e,t="asc"){const i=t,r=kh("orderBy",e);return a_._create(r,i)}class r_ extends t_{constructor(t,i,r){super(),this.type=t,this._limit=i,this._limitType=r}static _create(t,i,r){return new r_(t,i,r)}_apply(t){return new yr(t.firestore,t.converter,rh(t._query,this._limit,this._limitType))}}function uv(e){return uS("limit",e),r_._create("limit",e,"F")}function J0(e,t,i){if(typeof(i=lo(i))=="string"){if(i==="")throw new he(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rE(t)&&i.indexOf("/")!==-1)throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${i}' contains a '/' character.`);const r=t.path.child(dt.fromString(i));if(!Te.isDocumentKey(r))throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return m0(e,new Te(r))}if(i instanceof nn)return m0(e,i._key);throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mh(i)}.`)}function eT(e,t){if(!Array.isArray(e)||e.length===0)throw new he(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function cv(e,t){const i=(function(o,u){for(const c of o)for(const m of c.getFlattenedFilters())if(u.indexOf(m.op)>=0)return m.op;return null})(e.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(i!==null)throw i===t.op?new he(te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new he(te.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${i.toString()}' filters.`)}function v2(e,t,i){let r;return r=e?e.toFirestore(t):t,r}class Uc{constructor(t,i){this.hasPendingWrites=t,this.fromCache=i}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class ao extends sv{constructor(t,i,r,o,u,c){super(t,i,r,o,c),this._firestore=t,this._firestoreImpl=t,this.metadata=u}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const i=new Qc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,i={}){if(this._document){const r=this._document.data.field(kh("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,i.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,i={};return i.type=ao._jsonSchemaVersion,i.bundle="",i.bundleSource="DocumentSnapshot",i.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?i:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),i.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),i)}}ao._jsonSchemaVersion="firestore/documentSnapshot/1.0",ao._jsonSchema={type:jt("string",ao._jsonSchemaVersion),bundleSource:jt("string","DocumentSnapshot"),bundleName:jt("string"),bundle:jt("string")};class Qc extends ao{data(t={}){return super.data(t)}}class ro{constructor(t,i,r,o){this._firestore=t,this._userDataWriter=i,this._snapshot=o,this.metadata=new Uc(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const t=[];return this.forEach((i=>t.push(i))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,i){this._snapshot.docs.forEach((r=>{t.call(i,new Qc(this._firestore,this._userDataWriter,r.key,r,new Uc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const i=!!t.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new he(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=(function(o,u){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map((m=>{const _=new Qc(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Uc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:_,oldIndex:-1,newIndex:c++}}))}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>u||m.type!==3)).map((m=>{const _=new Qc(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Uc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let p=-1,y=-1;return m.type!==0&&(p=c.indexOf(m.doc.key),c=c.delete(m.doc.key)),m.type!==1&&(c=c.add(m.doc),y=c.indexOf(m.doc.key)),{type:w2(m.type),doc:_,oldIndex:p,newIndex:y}}))}})(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=ro._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=km.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const i=[],r=[],o=[];return this.docs.forEach((u=>{u._document!==null&&(i.push(u._document),r.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),o.push(u.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function w2(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se(61501,{type:e})}}ro._jsonSchemaVersion="firestore/querySnapshot/1.0",ro._jsonSchema={type:jt("string",ro._jsonSchemaVersion),bundleSource:jt("string","QuerySnapshot"),bundleName:jt("string"),bundle:jt("string")};function Dh(e){e=jl(e,yr);const t=jl(e.firestore,Ih),i=ZE(t),r=new y2(t);return E2(e._query),t2(i,e._query).then((o=>new ro(t,r,e,o)))}function hv(e){return dv(jl(e.firestore,Ih),[new Lm(e._key,Zi.none())])}function fv(e,t){const i=jl(e.firestore,Ih),r=s2(e),o=v2(e.converter,t),u=nv(e.firestore);return dv(i,[f2(u,"addDoc",r._key,o,e.converter!==null,{}).toMutation(r._key,Zi.exists(!1))]).then((()=>r))}function dv(e,t){const i=ZE(e);return n2(i,t)}(function(t,i=!0){$A(PA),eh(new Bl("firestore",((r,{instanceIdentifier:o,options:u})=>{const c=r.getProvider("app").getImmediate(),m=new Ih(new eS(r.getProvider("auth-internal")),new iS(c,r.getProvider("app-check-internal")),vS(c,o),c);return u={useFetchStreams:i,...u},m._setSettings(u),m}),"PUBLIC").setMultipleInstances(!0)),to($0,Z0,t),to($0,Z0,"esm2020")})();const b2={apiKey:"AIzaSyC0DwgLW_TZ0_F_sFtV7ClXiRamS19Ko0k",authDomain:"snowpeak-16fcc.firebaseapp.com",projectId:"snowpeak-16fcc",storageBucket:"snowpeak-16fcc.firebasestorage.app",messagingSenderId:"516645386130",appId:"1:516645386130:web:926f1606c8e82e5f27b34b"},A2=DT(b2),bo=o2(A2),s_="high_scores",o_="slalom_scores";async function S2(){try{const e=ov(wo(bo,s_),lv("steps","asc"),uv(50));return(await Dh(e)).docs.map(i=>i.data())}catch(e){return console.warn("Failed to fetch scores from cloud:",e),null}}async function tT(e){try{await fv(wo(bo,s_),e)}catch(t){console.warn("Failed to save score to cloud:",t)}}async function R2(){try{const t=(await Dh(wo(bo,s_))).docs.map(i=>hv(i.ref));await Promise.all(t)}catch(e){console.warn("Failed to clear scores from cloud:",e)}}async function I2(){try{const e=ov(wo(bo,o_),lv("score","desc"),uv(100));return(await Dh(e)).docs.map(i=>i.data())}catch(e){return console.warn("Failed to fetch slalom scores from cloud:",e),null}}async function k2(e){try{await fv(wo(bo,o_),e)}catch(t){console.warn("Failed to save slalom score to cloud:",t)}}async function D2(){try{const t=(await Dh(wo(bo,o_))).docs.map(i=>hv(i.ref));await Promise.all(t)}catch(e){console.warn("Failed to clear slalom scores from cloud:",e)}}const $l="snowpeak_high_scores_v4",Tm=50,O2=240*1e3;function Zl(){try{let e=localStorage.getItem($l);if(!e&&(e=localStorage.getItem("snowpeak_high_scores_v3"),e)){const i=_v(JSON.parse(e));return Jl(i),localStorage.setItem($l,JSON.stringify(i)),localStorage.removeItem("snowpeak_high_scores_v3"),i}const t=e?JSON.parse(e):[];if(t.length>0){const i=mv(t);return Jl(i),i}return t}catch{return[]}}function Jl(e){return e.sort((t,i)=>{const r={expert:0,standard:1,easy:2},o=(r[t.mode]??1)-(r[i.mode]??1);if(o!==0)return o;if(t.steps!==i.steps)return t.steps-i.steps;const u=t.date?new Date(t.date).getTime():0;return(i.date?new Date(i.date).getTime():0)-u})}function mv(e){const t={expert:0,standard:1,easy:2},i=new Map;for(const r of e){const o=r.name.toLowerCase(),u=i.get(o);if(!u)i.set(o,r);else{const c=t[u.mode]??1,m=t[r.mode]??1;(m<c||m===c&&r.steps<u.steps)&&i.set(o,r)}}return Array.from(i.values())}function C2(e,t,i,r){const o=Oh(i),u=Zl(),c={name:e,steps:t,time:o,elapsedMs:i,mode:r,date:new Date().toISOString(),migrated_v4:!0},m=u.findIndex(y=>y.name.toLowerCase()===e.toLowerCase());if(m!==-1){const y=u[m],v={expert:0,standard:1,easy:2},w=v[y.mode]??1,R=v[c.mode]??1;if(R<w||R===w&&t<y.steps)u.splice(m,1),u.push(c),tT(c);else{Jl(u);const V=u.slice(0,Tm);return{rank:V.findIndex(O=>O.name.toLowerCase()===e.toLowerCase())+1,scores:V,keptPrevious:!0,previousMode:y.mode,previousSteps:y.steps}}}else u.push(c),tT(c);Jl(u);const _=u.slice(0,Tm);try{localStorage.setItem($l,JSON.stringify(_))}catch{}return{rank:_.findIndex(y=>y.name.toLowerCase()===e.toLowerCase())+1,scores:_,keptPrevious:!1}}function _v(e){return e.map(t=>{if(t.migrated_v4)return t;const i=(t.elapsedMs||0)+O2;return{...t,elapsedMs:i,time:Oh(i),migrated_v4:!0}})}async function N2(){const e=await S2();if(!e||e.length===0)return Zl();const t=_v(e),i=Zl(),r=[...t,...i],o=mv(r);Jl(o);const u=o.slice(0,Tm);try{localStorage.setItem($l,JSON.stringify(u))}catch{}return u}async function M2(){try{localStorage.removeItem($l),localStorage.removeItem("snowpeak_high_scores_v3")}catch{}try{await R2()}catch{}}function Oh(e){const t=Math.floor(e/1e3),i=Math.floor(t/60),r=t%60;return i===0?`${r}s`:`${i}m ${String(r).padStart(2,"0")}s`}function pv(e){if(!e)return"";const t=new Date(e);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]} ${t.getDate()}, ${t.getFullYear()}`}function gv(e,t=!1){const i=[],r=t?50:10,o=e.slice(0,r);i.push({text:"",type:"normal"}),i.push({text:"--------- TOP ADVENTURERS WHO UNLOCKED THE SECRET ---------",type:"system"}),i.push({text:"  #   PLAYER           STEPS   ELAPSED TIME   MODE        DATE",type:"system"}),i.push({text:"  --  --------         -----   ------------   ---------   ----",type:"system"});for(let u=0;u<o.length;u++){const c=o[u],m="  "+String(u+1).padEnd(4)+c.name.slice(0,15).padEnd(18)+String(c.steps).padEnd(7)+(c.time||"").padEnd(14)+(c.mode||"standard").padEnd(11)+pv(c.date);i.push({text:m,type:"system"})}return!t&&e.length>10&&(i.push({text:"",type:"normal"}),i.push({text:`  Showing top 10 of ${e.length}.`,type:"normal",action:{label:"[Show all]",command:"scores all"}})),t&&e.length>10&&(i.push({text:"",type:"normal"}),i.push({text:`  Showing all ${Math.min(e.length,50)} scores.`,type:"normal",action:{label:"[Show less]",command:"scores"}})),i.push({text:"",type:"normal"}),i}const zl=["A friendly Siberian Husky bounds out of nowhere, tail wagging furiously! It drops a snow-covered stick at your feet, barks once, then zooms away in a blur of fluff.","You hear excited panting behind you. A Siberian Husky with bright blue eyes nudges your hand with its cold nose, demands exactly three pets, then trots off looking very satisfied.","A Husky appears, spins in three tight circles chasing its own tail, stops to give you a goofy tongue-out grin, then disappears around the corner at full speed.","A fluffy Siberian Husky slides across the icy ground on its belly like a furry toboggan, bumps gently into your leg, looks up at you with zero shame, and scrambles off.",'A Husky pops its head out from behind a snowdrift, lets out a dramatic "AWOOOO!", then army-crawls toward you for belly rubs before bounding away happily.',"A snow-dusted Husky trots up carrying something in its mouth. It drops a frozen finger at your feet, wags its tail proudly, and prances away before you can react. That's... unsettling.","You spot a Husky rolling ecstatically in a fresh patch of snow, all four paws in the air. It notices you watching, freezes mid-roll, then bolts off as if nothing happened.","A Siberian Husky zooms past at incredible speed, loops back, sniffs your boots thoroughly, sneezes directly on your shoes, and gallops away looking enormously pleased.","A Husky appears with snow on its nose and what appears to be a tiny snowball balanced on its head. It sits perfectly still for two seconds, shakes everything off, and dashes into the distance.","A playful Husky rushes up and play-bows in front of you, butt wiggling in the air. It lets out a series of excited yips, does a victory lap around you, and vanishes into the snow."];function K(e,t,i="normal"){return{...e,output:[...e.output,{text:t,type:i}]}}function nT(e,t){return{...e,output:[...e.output,...t]}}function en(e,t){return{...e,output:[...e.output,{type:"sound",sound:t}]}}function Fd(e,t){return e==="mountain_peak"&&t==="ski_lift_top"?"lift_motor":{lodge_lobby:"lobby_chatter",lodge_bar:"lobby_chatter",game_room:"footstep",lodge_balcony:"wind",basement:"creak_door",main_street:"snow_crunch",ski_rental:"creak_door",village:"snow_crunch",ski_slopes:"snow_crunch",ski_lift_top:"wind",frozen_waterfall:"wind",mountain_peak:"wind",hidden_cave:"cave_echo",underground_vault:"vault_rumble",staff_hallway:"footstep",staff_quarters:"creak_door",kitchen:"wood_floor",pantry:"wood_floor",storage_room:"creak_door",general_store:"store_bell",chapel:"chapel_echo",old_cabin:"wood_floor",underground_tunnel:"tunnel_drip",hidden_observatory:"observatory_hum",ice_caves:"wind",avalanche_zone:"wind",ridge_trail:"snow_crunch",summit_shelter:"wind"}[e]||"footstep"}function Ch(e){return e.currentRoomId==="hidden_cave"&&!e.inventory.includes("torch")}function Ul(e,t){const i=e.rooms[t];let r=e;if(t==="hidden_cave"&&!r.inventory.includes("torch"))return r=K(r,"Hidden Cave","title"),r=K(r,"You squeeze through the narrow opening into total darkness. The air is frigid and still. You can't see a thing, but you can feel the rough cave walls around you. Near the entrance, your hand brushes against something wooden mounted on the wall -- it feels like a torch.","normal"),r=K(r,`
Exits: west`,"system"),r;i.ascii&&(r=K(r,i.ascii,"ascii")),r=K(r,i.name,"title"),r=K(r,i.description,"normal");const o=i.items.filter(p=>{const y=r.items[p];return y&&!y.hidden});if(o.length>0){const p=o.map(y=>r.items[y].name);r=K(r,`
You can see: ${p.join(", ")}.`,"normal")}if(i.npcs.length>0){const p=i.npcs.map(y=>r.npcs[y].name);r=K(r,`${p.join(" and ")} ${i.npcs.length===1?"is":"are"} here.`,"normal")}const u={...i.exits,...i.hiddenExits},m=t!=="hidden_cave"?i.lockedExits||{}:{},_=[];for(const p of Object.keys(u)){const y=u[p],v=r.rooms[y];v?_.push(`${p} (${v.name})`):_.push(p)}for(const p of Object.keys(m)){const v=m[p].roomId,w=r.rooms[v];w?_.push(`${p} (${w.name})`):_.push(p)}return _.length>0&&(r=K(r,`
Exits: ${_.join(", ")}`,"system")),r}function V2(e,{direction:t}){const i=e.rooms[e.currentRoomId];let o={...i.exits,...i.hiddenExits}[t];if(!o&&i.lockedExits&&i.lockedExits[t]){const _=i.lockedExits[t];if(_.keyId&&e.inventory.includes(_.keyId)){o=_.roomId;const p={...i,exits:{...i.exits,[t]:_.roomId},lockedExits:{...i.lockedExits}};delete p.lockedExits[t];let y={...e,rooms:{...e.rooms,[e.currentRoomId]:p}};return _.roomId==="basement"?y=K(y,"The old basement key fits perfectly in the lock. With a satisfying click, the heavy wooden door creaks open, revealing stone steps leading down into darkness.","normal"):_.roomId==="staff_quarters"?(y=K(y,"You slide the staff key into the lock. The mechanism turns with a heavy *CLUNK* and the door to the staff quarters swings open, revealing a dimly lit corridor beyond.","normal"),y=en(y,"unlock")):y=K(y,`You use the ${e.items[_.keyId].name} to unlock the way ${t}.`,"normal"),y=K(y,"","normal"),y=en(y,Fd(o,e.currentRoomId)),y={...y,currentRoomId:o,previousRoomId:e.currentRoomId},y=Ul(y,o),y={...y,rooms:{...y.rooms,[o]:{...y.rooms[o],visited:!0}}},y}if(_.requireItems)if(_.requireItems.every(y=>e.inventory.includes(y))){o=_.roomId;const y={...i,exits:{...i.exits,[t]:_.roomId},lockedExits:{...i.lockedExits}};delete y.lockedExits[t];let v={...e,rooms:{...e.rooms,[e.currentRoomId]:y}};return _.roomId==="ice_caves"?(v=K(v,"You hammer the pickaxe into the ice wall and secure the climbing rope to a rock anchor. Carefully rappelling down the frozen passage, you descend into the mountain. The ice groans and cracks around you as you go deeper. Finally, you reach the bottom -- a vast cavern of glittering ice!","normal"),v=en(v,"wind")):v=K(v,`You use your equipment to unlock the way ${t}.`,"normal"),v=K(v,"","normal"),v=en(v,Fd(o,e.currentRoomId)),v={...v,currentRoomId:o,previousRoomId:e.currentRoomId},v=Ul(v,o),v={...v,rooms:{...v.rooms,[o]:{...v.rooms[o],visited:!0}}},v}else return K(e,_.message,"error");if(_.requireItem&&e.inventory.includes(_.requireItem))o=_.roomId;else return K(e,_.message,"error")}if(!o)return K(e,"You can't go that way.","error");if(["ski_slopes","frozen_waterfall","ski_lift_top","mountain_peak"].includes(o)&&!e.inventory.includes("warm_coat"))return K(e,"The bitter mountain wind cuts right through you! It's far too cold to continue without a warm coat. You turn back, shivering.","error");let c=en(e,Fd(o,e.currentRoomId));if(c={...c,currentRoomId:o,previousRoomId:e.currentRoomId},c=K(c,"","normal"),c=Ul(c,o),c={...c,rooms:{...c.rooms,[o]:{...c.rooms[o],visited:!0}}},!["hidden_cave","underground_vault"].includes(o)&&Math.random()<.2){const p=c.puzzles.finger_given;let y=Math.floor(Math.random()*zl.length);y===5&&p&&(y=(y+1)%zl.length),c=K(c,"","normal"),c=K(c,zl[y],"npc"),y===5&&!p&&(c={...c,inventory:[...c.inventory,"frozen_finger"],puzzles:{...c.puzzles,finger_given:!0}},c=K(c,`
[Frozen finger added to inventory]`,"system"))}return c.mode==="expert"&&c.puzzles.candle_lit&&["ski_slopes","frozen_waterfall","ski_lift_top","mountain_peak","ridge_trail","avalanche_zone","summit_shelter","ice_caves"].includes(o)&&(c=K(c,"","normal"),c=K(c,"The fierce mountain wind blows out your candle! The flame flickers and dies, leaving you in darkness once more.","normal"),c={...c,puzzles:{...c.puzzles,candle_lit:!1}}),c}function L2(e,t={}){if(Ch(e)&&(t.itemId||t.npcId||t.target))return K(e,"It's pitch black! You can't see a thing.","error");if(t.npcId){const i=e.npcs[t.npcId];return K(e,i.description,"normal")}if(t.itemId){const i=e.items[t.itemId];return K(e,i.description,"normal")}if(t.target){const i=e.rooms[e.currentRoomId];if(e.currentRoomId==="frozen_waterfall"&&(t.target.includes("waterfall")||t.target.includes("ice")||t.target.includes("water"))){if(i.hiddenExits?.east)return K(e,"You examine the frozen waterfall closely. You can see the narrow gap in the ice on the east side -- the hidden cave entrance you discovered with your binoculars.","normal");const r=e.npcs.angry_boss?.flags?.calmed,o=e.npcs.dill_pickle?.flags?.fixed_radio;return r||o?e.inventory.includes("binoculars")?K(e,"You examine the ice closely. You can tell something is behind it... try using your binoculars to get a better look!","normal"):K(e,"You examine the frozen waterfall closely. Knowing there's supposed to be a cave here, you squint at the ice... but you can't quite make out where the entrance might be. Maybe you need something to help you see better -- like binoculars?","normal"):K(e,"The frozen waterfall is mesmerizing -- a wall of ice frozen in mid-flow. It's beautiful but you feel like there might be more to it than meets the eye. Maybe someone at the resort knows something...","normal")}return e.currentRoomId==="basement"&&e.mode==="expert"&&(t.target.includes("metal")||t.target.includes("glint")||t.target.includes("behind")||t.target.includes("cabinet"))&&!e.puzzles.fuse_dislodged?K(e,"You crouch down and peer behind the old arcade cabinet. There's definitely something metallic wedged back there  looks like it could be some kind of heavy-duty electrical component. But it's jammed tight between the cabinet and the stone wall. No amount of reaching or prying is going to get it out. Maybe if the cabinet moved somehow...","normal"):K(e,"You don't see anything special about that.","normal")}return Ul(e,e.currentRoomId)}function H2(e,{itemId:t}){const i=e.rooms[e.currentRoomId];if(Ch(e)&&t!=="torch")return K(e,"It's pitch black! You can't see anything to take. You can feel something wooden on the wall near the entrance though...","error");if(!i.items.includes(t))return e.inventory.includes(t)?K(e,"You already have that.","error"):K(e,"That's not here.","error");const r=e.items[t];if(!r.takeable)return K(e,"You can't take that.","error");const o={...i,items:i.items.filter(c=>c!==t)};let u={...e,rooms:{...e.rooms,[e.currentRoomId]:o},inventory:[...e.inventory,t]};return u=K(u,`You pick up the ${r.name}.`,"normal"),t==="torch"&&e.currentRoomId==="hidden_cave"&&(u=K(u,`
The torch sputters to life, casting a warm flickering glow across the cave walls!`,"normal"),u=K(u,"","normal"),u=Ul(u,"hidden_cave")),u}function P2(e,{itemId:t}){if(!e.inventory.includes(t))return K(e,"You're not carrying that.","error");const i=e.items[t],r=e.rooms[e.currentRoomId],o={...r,items:[...r.items,t]};let u={...e,rooms:{...e.rooms,[e.currentRoomId]:o},inventory:e.inventory.filter(c=>c!==t)};return u=K(u,`You drop the ${i.name}.`,"normal"),u}function x2(e){if(e.inventory.length===0)return K(e,"You're not carrying anything.","normal");const t=e.inventory.map(r=>`  - ${e.items[r].name}`);let i=K(e,"You are carrying:","normal");for(const r of t)i=K(i,r,"normal");return i}function yv(e,{npcId:t}){const i=e.npcs[t];if(!e.rooms[e.currentRoomId].npcs.includes(t))return K(e,`${i.name} isn't here.`,"error");const o=i.dialogue.filter(_=>_.state===i.dialogueState);let u=null;for(const _ of o)if(_.condition){if(_.condition.hasItem&&e.inventory.includes(_.condition.hasItem)){u=_;break}if(_.condition.hasFlag&&e.puzzles[_.condition.hasFlag]){u=_;break}}if(u||(u=o.find(_=>!_.condition)),!u)return K(e,`${i.name} has nothing to say.`,"normal");let c=K(e,u.text,"npc");if(t==="angry_boss"&&!e.puzzles.angry_boss_image_shown&&(c=en(c,"angry_grunt"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/boss.jpg",text:"Angry Boss"}],puzzles:{...c.puzzles,angry_boss_image_shown:!0}}),t==="mr_smiles"&&!e.puzzles.mr_smiles_image_shown&&(c=en(c,"kid_laugh"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/mistersmiles.jpg",text:"Mr Smiles"}],puzzles:{...c.puzzles,mr_smiles_image_shown:!0}}),t==="mr_smiles"&&u.effects?.removeItem==="ski_poles"&&(c=en(c,"kid_laugh"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/smilespoles.jpg",text:"Mr Smiles with his ski poles"}]}),t==="dill_pickle"&&!e.puzzles.dill_pickle_image_shown&&(c={...c,output:[...c.output,{type:"image",src:"/snowpeak/skishop.jpg",text:"Dill Pickle in the ski shop"}],puzzles:{...c.puzzles,dill_pickle_image_shown:!0}}),t==="coach_joe"&&!e.puzzles.coach_joe_image_shown&&(c=en(c,"whistle"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/coach.jpg",text:"Coach Joe"}],puzzles:{...c.puzzles,coach_joe_image_shown:!0}}),t==="henrys_mom"&&!e.puzzles.henrys_mom_image_shown&&(c=en(c,"bag_rummage"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/snackmom.jpg",text:"Henry's Mom"}],puzzles:{...c.puzzles,henrys_mom_image_shown:!0}}),t==="dance_mom"&&!e.puzzles.dance_mom_image_shown&&(c=en(c,"camera_click"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/dancemom.jpg",text:"Social Media Influencer"}],puzzles:{...c.puzzles,dance_mom_image_shown:!0}}),t==="old_dad"&&!e.puzzles.old_dad_image_shown&&(c=en(c,"rocking_chair"),c={...c,output:[...c.output,{type:"image",src:"/snowpeak/olddad.jpg",text:"Old Dad"}],puzzles:{...c.puzzles,old_dad_image_shown:!0}}),u.effects){const _=u.effects;if(_.removeItem){const p=c.items[_.removeItem];c={...c,inventory:c.inventory.filter(y=>y!==_.removeItem)},p&&(c=K(c,`
[${p.name} removed from inventory]`,"system"))}if(_.addItem&&(c={...c,inventory:[...c.inventory,_.addItem]},c=K(c,`
[You received: ${c.items[_.addItem].name}]`,"system")),_.revealItem){const[p,y]=_.revealItem,v=c.items[p];if(v&&v.hidden){const w=c.rooms[y];c={...c,items:{...c.items,[p]:{...v,hidden:!1}},rooms:{...c.rooms,[y]:{...w,items:w.items.includes(p)?w.items:[...w.items,p]}}},c=K(c,`
[A ${v.name} has appeared on the floor!]`,"system")}}if(_.setFlag){const[p,y,v]=_.setFlag;c={...c,npcs:{...c.npcs,[p]:{...c.npcs[p],flags:{...c.npcs[p].flags,[y]:v}}}}}if(_.moveNpc){const[p,y]=_.moveNpc,v=c.npcs[p].currentRoomId;c={...c,npcs:{...c.npcs,[p]:{...c.npcs[p],currentRoomId:y}},rooms:{...c.rooms,[v]:{...c.rooms[v],npcs:c.rooms[v].npcs.filter(w=>w!==p)},[y]:{...c.rooms[y],npcs:[...c.rooms[y].npcs,p]}}}}}return(u.effects||i.dialogueState===0)&&(c={...c,npcs:{...c.npcs,[t]:{...c.npcs[t],dialogueState:i.dialogueState+1}}}),c}function z2(e,{itemId:t}){if(t==="arcade_machine"){if(!e.rooms[e.currentRoomId].items.includes("arcade_machine"))return K(e,"There's no arcade machine here.","error");let u=K(e,"You step up to the arcade machine and press START. The screen flickers to life...","normal");return u=K(u,"","normal"),u=K(u,"* SLALOM CHALLENGE *","title"),u=K(u,"The cabinet hums and the screen fills with green pixels. Time to hit the slopes!","normal"),u=en(u,"arcade_start"),u={...u,launchSlalom:!0},u}if(t==="basement_arcade"){if(!e.rooms[e.currentRoomId].items.includes("basement_arcade"))return K(e,"There's no arcade cabinet here.","error");let u=K(e,"You pull the dusty tarp aside and blow the cobwebs off the screen. The old CRT monitor crackles and hums to life, bathing the dark basement in an eerie green glow...","normal");return u=K(u,"","normal"),u=K(u,"* DEFEND THE VILLAGE *","title"),u=K(u,"The ancient cabinet shudders awake. Pixel wolves howl across the screen. Time to defend the village!","normal"),u=en(u,"arcade_start"),u={...u,launchDefend:!0},u}if(t==="store_arcade"){if(!e.rooms[e.currentRoomId].items.includes("store_arcade"))return K(e,"There's no arcade cabinet here.","error");if(!e.inventory.includes("game_tokens"))return K(e,'You squeeze past the shelves and find the old cabinet tucked in the corner. A slot on the front reads "INSERT TOKENS." You need game tokens to play this machine.',"normal");let u=K(e,"You fish a token out of the bag and drop it into the slot. The old cabinet hums to life with a satisfying clunk. The monitor crackles through a burst of static, casting a cool blue glow across the empty store...","normal");return u=K(u,"","normal"),u=K(u,"* SNOWBALL SHOWDOWN *","title"),u=K(u,'Two pixel characters face off across a snowy field. The screen reads: "READY... FIGHT!" Time for a snowball fight!',"normal"),u=en(u,"arcade_start"),u={...u,launchSnowball:!0},u}if(t==="shelter_arcade"){if(!e.rooms[e.currentRoomId].items.includes("shelter_arcade"))return K(e,"There's no arcade cabinet here.","error");if(!e.inventory.includes("game_tokens"))return K(e,'You brush the frost off the old arcade cabinet in the corner of the shelter. The token slot is frozen but readable: "INSERT TOKENS." You need game tokens to play this machine.',"normal");let u=K(e,"You drop a brass token into the frozen slot. The cabinet sputters, the screen crackles through a burst of static, and neon colors flood the dim shelter...","normal");return u=K(u,"","normal"),u=K(u,"* ICE BREAKER *","title"),u=K(u,"Rows of colorful bricks fill the screen. A glowing paddle waits at the bottom. Time to break some bricks!","normal"),u=en(u,"arcade_start"),u={...u,launchIcebreaker:!0},u}if(t==="store_bell"){if(!e.rooms[e.currentRoomId].items.includes("store_bell"))return K(e,"There's no bell here.","error");let u=K(e,"You ring the brass bell. *DING!* The sound echoes through the empty store.","normal");if(u=en(u,"bell"),Math.random()<.5){const c=zl[Math.floor(Math.random()*zl.length)];u=K(u,"","normal"),u=K(u,c,"normal"),c.includes("frozen finger")&&(u={...u,inventory:[...u.inventory,"frozen_finger"]})}else u=K(u,"","normal"),u=K(u,"Nobody comes. The store remains silent and empty.","normal");return u}if(!e.inventory.includes(t))return K(e,"You're not carrying that.","error");if(Ch(e))return K(e,"It's too dark to see what you're doing!","error");const i=e.items[t],r=e.currentRoomId;if(t==="frozen_finger")return K(e,"You use the frozen finger to pick your nose. It's a strangely refreshing feeling.","normal");if(t==="binoculars"&&r==="frozen_waterfall"){if(e.rooms.frozen_waterfall.hiddenExits?.east)return K(e,"You peer through the binoculars at the ice wall up close. You can already see the cave entrance to the east.","normal");let o=K(e,"You hold the binoculars up to the frozen waterfall and scan the ice closely. Through the lenses, a narrow crack in the ice comes into sharp focus -- it's not just a crack, it's an opening! A hidden passage leads east, into a cave behind the waterfall!","normal");return o={...o,rooms:{...o.rooms,frozen_waterfall:{...o.rooms.frozen_waterfall,hiddenExits:{...o.rooms.frozen_waterfall.hiddenExits,east:"hidden_cave"}}}},o=K(o,`
A new exit has been revealed: east (Hidden Cave)`,"system"),o}if(t==="binoculars"){const u={ridge_trail:["You peer through the binoculars along the ridge. The trail winds like a white ribbon between jagged peaks. Far below, the resort looks like a toy village. You can see tiny figures on the slopes, carving turns through fresh powder.","Through the lenses, you spot a family of mountain goats picking their way along a rocky outcrop across the valley. They move with impossible grace on the near-vertical cliff face.","The binoculars reveal an endless panorama of snow-capped peaks stretching to the horizon. The late afternoon sun paints them in shades of gold and pink. This is why people climb mountains."],mountain_peak:["From the summit, the binoculars reveal the entire valley spread out below like a living map. You can trace every trail, every road, every frozen stream. The world feels impossibly vast and quiet up here.","You scan the horizon through the binoculars. Peak after peak stretches into the distance, each one catching the light differently. You can see three other ski resorts, tiny and distant, nestled in neighboring valleys.","Peering straight down with the binoculars is dizzying -- the slopes fall away dramatically. You can see the ski lift chairs swaying gently in the wind, and far below, the warm glow of the lodge windows."],ski_lift_top:["You train the binoculars on the lift line stretching down the mountain. The cables hum in the wind. Below, you can see the full run of the ski slopes -- every mogul, every turn, every tree line.","Through the binoculars, you spot a hawk circling on the thermals above the valley. It dips and soars effortlessly, riding invisible currents of air. You feel a pang of envy.","The binoculars reveal details on the distant frozen waterfall -- layers of blue and white ice, frozen in mid-cascade. It looks like time itself stopped flowing there."],ice_caves:["You raise the binoculars inside the ice cave and peer through a gap in the frozen wall. The ice acts like a lens, refracting the light into shimmering rainbows that dance across the ceiling.","Through the binoculars, you study the ice formations up close. The crystalline structures are breathtaking -- delicate spires and curtains of ice that look like they were sculpted by an artist."],avalanche_zone:["You nervously scan the slopes above with the binoculars. Fresh snow sits heavy on the ridgeline -- it could slide at any moment. You can see where previous avalanches have carved paths through the trees, snapping trunks like matchsticks.","The binoculars reveal cracks in the snowpack above. This area is genuinely dangerous. Through the lenses, you spot what looks like an old warning sign half-buried in snow.","Scanning the debris field with binoculars, you notice strange shapes under the snow. Could be buried trees... or something else entirely. Best not to linger here."],ski_slopes:["You watch the empty slopes through the binoculars. Without any skiers, the mountain feels hauntingly peaceful. Fresh tracks from some animal -- maybe a fox -- zigzag across the pristine powder.","Through the binoculars, you can see all the way up to the ski lift station at the top. The slope looks steeper from down here than it does up close. No wonder they call it a black diamond run.","Scanning the tree line with binoculars, you catch a flash of movement -- a deer bounding through the deep snow at the edge of the forest, kicking up little clouds of white behind it."],frozen_waterfall:["The binoculars bring the frozen waterfall into sharp detail. Thousands of icicles hang like crystal chandeliers, some as thick as your arm. Behind the curtain of ice, you can just make out a dark opening...","You study the ice formations through the binoculars. The waterfall froze in layers -- you can see bands of clear blue ice alternating with milky white. It must have frozen over the course of several cold nights."]}[r];if(u){const c=u[Math.floor(Math.random()*u.length)];return K(e,c,"normal")}return K(e,"You peer through the binoculars, but there's nothing particularly interesting to see from here. Try using them somewhere with a view -- the mountain trails or slopes might be more rewarding.","normal")}if(t==="fuse"&&r==="ski_lift_top"){e.inventory.includes("fuse");const o=e.inventory.includes("screwdriver");if(e.mode==="expert"){if(!o)return K(e,"You try to install the fuse in the electrical panel. The fuse looks like it would fit perfectly, but you can't open the panel cover -- it's held shut by several screws. You need a tool... maybe a screwdriver to complete the job.","error");let u=K(e,"You use the screwdriver to open the electrical panel cover, then carefully slot the fuse into the empty socket. There's a satisfying CLUNK, followed by a low hum. The ski lift machinery groans to life! The chairs begin moving along the cable. The lift is working! You can now ride it up to the mountain peak.","normal");const c=u.rooms.ski_lift_top;return u={...u,inventory:u.inventory.filter(m=>m!=="fuse"&&m!=="screwdriver"),puzzles:{...u.puzzles,ski_lift_fixed:!0},rooms:{...u.rooms,ski_lift_top:{...c,description:"The upper ski lift station hums with power. The lift chairs glide smoothly along the cable, ready to carry riders to the peak. The electrical panel on the side of the station house is closed, the fuse and screwdriver both used in the repair.",exits:{...c.exits,up:"mountain_peak"}}}},u=K(u,`
[The ski lift is now operational! You can go up to the mountain peak.]`,"system"),u}else{let u=K(e,"You slot the electrical fuse into the empty socket on the control panel. There's a satisfying CLUNK, followed by a low hum. The ski lift machinery groans to life! The chairs begin moving along the cable. The lift is working! You can now ride it up to the mountain peak.","normal");const c=u.rooms.ski_lift_top;return u={...u,inventory:u.inventory.filter(m=>m!=="fuse"),puzzles:{...u.puzzles,ski_lift_fixed:!0},rooms:{...u.rooms,ski_lift_top:{...c,description:"The upper ski lift station hums with power. The lift chairs glide smoothly along the cable, ready to carry riders to the peak. The electrical panel on the side of the station house is closed, the fuse securely in place.",exits:{...c.exits,up:"mountain_peak"}}}},u=K(u,`
[The ski lift is now operational! You can go up to the mountain peak.]`,"system"),u}}if(t==="screwdriver"&&r==="ski_lift_top"&&e.mode==="expert")return K(e,"You use the screwdriver to open the electrical panel. Inside you can see an empty fuse socket -- the lift won't work without a fuse. You close the panel back up.","normal");if(t==="strange_medallion"&&r==="hidden_cave"){let o=K(e,"You press the strange medallion into the circular indentation beside the stone steps. It fits perfectly. There's a deep RUMBLE as ancient mechanisms engage. The heavy stone door at the bottom of the steps slowly grinds open, revealing a passage leading down into the mountain.","normal");const u=o.rooms.hidden_cave;return o={...o,inventory:o.inventory.filter(c=>c!=="strange_medallion"),rooms:{...o.rooms,hidden_cave:{...u,exits:{...u.exits,down:"underground_vault"},lockedExits:{}}}},o=K(o,`
[A new exit has been revealed: down]`,"system"),o}if(t==="binoculars"&&r==="lodge_balcony")return K(e,"You peer through the binoculars toward the mountain. The frozen waterfall comes into sharp focus. Behind the shimmering ice, you can make out what looks like... a cave entrance! The ice partially conceals a dark opening. Interesting.","normal");if(t==="torch"&&r==="hidden_cave")return K(e,"You hold the torch high. The flickering light reveals the cave walls in detail -- ancient markings, trail symbols, and an arrow pointing down toward the stone steps. The circular indentation beside the steps gleams in the torchlight.","normal");if(t==="matches"&&e.mode==="expert")return K(e,"You strike a match. It flares to life with a warm, flickering glow... but the mountain wind quickly snuffs it out. The brief light was comforting, but not very useful. Perhaps a candle would hold a flame longer.","normal");if(t==="candles"&&e.mode==="expert"){if(!e.inventory.includes("matches"))return K(e,"You hold the prayer candles, but you have no way to light them. You need matches or some other source of fire.","error");let o=K(e,"You strike a match and carefully light one of the prayer candles. The warm glow pushes back the shadows around you. The flame flickers but holds steady -- a comforting light in the cold mountain air.","normal");return o={...o,puzzles:{...o.puzzles,candle_lit:!0}},o=K(o,`
[The candle provides dim light, but beware of the wind!]`,"system"),o}if(t==="avalanche_beacon"&&e.mode==="expert"){let o=K(e,"You press the activation button on the avalanche beacon. Nothing happens -- the battery is long dead.","normal");return o=K(o,"","normal"),o=K(o,"Even if it worked, activating a beacon when there's no actual avalanche emergency is incredibly dangerous and irresponsible. False alarms put rescue teams at risk and waste critical resources.","normal"),o=K(o,"","normal"),o=K(o,`Have you heard the story of "The Boy Who Cried Wolf"? When a real emergency happens, nobody will believe you if you've raised false alarms. Out here in the mountains, that kind of mistake can cost lives.`,"normal"),o}return K(e,`You're not sure how to use the ${i.name} here.`,"error")}function U2(e,{itemId:t,npcId:i}){if(!e.inventory.includes(t))return K(e,"You're not carrying that.","error");if(!e.rooms[e.currentRoomId].npcs.includes(i))return K(e,"They're not here.","error");e.items[t];const o=e.npcs[i];if(t==="frozen_flower"){if(e.puzzles.frozen_flower_given)return K(e,"You've already given the frozen flower away.","error");let u=e;if(i==="angry_boss")u=K(u,`You hold out the frozen flower to ${o.name}.`,"normal"),u=K(u,"","normal"),u=K(u,`"What is THIS?!" Angry Boss snatches the flower and holds it up to the light. Her scowl flickers for just a moment. "A frozen flower. Great. Just GREAT. You know what this reminds me of? My FEELINGS on this vacation -- FROZEN and DEAD."

She pauses, turning the delicate petals in her fingers.

"...It's actually kind of beautiful though. Fine. FINE! I'll keep it. But DON'T tell anyone I said that. My reputation as the angriest person in this resort is ALL I have left."`,"npc");else if(i==="dance_mom")u=K(u,`You hold out the frozen flower to ${o.name}.`,"normal"),u=K(u,"","normal"),u=K(u,`"Oh. My. GOD!" She nearly drops her phone. "Is that a FROZEN FLOWER?! This is going STRAIGHT on my livestream! Hold on -- let me get the angle right --"

She grabs the flower and poses with it for approximately forty-seven selfies.

"This is CONTENT GOLD, honey! 'Mountain adventurer gifts rare frozen botanical specimen to influencer' -- my followers are going to LOSE IT! All four of them! Samantha is going to be SO jealous. You are now officially my favorite person at this resort. Don't let it go to your head."`,"npc");else if(i==="henrys_mom")u=K(u,`You hold out the frozen flower to ${o.name}.`,"normal"),u=K(u,"","normal"),u=K(u,`"Oh... oh my goodness." Henry's Mom takes the frozen flower gently, her eyes lighting up with the warmest smile. "This is just the sweetest thing. You know, Henry used to pick me dandelions from the backyard every single day. He'd line them up on the kitchen counter like little soldiers."

She carefully tucks the flower into her tote bag, nestled between the trail mix and a thermos of hot cocoa.

"I'm going to keep this forever. You are such a kind soul. Please  take some snacks. Take ALL the snacks. I insist. Granola bars, fruit snacks, string cheese  whatever you want. An adventurer with a good heart deserves a full stomach!"`,"npc");else return u=K(u,`You offer the frozen flower to ${o.name}, but they don't seem interested.`,"normal"),u;return u={...u,inventory:u.inventory.filter(c=>c!=="frozen_flower"),puzzles:{...u.puzzles,frozen_flower_given:!0}},u=K(u,`
[Frozen flower removed from inventory]`,"system"),u}return yv(e,{npcId:i})}function B2(e,{itemId:t}){if(!e.inventory.includes(t))return K(e,"You need to pick that up first before you can read it.","error");const i=e.items[t];if(t==="founders_letter"){let r=K(e,i.readText||i.description,"npc");r=K(r,"","normal"),r=K(r,"A faded photograph falls out of the envelope. It shows Tobias Snowpeak and friends on the slopes, grinning from ear to ear.","normal"),r={...r,output:[...r.output,{type:"image",src:"/snowpeak/founderskids.jpg",text:"Tobias Snowpeak and friends on the slopes"}]},r=nT(r,ub);try{const o=Date.now()-(e.startTime||Date.now()),u=e.turnCount+1,c=C2(e.playerName||"Adventurer",u,o,e.mode||"standard"),{rank:m,scores:_,keptPrevious:p,previousMode:y,previousSteps:v}=c;r=K(r,"","normal"),r=K(r,`${e.playerName}'s stats:  ${u} steps  |  ${Oh(o)}`,"victory"),p?r=K(r,`Your earlier score remains (#${m})  ${v} steps in ${y} mode was a better run!`,"system"):m===1?r=K(r,"NEW #1 HIGH SCORE!","victory"):r=K(r,`Ranked #${m} on the leaderboard!`,"victory"),r=nT(r,gv(_))}catch{r=K(r,"","normal"),r=K(r,"Congratulations on completing the adventure!","victory")}return r={...r,output:[...r.output,{type:"image",src:"/snowpeak/victory.svg",text:"The Golden Ski Trophy"}]},r=en(r,"victory"),r={...r,gameOver:!0,puzzles:{...r.puzzles,victory:!0}},r}if(t==="old_map"&&i.readText){const r={"Lodge Lobby":"lodge_lobby","Lodge Bar":"lodge_bar",Bar:"lodge_bar",Balcony:"lodge_balcony","Game Room":"game_room",Basement:"basement","Main Street":"main_street","Ski Rental":"ski_rental",Village:"village","Ski Slopes":"ski_slopes","Frozen Waterfall":"frozen_waterfall","Ski Lift Top":"ski_lift_top","Mountain Peak":"mountain_peak",Staff:"staff_hallway","Staff Quarters":"staff_quarters","Staff Q":"staff_quarters",Kitchen:"kitchen",Pantry:"pantry",Storage:"storage_room","General Store":"general_store",Chapel:"chapel","Old Cabin":"old_cabin","Underground Tunnel":"underground_tunnel",Observatory:"hidden_observatory","Ice Caves":"ice_caves","Avalanche Zone":"avalanche_zone","Ridge Trail":"ridge_trail","Summit Shelter":"summit_shelter"},o=i.readText.split(`
`);let u=e;for(const c of o){const m=/\[([^\]]+)\]/g,_=[];let p;for(;(p=m.exec(c))!==null;){const y=p[1],v=r[y];v&&_.push({start:p.index,end:p.index+p[0].length,text:p[0],displayName:y,roomId:v})}if(_.length===0)u=K(u,c,"normal");else{const y=[];let v=0;for(const w of _)w.start>v&&y.push({text:c.slice(v,w.start)}),w.roomId===e.currentRoomId?y.push({text:w.text,type:"current"}):e.rooms[w.roomId]?.visited?y.push({text:w.text,type:"visited"}):y.push({text:w.text}),v=w.end;v<c.length&&y.push({text:c.slice(v)}),u={...u,output:[...u.output,{text:"",type:"normal",segments:y}]}}}return u}return i.readText?K(e,i.readText,"normal"):K(e,i.description,"normal")}function G2(e){return{...e,gameRestart:!0,output:[...e.output,{text:"",type:"normal"},{text:"Restarting game...",type:"system"},{text:"Returning to mode selection...",type:"system"}]}}const On=7;function j2(e){const t=e.rooms[e.currentRoomId],i=[];if(Ch(e))return i.push({label:"Go west (Frozen Waterfall)",command:"west"}),t.items.includes("torch")&&i.push({label:"Take torch",command:"take torch"}),i.push({label:"Look around",command:"look"}),i;const r={...t.exits,...t.hiddenExits},u=e.currentRoomId!=="hidden_cave"?Object.keys(t.lockedExits||{}):[],c=[...Object.keys(r),...u],m={north:"Go north",south:"Go south",east:"Go east",west:"Go west",up:"Go up",down:"Go down"},_=c.filter(L=>{const O=r[L]||t.lockedExits?.[L]?.roomId;return O&&!e.rooms[O]?.visited}),p=c.filter(L=>{const O=r[L]||t.lockedExits?.[L]?.roomId;return!O||e.rooms[O]?.visited}),y=[..._,...p];function v(L){const O=r[L]||t.lockedExits?.[L]?.roomId,G=O?e.rooms[O]?.name:null;return{label:G?`${m[L]||`Go ${L}`} (${G})`:`${m[L]||`Go ${L}`}`,command:L}}for(const L of y){if(i.length>=On)break;i.push(v(L))}for(const L of t.npcs){if(i.length>=On)break;const O=e.npcs[L],G=q2(e,L);if(G){const J=e.items[G];i.push({label:`Give ${J.name} to ${O.name}`,command:`give ${J.name} to ${O.name.toLowerCase()}`})}else i.push({label:`Talk to ${O.name}`,command:`talk to ${O.name.toLowerCase()}`})}const w=t.items.filter(L=>{const O=e.items[L];return O&&!O.hidden});for(const L of w){if(i.length>=On)break;const O=e.items[L];O.takeable?i.push({label:`Take ${O.name}`,command:`take ${O.name}`}):i.push({label:`Look at ${O.name}`,command:`look at ${O.name}`})}const R=Y2(e);R&&i.length<On&&i.push(R);const M=F2(e);if(M&&i.length<On){const L=e.items[M];i.push({label:`Use ${L.name}`,command:`use ${L.name}`})}e.currentRoomId==="game_room"&&t.items.includes("arcade_machine")&&i.length<On&&i.push({label:"Play the arcade game",command:"play arcade game"}),e.currentRoomId==="basement"&&t.items.includes("basement_arcade")&&i.length<On&&i.push({label:"Play the dusty arcade cabinet",command:"play defend game"}),e.currentRoomId==="general_store"&&t.items.includes("store_arcade")&&i.length<On&&i.push({label:"Play the snowball arcade game",command:"play snowball game"}),e.currentRoomId==="summit_shelter"&&t.items.includes("shelter_arcade")&&i.length<On&&i.push({label:"Play the ice breaker arcade game",command:"play ice breaker"});const V=W2(e);if(V&&i.length<On){const L=e.items[V];i.push({label:`Read ${L.name}`,command:`read ${L.name}`})}return i.length<On&&e.inventory.length>0&&i.push({label:"Check inventory",command:"inventory"}),i.length<On&&i.push({label:"Look around",command:"look"}),i.length<On&&i.push({label:"Help",command:"help"}),i.slice(0,On)}function q2(e,t){const i=e.npcs[t];if(!i||i.dialogueState===0)return null;const o={angry_boss:"whiskey_bottle",mr_smiles:"ski_poles",dill_pickle:"broken_radio"}[t];return o&&e.inventory.includes(o)?o:null}function Y2(e){return e.currentRoomId==="frozen_waterfall"&&!e.rooms.frozen_waterfall.hiddenExits?.east&&!e.inventory.includes("binoculars")?{label:"Examine the frozen waterfall closely",command:"look at waterfall"}:null}function F2(e){const t=e.currentRoomId;for(const i of e.inventory){if(i==="fuse"&&t==="ski_lift_top"||i==="strange_medallion"&&t==="hidden_cave"||i==="binoculars"&&t==="lodge_balcony"||i==="binoculars"&&t==="frozen_waterfall"&&!e.rooms.frozen_waterfall.hiddenExits?.east)return i;const r=e.rooms[t];if(i==="whiskey_bottle"&&r.npcs.includes("angry_boss")||i==="ski_poles"&&r.npcs.includes("mr_smiles")||i==="broken_radio"&&r.npcs.includes("dill_pickle"))return null}for(const i of e.inventory)if(i==="torch"&&t==="hidden_cave")return i;return null}function W2(e){if(e.inventory.includes("founders_letter"))return"founders_letter";for(const t of e.inventory)if(["old_map","dusty_journal","note_from_founder"].includes(t))return t;return null}function X2({output:e,onCommand:t,gameOver:i,mode:r,gameState:o}){const[u,c]=ae.useState(""),[m,_]=ae.useState([]),[p,y]=ae.useState(-1),v=ae.useRef(null),w=ae.useRef(null),R=ae.useMemo(()=>r!=="easy"||i||!o?.currentRoomId?[]:j2(o),[r,i,o]);ae.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[e]),ae.useEffect(()=>{w.current&&w.current.focus()},[]);const M=ae.useCallback(G=>{G.preventDefault();const J=u.trim();J&&(_(re=>[...re,J]),y(-1),c(""),t(J))},[u,t]),V=ae.useCallback(G=>{t(G)},[t]),L=ae.useCallback(G=>{G.key==="ArrowUp"?(G.preventDefault(),y(J=>{const re=J===-1?m.length-1:Math.max(0,J-1);return m[re]!==void 0&&c(m[re]),re})):G.key==="ArrowDown"&&(G.preventDefault(),y(J=>{const re=J+1;return re>=m.length?(c(""),-1):(c(m[re]),re)}))},[m]),O=ae.useCallback(()=>{w.current&&w.current.focus()},[]);return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"terminal-output",ref:v,onClick:O,children:e.map((G,J)=>G.type==="sound"?null:G.type==="image"?S.jsx("div",{className:"output-line output-image",children:S.jsx("img",{src:G.src,alt:G.text||"image",onLoad:()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)}})},J):G.segments?S.jsx("div",{className:`output-line output-${G.type||"normal"}`,children:G.segments.map((re,Ce)=>S.jsx("span",{className:re.type?`output-${re.type}`:void 0,children:re.text},Ce))},J):S.jsxs("div",{className:`output-line output-${G.type||"normal"}`,children:[G.text,G.action&&S.jsxs(S.Fragment,{children:[" ",S.jsx("span",{className:"scores-expand-link",onClick:re=>{re.stopPropagation(),t(G.action.command)},children:G.action.label})]})]},J))}),!i&&r==="easy"&&R.length>0&&S.jsxs("div",{className:"choices-container",children:[R.map((G,J)=>S.jsxs("button",{className:"choice-button",onClick:()=>V(G.command),children:["[",J+1,"] ",G.label]},`${G.command}-${J}`)),S.jsx("button",{className:"choice-button choice-button-wildcard",onClick:()=>w.current?.focus(),children:"[*] Type a command..."})]}),!i&&S.jsxs("form",{className:"terminal-input-form",onSubmit:M,children:[S.jsx("span",{className:"prompt-char",children:">"}),S.jsx("input",{ref:w,type:"text",value:u,onChange:G=>c(G.target.value),onKeyDown:L,autoFocus:!0,spellCheck:!1,autoComplete:"off"})]})]})}const K2=["ass","asses","asshole","assholes","bastard","bastards","bitch","bitches","bitchy","bullshit","cock","cocks","crap","cum","damn","damned","dammit","dick","dicks","dickhead","douche","douchebag","fag","fags","faggot","faggots","fuck","fucker","fuckers","fuckin","fucking","fucks","fuckoff","goddamn","goddamnit","hell","ho","hoe","hoes","jackass","jerkoff","kike","kikes","milf","nazi","nazis","nigga","niggas","nigger","niggers","piss","pissed","prick","pricks","pussy","pussies","retard","retarded","retards","shit","shits","shitty","shithead","slut","sluts","slutty","tit","tits","titty","twat","twats","wank","wanker","wankers","whore","whores"];function Q2(e){const t=e.toLowerCase().replace(/[^a-z]/g,"");return K2.some(i=>t.includes(i))}function $2({onSubmit:e}){const[t,i]=ae.useState(""),[r,o]=ae.useState("name"),[u,c]=ae.useState(""),[m,_]=ae.useState(Zl()),[p,y]=ae.useState(!1),v=ae.useRef(null);ae.useEffect(()=>{N2().then(_)},[]),ae.useEffect(()=>{v.current&&v.current.focus()},[r]);const w=ae.useCallback(M=>{M.preventDefault();const V=t.trim();if(V){if(Q2(V)){c("Please choose a more appropriate handle.");return}c(""),o("mode")}},[t]),R=ae.useCallback(M=>{e({name:t.trim(),mode:M})},[t,e]);return ae.useEffect(()=>{if(r!=="mode")return;const M=V=>{const L=V.key;L==="1"?R("standard"):L==="2"?R("easy"):L==="3"?R("expert"):L==="4"&&R("bonus")};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[r,R]),S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"terminal-output",children:[S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-ascii welcome-art",children:`         *  .  *  .  *  .  *  .  *
      .     *     .     *     .
            .  *  .  *  .  *
               *  .  *
                 /\\
                /  \\         *  .  *
               / /\\ \\       .  *  .
              / /  \\ \\        *  .
             / /    \\ \\      .  *
            /  \\    /  \\
           /____\\  /____\\
          / ~~~~ SNOWPEAK ~~~~ \\
         / ~~~~~ RESORT  ~~~~~ \\
        /________________________\\
       /     est. 1976            \\
      /____________________________\\`}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"welcome-title",children:"THE SECRET OF SNOWPEAK RESORT"}),S.jsx("div",{className:"welcome-subtitle",children:"A Zork-Style Text Adventure"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-system",children:"Welcome, adventurer! Before we begin..."}),S.jsx("div",{className:"output-line output-normal",children:""}),m.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"output-line output-system",children:"--- TOP ADVENTURERS WHO UNLOCKED THE SECRET ---"}),S.jsx("div",{className:"output-line output-system",children:"  #   PLAYER           STEPS  ELAPSED TIME  MODE       DATE"}),S.jsx("div",{className:"output-line output-system",children:"  -   ------           -----  ------------  ----       ----"}),m.slice(0,p?50:10).map((M,V)=>S.jsxs("div",{className:"output-line output-system",children:["  ",String(V+1).padEnd(4),M.name.slice(0,15).padEnd(18),String(M.steps).padEnd(7),(M.time||"").padEnd(14),(M.mode||"standard").padEnd(11),pv(M.date)]},V)),!p&&m.length>10&&S.jsxs("div",{className:"output-line output-normal",children:["  ","Showing top 10 of ",m.length,"."," ",S.jsx("span",{className:"scores-expand-link",onClick:()=>y(!0),children:"[Show all]"})]}),p&&m.length>10&&S.jsxs("div",{className:"output-line output-normal",children:["  ","Showing all ",Math.min(m.length,50)," scores."," ",S.jsx("span",{className:"scores-expand-link",onClick:()=>y(!1),children:"[Show less]"})]}),S.jsx("div",{className:"output-line output-normal",children:""})]}),r==="mode"&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"output-line output-normal",children:["Welcome, ",t.trim(),"! Choose a mode:"]}),S.jsx("div",{className:"output-line output-normal",children:""})]})]}),r==="name"&&S.jsxs(S.Fragment,{children:[u&&S.jsx("div",{className:"output-line output-error",style:{padding:"0 20px 6px"},children:u}),S.jsxs("form",{className:"terminal-input-form name-entry-form",onSubmit:w,children:[S.jsx("label",{className:"prompt-label",children:"What name should I call you?"}),S.jsxs("div",{className:"name-input-row",children:[S.jsx("span",{className:"prompt-char",children:">"}),S.jsx("input",{ref:v,type:"text",value:t,onChange:M=>{i(M.target.value),c("")},autoFocus:!0,spellCheck:!1,autoComplete:"off",maxLength:15,placeholder:""})]})]})]}),r==="mode"&&S.jsxs("div",{className:"mode-select",children:[S.jsxs("button",{className:"mode-button",onClick:()=>R("standard"),autoFocus:!0,ref:v,children:["[1] STANDARD MODE",S.jsx("span",{className:"mode-desc",children:"Type commands freely, classic Zork style"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>R("easy"),children:["[2] EASY (CHEAT) MODE",S.jsx("span",{className:"mode-desc",children:"Choose from multiple choice options each turn, beginner friendly"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>R("expert"),children:["[3] EXPERT MODE (BETA)",S.jsx("span",{className:"mode-desc",children:"Double-size map with more locations to explore, for experienced adventurers"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>R("bonus"),children:["[4] BONUS CONTENT",S.jsx("span",{className:"mode-desc",children:"Play mini-games and view release notes"})]})]})]})}const _e={WIDTH:480,HEIGHT:640},We={SNOW_LIGHT:"#e8e8f0",SNOW_DARK:"#d0d0e0",SKI_BODY:"#ff5555",SKI_SKIS:"#333333",GATE_LEFT:"#ff4444",GATE_RIGHT:"#4488ff",GATE_POLE:"#886644",OBSTACLE_ROCK:"#888888",OBSTACLE_BEAR:"#dddddd",OBSTACLE_SKIER:"#ff8800",TREE_TRUNK:"#664422",TREE_LEAVES:"#227744",HUD_GREEN:"#33ff33",HUD_BG:"rgba(0,0,0,0.6)",OVERLAY_BG:"rgba(0,0,0,0.85)",MISS_RED:"#ff4444",TEXT_WHITE:"#ffffff",TEXT_DIM:"#88ff88"},Mn={WIDTH:16,HEIGHT:24,START_Y:100,ACCEL:.6,FRICTION:.88,MAX_VX:6},wt={MIN_GAP:60,MAX_GAP:120,FLAG_WIDTH:8,FLAG_HEIGHT:20,POLE_WIDTH:3,POLE_HEIGHT:28,SPAWN_SPACING_MIN:150,SPAWN_SPACING_MAX:200},_o={GATE_COUNT:10,GAP:160,SPACING:180,MAX_DRIFT:100},vi={ROCK:{width:24,height:20},BEAR:{width:28,height:28},SKIER:{width:16,height:24},TYPES:["rock","bear","skier"],SKIER_MOVE_MIN_DIFFICULTY:4,SKIER_VX_MIN:.3,SKIER_VX_MAX:1.2},ri={MIN_SIZE:20,MAX_SIZE:40,EDGE_MARGIN:60},Vn={LEVELS:10,DISTANCE_PER_LEVEL:750,SPEED_MIN:2,SPEED_MAX:6,OBSTACLE_CHANCE_MIN:.003,OBSTACLE_CHANCE_MAX:.015},Ln={MAX_MISSES:5,SPAWN_AHEAD:300,DESPAWN_BEHIND:-50,TREE_SPAWN_CHANCE:.08,SCORE_PER_GATE:100,CHAMPION_SCORE:2e3,GATE_DRIFT_FACTOR:.55},Ai={GATE_INTERVAL:5,SPEED_MULT_START:1.5,SPEED_MULT_MAX:4,ACCEL_FRAMES:120,BODY_COLOR:"#33ff33",HELMET_COLOR:"#ffcc00",LABEL:"NPC"},ai={GATE_INTERVAL:10,PEOPLE_PER_SIDE:5,PERSON_WIDTH:8,PERSON_HEIGHT:16,SPACING:14,SIDE_MARGIN:10,JACKET_COLORS:["#ff5555","#55ff55","#5555ff","#ffff55","#ff55ff","#55ffff","#ff8800","#ff44aa"]},hn={HUD:"20px VT323, monospace",TITLE:"48px VT323, monospace",SUBTITLE:"24px VT323, monospace",OVERLAY:"28px VT323, monospace",SMALL:"18px VT323, monospace"};function Z2(){const e=[];for(let t=-200;t<_e.HEIGHT+Ln.SPAWN_AHEAD+400;t+=35+Math.random()*30){const i=ri.MIN_SIZE+Math.random()*(ri.MAX_SIZE-ri.MIN_SIZE),o=(e.length%2===0?"left":"right")==="left"?Math.random()*ri.EDGE_MARGIN:_e.WIDTH-ri.EDGE_MARGIN+Math.random()*ri.EDGE_MARGIN;e.push({x:o,y:t,size:i})}return e}function Wd(){return{phase:"ready",skier:{x:_e.WIDTH/2,vx:0,y:Mn.START_Y,width:Mn.WIDTH,height:Mn.HEIGHT},worldY:0,speed:Vn.SPEED_MIN,gates:[],obstacles:[],trees:Z2(),crowds:[],lastCrowdAt:0,rivals:[],lastRivalAt:0,score:0,gatesPassed:0,gatesMissed:0,gatesSpawned:0,lastGateCenterX:_e.WIDTH/2,maxMisses:Ln.MAX_MISSES,difficulty:1,input:{left:!1,right:!1},canvasWidth:_e.WIDTH,canvasHeight:_e.HEIGHT,nextGateY:_e.HEIGHT+100,events:[]}}function J2(e){if(e.phase!=="playing")return e;let t={...e,events:[]};t.worldY+=t.speed;const i=Math.min(Vn.LEVELS,Math.floor(t.worldY/Vn.DISTANCE_PER_LEVEL)+1);i>t.difficulty&&(t={...t,difficulty:i,events:[...t.events,"speed_up"]});const r=(t.difficulty-1)/(Vn.LEVELS-1);return t.speed=Vn.SPEED_MIN+r*(Vn.SPEED_MAX-Vn.SPEED_MIN),t=eI(t),t=rI(t),t=oI(t),t=uI(t),t=lI(t),t=hI(t),t=fI(t),t=mI(t),t=_I(t),t.gatesMissed>=t.maxMisses&&(t={...t,phase:"gameover",events:[...t.events,"game_over"]}),t}function eI(e){let{x:t,vx:i}=e.skier;return e.input.left&&(i-=Mn.ACCEL),e.input.right&&(i+=Mn.ACCEL),i*=Mn.FRICTION,i=Math.max(-6,Math.min(Mn.MAX_VX,i)),Math.abs(i)<.1&&(i=0),t+=i,t=Math.max(Mn.WIDTH/2,Math.min(_e.WIDTH-Mn.WIDTH/2,t)),{...e,skier:{...e.skier,x:t,vx:i}}}function tI(e){return e<_o.GATE_COUNT}function l_(e,t,i){if(e>=_o.GATE_COUNT)return i;const r=e/_o.GATE_COUNT;return t+r*(i-t)}function nI(e,t){const i=wt.MAX_GAP-(e-1)/(Vn.LEVELS-1)*(wt.MAX_GAP-wt.MIN_GAP);return l_(t,_o.GAP,i)}function iI(e,t){const i=wt.SPAWN_SPACING_MAX-(e-1)/(Vn.LEVELS-1)*(wt.SPAWN_SPACING_MAX-wt.SPAWN_SPACING_MIN);return l_(t,_o.SPACING,i)}function aI(e,t,i){const r=e/Math.max(t,1),u=Mn.MAX_VX*r*Ln.GATE_DRIFT_FACTOR;return l_(i,_o.MAX_DRIFT,u)}function rI(e){const t=e.worldY+_e.HEIGHT+Ln.SPAWN_AHEAD;if(e.nextGateY>t)return e;const i=nI(e.difficulty,e.gatesSpawned),r=iI(e.difficulty,e.gatesSpawned),o=aI(r,e.speed,e.gatesSpawned),u=40+i/2,c=Math.max(u,e.lastGateCenterX-o),m=Math.min(_e.WIDTH-u,e.lastGateCenterX+o),_=c+Math.random()*(m-c),p=_-i/2,y=_+i/2,v={y:e.nextGateY,leftX:p,rightX:y,passed:!1,missed:!1};return{...e,gates:[...e.gates,v],nextGateY:e.nextGateY+r,gatesSpawned:e.gatesSpawned+1,lastGateCenterX:_}}function sI(e,t,i,r){const u=e-20,c=e+t+20,m=e+t/2;for(let _=0;_<r.length;_++){const p=r[_];if(Math.abs(i-p.y)<120&&c>p.leftX&&u<p.rightX)return!0;const y=r[_+1];if(y&&i>p.y&&i<y.y){const v=(i-p.y)/(y.y-p.y),w=(p.leftX+p.rightX)/2,R=(y.leftX+y.rightX)/2,M=w+v*(R-w),V=p.rightX-p.leftX,L=y.rightX-y.leftX,O=(V+v*(L-V))/2+20;if(Math.abs(m-M)<O)return!0}}return!1}function oI(e){if(tI(e.gatesSpawned))return e;const t=(e.difficulty-1)/(Vn.LEVELS-1),i=Vn.OBSTACLE_CHANCE_MIN+t*(Vn.OBSTACLE_CHANCE_MAX-Vn.OBSTACLE_CHANCE_MIN);if(Math.random()>i)return e;const r=Math.floor(Math.random()*vi.TYPES.length),o=vi.TYPES[r],u=o==="rock"?vi.ROCK:o==="bear"?vi.BEAR:vi.SKIER,c=30,m=c+Math.random()*(_e.WIDTH-2*c-u.width),_=e.worldY+_e.HEIGHT+Ln.SPAWN_AHEAD+Math.random()*100;if(sI(m,u.width,_,e.gates))return e;let p=0;if(o==="skier"&&e.difficulty>=vi.SKIER_MOVE_MIN_DIFFICULTY){const y=(e.difficulty-vi.SKIER_MOVE_MIN_DIFFICULTY)/(Vn.LEVELS-vi.SKIER_MOVE_MIN_DIFFICULTY),v=vi.SKIER_VX_MIN+y*(vi.SKIER_VX_MAX-vi.SKIER_VX_MIN);p=(Math.random()<.5?-1:1)*v}return{...e,obstacles:[...e.obstacles,{type:o,x:m,y:_,width:u.width,height:u.height,vx:p}]}}function lI(e){let t=!1;const i=e.obstacles.map(r=>{if(!r.vx||r.vx===0)return r;t=!0;let o=r.x+r.vx,u=r.vx;return o<10&&(o=10,u=Math.abs(u)),o+r.width>_e.WIDTH-10&&(o=_e.WIDTH-10-r.width,u=-Math.abs(u)),{...r,x:o,vx:u}});return t?{...e,obstacles:i}:e}function uI(e){if(Math.random()>Ln.TREE_SPAWN_CHANCE)return e;const t=ri.MIN_SIZE+Math.random()*(ri.MAX_SIZE-ri.MIN_SIZE),r=(Math.random()<.5?"left":"right")==="left"?Math.random()*ri.EDGE_MARGIN:_e.WIDTH-ri.EDGE_MARGIN+Math.random()*ri.EDGE_MARGIN,o=e.worldY+_e.HEIGHT+Ln.SPAWN_AHEAD+Math.random()*50;return{...e,trees:[...e.trees,{x:r,y:o,size:t}]}}function cI(e){const t=e.worldY-_e.HEIGHT+50,i=[...e.gates].filter(r=>r.y>t).sort((r,o)=>r.y-o.y);return{...e,rivals:[...e.rivals,{x:_e.WIDTH/2,y:t,frame:0,gateIndex:0,gateCenters:i.map(r=>({y:r.y,cx:(r.leftX+r.rightX)/2}))}],lastRivalAt:e.gatesPassed}}function hI(e){if(e.rivals.length===0)return e;const i=e.rivals.map(r=>{const o=Math.min(1,r.frame/Ai.ACCEL_FRAMES),u=Ai.SPEED_MULT_START+o*(Ai.SPEED_MULT_MAX-Ai.SPEED_MULT_START),c=e.speed*u,m=r.y+c;let _=r.x;const p=r.gateCenters;let y=r.gateIndex;for(;y<p.length&&m>p[y].y+20;)y++;y<p.length&&(_=p[y].cx);const v=_-r.x,w=Math.min(Math.abs(v),4+o*3),R=r.x+Math.sign(v)*w;return{...r,x:R,y:m,frame:r.frame+1,gateIndex:y}}).filter(r=>li(r.y,e.worldY)<_e.HEIGHT+200);return{...e,rivals:i}}function li(e,t){return e-t+_e.HEIGHT-100}function fI(e){let t=[...e.events],i=e.score,r=e.gatesPassed,o=e.gatesMissed;const u=e.skier.y,c=e.skier.x,m=e.gates.map(p=>p.passed||p.missed?p:li(p.y,e.worldY)<u-Mn.HEIGHT/2?c>p.leftX&&c<p.rightX?(i+=Ln.SCORE_PER_GATE,r+=1,t.push("gate_pass"),{...p,passed:!0}):(o+=1,t.push("gate_miss"),{...p,missed:!0}):p);let _={...e,gates:m,score:i,gatesPassed:r,gatesMissed:o,events:t};return r>0&&r>=_.lastCrowdAt+ai.GATE_INTERVAL&&Math.floor(r/ai.GATE_INTERVAL)>Math.floor(_.lastCrowdAt/ai.GATE_INTERVAL)&&(_=dI(_),_={..._,lastCrowdAt:r,events:[..._.events,"crowd_cheer"]}),r>0&&r>=_.lastRivalAt+Ai.GATE_INTERVAL&&Math.floor(r/Ai.GATE_INTERVAL)>Math.floor(_.lastRivalAt/Ai.GATE_INTERVAL)&&(_=cI(_),_={..._,events:[..._.events,"rival_zoom"]}),_}function dI(e){const t=e.worldY+Mn.START_Y+80,i=[];for(const r of["left","right"])for(let o=0;o<ai.PEOPLE_PER_SIDE;o++){const u=ai.JACKET_COLORS[Math.floor(Math.random()*ai.JACKET_COLORS.length)],c=r==="left"?ai.SIDE_MARGIN+o*ai.SPACING:_e.WIDTH-ai.SIDE_MARGIN-(o+1)*ai.SPACING;i.push({side:r,x:c+(Math.random()-.5)*4,offsetY:(Math.random()-.5)*10,color:u,armPhase:Math.random()*Math.PI*2})}return{...e,crowds:[...e.crowds,{y:t,people:i}]}}function mI(e){const t=e.skier,i=t.x-t.width/2,r=t.x+t.width/2,o=t.y-t.height/2,u=t.y+t.height/2;for(const c of e.obstacles){const m=li(c.y,e.worldY),_=c.x,p=c.x+c.width,y=m-c.height/2,v=m+c.height/2;if(i<p&&r>_&&o<v&&u>y)return{...e,phase:"gameover",events:[...e.events,"crash"]}}return e}function _I(e){return{...e,gates:e.gates.filter(t=>li(t.y,e.worldY)>Ln.DESPAWN_BEHIND),obstacles:e.obstacles.filter(t=>li(t.y,e.worldY)>Ln.DESPAWN_BEHIND),trees:e.trees.filter(t=>li(t.y,e.worldY)>Ln.DESPAWN_BEHIND),crowds:e.crowds.filter(t=>li(t.y,e.worldY)>Ln.DESPAWN_BEHIND-30)}}const so="slalom_scores_v1",ar={name:"Coach Joe",score:1e3,date:"2025-01-01"};function oo(){return new Date().toISOString().split("T")[0]}function u_(){try{const e=localStorage.getItem(so);if(!e){const r={allTime:ar,daily:{date:oo(),record:ar}};return localStorage.setItem(so,JSON.stringify(r)),r}const t=JSON.parse(e),i=oo();return t.daily.date!==i&&(t.daily={date:i,record:ar},localStorage.setItem(so,JSON.stringify(t))),t}catch{return{allTime:ar,daily:{date:oo(),record:ar}}}}function pI(e,t){const i=u_(),r=oo();let o=!1,u=!1,c=!1;const m={name:e,score:t,date:r};return t>ar.score&&(o=!0),t>i.allTime.score&&(i.allTime=m,c=!0),t>i.daily.record.score&&(i.daily.record=m,u=!0),localStorage.setItem(so,JSON.stringify(i)),k2(m).catch(()=>{}),{beatCoachJoe:o,newDailyRecord:u,newAllTimeRecord:c,dailyRecord:i.daily.record,allTimeRecord:i.allTime}}async function gI(){try{const e=await I2();if(!e||e.length===0)return;const t=u_(),i=oo();let r=!1;const o=e.reduce((c,m)=>m.score>c.score?m:c,{score:0});o.score>t.allTime.score&&(t.allTime=o,r=!0);const u=e.filter(c=>c.date===i).reduce((c,m)=>m.score>c.score?m:c,{score:0});u.score>0&&u.score>t.daily.record.score&&(t.daily.record=u,r=!0),r&&localStorage.setItem(so,JSON.stringify(t))}catch{}}function yI(){const e={allTime:ar,daily:{date:oo(),record:ar}};return localStorage.setItem(so,JSON.stringify(e)),D2().catch(()=>{}),e}function iT(e,t){e.fillStyle=We.SNOW_LIGHT,e.fillRect(0,0,_e.WIDTH,_e.HEIGHT),TI(e,t),EI(e,t),vI(e,t),wI(e,t),bI(e,t),AI(e,t),SI(e,t),RI(e,t),t.phase==="ready"&&II(e),t.phase==="gameover"&&kI(e,t)}function TI(e,t){const o=t.worldY*.5%160;e.fillStyle=We.SNOW_DARK;for(let u=-160+o;u<_e.HEIGHT;u+=160)e.fillRect(0,u+120,_e.WIDTH,40)}function EI(e,t){for(const i of t.trees){const r=li(i.y,t.worldY),{x:o,size:u}=i;e.fillStyle=We.TREE_TRUNK,e.fillRect(o+u/2-3,r,6,u*.4),e.fillStyle=We.TREE_LEAVES,e.beginPath(),e.moveTo(o+u/2,r-u*.6),e.lineTo(o,r+2),e.lineTo(o+u,r+2),e.closePath(),e.fill()}}function vI(e,t){const i=Date.now()/150;for(const r of t.crowds){const o=li(r.y,t.worldY);for(const c of r.people){const m=o+c.offsetY,_=c.x,p=ai.PERSON_WIDTH,y=ai.PERSON_HEIGHT;e.fillStyle="#334",e.fillRect(_,m+y*.6,p*.35,y*.4),e.fillRect(_+p*.65,m+y*.6,p*.35,y*.4),e.fillStyle=c.color,e.fillRect(_,m+y*.2,p,y*.45),e.fillStyle="#ffcc88",e.fillRect(_+p*.15,m,p*.7,y*.25);const v=Math.sin(i+c.armPhase)*.6,w=y*.35,R=m+y*.25,M=_+p/2;e.strokeStyle=c.color,e.lineWidth=2,e.beginPath(),e.moveTo(M-p*.4,R),e.lineTo(M-p*.4-Math.cos(v+.5)*w,R-Math.sin(v+.5)*w),e.stroke(),e.beginPath(),e.moveTo(M+p*.4,R),e.lineTo(M+p*.4+Math.cos(-v+.5)*w,R-Math.sin(-v+.5)*w),e.stroke()}const u=o-20;e.fillStyle="#ffcc00",e.font=hn.SMALL,e.textAlign="center",e.fillText("GO!",38,u),e.fillText("GO!",_e.WIDTH-38,u)}}function wI(e,t){for(const i of t.gates){const r=li(i.y,t.worldY);e.fillStyle=We.GATE_POLE,e.fillRect(i.leftX-wt.POLE_WIDTH/2,r-wt.POLE_HEIGHT,wt.POLE_WIDTH,wt.POLE_HEIGHT),e.fillStyle=i.missed?We.MISS_RED:We.GATE_LEFT,e.fillRect(i.leftX-wt.POLE_WIDTH/2,r-wt.POLE_HEIGHT,wt.FLAG_WIDTH,wt.FLAG_HEIGHT),e.fillStyle=We.GATE_POLE,e.fillRect(i.rightX-wt.POLE_WIDTH/2,r-wt.POLE_HEIGHT,wt.POLE_WIDTH,wt.POLE_HEIGHT),e.fillStyle=i.missed?We.MISS_RED:We.GATE_RIGHT,e.fillRect(i.rightX-wt.FLAG_WIDTH+wt.POLE_WIDTH/2,r-wt.POLE_HEIGHT,wt.FLAG_WIDTH,wt.FLAG_HEIGHT),i.passed&&(e.fillStyle=We.HUD_GREEN,e.font=hn.SMALL,e.textAlign="center",e.fillText("+"+Ln.SCORE_PER_GATE,(i.leftX+i.rightX)/2,r-wt.POLE_HEIGHT-4))}}function bI(e,t){for(const i of t.obstacles){const r=li(i.y,t.worldY);i.type==="rock"?(e.fillStyle=We.OBSTACLE_ROCK,e.fillRect(i.x,r-i.height/2,i.width,i.height),e.fillStyle="#666666",e.fillRect(i.x+2,r-i.height/2+2,i.width-4,4)):i.type==="bear"?(e.fillStyle=We.OBSTACLE_BEAR,e.fillRect(i.x+4,r-i.height/2+4,i.width-8,i.height-4),e.fillRect(i.x+8,r-i.height/2,i.width-16,10),e.fillStyle="#000000",e.fillRect(i.x+10,r-i.height/2+2,3,3),e.fillRect(i.x+i.width-13,r-i.height/2+2,3,3)):i.type==="skier"&&(e.fillStyle=We.OBSTACLE_SKIER,e.fillRect(i.x,r-i.height/2+6,i.width,i.height-6),e.fillStyle="#ffcc88",e.fillRect(i.x+4,r-i.height/2,8,8),e.fillStyle="#333333",e.fillRect(i.x-2,r+i.height/2-3,i.width+4,3))}}function AI(e,t){for(const i of t.rivals){const r=li(i.y,t.worldY),o=i.x,u=Mn.WIDTH,c=Mn.HEIGHT;e.fillStyle=Ai.BODY_COLOR,e.fillRect(o-u/2,r-c/2+6,u,c-10),e.fillStyle="#ffcc88",e.fillRect(o-4,r-c/2,8,8),e.fillStyle=Ai.HELMET_COLOR,e.fillRect(o-5,r-c/2-1,10,5),e.fillStyle=We.SKI_SKIS,e.fillRect(o-u/2-2,r+c/2-4,u+4,3),e.fillStyle=Ai.HELMET_COLOR,e.font=hn.SMALL,e.textAlign="center",e.fillText(Ai.LABEL,o,r-c/2-6)}}function SI(e,t){const{x:i,y:r,width:o,height:u,vx:c}=t.skier;e.fillStyle=We.SKI_BODY,e.fillRect(i-o/2,r-u/2+6,o,u-10),e.fillStyle="#ffcc88",e.fillRect(i-4,r-u/2,8,8),e.fillStyle="#4444ff",e.fillRect(i-5,r-u/2-1,10,5),e.fillStyle=We.SKI_SKIS;const m=Math.min(3,Math.abs(c))*Math.sign(c);e.fillRect(i-o/2-2+m,r+u/2-4,o+4,3)}function RI(e,t){e.fillStyle=We.HUD_BG,e.fillRect(0,0,_e.WIDTH,36),e.font=hn.HUD,e.textBaseline="top",e.fillStyle=We.HUD_GREEN,e.textAlign="left",e.fillText(`SCORE: ${t.score}`,10,8),e.font=hn.SMALL,e.fillStyle=We.TEXT_DIM,e.fillText(`LVL ${t.difficulty}`,10,22),e.font=hn.HUD,e.fillStyle=We.HUD_GREEN,e.textAlign="center",e.fillText(`GATES: ${t.gatesPassed}`,_e.WIDTH/2,8),e.textAlign="right";let i="";for(let r=0;r<t.maxMisses;r++)r<t.gatesMissed?i+="X ":i+="- ";e.fillStyle=t.gatesMissed>0?We.MISS_RED:We.HUD_GREEN,e.fillText(i.trim(),_e.WIDTH-10,8),e.textBaseline="alphabetic"}function II(e){e.fillStyle=We.OVERLAY_BG,e.fillRect(0,0,_e.WIDTH,_e.HEIGHT),e.textAlign="center",e.textBaseline="middle",e.fillStyle=We.HUD_GREEN,e.font=hn.TITLE,e.fillText("MR. CRAWFORD",_e.WIDTH/2,_e.HEIGHT/2-140),e.fillText("SLALOM",_e.WIDTH/2,_e.HEIGHT/2-90),e.fillText("CHALLENGE",_e.WIDTH/2,_e.HEIGHT/2-40),e.fillStyle=We.TEXT_DIM,e.font=hn.SUBTITLE,e.fillText("A SNOWPEAK RESORT PRODUCTION",_e.WIDTH/2,_e.HEIGHT/2+4),e.fillStyle=We.TEXT_WHITE,e.font=hn.OVERLAY,["LEFT/RIGHT arrows to steer","Ski between the gates to score","Miss 5 gates = Game Over","Avoid rocks, bears & skiers!"].forEach((r,o)=>{e.fillText(r,_e.WIDTH/2,_e.HEIGHT/2+50+o*32)}),e.fillStyle=We.HUD_GREEN,e.font=hn.SUBTITLE,Math.floor(Date.now()/500)%2&&e.fillText("PRESS SPACE TO START",_e.WIDTH/2,_e.HEIGHT/2+220),e.textBaseline="alphabetic"}function kI(e,t){e.fillStyle=We.OVERLAY_BG,e.fillRect(0,0,_e.WIDTH,_e.HEIGHT),e.textAlign="center",e.textBaseline="middle",e.fillStyle=We.MISS_RED,e.font=hn.TITLE,e.fillText("GAME OVER",_e.WIDTH/2,_e.HEIGHT/2-140),e.fillStyle=We.HUD_GREEN,e.font=hn.OVERLAY,e.fillText(`FINAL SCORE: ${t.score}`,_e.WIDTH/2,_e.HEIGHT/2-80),e.fillStyle=We.TEXT_WHITE,e.font=hn.SUBTITLE,e.fillText(`Gates Passed: ${t.gatesPassed}`,_e.WIDTH/2,_e.HEIGHT/2-50),e.fillText(`Difficulty Reached: ${t.difficulty}`,_e.WIDTH/2,_e.HEIGHT/2-20);const i=u_();e.fillStyle="#ffcc00",e.font=hn.SUBTITLE,e.fillText("--- HIGH SCORES ---",_e.WIDTH/2,_e.HEIGHT/2+20),e.fillStyle=We.TEXT_WHITE,e.font=hn.SMALL,e.fillText(`TODAY: ${i.daily.record.score} by ${i.daily.record.name}`,_e.WIDTH/2,_e.HEIGHT/2+50),e.fillText(`ALL-TIME: ${i.allTime.score} by ${i.allTime.name}`,_e.WIDTH/2,_e.HEIGHT/2+75),t.score>=Ln.CHAMPION_SCORE&&(e.fillStyle="#ffcc00",e.font=hn.OVERLAY,e.fillText("CHAMPION RUN!",_e.WIDTH/2,_e.HEIGHT/2+110)),e.fillStyle=We.HUD_GREEN,e.font=hn.SUBTITLE,Math.floor(Date.now()/500)%2&&e.fillText("PRESS SPACE TO PLAY AGAIN",_e.WIDTH/2,_e.HEIGHT/2+170),e.textBaseline="alphabetic"}function DI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="square",t.frequency.setValueAtTime(880,e.currentTime),t.frequency.linearRampToValueAtTime(1320,e.currentTime+.08),i.gain.setValueAtTime(.12,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.12),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.15),setTimeout(()=>e.close(),500)}catch{}}function OI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(400,e.currentTime),t.frequency.linearRampToValueAtTime(200,e.currentTime+.15),i.gain.setValueAtTime(.1,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.2),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.25),setTimeout(()=>e.close(),600)}catch{}}function CI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=Math.floor(e.sampleRate*.15),i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let m=0;m<t;m++)r[m]=Math.random()*2-1;const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="lowpass",u.frequency.setValueAtTime(800,e.currentTime),u.frequency.exponentialRampToValueAtTime(200,e.currentTime+.12);const c=e.createGain();c.gain.setValueAtTime(.1,e.currentTime),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+.12),o.connect(u),u.connect(c),c.connect(e.destination),o.start(),setTimeout(()=>e.close(),600)}catch{}}function NI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(300,e.currentTime),t.frequency.exponentialRampToValueAtTime(900,e.currentTime+.3),i.gain.setValueAtTime(.08,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.35),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.4),setTimeout(()=>e.close(),800)}catch{}}function MI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:466,start:0,dur:.3},{freq:440,start:.35,dur:.3},{freq:415,start:.7,dur:.3},{freq:370,start:1.05,dur:.6}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sawtooth",r.frequency.setValueAtTime(i.freq,e.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.97,e.currentTime+i.start+i.dur),o.gain.setValueAtTime(0,e.currentTime+i.start),o.gain.linearRampToValueAtTime(.1,e.currentTime+i.start+.03),o.gain.setValueAtTime(.1,e.currentTime+i.start+i.dur*.7),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.05)}setTimeout(()=>e.close(),2500)}catch{}}function VI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=Math.floor(e.sampleRate*.8),i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let p=0;p<t;p++)r[p]=Math.random()*2-1;const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="bandpass",u.frequency.setValueAtTime(1200,e.currentTime),u.frequency.linearRampToValueAtTime(800,e.currentTime+.6),u.Q.value=.8;const c=e.createGain();c.gain.setValueAtTime(0,e.currentTime),c.gain.linearRampToValueAtTime(.12,e.currentTime+.08),c.gain.setValueAtTime(.12,e.currentTime+.3),c.gain.linearRampToValueAtTime(.06,e.currentTime+.5),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+.8),o.connect(u),u.connect(c),c.connect(e.destination),o.start();const m=e.createOscillator(),_=e.createGain();m.type="sine",m.frequency.setValueAtTime(400,e.currentTime),m.frequency.linearRampToValueAtTime(700,e.currentTime+.2),m.frequency.linearRampToValueAtTime(500,e.currentTime+.5),_.gain.setValueAtTime(0,e.currentTime),_.gain.linearRampToValueAtTime(.04,e.currentTime+.05),_.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),m.connect(_),_.connect(e.destination),m.start(),m.stop(e.currentTime+.55),setTimeout(()=>e.close(),1500)}catch{}}function LI(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(1200,e.currentTime),t.frequency.exponentialRampToValueAtTime(300,e.currentTime+.3),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.08,e.currentTime+.03),i.gain.setValueAtTime(.08,e.currentTime+.1),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.3),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.35),setTimeout(()=>e.close(),800)}catch{}}function HI(e){const i={gate_pass:DI,gate_miss:OI,crash:CI,speed_up:NI,game_over:MI,crowd_cheer:VI,rival_zoom:LI}[e];i&&i()}function c_({standalone:e=!1,onGameOver:t}){const i=ae.useRef(null),r=ae.useRef(Wd()),o=ae.useRef(null),u=ae.useCallback(()=>{const p=r.current,y=J2(p);r.current=y;for(const w of y.events)HI(w);const v=i.current;if(v){const w=v.getContext("2d");iT(w,y)}o.current=requestAnimationFrame(u)},[e,t]);ae.useEffect(()=>{const p=i.current;if(p){const y=p.getContext("2d");iT(y,r.current)}return o.current=requestAnimationFrame(u),()=>{o.current&&cancelAnimationFrame(o.current)}},[u]),ae.useEffect(()=>{const p=v=>{const w=r.current;if(v.key===" "||v.code==="Space"){v.preventDefault(),w.phase==="ready"?r.current={...w,phase:"playing"}:w.phase==="gameover"&&(e?r.current={...Wd(),phase:"ready"}:t&&t({score:w.score,gatesPassed:w.gatesPassed,difficulty:w.difficulty}));return}if(v.key==="Escape"){if(v.preventDefault(),!e&&t){const R=r.current;t({score:R.score,gatesPassed:R.gatesPassed,difficulty:R.difficulty})}return}v.key==="ArrowLeft"&&(v.preventDefault(),r.current={...r.current,input:{...r.current.input,left:!0}}),v.key==="ArrowRight"&&(v.preventDefault(),r.current={...r.current,input:{...r.current.input,right:!0}})},y=v=>{v.key==="ArrowLeft"&&(r.current={...r.current,input:{...r.current.input,left:!1}}),v.key==="ArrowRight"&&(r.current={...r.current,input:{...r.current.input,right:!1}})};return window.addEventListener("keydown",p),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",p),window.removeEventListener("keyup",y)}},[e,t]);const c=ae.useCallback(()=>{const p=r.current;p.phase==="ready"?r.current={...p,phase:"playing"}:p.phase==="gameover"&&(e?r.current={...Wd(),phase:"ready"}:t&&t({score:p.score,gatesPassed:p.gatesPassed,difficulty:p.difficulty}))},[e,t]),m=ae.useCallback(p=>{r.current={...r.current,input:{...r.current.input,left:p}}},[]),_=ae.useCallback(p=>{r.current={...r.current,input:{...r.current.input,right:p}}},[]);return S.jsx("div",{className:"slalom-container",children:S.jsxs("div",{className:"arcade-cabinet",children:[S.jsx("div",{className:"arcade-top"}),S.jsx("div",{className:"arcade-marquee",children:"MR. CRAWFORD SLALOM CHALLENGE"}),S.jsx("div",{className:"arcade-screen-bezel",children:S.jsx("canvas",{ref:i,width:_e.WIDTH,height:_e.HEIGHT,className:"slalom-canvas"})}),S.jsx("div",{className:"arcade-controls",children:S.jsxs("div",{className:"arcade-controls-inner",children:[S.jsx("button",{className:"arcade-touch-btn",onTouchStart:p=>{p.preventDefault(),m(!0)},onTouchEnd:p=>{p.preventDefault(),m(!1)},onMouseDown:()=>m(!0),onMouseUp:()=>m(!1),onMouseLeave:()=>m(!1),children:""}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:p=>{p.preventDefault(),c()},onMouseDown:c,children:"START"}),S.jsx("button",{className:"arcade-touch-btn",onTouchStart:p=>{p.preventDefault(),_(!0)},onTouchEnd:p=>{p.preventDefault(),_(!1)},onMouseDown:()=>_(!0),onMouseUp:()=>_(!1),onMouseLeave:()=>_(!1),children:""})]})}),S.jsx("div",{className:"arcade-base"})]})})}const oe={WIDTH:480,HEIGHT:640},ve={SKY_TOP:"#1a0a2e",SKY_BOTTOM:"#2d1b4e",GROUND:"#2a4a1a",GROUND_DARK:"#1e3a12",SNOW_CAPS:"#ccccdd",MOUNTAIN:"#3a3a5a",MOUNTAIN_DARK:"#2a2a4a",TREE_TRUNK:"#553311",TREE_LEAVES:"#1a5522",CABIN_WALL:"#885533",CABIN_ROOF:"#553322",CABIN_WINDOW:"#ffcc44",RETICLE:"#ff3333",MUZZLE_FLASH:"#ffff88",HUD_GREEN:"#33ff33",HUD_BG:"rgba(0,0,0,0.6)",OVERLAY_BG:"rgba(0,0,0,0.85)",TEXT_WHITE:"#ffffff",TEXT_DIM:"#88ff88",MISS_RED:"#ff4444",WOLF_BODY:"#777788",WOLF_DARK:"#555566",WOLF_EYE:"#ffcc00",BEAR_BODY:"#664422",BEAR_DARK:"#553311",BEAR_EYE:"#ff4444",HIT_FLASH:"#ffffff",HEALTH_GREEN:"#33ff33",HEALTH_YELLOW:"#ffcc00",HEALTH_RED:"#ff3333",BOSS_GLOW:"#ff2200"},mn={HUD:"20px VT323, monospace",TITLE:"48px VT323, monospace",SUBTITLE:"24px VT323, monospace",OVERLAY:"28px VT323, monospace",SMALL:"18px VT323, monospace"},Em={SIZE:20,SPEED:5,LINE_WIDTH:2},Ve={TOTAL_ANIMALS:20,SPAWN_INTERVAL_START:120,SPAWN_INTERVAL_MIN:45,WOLF_SPEED_MIN:.24,WOLF_SPEED_MAX:.64,BEAR_SPEED_MIN:.18,BEAR_SPEED_MAX:.48,SCALE_MIN:.12,SCALE_MAX:2.5,REACH_SCALE:2.2,HIT_RADIUS_MULT:.5,WOLF_WIDTH:40,WOLF_HEIGHT:28,BEAR_WIDTH:36,BEAR_HEIGHT:55,BEAR_CHANCE:.25,RETREAT_SPEED:3,RETREAT_DURATION:60,FLASH_DURATION:4,SHOT_COOLDOWN:12,AMMO_MAX:5,RELOAD_TIME:90,BOSS_HP:20,BOSS_SIZE_MULT:2,BOSS_SPEED_MIN:.144,BOSS_SPEED_MAX:.384,BOSS_SPAWN_DELAY:90},pt={HORIZON_Y:280,GROUND_TOP:280,PLAYER_Y:620,SPAWN_Y_MIN:288,SPAWN_Y_MAX:310,SPAWN_X_MIN:100,SPAWN_X_MAX:380,GUN_X:240};function Bc(){return{phase:"ready",reticle:{x:oe.WIDTH/2,y:oe.HEIGHT/2},animals:[],animalsSpawned:0,animalsDefeated:0,totalAnimals:Ve.TOTAL_ANIMALS,frameCount:0,startTime:0,elapsedMs:0,lastSpawnFrame:0,shotCooldown:0,muzzleFlash:0,lastShotX:0,lastShotY:0,input:{left:!1,right:!1,up:!1,down:!1},events:[],ammo:Ve.AMMO_MAX,reloading:!1,reloadTimer:0,halfwayShown:!1,halfwayTimer:0,bossPhase:!1,bossSpawned:!1,bossDefeated:!1,bossDelayTimer:0}}function PI(e){if(e.phase!=="playing")return e;let t={...e,events:[],frameCount:e.frameCount+1};t.elapsedMs=Date.now()-t.startTime,t=xI(t),t.bossPhase||(t=zI(t)),t.bossPhase&&!t.bossSpawned&&t.animals.filter(r=>r.state!=="gone").length===0&&(t.bossDelayTimer<=0?t=UI(t):t={...t,bossDelayTimer:t.bossDelayTimer-1}),t=BI(t),t.shotCooldown>0&&(t={...t,shotCooldown:t.shotCooldown-1}),t.muzzleFlash>0&&(t={...t,muzzleFlash:t.muzzleFlash-1}),t.reloading&&(t.reloadTimer<=0?t={...t,reloading:!1,ammo:Ve.AMMO_MAX,events:[...t.events,"reload_done"]}:t={...t,reloadTimer:t.reloadTimer-1}),t.halfwayTimer>0&&(t={...t,halfwayTimer:t.halfwayTimer-1});for(const i of t.animals)if(i.state==="approaching"&&i.scale>=Ve.REACH_SCALE)return t={...t,phase:"gameover",events:[...t.events,"game_over"]},t;return!t.halfwayShown&&t.animalsDefeated>=Math.floor(t.totalAnimals/2)&&(t={...t,halfwayShown:!0,halfwayTimer:120,events:[...t.events,"halfway"]}),!t.bossPhase&&t.animalsDefeated>=t.totalAnimals&&(t={...t,bossPhase:!0,bossDelayTimer:Ve.BOSS_SPAWN_DELAY,events:[...t.events,"boss_incoming"]}),t.bossDefeated&&t.animals.filter(r=>r.state!=="gone").length===0&&(t={...t,phase:"victory",events:[...t.events,"victory"]}),t}function Xd(e){if(e.phase!=="playing"||e.shotCooldown>0||e.reloading||e.ammo<=0)return e;const t=e.ammo-1;let i={...e,shotCooldown:Ve.SHOT_COOLDOWN,muzzleFlash:Ve.FLASH_DURATION,lastShotX:e.reticle.x,lastShotY:e.reticle.y,ammo:t,events:[...e.events,"shoot"]};t<=0&&(i={...i,reloading:!0,reloadTimer:Ve.RELOAD_TIME});const r=i.animals.map((o,u)=>({...o,idx:u})).filter(o=>o.state==="approaching").sort((o,u)=>u.scale-o.scale);for(const o of r){const m=(o.type==="wolf"?Ve.WOLF_WIDTH:Ve.BEAR_WIDTH)*o.scale*(o.sizeMult||1)*Ve.HIT_RADIUS_MULT,_=i.reticle.x-o.x,p=i.reticle.y-o.y;if(Math.sqrt(_*_+p*p)<m){const v=[...i.animals],w={...v[o.idx]};if(w.hp-=1,w.hitFlash=8,w.hp<=0){w.state="retreating",w.retreatDir=o.x<oe.WIDTH/2?-1:1,w.retreatTimer=Ve.RETREAT_DURATION;const R=o.type==="boss",M=o.type==="wolf"?"wolf_whimper":R?"boss_defeat":"bear_roar";i={...i,animalsDefeated:i.animalsDefeated+1,bossDefeated:R?!0:i.bossDefeated,events:[...i.events,M]}}else i={...i,events:[...i.events,"hit"]};v[o.idx]=w,i={...i,animals:v};break}}return i}function xI(e){let{x:t,y:i}=e.reticle;const r=Em.SPEED;return e.input.left&&(t-=r),e.input.right&&(t+=r),e.input.up&&(i-=r),e.input.down&&(i+=r),t=Math.max(10,Math.min(oe.WIDTH-10,t)),i=Math.max(pt.HORIZON_Y,Math.min(oe.HEIGHT-30,i)),{...e,reticle:{x:t,y:i}}}function zI(e){if(e.animalsSpawned>=e.totalAnimals)return e;const t=e.animalsSpawned/e.totalAnimals,i=Ve.SPAWN_INTERVAL_START-t*(Ve.SPAWN_INTERVAL_START-Ve.SPAWN_INTERVAL_MIN);if(e.frameCount-e.lastSpawnFrame<i)return e;const o=Math.random()<Ve.BEAR_CHANCE?"bear":"wolf",u=pt.SPAWN_X_MIN+Math.random()*(pt.SPAWN_X_MAX-pt.SPAWN_X_MIN),c=pt.SPAWN_Y_MIN+Math.random()*(pt.SPAWN_Y_MAX-pt.SPAWN_Y_MIN),m=o==="bear"?Ve.BEAR_SPEED_MIN:Ve.WOLF_SPEED_MIN,_=o==="bear"?Ve.BEAR_SPEED_MAX:Ve.WOLF_SPEED_MAX,p=m+Math.random()*(_-m),y=1+t*.5,v={type:o,x:u,y:c,startX:u,startY:c,scale:Ve.SCALE_MIN,sizeMult:1,approachSpeed:p*y,hp:o==="wolf"?1:3,maxHp:o==="wolf"?1:3,state:"approaching",retreatDir:0,retreatTimer:0,hitFlash:0,drift:(Math.random()-.5)*.8,wobble:Math.random()*Math.PI*2};return{...e,animals:[...e.animals,v],animalsSpawned:e.animalsSpawned+1,lastSpawnFrame:e.frameCount,events:[...e.events,o==="bear"?"bear_spawn":"wolf_spawn"]}}function UI(e){const t=oe.WIDTH/2,i=pt.SPAWN_Y_MIN+5,r=Ve.BOSS_SPEED_MIN+Math.random()*(Ve.BOSS_SPEED_MAX-Ve.BOSS_SPEED_MIN),o={type:"boss",x:t,y:i,startX:t,startY:i,scale:Ve.SCALE_MIN,sizeMult:Ve.BOSS_SIZE_MULT,approachSpeed:r,hp:Ve.BOSS_HP,maxHp:Ve.BOSS_HP,state:"approaching",retreatDir:0,retreatTimer:0,hitFlash:0,drift:0,wobble:0};return{...e,animals:[...e.animals,o],bossSpawned:!0,events:[...e.events,"boss_roar"]}}function BI(e){const i=e.animals.map(r=>{if(r.hitFlash>0&&(r={...r,hitFlash:r.hitFlash-1}),r.state==="approaching"){const o=r.scale+r.approachSpeed*.008,u=(o-Ve.SCALE_MIN)/(Ve.SCALE_MAX-Ve.SCALE_MIN),c=r.startY+u*(pt.PLAYER_Y-r.startY),m=Math.sin(r.wobble+e.frameCount*.03)*15*r.scale,_=r.startX+r.drift*u*80+m;return{...r,scale:o,y:c,x:_}}if(r.state==="retreating"){const o=r.retreatTimer-1;if(o<=0)return{...r,state:"gone"};const u=r.x+r.retreatDir*Ve.RETREAT_SPEED,c=r.scale*.995;return{...r,x:u,retreatTimer:o,scale:c}}return r}).filter(r=>r.state!=="gone");return{...e,animals:i}}function aT(e,t){GI(e),jI(e),qI(e),YI(e),FI(e,t),t.muzzleFlash>0&&QI(e,t),t.phase==="playing"&&KI(e,t),t.phase==="playing"&&$I(e,t),t.phase==="playing"&&ZI(e,t),t.phase==="playing"&&JI(e,t),t.phase==="playing"&&t.halfwayTimer>0&&ek(e,t),t.phase==="ready"&&tk(e),t.phase==="gameover"&&nk(e,t),t.phase==="victory"&&ik(e,t)}function GI(e){const t=e.createLinearGradient(0,0,0,pt.HORIZON_Y);t.addColorStop(0,ve.SKY_TOP),t.addColorStop(1,ve.SKY_BOTTOM),e.fillStyle=t,e.fillRect(0,0,oe.WIDTH,pt.HORIZON_Y),e.fillStyle="#ffffff";const i=[[45,30],[120,55],[200,20],[280,65],[350,35],[410,50],[70,90],[160,110],[300,100],[440,80],[30,140],[240,130],[380,150],[90,170],[460,160],[55,210],[180,230],[320,215],[420,240],[140,255],[260,200],[400,190],[75,260],[350,265],[460,225]];for(const[r,o]of i)if(o<pt.HORIZON_Y-20){const u=Math.sin(Date.now()*.003+r)>.3?2:1;e.fillRect(r,o,u,u)}}function jI(e){const t=pt.HORIZON_Y;e.fillStyle=ve.MOUNTAIN_DARK,e.beginPath(),e.moveTo(0,t),e.lineTo(60,t-130),e.lineTo(140,t-90),e.lineTo(200,t-155),e.lineTo(280,t-100),e.lineTo(360,t-165),e.lineTo(420,t-110),e.lineTo(oe.WIDTH,t-120),e.lineTo(oe.WIDTH,t),e.closePath(),e.fill(),e.fillStyle=ve.SNOW_CAPS,rT(e,200,t-155,30),rT(e,360,t-165,25),e.fillStyle=ve.MOUNTAIN,e.beginPath(),e.moveTo(0,t),e.lineTo(30,t-85),e.lineTo(100,t-65),e.lineTo(170,t-95),e.lineTo(240,t-60),e.lineTo(310,t-80),e.lineTo(400,t-70),e.lineTo(oe.WIDTH,t-75),e.lineTo(oe.WIDTH,t),e.closePath(),e.fill()}function rT(e,t,i,r){e.beginPath(),e.moveTo(t,i),e.lineTo(t-r*.6,i+r*.4),e.lineTo(t+r*.6,i+r*.4),e.closePath(),e.fill()}function qI(e,t){e.fillStyle=ve.GROUND,e.fillRect(0,pt.GROUND_TOP,oe.WIDTH,oe.HEIGHT-pt.GROUND_TOP),e.fillStyle=ve.GROUND_DARK;for(let i=pt.GROUND_TOP+15;i<oe.HEIGHT;i+=30){const o=2+(i-pt.GROUND_TOP)/(oe.HEIGHT-pt.GROUND_TOP)*6;e.fillRect(0,i,oe.WIDTH,o)}e.fillStyle="#3a3a2a",e.beginPath(),e.moveTo(oe.WIDTH/2-4,pt.HORIZON_Y),e.lineTo(oe.WIDTH/2-120,oe.HEIGHT),e.lineTo(oe.WIDTH/2+120,oe.HEIGHT),e.lineTo(oe.WIDTH/2+4,pt.HORIZON_Y),e.closePath(),e.fill()}function YI(e){const t=pt.HORIZON_Y+30;sT(e,60,t+10,.5),sT(e,370,t+15,.45),Ks(e,30,t+5,.55),Ks(e,440,t+10,.6),Ks(e,130,t+25,.45),Ks(e,340,t+20,.5),Ks(e,15,t+80,.9),Ks(e,455,t+70,.85),e.fillStyle="#886644";const i=t+50;for(let r=60;r<oe.WIDTH-60;r+=45)e.fillRect(r,i,3,14);e.fillStyle="#775533",e.fillRect(60,i+3,oe.WIDTH-120,2),e.fillRect(60,i+9,oe.WIDTH-120,2)}function sT(e,t,i,r){const o=60*r,u=35*r,c=20*r;e.fillStyle=ve.CABIN_WALL,e.fillRect(t,i,o,u),e.fillStyle=ve.CABIN_ROOF,e.beginPath(),e.moveTo(t-5*r,i),e.lineTo(t+o/2,i-c),e.lineTo(t+o+5*r,i),e.closePath(),e.fill(),e.fillStyle=ve.CABIN_WINDOW,e.fillRect(t+o*.3,i+u*.25,o*.15,u*.3),e.fillRect(t+o*.55,i+u*.25,o*.15,u*.3),e.fillStyle="#442211",e.fillRect(t+o*.4,i+u*.5,o*.2,u*.5)}function Ks(e,t,i,r){const o=6*r,u=20*r,c=24*r,m=30*r;e.fillStyle=ve.TREE_TRUNK,e.fillRect(t-o/2,i,o,u),e.fillStyle=ve.TREE_LEAVES;for(let _=0;_<3;_++){const p=c*(1-_*.25),y=i-m*.3*_;e.beginPath(),e.moveTo(t,y-m*.4),e.lineTo(t-p/2,y+m*.2),e.lineTo(t+p/2,y+m*.2),e.closePath(),e.fill()}}function FI(e,t){const i=[...t.animals].sort((r,o)=>r.scale-o.scale);for(const r of i)r.type==="wolf"?WI(e,r):XI(e,r);t.bossPhase&&!t.bossSpawned&&Math.floor(Date.now()/300)%2&&(e.save(),e.fillStyle=ve.BOSS_GLOW,e.font=mn.SUBTITLE,e.textAlign="center",e.textBaseline="middle",e.fillText("!! BOSS APPROACHING !!",oe.WIDTH/2,oe.HEIGHT/2),e.restore())}function WI(e,t){const{x:i,y:r,scale:o,hitFlash:u,state:c}=t,m=Ve.WOLF_WIDTH*o,_=Ve.WOLF_HEIGHT*o;e.save(),u>0&&u%2===0&&(e.globalAlpha=.5);const p=u>0,y=p?ve.HIT_FLASH:ve.WOLF_BODY,v=p?ve.HIT_FLASH:ve.WOLF_DARK,w=c==="retreating"?t.retreatDir*.35:0;e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(i,r+_*.45,m*.4,_*.1,0,0,Math.PI*2),e.fill();const R=Math.sin(Date.now()*.008+t.wobble)*m*.06;e.fillStyle=v,e.beginPath(),e.moveTo(i-m*.35,r-_*.15),e.quadraticCurveTo(i-m*.6+R,r-_*.7,i-m*.45+R,r-_*.55),e.lineTo(i-m*.35,r-_*.1),e.closePath(),e.fill(),e.fillStyle=y,e.beginPath(),e.moveTo(i-m*.35,r-_*.1),e.lineTo(i-m*.3,r-_*.35),e.lineTo(i+m*.15,r-_*.4),e.lineTo(i+m*.3,r-_*.2),e.lineTo(i+m*.25,r+_*.15),e.lineTo(i-m*.3,r+_*.15),e.closePath(),e.fill(),e.fillStyle=v,e.beginPath(),e.moveTo(i-m*.3,r-_*.35),e.lineTo(i+m*.1,r-_*.4),e.lineTo(i+m*.1,r-_*.3),e.lineTo(i-m*.3,r-_*.25),e.closePath(),e.fill(),e.fillStyle=v;const M=Math.sin(Date.now()*.012+t.wobble)*m*.1;e.fillRect(i+m*.12+M,r+_*.05,m*.06,_*.42),e.fillRect(i+m*.22-M,r+_*.05,m*.06,_*.42),e.fillRect(i-m*.25-M,r+_*.05,m*.07,_*.42),e.fillRect(i-m*.12+M,r+_*.05,m*.07,_*.42),e.fillRect(i+m*.1+M,r+_*.42,m*.1,_*.06),e.fillRect(i+m*.2-M,r+_*.42,m*.1,_*.06),e.fillRect(i-m*.27-M,r+_*.42,m*.1,_*.06),e.fillRect(i-m*.14+M,r+_*.42,m*.1,_*.06);const V=i+m*(.3+w*.5),L=r-_*.25;e.fillStyle=y,e.beginPath(),e.moveTo(i+m*.15,r-_*.4),e.lineTo(V+m*.05,L-_*.3),e.lineTo(V+m*.12,L-_*.15),e.lineTo(i+m*.3,r-_*.2),e.closePath(),e.fill();const O=V+m*.05+w*m*.1,G=L-_*.35;if(e.fillStyle=v,e.beginPath(),e.moveTo(O-m*.12,G),e.lineTo(O+m*.12,G),e.lineTo(O+m*.1,G+_*.25),e.lineTo(O-m*.1,G+_*.25),e.closePath(),e.fill(),e.fillStyle=y,e.beginPath(),e.moveTo(O+m*.12,G+_*.08),e.lineTo(O+m*.3,G+_*.18),e.lineTo(O+m*.12,G+_*.22),e.closePath(),e.fill(),e.fillStyle="#111111",e.beginPath(),e.arc(O+m*.28,G+_*.18,Math.max(1.5,m*.03),0,Math.PI*2),e.fill(),e.fillStyle=v,e.beginPath(),e.moveTo(O-m*.08,G),e.lineTo(O-m*.14,G-_*.25),e.lineTo(O-m*.01,G+_*.02),e.closePath(),e.fill(),e.beginPath(),e.moveTo(O+m*.05,G),e.lineTo(O+m*.1,G-_*.25),e.lineTo(O+m*.14,G+_*.02),e.closePath(),e.fill(),e.fillStyle="#998877",e.beginPath(),e.moveTo(O-m*.07,G+_*.01),e.lineTo(O-m*.12,G-_*.18),e.lineTo(O-m*.02,G+_*.02),e.closePath(),e.fill(),e.beginPath(),e.moveTo(O+m*.06,G+_*.01),e.lineTo(O+m*.09,G-_*.18),e.lineTo(O+m*.13,G+_*.02),e.closePath(),e.fill(),o>.25){e.fillStyle=ve.WOLF_EYE;const J=Math.max(2,m*.06);e.fillRect(O+m*.02,G+_*.06,J,J),e.fillStyle="#111111",e.fillRect(O+m*.03,G+_*.07,Math.max(1,J*.5),Math.max(1,J*.5))}if(o>.6){e.fillStyle="#331111",e.beginPath(),e.moveTo(O+m*.12,G+_*.22),e.lineTo(O+m*.28,G+_*.24),e.lineTo(O+m*.12,G+_*.3),e.closePath(),e.fill(),e.fillStyle="#eeeeee";for(let J=0;J<3;J++)e.fillRect(O+m*.14+J*m*.04,G+_*.22,m*.015,_*.04)}e.restore()}function XI(e,t){const{x:i,y:r,scale:o,hitFlash:u,state:c,hp:m,maxHp:_}=t,p=t.sizeMult||1,y=t.type==="boss",v=Ve.BEAR_WIDTH*o*p,w=Ve.BEAR_HEIGHT*o*p;e.save(),u>0&&u%2===0&&(e.globalAlpha=.5);const R=u>0,M=R?ve.HIT_FLASH:ve.BEAR_BODY,V=R?ve.HIT_FLASH:ve.BEAR_DARK;if(y&&c==="approaching"){e.save();const re=.15+Math.sin(Date.now()*.005)*.1;e.globalAlpha=re,e.fillStyle=ve.BOSS_GLOW,e.beginPath(),e.ellipse(i,r-w*.1,v*.6,w*.5,0,0,Math.PI*2),e.fill(),e.restore()}e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(i,r+w*.45,v*.35,w*.08,0,0,Math.PI*2),e.fill();const L=Math.sin(Date.now()*.008+t.wobble)*v*.06;e.fillStyle=V,e.fillRect(i-v*.22+L,r+w*.15,v*.18,w*.3),e.fillRect(i+v*.04-L,r+w*.15,v*.18,w*.3),e.fillStyle=V,e.fillRect(i-v*.25+L,r+w*.42,v*.22,w*.06),e.fillRect(i+v*.02-L,r+w*.42,v*.22,w*.06),e.fillStyle=M,e.beginPath(),e.ellipse(i,r-w*.05,v*.35,w*.28,0,0,Math.PI*2),e.fill(),e.fillStyle=R?ve.HIT_FLASH:"#886644",e.beginPath(),e.ellipse(i,r+w*.02,v*.2,w*.15,0,0,Math.PI*2),e.fill();const O=Math.sin(Date.now()*.006+t.wobble)*.15;e.fillStyle=M,e.save(),e.translate(i-v*.3,r-w*.2),e.rotate(-.8+O),e.fillRect(0,0,v*.12,w*.3),e.fillStyle=V,e.fillRect(-v*.03,-w*.05,v*.18,w*.08),e.fillStyle="#ccccaa";for(let re=0;re<3;re++)e.fillRect(v*.01+re*v*.05,-w*.1,v*.02,w*.06);e.restore(),e.fillStyle=M,e.save(),e.translate(i+v*.3,r-w*.2),e.rotate(.8-O),e.fillRect(-v*.12,0,v*.12,w*.3),e.fillStyle=V,e.fillRect(-v*.15,-w*.05,v*.18,w*.08),e.fillStyle="#ccccaa";for(let re=0;re<3;re++)e.fillRect(-v*.1+re*v*.05,-w*.1,v*.02,w*.06);e.restore();const G=c==="retreating"?t.retreatDir*v*.1:0;if(e.fillStyle=V,e.beginPath(),e.ellipse(i+G,r-w*.35,v*.22,w*.13,0,0,Math.PI*2),e.fill(),e.fillStyle=M,e.beginPath(),e.arc(i-v*.16+G,r-w*.45,v*.08,0,Math.PI*2),e.arc(i+v*.16+G,r-w*.45,v*.08,0,Math.PI*2),e.fill(),e.fillStyle="#996655",e.beginPath(),e.arc(i-v*.16+G,r-w*.45,v*.04,0,Math.PI*2),e.arc(i+v*.16+G,r-w*.45,v*.04,0,Math.PI*2),e.fill(),e.fillStyle="#886644",e.beginPath(),e.ellipse(i+G,r-w*.31,v*.1,w*.05,0,0,Math.PI*2),e.fill(),e.fillStyle="#222222",e.fillRect(i-v*.03+G,r-w*.33,v*.06,w*.03),o>.25){e.fillStyle=ve.BEAR_EYE;const re=Math.max(2,v*.06);e.fillRect(i-v*.12+G,r-w*.38,re,re),e.fillRect(i+v*.06+G,r-w*.38,re,re)}if(o>.6){e.fillStyle="#441111",e.fillRect(i-v*.06+G,r-w*.28,v*.12,w*.04),e.fillStyle="#eeeeee";for(let re=0;re<3;re++)e.fillRect(i-v*.04+re*v*.04+G,r-w*.28,v*.02,w*.02)}if(e.restore(),y?c==="approaching"&&o>.2:c==="approaching"&&m<_&&o>.25){const re=v*.6,Ce=Math.max(3,5*o*p),we=i-re/2,k=r-w*.55;y&&o>.3&&(e.fillStyle=ve.BOSS_GLOW,e.font=mn.SMALL,e.textAlign="center",e.textBaseline="bottom",e.fillText("BOSS",i,k-2)),e.fillStyle="#333333",e.fillRect(we,k,re,Ce);const I=m/_;e.fillStyle=I>.5?ve.HEALTH_GREEN:I>.25?ve.HEALTH_YELLOW:ve.HEALTH_RED,e.fillRect(we,k,re*I,Ce)}}function KI(e,t){const i=pt.GUN_X,r=oe.HEIGHT,o=(t.reticle.x-oe.WIDTH/2)*.15,u=(t.reticle.y-oe.HEIGHT/2)*.05;if(e.save(),e.translate(o,u),e.fillStyle="#333344",e.beginPath(),e.moveTo(i-8,r),e.lineTo(i-6,r-80),e.lineTo(i+6,r-80),e.lineTo(i+8,r),e.closePath(),e.fill(),e.fillStyle="#444466",e.fillRect(i-2,r-80,4,80),e.fillStyle="#222233",e.beginPath(),e.ellipse(i,r-80,7,4,0,0,Math.PI*2),e.fill(),e.fillStyle="#664422",e.beginPath(),e.moveTo(i-8,r),e.lineTo(i-20,r),e.lineTo(i-14,r-30),e.lineTo(i-8,r-20),e.closePath(),e.fill(),e.fillStyle="#664422",e.beginPath(),e.moveTo(i+8,r),e.lineTo(i+20,r),e.lineTo(i+14,r-30),e.lineTo(i+8,r-20),e.closePath(),e.fill(),e.fillStyle="#cc9966",e.beginPath(),e.ellipse(i-12,r-35,8,6,-.3,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(i+10,r-20,7,6,.3,0,Math.PI*2),e.fill(),t.muzzleFlash>0){const c=t.muzzleFlash/Ve.FLASH_DURATION;e.globalAlpha=c*.6,e.fillStyle=ve.MUZZLE_FLASH,e.beginPath(),e.arc(i,r-85,12+(Ve.FLASH_DURATION-t.muzzleFlash)*4,0,Math.PI*2),e.fill(),e.globalAlpha=1}e.restore()}function QI(e,t){e.save(),e.globalAlpha=t.muzzleFlash/Ve.FLASH_DURATION,e.fillStyle=ve.MUZZLE_FLASH,e.beginPath(),e.arc(t.lastShotX,t.lastShotY,8+(Ve.FLASH_DURATION-t.muzzleFlash)*3,0,Math.PI*2),e.fill(),e.restore()}function $I(e,t){const{x:i,y:r}=t.reticle,o=Em.SIZE;e.strokeStyle=ve.RETICLE,e.lineWidth=Em.LINE_WIDTH,e.beginPath(),e.arc(i,r,o,0,Math.PI*2),e.stroke(),e.beginPath(),e.moveTo(i-o-6,r),e.lineTo(i-o*.4,r),e.moveTo(i+o*.4,r),e.lineTo(i+o+6,r),e.moveTo(i,r-o-6),e.lineTo(i,r-o*.4),e.moveTo(i,r+o*.4),e.lineTo(i,r+o+6),e.stroke(),e.fillStyle=ve.RETICLE,e.fillRect(i-1,r-1,3,3)}function ZI(e,t){if(e.fillStyle=ve.HUD_BG,e.fillRect(0,0,oe.WIDTH,36),e.font=mn.HUD,e.textBaseline="top",e.fillStyle=t.bossPhase?ve.BOSS_GLOW:ve.HUD_GREEN,e.textAlign="left",t.bossPhase){const i=t.animals.find(r=>r.type==="boss");i&&i.state==="approaching"?e.fillText(`BOSS HP: ${i.hp}/${i.maxHp}`,10,8):t.bossSpawned?e.fillText("BOSS DEFEATED!",10,8):e.fillText("BOSS INCOMING...",10,8)}else{const i=t.totalAnimals-t.animalsDefeated;e.fillText(`HOSTILES: ${i}`,10,8)}e.textAlign="center",e.fillText(h_(t.elapsedMs),oe.WIDTH/2,8),e.textAlign="right",e.fillText(`DEFEATED: ${t.animalsDefeated}/${t.totalAnimals}`,oe.WIDTH-10,8),e.textBaseline="alphabetic"}function JI(e,t){const u=oe.WIDTH-20-Ve.AMMO_MAX*13,c=oe.HEIGHT-45;for(let m=0;m<Ve.AMMO_MAX;m++){const _=u+m*13;m<t.ammo?(e.fillStyle="#cc9933",e.fillRect(_,c+6,8,16),e.fillStyle="#aa7722",e.beginPath(),e.moveTo(_,c+6),e.lineTo(_+8/2,c),e.lineTo(_+8,c+6),e.closePath(),e.fill(),e.fillStyle="#886622",e.fillRect(_+1,c+22-3,6,3)):(e.strokeStyle="#555555",e.lineWidth=1,e.strokeRect(_,c,8,22))}t.reloading&&Math.floor(Date.now()/200)%2&&(e.fillStyle=ve.MISS_RED,e.font=mn.SUBTITLE,e.textAlign="right",e.textBaseline="bottom",e.fillText("RELOAD",oe.WIDTH-15,c-5))}function ek(e,t){const i=Math.min(1,t.halfwayTimer/30);e.save(),e.globalAlpha=i,e.fillStyle="rgba(0, 80, 0, 0.7)",e.fillRect(0,oe.HEIGHT/2-25,oe.WIDTH,50),e.fillStyle=ve.HUD_GREEN,e.font=mn.TITLE,e.textAlign="center",e.textBaseline="middle",e.fillText("HALF WAY DONE!",oe.WIDTH/2,oe.HEIGHT/2),e.restore()}function h_(e){const t=Math.floor(e/1e3),i=Math.floor(t/60),r=t%60;return`${String(i).padStart(2,"0")}:${String(r).padStart(2,"0")}`}function tk(e){e.fillStyle=ve.OVERLAY_BG,e.fillRect(0,0,oe.WIDTH,oe.HEIGHT),e.textAlign="center",e.textBaseline="middle",e.fillStyle=ve.HUD_GREEN,e.font=mn.TITLE,e.fillText("DEFEND",oe.WIDTH/2,oe.HEIGHT/2-150),e.fillText("THE VILLAGE",oe.WIDTH/2,oe.HEIGHT/2-100),e.fillStyle=ve.TEXT_DIM,e.font=mn.SUBTITLE,e.fillText("A SNOWPEAK RESORT PRODUCTION",oe.WIDTH/2,oe.HEIGHT/2-55),e.fillStyle=ve.TEXT_WHITE,e.font=mn.OVERLAY,["Tap or click to aim & shoot!","Or: Arrow keys + SPACE","5 shots per clip  auto-reloads!","Wolves: 1 hit  |  Bears: 3 hits","Don't let them reach the village!"].forEach((r,o)=>{e.fillText(r,oe.WIDTH/2,oe.HEIGHT/2+o*34)}),e.fillStyle=ve.HUD_GREEN,e.font=mn.SUBTITLE,Math.floor(Date.now()/500)%2&&e.fillText("TAP or PRESS SPACE TO START",oe.WIDTH/2,oe.HEIGHT/2+220),e.textBaseline="alphabetic"}function nk(e,t){e.fillStyle=ve.OVERLAY_BG,e.fillRect(0,0,oe.WIDTH,oe.HEIGHT),e.textAlign="center",e.textBaseline="middle",e.fillStyle=ve.MISS_RED,e.font=mn.TITLE,e.fillText("GAME OVER",oe.WIDTH/2,oe.HEIGHT/2-100),e.fillStyle=ve.TEXT_WHITE,e.font=mn.OVERLAY,e.fillText("A wild animal reached the village!",oe.WIDTH/2,oe.HEIGHT/2-40),e.fillStyle=ve.HUD_GREEN,e.font=mn.SUBTITLE,e.fillText(`Animals Defeated: ${t.animalsDefeated}/${t.totalAnimals}`,oe.WIDTH/2,oe.HEIGHT/2+10),e.fillText(`Time: ${h_(t.elapsedMs)}`,oe.WIDTH/2,oe.HEIGHT/2+40),e.fillStyle=ve.HUD_GREEN,e.font=mn.SUBTITLE,Math.floor(Date.now()/500)%2&&e.fillText("TAP or PRESS SPACE TO CONTINUE",oe.WIDTH/2,oe.HEIGHT/2+120),e.textBaseline="alphabetic"}function ik(e,t){e.fillStyle=ve.OVERLAY_BG,e.fillRect(0,0,oe.WIDTH,oe.HEIGHT),e.textAlign="center",e.textBaseline="middle",e.fillStyle="#ffcc00",e.font=mn.TITLE,e.fillText("VICTORY!",oe.WIDTH/2,oe.HEIGHT/2-100),e.fillStyle=ve.TEXT_WHITE,e.font=mn.OVERLAY,e.fillText("The village is safe!",oe.WIDTH/2,oe.HEIGHT/2-40),e.fillStyle=ve.HUD_GREEN,e.font=mn.SUBTITLE,e.fillText(`${t.totalAnimals} animals + BOSS defeated!`,oe.WIDTH/2,oe.HEIGHT/2+10),e.fillText(`Time: ${h_(t.elapsedMs)}`,oe.WIDTH/2,oe.HEIGHT/2+40),e.fillStyle=ve.HUD_GREEN,e.font=mn.SUBTITLE,Math.floor(Date.now()/500)%2&&e.fillText("TAP or PRESS SPACE TO CONTINUE",oe.WIDTH/2,oe.HEIGHT/2+120),e.textBaseline="alphabetic"}function ak(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="square",t.frequency.setValueAtTime(800,e.currentTime),t.frequency.exponentialRampToValueAtTime(200,e.currentTime+.05),i.gain.setValueAtTime(.15,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.08),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.1);const r=Math.floor(e.sampleRate*.03),o=e.createBuffer(1,r,e.sampleRate),u=o.getChannelData(0);for(let _=0;_<r;_++)u[_]=(Math.random()*2-1)*(1-_/r);const c=e.createBufferSource();c.buffer=o;const m=e.createGain();m.gain.setValueAtTime(.08,e.currentTime),c.connect(m),m.connect(e.destination),c.start(),setTimeout(()=>e.close(),400)}catch{}}function rk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(600,e.currentTime),t.frequency.linearRampToValueAtTime(400,e.currentTime+.1),i.gain.setValueAtTime(.1,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.12),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.15),setTimeout(()=>e.close(),400)}catch{}}function sk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:800,start:0,dur:.12},{freq:600,start:.12,dur:.1},{freq:400,start:.22,dur:.15}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sine",r.frequency.setValueAtTime(i.freq,e.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.7,e.currentTime+i.start+i.dur),o.gain.setValueAtTime(.1,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),800)}catch{}}function ok(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(120,e.currentTime),t.frequency.linearRampToValueAtTime(80,e.currentTime+.4),i.gain.setValueAtTime(.12,e.currentTime),i.gain.linearRampToValueAtTime(.15,e.currentTime+.15),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.55);const r=Math.floor(e.sampleRate*.4),o=e.createBuffer(1,r,e.sampleRate),u=o.getChannelData(0);for(let p=0;p<r;p++)u[p]=Math.random()*2-1;const c=e.createBufferSource();c.buffer=o;const m=e.createBiquadFilter();m.type="lowpass",m.frequency.value=300;const _=e.createGain();_.gain.setValueAtTime(.06,e.currentTime),_.gain.exponentialRampToValueAtTime(.01,e.currentTime+.4),c.connect(m),m.connect(_),_.connect(e.destination),c.start(),setTimeout(()=>e.close(),1e3)}catch{}}function lk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(80,e.currentTime),t.frequency.linearRampToValueAtTime(50,e.currentTime+.8),i.gain.setValueAtTime(.18,e.currentTime),i.gain.linearRampToValueAtTime(.22,e.currentTime+.3),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+1),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+1.1);const r=e.createOscillator(),o=e.createGain();r.type="triangle",r.frequency.setValueAtTime(55,e.currentTime),r.frequency.linearRampToValueAtTime(35,e.currentTime+.9),o.gain.setValueAtTime(.1,e.currentTime),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+.9),r.connect(o),o.connect(e.destination),r.start(),r.stop(e.currentTime+1);const u=Math.floor(e.sampleRate*.8),c=e.createBuffer(1,u,e.sampleRate),m=c.getChannelData(0);for(let v=0;v<u;v++)m[v]=Math.random()*2-1;const _=e.createBufferSource();_.buffer=c;const p=e.createBiquadFilter();p.type="lowpass",p.frequency.value=200;const y=e.createGain();y.gain.setValueAtTime(.08,e.currentTime),y.gain.exponentialRampToValueAtTime(.01,e.currentTime+.7),_.connect(p),p.connect(y),y.connect(e.destination),_.start(),setTimeout(()=>e.close(),1500)}catch{}}function uk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:110,start:0,dur:.2},{freq:110,start:.3,dur:.2},{freq:110,start:.6,dur:.2},{freq:80,start:.9,dur:.5}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.12,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.05)}setTimeout(()=>e.close(),2e3)}catch{}}function ck(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(90,e.currentTime),t.frequency.linearRampToValueAtTime(120,e.currentTime+.3),t.frequency.exponentialRampToValueAtTime(20,e.currentTime+1.8),i.gain.setValueAtTime(.25,e.currentTime),i.gain.linearRampToValueAtTime(.3,e.currentTime+.2),i.gain.linearRampToValueAtTime(.2,e.currentTime+.8),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+2),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+2.1);const r=e.createOscillator(),o=e.createGain();r.type="triangle",r.frequency.setValueAtTime(45,e.currentTime),r.frequency.linearRampToValueAtTime(60,e.currentTime+.3),r.frequency.exponentialRampToValueAtTime(20,e.currentTime+1.5),o.gain.setValueAtTime(.15,e.currentTime),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+1.6),r.connect(o),o.connect(e.destination),r.start(),r.stop(e.currentTime+1.7);const u=e.createOscillator(),c=e.createGain();u.type="square",u.frequency.setValueAtTime(150,e.currentTime),u.frequency.exponentialRampToValueAtTime(40,e.currentTime+1.2),c.gain.setValueAtTime(.08,e.currentTime),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+1),u.connect(c),c.connect(e.destination),u.start(),u.stop(e.currentTime+1.1);const m=Math.floor(e.sampleRate*1.5),_=e.createBuffer(1,m,e.sampleRate),p=_.getChannelData(0);for(let R=0;R<m;R++)p[R]=Math.random()*2-1;const y=e.createBufferSource();y.buffer=_;const v=e.createBiquadFilter();v.type="lowpass",v.frequency.value=180;const w=e.createGain();w.gain.setValueAtTime(.12,e.currentTime),w.gain.exponentialRampToValueAtTime(.01,e.currentTime+1.3),y.connect(v),v.connect(w),w.connect(e.destination),y.start(),setTimeout(()=>e.close(),2500)}catch{}}function hk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:660,start:0,dur:.12},{freq:880,start:.15,dur:.2}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.1,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),600)}catch{}}function fk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="square",t.frequency.setValueAtTime(300,e.currentTime),t.frequency.exponentialRampToValueAtTime(150,e.currentTime+.04),i.gain.setValueAtTime(.12,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.06),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.08);const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.setValueAtTime(400,e.currentTime+.08),r.frequency.exponentialRampToValueAtTime(200,e.currentTime+.12),o.gain.setValueAtTime(.12,e.currentTime+.08),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+.14),r.connect(o),o.connect(e.destination),r.start(e.currentTime+.08),r.stop(e.currentTime+.16),setTimeout(()=>e.close(),400)}catch{}}function dk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:466,start:0,dur:.3},{freq:440,start:.35,dur:.3},{freq:415,start:.7,dur:.3},{freq:370,start:1.05,dur:.6}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sawtooth",r.frequency.setValueAtTime(i.freq,e.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.97,e.currentTime+i.start+i.dur),o.gain.setValueAtTime(0,e.currentTime+i.start),o.gain.linearRampToValueAtTime(.1,e.currentTime+i.start+.03),o.gain.setValueAtTime(.1,e.currentTime+i.start+i.dur*.7),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.05)}setTimeout(()=>e.close(),2500)}catch{}}function mk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:523,start:0,dur:.15},{freq:659,start:.18,dur:.15},{freq:784,start:.36,dur:.15},{freq:1047,start:.54,dur:.4}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(0,e.currentTime+i.start),o.gain.linearRampToValueAtTime(.12,e.currentTime+i.start+.02),o.gain.setValueAtTime(.12,e.currentTime+i.start+i.dur*.7),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.05)}setTimeout(()=>e.close(),1500)}catch{}}function Kd(e){const i={shoot:ak,hit:rk,wolf_whimper:sk,bear_roar:ok,boss_roar:lk,boss_incoming:uk,boss_defeat:ck,halfway:hk,reload_done:fk,game_over:dk,victory:mk}[e];i&&i()}function f_({standalone:e=!1,onGameOver:t}){const i=ae.useRef(null),r=ae.useRef(Bc()),o=ae.useRef(null),u=ae.useCallback((w,R)=>{const M=i.current;if(!M)return null;const V=M.getBoundingClientRect(),L=oe.WIDTH/V.width,O=oe.HEIGHT/V.height;return{x:(w-V.left)*L,y:(R-V.top)*O}},[]);ae.useCallback(w=>{for(const R of w.events)Kd(R);w.events.length>0&&(r.current={...r.current,events:[]})},[]);const c=ae.useCallback(()=>{const w=r.current;if(w.events.length>0)for(const V of w.events)Kd(V);const R=PI({...w,events:[]});r.current=R;for(const V of R.events)Kd(V);const M=i.current;if(M){const V=M.getContext("2d");aT(V,R)}o.current=requestAnimationFrame(c)},[e,t]);ae.useEffect(()=>{const w=i.current;if(w){const R=w.getContext("2d");aT(R,r.current)}return o.current=requestAnimationFrame(c),()=>{o.current&&cancelAnimationFrame(o.current)}},[c]),ae.useEffect(()=>{const w=M=>{const V=r.current;if(M.key===" "||M.code==="Space"){if(M.preventDefault(),V.phase==="ready"){r.current={...V,phase:"playing",startTime:Date.now()};return}if(V.phase==="playing"){r.current=Xd(V);return}if(V.phase==="gameover"||V.phase==="victory"){e?r.current={...Bc(),phase:"ready"}:t&&t({defeated:V.animalsDefeated,total:V.totalAnimals,elapsedMs:V.elapsedMs,won:V.phase==="victory"});return}}if(M.key==="Escape"){if(M.preventDefault(),!e&&t){const L=r.current;t({defeated:L.animalsDefeated,total:L.totalAnimals,elapsedMs:L.elapsedMs,won:!1})}return}M.key==="ArrowLeft"&&(M.preventDefault(),r.current={...r.current,input:{...r.current.input,left:!0}}),M.key==="ArrowRight"&&(M.preventDefault(),r.current={...r.current,input:{...r.current.input,right:!0}}),M.key==="ArrowUp"&&(M.preventDefault(),r.current={...r.current,input:{...r.current.input,up:!0}}),M.key==="ArrowDown"&&(M.preventDefault(),r.current={...r.current,input:{...r.current.input,down:!0}})},R=M=>{M.key==="ArrowLeft"&&(r.current={...r.current,input:{...r.current.input,left:!1}}),M.key==="ArrowRight"&&(r.current={...r.current,input:{...r.current.input,right:!1}}),M.key==="ArrowUp"&&(r.current={...r.current,input:{...r.current.input,up:!1}}),M.key==="ArrowDown"&&(r.current={...r.current,input:{...r.current.input,down:!1}})};return window.addEventListener("keydown",w),window.addEventListener("keyup",R),()=>{window.removeEventListener("keydown",w),window.removeEventListener("keyup",R)}},[e,t]);const m=ae.useCallback((w,R)=>{const M=u(w,R);if(!M)return;const V=r.current;if(V.phase==="ready"){r.current={...V,phase:"playing",startTime:Date.now()};return}if(V.phase==="playing"){const L=Math.max(pt.HORIZON_Y,Math.min(oe.HEIGHT-30,M.y)),O=Math.max(10,Math.min(oe.WIDTH-10,M.x)),G={...V,reticle:{x:O,y:L}};r.current=Xd(G);return}(V.phase==="gameover"||V.phase==="victory")&&(e?r.current={...Bc(),phase:"ready"}:t&&t({defeated:V.animalsDefeated,total:V.totalAnimals,elapsedMs:V.elapsedMs,won:V.phase==="victory"}))},[u,e,t]),_=ae.useCallback(w=>{const R=r.current;if(R.phase!=="playing")return;const M=u(w.clientX,w.clientY);if(!M)return;const V=Math.max(pt.HORIZON_Y,Math.min(oe.HEIGHT-30,M.y)),L=Math.max(10,Math.min(oe.WIDTH-10,M.x));r.current={...R,reticle:{x:L,y:V}}},[u]),p=ae.useCallback(()=>{const w=r.current;w.phase==="ready"?r.current={...w,phase:"playing",startTime:Date.now()}:(w.phase==="gameover"||w.phase==="victory")&&(e?r.current={...Bc(),phase:"ready"}:t&&t({defeated:w.animalsDefeated,total:w.totalAnimals,elapsedMs:w.elapsedMs,won:w.phase==="victory"}))},[e,t]),y=ae.useCallback((w,R)=>{r.current={...r.current,input:{...r.current.input,[w]:R}}},[]),v=ae.useCallback(()=>{const w=r.current;w.phase==="playing"&&(r.current=Xd(w))},[]);return S.jsx("div",{className:"slalom-container",children:S.jsxs("div",{className:"arcade-cabinet",children:[S.jsx("div",{className:"arcade-top"}),S.jsx("div",{className:"arcade-marquee",children:"DEFEND THE VILLAGE"}),S.jsx("div",{className:"arcade-screen-bezel",children:S.jsx("canvas",{ref:i,width:oe.WIDTH,height:oe.HEIGHT,className:"slalom-canvas",style:{cursor:"crosshair",touchAction:"none"},onClick:w=>m(w.clientX,w.clientY),onMouseMove:_,onTouchStart:w=>{w.preventDefault();const R=w.touches[0];R&&m(R.clientX,R.clientY)},onTouchMove:w=>{w.preventDefault();const R=w.touches[0];if(!R)return;const M=r.current;if(M.phase!=="playing")return;const V=u(R.clientX,R.clientY);if(!V)return;const L=Math.max(pt.HORIZON_Y,Math.min(oe.HEIGHT-30,V.y)),O=Math.max(10,Math.min(oe.WIDTH-10,V.x));r.current={...M,reticle:{x:O,y:L}}}})}),S.jsx("div",{className:"arcade-controls",children:S.jsxs("div",{className:"arcade-controls-inner",children:[S.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[S.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("up",!0)},onTouchEnd:w=>{w.preventDefault(),y("up",!1)},onMouseDown:()=>y("up",!0),onMouseUp:()=>y("up",!1),onMouseLeave:()=>y("up",!1),children:""}),S.jsxs("div",{style:{display:"flex",gap:"2px"},children:[S.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("left",!0)},onTouchEnd:w=>{w.preventDefault(),y("left",!1)},onMouseDown:()=>y("left",!0),onMouseUp:()=>y("left",!1),onMouseLeave:()=>y("left",!1),children:""}),S.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("down",!0)},onTouchEnd:w=>{w.preventDefault(),y("down",!1)},onMouseDown:()=>y("down",!0),onMouseUp:()=>y("down",!1),onMouseLeave:()=>y("down",!1),children:""}),S.jsx("button",{className:"arcade-touch-btn",onTouchStart:w=>{w.preventDefault(),y("right",!0)},onTouchEnd:w=>{w.preventDefault(),y("right",!1)},onMouseDown:()=>y("right",!0),onMouseUp:()=>y("right",!1),onMouseLeave:()=>y("right",!1),children:""})]})]}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:w=>{w.preventDefault(),p()},onMouseDown:p,children:"START"}),S.jsx("button",{className:"arcade-touch-btn",style:{backgroundColor:"#cc2222",fontSize:"14px",padding:"8px 16px"},onTouchStart:w=>{w.preventDefault(),v()},onMouseDown:v,children:"FIRE"})]})}),S.jsx("div",{className:"arcade-base"})]})})}const De={WIDTH:480,HEIGHT:640},Ae={SKY_TOP:"#0a1a3e",SKY_BOTTOM:"#1a3a6e",GROUND:"#ddeeff",GROUND_DARK:"#bbccee",TREE_TRUNK:"#553311",TREE_LEAVES:"#1a5522",TREE_SNOW:"#ddeeff",MOUNTAIN_DARK:"#445588",SNOW_CAPS:"#eeeeff",FORT_WALL:"#8899bb",FORT_SHADOW:"#667799",SNOWBALL:"#ffffff",SNOWBALL_SHADOW:"#bbccdd",PLAYER_BODY:"#cc3333",PLAYER_DARK:"#991111",PLAYER_SKIN:"#ffcc99",PLAYER_HAT:"#cc3333",OPPONENT_BODY:"#3366cc",OPPONENT_DARK:"#1144aa",OPPONENT_HAT:"#3366cc",HUD_BG:"rgba(0,0,0,0.6)",HUD_GREEN:"#33ff33",HUD_YELLOW:"#ffcc00",HUD_RED:"#ff4444",OVERLAY_BG:"rgba(0,0,0,0.85)",TEXT_WHITE:"#ffffff",TEXT_DIM:"#88ccff"},fn={HUD:"20px VT323, monospace",TITLE:"44px VT323, monospace",SUBTITLE:"24px VT323, monospace",OVERLAY:"28px VT323, monospace",SMALL:"18px VT323, monospace",TINY:"14px VT323, monospace",BIG:"36px VT323, monospace"},ft={THROWS_PER_TURN:5,HITS_TO_WIN:5,THROW_DELAY:60,TURN_SWITCH_DELAY:90,SNOWBALL_SPEED:6,SNOWBALL_SIZE:8,SPLAT_DURATION:40,HIT_STUN:30,DOUBLE_THROW_CHANCE:.3,PLAYER_TURN_TIMEOUT:600},Rt={X:370,Y_CENTER:400,HEIGHT:56,MOVE_SPEED:4,Y_MIN:280,Y_MAX:520},Ze={X:110,Y_CENTER:400,HEIGHT:56,MOVE_SPEED:3,Y_MIN:280,Y_MAX:520,DODGE_CHANCE:.6,DODGE_MISS_CHANCE:.15},Ke={HORIZON_Y:200,CENTER_LINE:240,FORT_HEIGHT:40};function oT(){return{phase:"ready",turn:"computer",turnPhase:"throwing",player:{y:Rt.Y_CENTER,hits:0,stunTimer:0,splatTimer:0,splatY:0,throwAnim:0},opponent:{y:Ze.Y_CENTER,hits:0,stunTimer:0,splatTimer:0,splatY:0,dodgeTarget:null,dodgeDecided:!1,throwAnim:0,wanderTarget:null,wanderTimer:0},snowballs:[],splats:[],throwsRemaining:ft.THROWS_PER_TURN,throwCooldown:0,switchTimer:0,turnTimer:0,aimY:Rt.Y_CENTER,frameCount:0,startTime:0,events:[],input:{up:!1,down:!1,space:!1},announcement:"",announcementTimer:0}}function _k(e){if(e.phase!=="playing")return e;let t={...e,frameCount:e.frameCount+1,events:[]};return t.player.stunTimer>0&&(t={...t,player:{...t.player,stunTimer:t.player.stunTimer-1}}),t.opponent.stunTimer>0&&(t={...t,opponent:{...t.opponent,stunTimer:t.opponent.stunTimer-1}}),t.player.splatTimer>0&&(t={...t,player:{...t.player,splatTimer:t.player.splatTimer-1}}),t.opponent.splatTimer>0&&(t={...t,opponent:{...t.opponent,splatTimer:t.opponent.splatTimer-1}}),t.player.throwAnim>0&&(t={...t,player:{...t.player,throwAnim:t.player.throwAnim-1}}),t.opponent.throwAnim>0&&(t={...t,opponent:{...t.opponent,throwAnim:t.opponent.throwAnim-1}}),t.announcementTimer>0&&(t={...t,announcementTimer:t.announcementTimer-1},t.announcementTimer===0&&(t={...t,announcement:""})),t={...t,splats:t.splats.map(i=>({...i,timer:i.timer-1})).filter(i=>i.timer>0)},t.turn==="computer"&&t.player.stunTimer===0&&(t=pk(t)),t.turn==="player"&&(t=gk(t)),t.turn==="player"&&t.opponent.stunTimer===0&&(t=Tk(t)),t.turn==="computer"&&(t=yk(t)),t=Ek(t),t.turnPhase==="switching"&&(t={...t,switchTimer:t.switchTimer-1},t.switchTimer<=0&&(t=vk(t))),t.throwCooldown>0&&(t={...t,throwCooldown:t.throwCooldown-1}),t.turn==="player"&&t.turnPhase==="throwing"&&t.throwsRemaining>0&&(t={...t,turnTimer:t.turnTimer+1},t.turnTimer>=ft.PLAYER_TURN_TIMEOUT&&(t={...t,throwsRemaining:0,turnTimer:0,announcement:"TOO SLOW! TURN FORFEIT!",announcementTimer:ft.TURN_SWITCH_DELAY},t.snowballs.length===0&&(t={...t,turnPhase:"switching",switchTimer:ft.TURN_SWITCH_DELAY,announcement:"OPPONENT'S TURN!"}))),t}function pk(e){let t=e.player.y;return e.input.up&&(t-=Rt.MOVE_SPEED),e.input.down&&(t+=Rt.MOVE_SPEED),t=Math.max(Rt.Y_MIN,Math.min(Rt.Y_MAX,t)),{...e,player:{...e.player,y:t}}}function gk(e){let t=e.aimY;return e.input.up&&(t-=Rt.MOVE_SPEED),e.input.down&&(t+=Rt.MOVE_SPEED),t=Math.max(Ze.Y_MIN,Math.min(Ze.Y_MAX,t)),{...e,aimY:t}}function Qd(e){if(e.phase!=="playing"||e.turn!=="player"||e.turnPhase!=="throwing"||e.throwsRemaining<=0||e.throwCooldown>0)return e;const t=vm(Rt.X,e.player.y,Ze.X,e.aimY,"player");return{...e,snowballs:[...e.snowballs,t],throwsRemaining:e.throwsRemaining-1,throwCooldown:30,turnTimer:0,player:{...e.player,throwAnim:15},events:[...e.events,"throw"]}}function yk(e){if(e.turnPhase!=="throwing"||e.throwsRemaining<=0||e.throwCooldown>0||e.opponent.stunTimer>0)return e;if(e.throwCooldown===0&&e.frameCount%ft.THROW_DELAY===0){const t=e.player.y+(Math.random()-.5)*80;let r=[vm(Ze.X,e.opponent.y,Rt.X,t,"computer")],o=1;if(e.throwsRemaining>=2&&Math.random()<ft.DOUBLE_THROW_CHANCE){const u=e.player.y+(Math.random()-.5)*120,c=vm(Ze.X,e.opponent.y+10,Rt.X,u,"computer");r.push(c),o=2}return{...e,snowballs:[...e.snowballs,...r],throwsRemaining:e.throwsRemaining-o,throwCooldown:ft.THROW_DELAY,opponent:{...e.opponent,throwAnim:15},events:[...e.events,"throw"]}}return e}function Tk(e){const t=e.snowballs.filter(r=>r.thrower==="player"&&r.x>Ke.CENTER_LINE&&r.vx<0);let i={...e.opponent};if(t.length>0){const r=t.reduce((u,c)=>u.x<c.x?u:c),o=r.x-Ze.X;if(o<200&&!i.dodgeDecided){i.dodgeDecided=!0,i.wanderTarget=null;const u=o/Math.abs(r.vx),c=r.y+r.vy*u;if(Math.random()<Ze.DODGE_CHANCE){const m=c>i.y?-1:1;i.dodgeTarget=i.y+m*(60+Math.random()*40)}else Math.random()<Ze.DODGE_MISS_CHANCE?i.dodgeTarget=c:i.dodgeTarget=i.y}if(i.dodgeTarget!==null){const u=i.dodgeTarget-i.y;Math.abs(u)>2&&(i.y+=Math.sign(u)*Ze.MOVE_SPEED*1.3),i.y=Math.max(Ze.Y_MIN,Math.min(Ze.Y_MAX,i.y))}}else{if(i.dodgeDecided=!1,i.dodgeTarget=null,i.wanderTimer=(i.wanderTimer||0)-1,i.wanderTimer<=0||i.wanderTarget===null){const o=Ze.Y_MAX-Ze.Y_MIN,u=i.y>Ze.Y_CENTER?-.3:.3;i.wanderTarget=Ze.Y_MIN+(Math.random()+u)*o,i.wanderTarget=Math.max(Ze.Y_MIN,Math.min(Ze.Y_MAX,i.wanderTarget)),i.wanderTimer=30+Math.floor(Math.random()*40)}const r=i.wanderTarget-i.y;Math.abs(r)>2&&(i.y+=Math.sign(r)*Ze.MOVE_SPEED*.8),i.y=Math.max(Ze.Y_MIN,Math.min(Ze.Y_MAX,i.y))}return{...e,opponent:i}}function vm(e,t,i,r,o){const u=i-e,c=r-t,_=Math.sqrt(u*u+c*c)/ft.SNOWBALL_SPEED,p=u/_,y=c/_;return{x:e,y:t,startX:e,startY:t,targetX:i,targetY:r,vx:p,vy:y,progress:0,totalFrames:_,thrower:o}}function Ek(e){let t=[],i={...e.player},r={...e.opponent},o=[...e.events],u=[...e.splats],c=e.announcement,m=e.announcementTimer,_=e.turnPhase,p=e.switchTimer,y=e.throwsRemaining;for(const w of e.snowballs){const R={...w,x:w.x+w.vx,y:w.y+w.vy,progress:w.progress+1/w.totalFrames},M=Math.min(R.progress,1),V=-.15*R.totalFrames*4*M*(1-M);if(R.progress>=1&&!w.resolved)if(R.resolved=!0,w.thrower==="computer")if(Math.abs(i.y-w.targetY)<Rt.HEIGHT*.6){r.hits++,i.stunTimer=ft.HIT_STUN,i.splatTimer=ft.SPLAT_DURATION,i.splatY=i.y,o.push("hit");continue}else u.push({x:Rt.X+(Math.random()-.5)*30,y:w.targetY,timer:60}),o.push("miss");else if(Math.abs(r.y-w.targetY)<Ze.HEIGHT*.6){i.hits++,r.stunTimer=ft.HIT_STUN,r.splatTimer=ft.SPLAT_DURATION,r.splatY=r.y,r.dodgeDecided=!1,r.dodgeTarget=null,o.push("hit");continue}else u.push({x:Ze.X+(Math.random()-.5)*30,y:w.targetY,timer:60}),o.push("miss"),r.dodgeDecided=!1,r.dodgeTarget=null;R.x<-20||R.x>De.WIDTH+20||R.y<-20||R.y>De.HEIGHT+20||(R.arcOffset=V,t.push(R))}let v={...e,snowballs:t,player:i,opponent:r,events:o,splats:u,announcement:c,announcementTimer:m,turnPhase:_,switchTimer:p,throwsRemaining:y};return i.hits>=ft.HITS_TO_WIN?{...v,phase:"gameover",winner:"player",events:[...v.events,"victory"]}:r.hits>=ft.HITS_TO_WIN?{...v,phase:"gameover",winner:"computer",events:[...v.events,"game_over"]}:(y<=0&&t.length===0&&_==="throwing"&&(v={...v,turnPhase:"switching",switchTimer:ft.TURN_SWITCH_DELAY,announcement:e.turn==="computer"?"YOUR TURN!":"OPPONENT'S TURN!",announcementTimer:ft.TURN_SWITCH_DELAY}),v)}function vk(e){const t=e.turn==="computer"?"player":"computer";return{...e,turn:t,turnPhase:"throwing",throwsRemaining:ft.THROWS_PER_TURN,throwCooldown:ft.THROW_DELAY,turnTimer:0,aimY:e.opponent.y,opponent:{...e.opponent,dodgeTarget:null,dodgeDecided:!1},events:[...e.events,"turn_switch"]}}function lT(e,t){e.imageSmoothingEnabled=!1,wk(e),bk(e),Ak(e),Sk(e),Ik(e),kk(e,t),Nk(e,t),cT(e,Ze.X,t.opponent.y,"opponent",t.opponent,t),cT(e,Rt.X,t.player.y,"player",t.player,t),Ck(e,t),Ok(e,t),t.phase==="playing"&&(Vk(e,t),t.turn==="player"&&t.turnPhase==="throwing"&&Mk(e,t),t.announcement&&Lk(e,t)),t.phase==="ready"&&Hk(e),t.phase==="gameover"&&Pk(e,t)}function wk(e){const t=e.createLinearGradient(0,0,0,Ke.HORIZON_Y);t.addColorStop(0,Ae.SKY_TOP),t.addColorStop(1,Ae.SKY_BOTTOM),e.fillStyle=t,e.fillRect(0,0,De.WIDTH,Ke.HORIZON_Y),e.fillStyle="#ffffff";const i=[[50,30],[120,60],[200,20],[280,50],[350,35],[420,55],[80,90],[300,80],[450,25],[160,45]];for(const[r,o]of i)e.fillRect(r,o,2,2)}function bk(e){e.fillStyle=Ae.MOUNTAIN_DARK,e.beginPath(),e.moveTo(0,Ke.HORIZON_Y),e.lineTo(60,Ke.HORIZON_Y-80),e.lineTo(130,Ke.HORIZON_Y-40),e.lineTo(200,Ke.HORIZON_Y-100),e.lineTo(270,Ke.HORIZON_Y-50),e.lineTo(340,Ke.HORIZON_Y-90),e.lineTo(400,Ke.HORIZON_Y-60),e.lineTo(De.WIDTH,Ke.HORIZON_Y-70),e.lineTo(De.WIDTH,Ke.HORIZON_Y),e.fill(),e.fillStyle=Ae.SNOW_CAPS,e.beginPath(),e.moveTo(190,Ke.HORIZON_Y-100),e.lineTo(200,Ke.HORIZON_Y-100),e.lineTo(210,Ke.HORIZON_Y-90),e.lineTo(195,Ke.HORIZON_Y-85),e.fill(),e.beginPath(),e.moveTo(330,Ke.HORIZON_Y-90),e.lineTo(340,Ke.HORIZON_Y-90),e.lineTo(350,Ke.HORIZON_Y-80),e.lineTo(335,Ke.HORIZON_Y-78),e.fill()}function Ak(e){const t=e.createLinearGradient(0,Ke.HORIZON_Y,0,De.HEIGHT);t.addColorStop(0,Ae.GROUND),t.addColorStop(1,Ae.GROUND_DARK),e.fillStyle=t,e.fillRect(0,Ke.HORIZON_Y,De.WIDTH,De.HEIGHT-Ke.HORIZON_Y),e.strokeStyle="#aabbcc",e.lineWidth=1,e.setLineDash([8,8]),e.beginPath(),e.moveTo(Ke.CENTER_LINE,Ke.HORIZON_Y+20),e.lineTo(Ke.CENTER_LINE,De.HEIGHT),e.stroke(),e.setLineDash([])}function Sk(e){const t=[{x:20,y:Ke.HORIZON_Y+5,s:.6},{x:460,y:Ke.HORIZON_Y+8,s:.7},{x:100,y:Ke.HORIZON_Y+3,s:.5},{x:380,y:Ke.HORIZON_Y+6,s:.55},{x:240,y:Ke.HORIZON_Y+2,s:.4}];for(const i of t)Rk(e,i.x,i.y,i.s)}function Rk(e,t,i,r){const o=r;e.fillStyle=Ae.TREE_TRUNK,e.fillRect(t-3*o,i,6*o,20*o),e.fillStyle=Ae.TREE_LEAVES;for(let u=0;u<3;u++){const c=(24-u*6)*o,m=14*o,_=i-u*12*o;e.beginPath(),e.moveTo(t,_-m),e.lineTo(t-c/2,_),e.lineTo(t+c/2,_),e.fill()}e.fillStyle=Ae.TREE_SNOW;for(let u=0;u<3;u++){const c=(16-u*4)*o,m=i-u*12*o;e.fillRect(t-c/2,m-14*o,c,4*o)}}function Ik(e){uT(e,Ze.X-25,460),uT(e,Rt.X-25,460)}function uT(e,t,i){e.fillStyle=Ae.FORT_WALL,e.fillRect(t,i,50,Ke.FORT_HEIGHT);for(let r=0;r<3;r++)e.fillRect(t+5+r*16,i-10,12,10);e.fillStyle=Ae.FORT_SHADOW,e.fillRect(t,i+Ke.FORT_HEIGHT-6,50,6),e.fillStyle="#ffffff";for(let r=0;r<3;r++)e.fillRect(t+5+r*16,i-12,12,3)}function kk(e,t){if(t.phase!=="playing")return;const i=t.turn==="player",r=t.throwsRemaining;if(t.turnPhase!=="throwing"&&t.turnPhase!=="switching")return;const o=i?Rt.X+30:Ze.X-30;Dk(e,o,480,r)}function Dk(e,t,i,r){const u=15.400000000000002,c=[{x:t-u,y:i},{x:t,y:i},{x:t+u,y:i},{x:t-u*.5,y:i-u*.85},{x:t+u*.5,y:i-u*.85}];for(let m=0;m<Math.min(r,5);m++){const _=c[m];e.fillStyle=Ae.SNOWBALL_SHADOW,e.beginPath(),e.arc(_.x+1,_.y+1,7,0,Math.PI*2),e.fill(),e.fillStyle=Ae.SNOWBALL,e.beginPath(),e.arc(_.x,_.y,7,0,Math.PI*2),e.fill(),e.fillStyle="#ffffff",e.beginPath(),e.arc(_.x-2,_.y-2,2.5,0,Math.PI*2),e.fill()}r>0&&(e.font=fn.TINY,e.fillStyle=Ae.TEXT_DIM,e.textAlign="center",e.fillText(`${r}`,t,i+7+12))}function cT(e,t,i,r,o,u){const c=r==="player"?Ae.PLAYER_BODY:Ae.OPPONENT_BODY,m=r==="player"?Ae.PLAYER_DARK:Ae.OPPONENT_DARK,_=r==="player"?Ae.PLAYER_HAT:Ae.OPPONENT_HAT,p=o.stunTimer>0?Math.sin(o.stunTimer*.8)*3:0,y=t+p;e.fillStyle="rgba(0,0,0,0.15)",e.beginPath(),e.ellipse(y,i+28,18,6,0,0,Math.PI*2),e.fill(),e.fillStyle=c,e.fillRect(y-12,i-16,24,32),e.fillStyle=m,e.fillRect(y-12,i-16,24,4),e.fillRect(y-12,i+12,24,4),e.fillStyle=Ae.PLAYER_SKIN,e.beginPath(),e.arc(y,i-24,10,0,Math.PI*2),e.fill(),e.fillStyle=_,e.beginPath(),e.arc(y,i-28,10,Math.PI,0),e.fill(),e.fillRect(y-10,i-28,20,4),e.fillStyle="#ffffff",e.beginPath(),e.arc(y,i-36,4,0,Math.PI*2),e.fill(),e.fillStyle="#000000";const v=r==="player"?-1:1;e.fillRect(y+v*3-1,i-26,3,3),e.fillRect(y+v*-5,i-26,3,3);const w=r==="player"?-1:1,R=r==="player"&&u.turn==="player"||r!=="player"&&u.turn==="computer",M=o.throwAnim||0;if(e.fillStyle=c,M>0){const V=1-M/15,L=-Math.PI*.4+V*Math.PI*.8;e.save(),e.translate(y+w*8,i-10),e.rotate(L*w),e.fillRect(0,-3,18,6),e.restore(),e.fillRect(y-w*16,i-10,5,18)}else R&&u.turnPhase==="throwing"?(e.fillRect(y+w*12,i-16,8*w,-16),e.fillStyle=Ae.SNOWBALL,e.beginPath(),e.arc(y+w*18,i-30,5,0,Math.PI*2),e.fill(),e.fillStyle=c,e.fillRect(y-w*16,i-10,5,18)):(e.fillRect(y-16,i-10,5,18),e.fillRect(y+11,i-10,5,18));e.fillStyle="#444466",e.fillRect(y-8,i+16,7,12),e.fillRect(y+1,i+16,7,12),e.fillStyle="#332211",e.fillRect(y-9,i+26,9,4),e.fillRect(y,i+26,9,4)}function Ok(e,t){t.player.splatTimer>0&&hT(e,Rt.X,t.player.splatY,t.player.splatTimer),t.opponent.splatTimer>0&&hT(e,Ze.X,t.opponent.splatY,t.opponent.splatTimer)}function hT(e,t,i,r){const o=1-r/ft.SPLAT_DURATION,u=Math.max(0,1-o);e.fillStyle=`rgba(255, 255, 255, ${u})`,e.beginPath(),e.arc(t,i-10,14+o*8,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(220, 235, 255, ${u*.8})`;const c=8;for(let m=0;m<c;m++){const _=m/c*Math.PI*2,p=10+o*30,y=t+Math.cos(_)*p,v=i-10+Math.sin(_)*p*.6,w=4*(1-o);e.beginPath(),e.arc(y,v,w,0,Math.PI*2),e.fill()}}function Ck(e,t){for(const i of t.snowballs){const r=i.y+(i.arcOffset||0);e.fillStyle="rgba(0,0,0,0.1)",e.beginPath(),e.ellipse(i.x,i.y+2,6,3,0,0,Math.PI*2),e.fill(),e.fillStyle=Ae.SNOWBALL,e.beginPath(),e.arc(i.x,r,ft.SNOWBALL_SIZE,0,Math.PI*2),e.fill(),e.fillStyle=Ae.SNOWBALL_SHADOW,e.beginPath(),e.arc(i.x+2,r+2,ft.SNOWBALL_SIZE*.6,0,Math.PI*2),e.fill(),e.fillStyle="#ffffff",e.beginPath(),e.arc(i.x-2,r-2,3,0,Math.PI*2),e.fill()}}function Nk(e,t){for(const i of t.splats){const r=i.timer/60;e.fillStyle=`rgba(200, 220, 240, ${r*.5})`,e.beginPath(),e.ellipse(i.x,i.y,12,5,0,0,Math.PI*2),e.fill()}}function Mk(e,t){const i=Ze.X,r=t.aimY;e.strokeStyle="rgba(255, 100, 100, 0.4)",e.lineWidth=1,e.setLineDash([4,4]),e.beginPath();const o=Rt.X,u=t.player.y,c=.5;for(let V=0;V<=c;V+=.05){const L=o+(i-o)*V,O=u+(r-u)*V-Math.sin(V*Math.PI)*40;V===0?e.moveTo(L,O):e.lineTo(L,O)}e.stroke(),e.setLineDash([]);const m=c,_=c-.05,p=o+(i-o)*m,y=u+(r-u)*m-Math.sin(m*Math.PI)*40,v=o+(i-o)*_,w=u+(r-u)*_-Math.sin(_*Math.PI)*40,R=Math.atan2(y-w,p-v),M=10;e.strokeStyle="rgba(255, 100, 100, 0.6)",e.lineWidth=2,e.beginPath(),e.moveTo(p,y),e.lineTo(p-M*Math.cos(R-.5),y-M*Math.sin(R-.5)),e.moveTo(p,y),e.lineTo(p-M*Math.cos(R+.5),y-M*Math.sin(R+.5)),e.stroke()}function Vk(e,t){e.fillStyle=Ae.HUD_BG,e.fillRect(0,0,De.WIDTH,50),e.font=fn.HUD,e.textAlign="left",e.fillStyle=Ae.OPPONENT_BODY,e.fillText(`CPU: ${t.opponent.hits}/${ft.HITS_TO_WIN}`,20,20),fT(e,20,28,t.opponent.hits,Ae.OPPONENT_BODY),e.fillStyle=Ae.PLAYER_BODY,e.textAlign="right",e.fillText(`YOU: ${t.player.hits}/${ft.HITS_TO_WIN}`,De.WIDTH-20,20);const i=ft.HITS_TO_WIN*16;if(fT(e,De.WIDTH-20-i,28,t.player.hits,Ae.PLAYER_BODY),e.textAlign="left",e.fillStyle=Ae.TEXT_WHITE,e.textAlign="center",e.font=fn.SMALL,t.turn==="player"&&t.turnPhase==="throwing"){const r=Math.ceil((ft.PLAYER_TURN_TIMEOUT-(t.turnTimer||0))/60),o=r<=3?Ae.HUD_RED:Ae.HUD_GREEN;e.fillStyle=o,e.fillText(`YOUR THROW  [${t.throwsRemaining} left]  ${r}s`,De.WIDTH/2,20),e.fillStyle=Ae.TEXT_DIM,e.font=fn.TINY,e.fillText(" AIM    SPACE/TAP THROW",De.WIDTH/2,38)}else t.turn==="computer"&&t.turnPhase==="throwing"?(e.fillStyle=Ae.HUD_YELLOW,e.fillText(`DODGE!  [${t.throwsRemaining} incoming]`,De.WIDTH/2,20),e.fillStyle=Ae.TEXT_DIM,e.font=fn.TINY,e.fillText(" DODGE",De.WIDTH/2,38)):(e.fillStyle=Ae.TEXT_DIM,e.fillText("SWITCHING...",De.WIDTH/2,28))}function fT(e,t,i,r,o){for(let u=0;u<ft.HITS_TO_WIN;u++)e.fillStyle=u<r?o:"rgba(255,255,255,0.2)",e.beginPath(),e.arc(t+u*16+6,i+8,5,0,Math.PI*2),e.fill()}function Lk(e,t){const i=Math.min(1,t.announcementTimer/20);e.fillStyle=`rgba(0, 0, 0, ${i*.6})`,e.fillRect(0,De.HEIGHT/2-30,De.WIDTH,60),e.font=fn.BIG,e.textAlign="center",e.fillStyle=`rgba(255, 255, 255, ${i})`,e.fillText(t.announcement,De.WIDTH/2,De.HEIGHT/2+10)}function Hk(e){e.fillStyle=Ae.OVERLAY_BG,e.fillRect(0,0,De.WIDTH,De.HEIGHT),e.textAlign="center",e.font=fn.TITLE,e.fillStyle=Ae.TEXT_WHITE,e.fillText("SNOWBALL",De.WIDTH/2,200),e.fillText("SHOWDOWN",De.WIDTH/2,250),e.font=fn.SUBTITLE,e.fillStyle=Ae.TEXT_DIM,e.fillText("* * *",De.WIDTH/2,300),e.font=fn.OVERLAY,e.fillStyle=Ae.TEXT_WHITE,e.fillText("Dodge snowballs!",De.WIDTH/2,360),e.fillText("Aim & throw back!",De.WIDTH/2,395),e.font=fn.SMALL,e.fillStyle=Ae.TEXT_DIM,e.fillText("  Move / Aim",De.WIDTH/2,440),e.fillText("SPACE or TAP  Throw",De.WIDTH/2,465),e.fillText(`First to ${ft.HITS_TO_WIN} hits wins!`,De.WIDTH/2,500),e.font=fn.SUBTITLE,Math.floor(Date.now()/500)%2&&(e.fillStyle=Ae.HUD_GREEN,e.fillText("TAP or PRESS SPACE TO START",De.WIDTH/2,560))}function Pk(e,t){e.fillStyle=Ae.OVERLAY_BG,e.fillRect(0,0,De.WIDTH,De.HEIGHT),e.textAlign="center",t.winner==="player"?(e.font=fn.TITLE,e.fillStyle=Ae.HUD_GREEN,e.fillText("YOU WIN!",De.WIDTH/2,220),e.font=fn.OVERLAY,e.fillStyle=Ae.TEXT_WHITE,e.fillText("Snowball Champion!",De.WIDTH/2,280)):(e.font=fn.TITLE,e.fillStyle=Ae.HUD_RED,e.fillText("YOU LOSE!",De.WIDTH/2,220),e.font=fn.OVERLAY,e.fillStyle=Ae.TEXT_WHITE,e.fillText("Better luck next time!",De.WIDTH/2,280)),e.font=fn.SUBTITLE,e.fillStyle=Ae.TEXT_DIM,e.fillText(`CPU: ${t.opponent.hits}    YOU: ${t.player.hits}`,De.WIDTH/2,340),e.font=fn.SUBTITLE,Math.floor(Date.now()/500)%2&&(e.fillStyle=Ae.TEXT_WHITE,e.fillText("TAP or PRESS SPACE TO CONTINUE",De.WIDTH/2,420))}function xk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=Math.floor(e.sampleRate*.2),i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let m=0;m<t;m++)r[m]=(Math.random()*2-1)*(1-m/t);const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="bandpass",u.frequency.setValueAtTime(800,e.currentTime),u.frequency.linearRampToValueAtTime(2e3,e.currentTime+.1),u.frequency.linearRampToValueAtTime(500,e.currentTime+.2),u.Q.value=2;const c=e.createGain();c.gain.setValueAtTime(.12,e.currentTime),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+.2),o.connect(u),u.connect(c),c.connect(e.destination),o.start(),setTimeout(()=>e.close(),500)}catch{}}function zk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=Math.floor(e.sampleRate*.15),i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let p=0;p<t;p++)r[p]=(Math.random()*2-1)*Math.pow(1-p/t,.5);const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="lowpass",u.frequency.value=1500;const c=e.createGain();c.gain.setValueAtTime(.18,e.currentTime),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+.15),o.connect(u),u.connect(c),c.connect(e.destination),o.start();const m=e.createOscillator(),_=e.createGain();m.type="sine",m.frequency.setValueAtTime(150,e.currentTime),m.frequency.exponentialRampToValueAtTime(60,e.currentTime+.1),_.gain.setValueAtTime(.15,e.currentTime),_.gain.exponentialRampToValueAtTime(.01,e.currentTime+.12),m.connect(_),_.connect(e.destination),m.start(),m.stop(e.currentTime+.15),setTimeout(()=>e.close(),500)}catch{}}function Uk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(100,e.currentTime),t.frequency.exponentialRampToValueAtTime(40,e.currentTime+.1),i.gain.setValueAtTime(.08,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.12),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.15);const r=Math.floor(e.sampleRate*.06),o=e.createBuffer(1,r,e.sampleRate),u=o.getChannelData(0);for(let _=0;_<r;_++)u[_]=(Math.random()*2-1)*(1-_/r)*.5;const c=e.createBufferSource();c.buffer=o;const m=e.createGain();m.gain.setValueAtTime(.05,e.currentTime),c.connect(m),m.connect(e.destination),c.start(),setTimeout(()=>e.close(),400)}catch{}}function Bk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:440,start:0,dur:.12},{freq:660,start:.15,dur:.18}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.08,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),600)}catch{}}function Gk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:440,start:0,dur:.25},{freq:415,start:.3,dur:.25},{freq:370,start:.6,dur:.25},{freq:330,start:.9,dur:.5}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sawtooth",r.frequency.setValueAtTime(i.freq,e.currentTime+i.start),r.frequency.linearRampToValueAtTime(i.freq*.97,e.currentTime+i.start+i.dur),o.gain.setValueAtTime(.08,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),2e3)}catch{}}function jk(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:523,start:0,dur:.15},{freq:659,start:.18,dur:.15},{freq:784,start:.36,dur:.15},{freq:1047,start:.54,dur:.4}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(.1,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),1500)}catch{}}function dT(e){const i={throw:xk,hit:zk,miss:Uk,turn_switch:Bk,game_over:Gk,victory:jk}[e];i&&i()}function d_({standalone:e=!1,onGameOver:t}){const i=ae.useRef(null),r=ae.useRef(oT()),o=ae.useRef(null),u=ae.useCallback((R,M)=>{const V=i.current;if(!V)return null;const L=V.getBoundingClientRect(),O=De.WIDTH/L.width,G=De.HEIGHT/L.height;return{x:(R-L.left)*O,y:(M-L.top)*G}},[]),c=ae.useCallback(()=>{const R=r.current;if(R.events.length>0)for(const L of R.events)dT(L);const M=_k({...R,events:[]});r.current=M;for(const L of M.events)dT(L);const V=i.current;if(V){const L=V.getContext("2d");lT(L,M)}o.current=requestAnimationFrame(c)},[e,t]);ae.useEffect(()=>{const R=i.current;if(R){const M=R.getContext("2d");lT(M,r.current)}return o.current=requestAnimationFrame(c),()=>{o.current&&cancelAnimationFrame(o.current)}},[c]);const m=ae.useCallback(R=>{e?r.current={...oT(),phase:"ready"}:t&&t({playerHits:R.player.hits,computerHits:R.opponent.hits,won:R.winner==="player"})},[e,t]);ae.useEffect(()=>{const R=V=>{const L=r.current;if(V.key===" "||V.code==="Space"){if(V.preventDefault(),L.phase==="ready"){r.current={...L,phase:"playing",startTime:Date.now()};return}if(L.phase==="playing"&&L.turn==="player"&&L.turnPhase==="throwing"){r.current=Qd(L);return}if(L.phase==="gameover"){m(L);return}}if(V.key==="Escape"){V.preventDefault(),!e&&t&&t({playerHits:L.player.hits,computerHits:L.opponent.hits,won:!1});return}V.key==="ArrowUp"&&(V.preventDefault(),r.current={...r.current,input:{...r.current.input,up:!0}}),V.key==="ArrowDown"&&(V.preventDefault(),r.current={...r.current,input:{...r.current.input,down:!0}})},M=V=>{V.key==="ArrowUp"&&(r.current={...r.current,input:{...r.current.input,up:!1}}),V.key==="ArrowDown"&&(r.current={...r.current,input:{...r.current.input,down:!1}})};return window.addEventListener("keydown",R),window.addEventListener("keyup",M),()=>{window.removeEventListener("keydown",R),window.removeEventListener("keyup",M)}},[e,t,m]);const _=ae.useCallback((R,M)=>{const V=u(R,M);if(!V)return;const L=r.current;if(L.phase==="ready"){r.current={...L,phase:"playing",startTime:Date.now()};return}if(L.phase==="playing"){if(L.turn==="player"&&L.turnPhase==="throwing"){const O=Math.max(Ze.Y_MIN,Math.min(Ze.Y_MAX,V.y)),G={...L,aimY:O};r.current=Qd(G)}else if(L.turn==="computer"){const O=Math.max(Rt.Y_MIN,Math.min(Rt.Y_MAX,V.y));r.current={...L,player:{...L.player,y:O}}}return}L.phase==="gameover"&&m(L)},[u,m]),p=ae.useCallback(R=>{R.preventDefault();const M=R.touches[0];if(!M)return;const V=r.current;if(V.phase!=="playing")return;const L=u(M.clientX,M.clientY);if(L){if(V.turn==="computer"){const O=Math.max(Rt.Y_MIN,Math.min(Rt.Y_MAX,L.y));r.current={...V,player:{...V.player,y:O}}}else if(V.turn==="player"){const O=Math.max(Ze.Y_MIN,Math.min(Ze.Y_MAX,L.y));r.current={...V,aimY:O}}}},[u]),y=ae.useCallback((R,M)=>{r.current={...r.current,input:{...r.current.input,[R]:M}}},[]),v=ae.useCallback(()=>{const R=r.current;R.phase==="ready"?r.current={...R,phase:"playing",startTime:Date.now()}:R.phase==="gameover"&&m(R)},[m]),w=ae.useCallback(()=>{const R=r.current;R.phase==="playing"&&R.turn==="player"&&R.turnPhase==="throwing"&&(r.current=Qd(R))},[]);return S.jsx("div",{className:"slalom-container",children:S.jsxs("div",{className:"arcade-cabinet",children:[S.jsx("div",{className:"arcade-top"}),S.jsx("div",{className:"arcade-marquee",children:"SNOWBALL SHOWDOWN"}),S.jsx("div",{className:"arcade-screen-bezel",children:S.jsx("canvas",{ref:i,width:De.WIDTH,height:De.HEIGHT,className:"slalom-canvas",style:{cursor:"crosshair",touchAction:"none"},onClick:R=>_(R.clientX,R.clientY),onTouchStart:R=>{R.preventDefault();const M=R.touches[0];M&&_(M.clientX,M.clientY)},onTouchMove:p})}),S.jsx("div",{className:"arcade-controls",children:S.jsxs("div",{className:"arcade-controls-inner",children:[S.jsx("button",{className:"arcade-touch-btn",onTouchStart:R=>{R.preventDefault(),y("up",!0)},onTouchEnd:R=>{R.preventDefault(),y("up",!1)},onMouseDown:()=>y("up",!0),onMouseUp:()=>y("up",!1),onMouseLeave:()=>y("up",!1),children:""}),S.jsx("button",{className:"arcade-touch-btn",onTouchStart:R=>{R.preventDefault(),y("down",!0)},onTouchEnd:R=>{R.preventDefault(),y("down",!1)},onMouseDown:()=>y("down",!0),onMouseUp:()=>y("down",!1),onMouseLeave:()=>y("down",!1),children:""}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:R=>{R.preventDefault(),v()},onMouseDown:v,children:"START"}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-throw",onTouchStart:R=>{R.preventDefault(),w()},onMouseDown:w,children:"THROW"})]})}),S.jsx("div",{className:"arcade-base"})]})})}const mT="https://stevehau.github.io/snowpeak/";function Tv({onBack:e,standalone:t=!1}){const[i,r]=ae.useState(!1),[o,u]=ae.useState(!1);ae.useEffect(()=>{const m=setTimeout(()=>r(!0),800),_=setTimeout(()=>u(!0),1600);return()=>{clearTimeout(m),clearTimeout(_)}},[]);const c=ae.useCallback(()=>{t?(window.location.hash="",window.location.reload()):e()},[e,t]);return ae.useEffect(()=>{const m=_=>{(_.key==="Escape"||_.key==="b"||_.key==="B")&&c()};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[c]),S.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",background:i?"linear-gradient(180deg, #050510 0%, #0a0a20 40%, #0c1225 100%)":"linear-gradient(180deg, #1a2040 0%, #0a1030 40%, #0c1225 100%)",transition:"background 1.5s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",fontFamily:"'Georgia', serif"},children:[S.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",overflow:"hidden"},children:[{x:5,y:3,s:2},{x:12,y:8,s:1.5},{x:20,y:2,s:1},{x:30,y:6,s:2},{x:42,y:4,s:1.5},{x:55,y:7,s:1},{x:65,y:2,s:2},{x:75,y:5,s:1.5},{x:85,y:3,s:1},{x:92,y:8,s:2},{x:8,y:12,s:1},{x:35,y:11,s:1.5},{x:58,y:10,s:1},{x:78,y:13,s:1.5},{x:95,y:11,s:1},{x:15,y:15,s:1},{x:48,y:14,s:1},{x:88,y:16,s:1}].map((m,_)=>S.jsx("div",{style:{position:"absolute",left:`${m.x}%`,top:`${m.y}%`,width:m.s,height:m.s,borderRadius:"50%",background:"white",opacity:i?.3+Math.random()*.5:.1,transition:"opacity 2s ease"}},_))}),S.jsx("div",{style:{color:"#FFD700",fontSize:"clamp(10px, 1.8vw, 18px)",letterSpacing:"6px",textTransform:"uppercase",marginBottom:"8px",opacity:i?.8:.4,transition:"opacity 1.5s ease",textShadow:"0 0 10px rgba(255,215,0,0.5)"},children:"Now Showing"}),S.jsxs("div",{style:{position:"relative",width:"min(85vw, 960px)",maxWidth:"960px"},children:[S.jsx("div",{style:{border:"6px solid #3a3020",borderRadius:"4px",boxShadow:i?"0 0 40px rgba(255,255,255,0.05), inset 0 0 30px rgba(0,0,0,0.3), 0 8px 30px rgba(0,0,0,0.6)":"0 0 10px rgba(255,255,255,0.02), inset 0 0 10px rgba(0,0,0,0.2), 0 4px 15px rgba(0,0,0,0.4)",background:"#111",transition:"box-shadow 1.5s ease",overflow:"hidden"},children:S.jsxs("div",{style:{border:"2px solid #555",borderRadius:"2px",overflow:"hidden",position:"relative"},children:[o&&S.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, rgba(255,255,255,0.03) 0%, transparent 50%, rgba(255,255,255,0.02) 100%)",pointerEvents:"none",zIndex:2}}),o?S.jsx("object",{data:"trailer.svg",type:"image/svg+xml",style:{width:"100%",display:"block",aspectRatio:"1200 / 675",background:"#000"},children:S.jsx("img",{src:"trailer.svg",alt:"Snowpeak Resort Trailer",style:{width:"100%"}})}):S.jsx("div",{style:{width:"100%",aspectRatio:"1200 / 675",background:"linear-gradient(180deg, #1a0a0a 0%, #0a0505 50%, #1a0a0a 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:S.jsx("div",{style:{color:"#FFD700",fontSize:"clamp(14px, 2.5vw, 28px)",letterSpacing:"8px",opacity:.7,animation:"pulse 1.5s ease-in-out infinite"},children:"LIGHTS DIMMING..."})})]})}),S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0 20px"},children:[S.jsx("div",{style:{width:"8px",height:"30px",background:"#2a2015",borderRadius:"0 0 2px 2px"}}),S.jsx("div",{style:{width:"8px",height:"30px",background:"#2a2015",borderRadius:"0 0 2px 2px"}})]})]}),S.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"18%",pointerEvents:"none"},children:[S.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"60%",background:"linear-gradient(180deg, transparent, #080812 30%, #0a0a15)"}}),S.jsxs("svg",{viewBox:"0 0 1200 140",style:{position:"absolute",bottom:0,left:0,width:"100%",height:"100%"},preserveAspectRatio:"xMidYMax meet",children:[S.jsxs("g",{transform:"translate(100,60)",opacity:"0.35",children:[S.jsx("rect",{x:"-50",y:"10",width:"100",height:"30",rx:"4",fill:"#111"}),S.jsx("rect",{x:"-35",y:"-5",width:"70",height:"20",rx:"8",fill:"#111"}),S.jsx("rect",{x:"-25",y:"-2",width:"20",height:"12",rx:"2",fill:"#1a1a2a",opacity:"0.6"}),S.jsx("rect",{x:"5",y:"-2",width:"20",height:"12",rx:"2",fill:"#1a1a2a",opacity:"0.6"}),S.jsx("circle",{cx:"-30",cy:"42",r:"10",fill:"#0a0a12"}),S.jsx("circle",{cx:"30",cy:"42",r:"10",fill:"#0a0a12"}),S.jsx("circle",{cx:"-48",cy:"22",r:"3",fill:"#ff2222",opacity:"0.3"})]}),S.jsxs("g",{transform:"translate(350,50)",opacity:"0.3",children:[S.jsx("rect",{x:"-55",y:"10",width:"110",height:"34",rx:"5",fill:"#0e0e18"}),S.jsx("rect",{x:"-40",y:"-8",width:"80",height:"24",rx:"10",fill:"#0e0e18"}),S.jsx("rect",{x:"-30",y:"-4",width:"22",height:"14",rx:"3",fill:"#181828",opacity:"0.5"}),S.jsx("rect",{x:"8",y:"-4",width:"22",height:"14",rx:"3",fill:"#181828",opacity:"0.5"}),S.jsx("circle",{cx:"-34",cy:"46",r:"11",fill:"#080812"}),S.jsx("circle",{cx:"34",cy:"46",r:"11",fill:"#080812"})]}),S.jsxs("g",{transform:"translate(600,55)",opacity:"0.25",children:[S.jsx("rect",{x:"-60",y:"8",width:"120",height:"36",rx:"4",fill:"#101018"}),S.jsx("rect",{x:"-55",y:"-12",width:"50",height:"26",rx:"6",fill:"#101018"}),S.jsx("rect",{x:"-45",y:"-8",width:"16",height:"14",rx:"2",fill:"#1a1a28",opacity:"0.5"}),S.jsx("rect",{x:"-25",y:"-8",width:"16",height:"14",rx:"2",fill:"#1a1a28",opacity:"0.5"}),S.jsx("rect",{x:"0",y:"-2",width:"56",height:"16",rx:"2",fill:"#0c0c16"}),S.jsx("circle",{cx:"-38",cy:"46",r:"12",fill:"#080810"}),S.jsx("circle",{cx:"40",cy:"46",r:"12",fill:"#080810"})]}),S.jsxs("g",{transform:"translate(830,50)",opacity:"0.3",children:[S.jsx("rect",{x:"-50",y:"10",width:"100",height:"30",rx:"4",fill:"#0f0f1a"}),S.jsx("rect",{x:"-35",y:"-5",width:"70",height:"20",rx:"8",fill:"#0f0f1a"}),S.jsx("rect",{x:"-25",y:"-2",width:"20",height:"12",rx:"2",fill:"#191928",opacity:"0.6"}),S.jsx("rect",{x:"5",y:"-2",width:"20",height:"12",rx:"2",fill:"#191928",opacity:"0.6"}),S.jsx("circle",{cx:"-30",cy:"42",r:"10",fill:"#080812"}),S.jsx("circle",{cx:"30",cy:"42",r:"10",fill:"#080812"})]}),S.jsxs("g",{transform:"translate(1060,48)",opacity:"0.35",children:[S.jsx("rect",{x:"-55",y:"8",width:"110",height:"38",rx:"5",fill:"#111"}),S.jsx("rect",{x:"-45",y:"-14",width:"90",height:"28",rx:"6",fill:"#111"}),S.jsx("rect",{x:"-35",y:"-10",width:"18",height:"16",rx:"2",fill:"#1a1a2a",opacity:"0.5"}),S.jsx("rect",{x:"-12",y:"-10",width:"18",height:"16",rx:"2",fill:"#1a1a2a",opacity:"0.5"}),S.jsx("rect",{x:"12",y:"-10",width:"18",height:"16",rx:"2",fill:"#1a1a2a",opacity:"0.5"}),S.jsx("circle",{cx:"-34",cy:"48",r:"12",fill:"#0a0a14"}),S.jsx("circle",{cx:"34",cy:"48",r:"12",fill:"#0a0a14"}),S.jsx("circle",{cx:"53",cy:"20",r:"3",fill:"#ff2222",opacity:"0.2"})]}),S.jsxs("g",{opacity:"0.2",fill:"#222",children:[S.jsx("rect",{x:"228",y:"20",width:"4",height:"70"}),S.jsx("rect",{x:"226",y:"16",width:"8",height:"12",rx:"2"}),S.jsx("rect",{x:"490",y:"25",width:"4",height:"65"}),S.jsx("rect",{x:"488",y:"21",width:"8",height:"12",rx:"2"}),S.jsx("rect",{x:"720",y:"22",width:"4",height:"68"}),S.jsx("rect",{x:"718",y:"18",width:"8",height:"12",rx:"2"}),S.jsx("rect",{x:"950",y:"24",width:"4",height:"66"}),S.jsx("rect",{x:"948",y:"20",width:"8",height:"12",rx:"2"})]})]})]}),S.jsxs("div",{style:{display:"flex",gap:"clamp(8px, 2vw, 20px)",marginTop:"clamp(6px, 1.2vh, 14px)",zIndex:10},children:[S.jsx("button",{onClick:()=>window.open(mT,"_blank"),style:{background:"linear-gradient(180deg, #FFD700, #E6A800)",color:"#1a2a4a",border:"none",padding:"clamp(6px, 1vw, 12px) clamp(12px, 2vw, 28px)",borderRadius:"24px",fontSize:"clamp(10px, 1.4vw, 16px)",fontWeight:"bold",letterSpacing:"2px",cursor:"pointer",fontFamily:"'Georgia', serif",boxShadow:"0 0 20px rgba(255,215,0,0.3), 0 4px 12px rgba(0,0,0,0.4)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:m=>{m.target.style.transform="scale(1.05)",m.target.style.boxShadow="0 0 30px rgba(255,215,0,0.5), 0 4px 15px rgba(0,0,0,0.5)"},onMouseLeave:m=>{m.target.style.transform="scale(1)",m.target.style.boxShadow="0 0 20px rgba(255,215,0,0.3), 0 4px 12px rgba(0,0,0,0.4)"},children:"PLAY THE GAME"}),S.jsx("button",{onClick:()=>{const m=mT+"#trailer";navigator.clipboard.writeText(m).catch(()=>{}),alert(`Link copied!
`+m)},style:{background:"rgba(100,150,200,0.2)",color:"#8AACCC",border:"1.5px solid #8AACCC",padding:"clamp(6px, 1vw, 12px) clamp(12px, 2vw, 28px)",borderRadius:"24px",fontSize:"clamp(10px, 1.4vw, 16px)",fontWeight:"bold",letterSpacing:"2px",cursor:"pointer",fontFamily:"'Georgia', serif",transition:"transform 0.2s, background 0.2s"},onMouseEnter:m=>{m.target.style.transform="scale(1.05)",m.target.style.background="rgba(100,150,200,0.35)"},onMouseLeave:m=>{m.target.style.transform="scale(1)",m.target.style.background="rgba(100,150,200,0.2)"},children:"SHARE LINK"})]}),S.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 0.5; }
          50% { opacity: 1; }
        }
      `})]})}const se={WIDTH:480,HEIGHT:640},ye={SKY_TOP:"#0B1628",SKY_MID:"#152844",SKY_BOT:"#1A3355",BRICK_ROWS:["#C8D0D8","#D0D8E0","#D8E0E8","#DDE5ED","#E2EAF2","#E8EFF5","#EDF3F8","#F0F5FA","#F5F9FC","#FAFCFE"],BRICK_HIGHLIGHT:"rgba(255,255,255,0.45)",BRICK_SHADOW:"rgba(40,60,90,0.35)",BRICK_SILVER:"#A8B8CC",BRICK_GOLD:"#88CCEE",SLEIGH_RED:"#CC2222",SLEIGH_DARK:"#881515",SLEIGH_TRIM:"#FFD700",SLEIGH_RUNNER:"#A0A8B0",DEER_BODY:"#8B6B42",DEER_LIGHT:"#A88050",DEER_DARK:"#5E4428",DEER_ANTLER:"#C4A060",DEER_NOSE:"#FF3333",HARNESS:"#CC8833",BALL_GLOW:"rgba(180,220,255,0.4)",SNOWFLAKE:"#E0F0FF",TEXT_WHITE:"#FFFFFF",TEXT_DIM:"#8899BB",TEXT_GOLD:"#FFD700",TEXT_ICE:"#AADDFF",PARTICLE:"#E0EEFF",SNOW_PARTICLE:"#FFFFFF"},Xt={TITLE:'44px "Press Start 2P", "VT323", monospace',SUBTITLE:'22px "Press Start 2P", "VT323", monospace',OVERLAY:'28px "Press Start 2P", "VT323", monospace',HUD:'18px "Press Start 2P", "VT323", monospace',SMALL:'16px "Press Start 2P", "VT323", monospace',TINY:'12px "Press Start 2P", "VT323", monospace',BIG:'36px "Press Start 2P", "VT323", monospace'},va={WIDTH:72,HEIGHT:14,Y:se.HEIGHT-50,SPEED:6},ct={RADIUS:8,BASE_SPEED:5,SPEED_INCREMENT:.15},wi={ROWS:10,COLS:10,WIDTH:42,HEIGHT:16,PADDING:3,OFFSET_TOP:80,OFFSET_LEFT:(se.WIDTH-447)/2},tn={LIVES:3,POINTS_PER_BRICK:10,POINTS_BONUS_ROW:5,POWERUP_CHANCE:.08,POWERUP_SPEED:2,POWERUP_SIZE:14,MAX_LEVELS:5,SERVE_DELAY:60,LEVEL_DELAY:120,SNOW_COUNT:30},eu={WIDE:{color:"#66EEBB",label:"W",duration:600},MULTI:{color:"#DD88FF",label:"M",duration:0},SLOW:{color:"#88BBFF",label:"S",duration:480}};function Ev(e){const t=[];for(let i=0;i<wi.ROWS;i++)for(let r=0;r<wi.COLS;r++){const o=wi.OFFSET_LEFT+r*(wi.WIDTH+wi.PADDING),u=wi.OFFSET_TOP+i*(wi.HEIGHT+wi.PADDING);let c=1,m=ye.BRICK_ROWS[i]||"#FFFFFF";if(e>=2&&i<2&&(c=2,m=ye.BRICK_SILVER),e>=3&&i===0&&(c=3,m=ye.BRICK_GOLD),e>=4){if((i+r)%3===0)continue;i<3&&(c=Math.min(c+1,3))}e>=5&&i>=3&&i<=6&&r>=3&&r<=6&&(c=3,m=ye.BRICK_GOLD),t.push({x:o,y:u,w:wi.WIDTH,h:wi.HEIGHT,hits:c,maxHits:c,color:m,row:i,col:r})}return t}function wm(e){const t=-(Math.PI/6+Math.random()*Math.PI/6);return{x:se.WIDTH/2,y:va.Y-ct.RADIUS-2,vx:Math.cos(t)*e*(Math.random()>.5?1:-1),vy:Math.sin(t)*e,speed:e,stuck:!0}}function _T(){const e=ct.BASE_SPEED;return{phase:"ready",level:1,score:0,lives:tn.LIVES,combo:0,paddle:{x:se.WIDTH/2-va.WIDTH/2,y:va.Y,w:va.WIDTH,h:va.HEIGHT,baseWidth:va.WIDTH},balls:[wm(e)],bricks:Ev(1),particles:[],powerups:[],activePowerups:{},input:{left:!1,right:!1},events:[],frameCount:0,serveTimer:0,levelTimer:0,wallFlash:0,startTime:null,winner:null}}function qk(e){if(e.phase==="ready"||e.phase==="gameover")return{...e,frameCount:e.frameCount+1};let t={...e,events:[],frameCount:e.frameCount+1};if(t.phase==="levelup"){if(t.levelTimer--,t.levelTimer<=0){const i=t.level+1;if(i>tn.MAX_LEVELS)return{...t,phase:"gameover",winner:"player",events:["victory"]};const r=ct.BASE_SPEED+(i-1)*ct.SPEED_INCREMENT;return{...t,phase:"serving",level:i,bricks:Ev(i),balls:[wm(r)],powerups:[],activePowerups:{},paddle:{...t.paddle,w:va.WIDTH},serveTimer:tn.SERVE_DELAY,combo:0}}return t}if(t.phase==="serving"){t=pT(t);const i=t.balls[0];return i&&i.stuck&&(t.balls=[{...i,x:t.paddle.x+t.paddle.w/2,y:t.paddle.y-ct.RADIUS-2}]),t.serveTimer--,t}if(t=pT(t),t=Wk(t),t=Yk(t),t=Fk(t),t=Xk(t),t.wallFlash>0&&(t={...t,wallFlash:t.wallFlash-1}),t.bricks.length===0)return{...t,phase:"levelup",levelTimer:tn.LEVEL_DELAY,events:[...t.events,"level_complete"]};if(t.balls.length===0){const i=t.lives-1;if(i<=0)return{...t,lives:0,phase:"gameover",winner:"computer",events:[...t.events,"game_over"]};const r=ct.BASE_SPEED+(t.level-1)*ct.SPEED_INCREMENT;return{...t,lives:i,balls:[wm(r)],phase:"serving",serveTimer:tn.SERVE_DELAY,combo:0,activePowerups:{},paddle:{...t.paddle,w:va.WIDTH},events:[...t.events,"ball_lost"]}}return t}function Gc(e){if(e.phase!=="serving")return e;const t=e.balls[0];if(!t||!t.stuck)return e;const i=t.speed||ct.BASE_SPEED,r=-(Math.PI/6+Math.random()*Math.PI/6),o=e.input.left?-1:e.input.right||Math.random()>.5?1:-1;return{...e,phase:"playing",balls:[{...t,stuck:!1,vx:Math.cos(r)*i*o,vy:-Math.abs(Math.sin(r)*i)}],events:[...e.events,"serve"]}}function pT(e){let t=e.paddle.x;const i=va.SPEED;return e.input.left&&(t-=i),e.input.right&&(t+=i),t=Math.max(0,Math.min(se.WIDTH-e.paddle.w,t)),{...e,paddle:{...e.paddle,x:t}}}function Yk(e){let t=[...e.events],i=[...e.bricks],r=[...e.particles],o=[...e.powerups],u=e.score,c=e.combo,m=e.wallFlash;const _=e.activePowerups.SLOW>0,p=[];for(const y of e.balls){if(y.stuck){p.push(y);continue}let v=y.x+y.vx*(_?.6:1),w=y.y+y.vy*(_?.6:1),R=y.vx,M=y.vy;if(v-ct.RADIUS<=0&&(v=ct.RADIUS,R=Math.abs(R),t.push("wall"),m=6),v+ct.RADIUS>=se.WIDTH&&(v=se.WIDTH-ct.RADIUS,R=-Math.abs(R),t.push("wall"),m=6),w-ct.RADIUS<=0&&(w=ct.RADIUS,M=Math.abs(M),t.push("wall"),m=6),w+ct.RADIUS>se.HEIGHT+10)continue;const V=e.paddle;if(M>0&&w+ct.RADIUS>=V.y&&w+ct.RADIUS<=V.y+V.h+4&&v>=V.x-2&&v<=V.x+V.w+2){const L=(v-V.x)/V.w,O=-(Math.PI*.15+L*Math.PI*.7),G=Math.sqrt(R*R+M*M);R=Math.cos(O)*G,M=Math.sin(O)*G,w=V.y-ct.RADIUS-1,t.push("paddle"),c=0}for(let L=i.length-1;L>=0;L--){const O=i[L];if(v+ct.RADIUS>O.x&&v-ct.RADIUS<O.x+O.w&&w+ct.RADIUS>O.y&&w-ct.RADIUS<O.y+O.h){const G=v+ct.RADIUS-O.x,J=O.x+O.w-(v-ct.RADIUS),re=w+ct.RADIUS-O.y,Ce=O.y+O.h-(w-ct.RADIUS),we=Math.min(G,J,re,Ce);we===G||we===J?R=-R:M=-M;const k=O.hits-1;if(k<=0){i.splice(L,1),c++;const I=(tn.POINTS_PER_BRICK+(wi.ROWS-O.row)*tn.POINTS_BONUS_ROW)*Math.min(c,8);u+=I;for(let D=0;D<8;D++)r.push({x:O.x+O.w/2,y:O.y+O.h/2,vx:(Math.random()-.5)*4,vy:(Math.random()-.5)*4,life:20+Math.random()*20,color:O.color});if(Math.random()<tn.POWERUP_CHANCE){const D=Object.keys(eu),z=D[Math.floor(Math.random()*D.length)];o.push({x:O.x+O.w/2,y:O.y+O.h/2,type:z,vy:tn.POWERUP_SPEED})}t.push("brick_break")}else i[L]={...O,hits:k,color:k===1?ye.BRICK_SILVER:O.color},t.push("brick_hit");break}}p.push({...y,x:v,y:w,vx:R,vy:M})}return{...e,balls:p,bricks:i,particles:r,powerups:o,score:u,combo:c,events:t,wallFlash:m}}function Fk(e){let t=[...e.events],i={...e.activePowerups},r={...e.paddle},o=[...e.balls];const u=[];for(const c of e.powerups){const m=c.y+c.vy;if(m+tn.POWERUP_SIZE/2>=r.y&&m-tn.POWERUP_SIZE/2<=r.y+r.h&&c.x>=r.x&&c.x<=r.x+r.w){t.push("powerup");const _=eu[c.type];if(c.type==="WIDE")r={...r,w:Math.min(r.baseWidth*1.6,r.w*1.4)},i.WIDE=_.duration;else if(c.type==="SLOW")i.SLOW=_.duration;else if(c.type==="MULTI"){const p=[];for(const y of o){if(y.stuck){p.push(y);continue}const v=Math.sqrt(y.vx*y.vx+y.vy*y.vy),w=Math.atan2(y.vy,y.vx);p.push(y),p.push({...y,vx:Math.cos(w-.4)*v,vy:Math.sin(w-.4)*v}),p.push({...y,vx:Math.cos(w+.4)*v,vy:Math.sin(w+.4)*v})}o=p}continue}m>se.HEIGHT+20||u.push({...c,y:m})}return{...e,powerups:u,activePowerups:i,paddle:r,balls:o,events:t}}function Wk(e){const t={...e.activePowerups};let i=e.paddle;return t.WIDE>0&&(t.WIDE--,t.WIDE<=0&&(i={...i,w:i.baseWidth})),t.SLOW>0&&t.SLOW--,{...e,activePowerups:t,paddle:i}}function Xk(e){const t=e.particles.map(i=>({...i,x:i.x+i.vx,y:i.y+i.vy,vy:i.vy+.15,life:i.life-1})).filter(i=>i.life>0);return{...e,particles:t}}const dh=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),vv=[];for(let e=0;e<tn.SNOW_COUNT;e++)vv.push({x:Math.random()*se.WIDTH,y:Math.random()*se.HEIGHT,r:1+Math.random()*2.5,speed:.3+Math.random()*.7,drift:(Math.random()-.5)*.4,phase:Math.random()*Math.PI*2});function gT(e,t){e.imageSmoothingEnabled=!1,Kk(e,t),Qk(e,t),eD(e,t),tD(e,t),Zk(e,t),$k(e,t),nD(e,t),t.phase==="ready"&&aD(e,t),t.phase==="gameover"&&oD(e,t),t.phase==="levelup"&&sD(e,t),t.phase==="serving"&&rD(e)}function Kk(e,t){const i=e.createLinearGradient(0,0,0,se.HEIGHT);i.addColorStop(0,ye.SKY_TOP),i.addColorStop(.5,ye.SKY_MID),i.addColorStop(1,ye.SKY_BOT),e.fillStyle=i,e.fillRect(0,0,se.WIDTH,se.HEIGHT);const r=t.frameCount;for(let o=0;o<50;o++){const u=(o*127+23)%se.WIDTH,c=(o*89+11)%(se.HEIGHT*.35),m=Math.sin(r*.02+o*2.1)*.3+.5;e.fillStyle=`rgba(200,220,255,${m*.5})`;const _=o%3===0?2:1.5;e.fillRect(u,c,_,_)}e.fillStyle=ye.SNOW_PARTICLE;for(const o of vv){const u=r*o.speed%se.HEIGHT,c=(o.y+u)%se.HEIGHT,m=o.x+Math.sin(r*.015+o.phase)*8*o.drift,_=.15+o.r*.12;e.globalAlpha=_,e.beginPath(),e.arc((m%se.WIDTH+se.WIDTH)%se.WIDTH,c,o.r,0,Math.PI*2),e.fill()}if(e.globalAlpha=1,t.wallFlash>0){const o=t.wallFlash/6;e.fillStyle=`rgba(180,220,255,${o*.25})`,e.fillRect(0,0,4,se.HEIGHT),e.fillRect(se.WIDTH-4,0,4,se.HEIGHT),e.fillStyle=`rgba(180,220,255,${o*.2})`,e.fillRect(0,0,se.WIDTH,4)}e.fillStyle="rgba(0,0,0,0.04)";for(let o=0;o<se.HEIGHT;o+=3)e.fillRect(0,o,se.WIDTH,1)}function Qk(e,t){for(const i of t.bricks){e.fillStyle=ye.BRICK_SHADOW,e.fillRect(i.x+2,i.y+2,i.w,i.h);let r=i.color;i.hits<i.maxHits&&i.hits===2&&(r=ye.BRICK_SILVER),i.hits<i.maxHits&&i.hits===1&&(r=ye.BRICK_ROWS[i.row]||"#CCCCCC"),e.fillStyle=r,e.fillRect(i.x,i.y,i.w,i.h);const o=i.row*31+i.col*17;e.fillStyle="rgba(255,255,255,0.3)";for(let u=0;u<4;u++){const c=i.x+(o+u*13)%(i.w-4)+2,m=i.y+(o+u*7)%(i.h-3)+1;e.fillRect(c,m,2,1)}if(e.fillStyle=ye.BRICK_HIGHLIGHT,e.fillRect(i.x,i.y,i.w,3),e.fillRect(i.x,i.y,3,i.h),e.fillStyle=ye.BRICK_SHADOW,e.fillRect(i.x,i.y+i.h-2,i.w,2),e.fillRect(i.x+i.w-2,i.y,2,i.h),i.hits<i.maxHits&&(e.strokeStyle="rgba(100,140,180,0.5)",e.lineWidth=1,e.beginPath(),e.moveTo(i.x+i.w*.2,i.y+1),e.lineTo(i.x+i.w*.4,i.y+i.h*.5),e.lineTo(i.x+i.w*.3,i.y+i.h-1),e.stroke(),e.beginPath(),e.moveTo(i.x+i.w*.6,i.y+2),e.lineTo(i.x+i.w*.7,i.y+i.h*.6),e.stroke()),i.maxHits>=3&&i.hits>=2){const u=Math.sin(t.frameCount*.06+i.col*.8)*.12+.08;e.fillStyle=`rgba(150,210,255,${u})`,e.fillRect(i.x+3,i.y+3,i.w-6,i.h-6)}}}let Cn=1,yT=0;function $k(e,t){const i=t.paddle,r=t.frameCount,o=i.x-yT;o>.5?Cn=1:o<-.5&&(Cn=-1),yT=i.x;const u=Math.abs(o)>.3;i.x+i.w/2;const c=i.y;e.save();const m=i.w*.55,_=i.h,p=Cn>0?i.x+i.w-m:i.x;e.shadowColor="rgba(200,80,40,0.3)",e.shadowBlur=10,e.fillStyle=ye.SLEIGH_RUNNER;const y=4;rr(e,p-(Cn>0?y:0),c+_-3,m+y,4,2),e.fill();const v=Cn>0?p-y:p+m;e.beginPath(),e.arc(v+(Cn>0?0:y),c+_-5,4,Cn>0?Math.PI*.5:0,Cn>0?Math.PI:Math.PI*.5),e.strokeStyle=ye.SLEIGH_RUNNER,e.lineWidth=2,e.stroke(),e.fillStyle=ye.SLEIGH_RED,rr(e,p,c,m,_-2,3),e.fill(),e.fillStyle=ye.SLEIGH_DARK,e.fillRect(p+2,c+_*.5,m-4,_*.35),e.fillStyle=ye.SLEIGH_TRIM,e.fillRect(p+2,c+2,m-4,2);const w=Cn>0?p:p+m-3;e.fillRect(w,c+2,3,_-5),e.fillStyle="rgba(255,255,255,0.2)",e.fillRect(p+4,c+1,m*.5,2);const R=Cn>0?p+m-10:p+4;e.fillStyle="#556B2F",e.beginPath(),e.arc(R+3,c-1,5,Math.PI,0),e.fill(),e.fillRect(R,c-1,7,4),e.fillStyle=ye.SLEIGH_TRIM,e.fillRect(R+2,c-3,3,2),e.shadowBlur=0;const M=Cn>0?p:p+m,V=Cn>0?i.x+i.w*.18:i.x+i.w*.82,L=c+4;e.strokeStyle=ye.HARNESS,e.lineWidth=1.2,e.setLineDash([3,2]),e.beginPath(),e.moveTo(M,c+3),e.lineTo(V,L-2),e.stroke(),e.beginPath(),e.moveTo(M,c+6),e.lineTo(V,L+2),e.stroke(),e.setLineDash([]);const O=V,G=c+2;e.save(),e.translate(O,G),Cn<0&&e.scale(-1,1);const J=u?Math.floor(r*.15)%4:0,re=[[0,0,0,0],[-1,1,1,-1],[0,0,0,0],[1,-1,-1,1]][J];e.fillStyle=ye.DEER_DARK;const Ce=4,we=5;e.fillRect(-4,Ce,2,we+re[0]),e.fillRect(-1,Ce,2,we+re[1]),e.fillRect(4,Ce,2,we+re[2]),e.fillRect(7,Ce,2,we+re[3]),e.fillStyle=ye.DEER_DARK,e.fillRect(-4,Ce+we+re[0]-1,2,1),e.fillRect(-1,Ce+we+re[1]-1,2,1),e.fillRect(4,Ce+we+re[2]-1,2,1),e.fillRect(7,Ce+we+re[3]-1,2,1),e.fillStyle=ye.DEER_BODY,rr(e,-5,-2,14,8,3),e.fill(),e.fillStyle=ye.DEER_LIGHT,e.fillRect(-2,2,8,3),e.fillStyle=ye.DEER_BODY,e.fillRect(8,-4,4,6),e.fillStyle=ye.DEER_BODY,rr(e,10,-6,7,5,2),e.fill(),e.fillStyle=ye.DEER_LIGHT,e.fillRect(13,-8,2,3),e.fillStyle="#000000",e.fillRect(15,-5,2,2),e.fillStyle="#FFFFFF",e.fillRect(15,-5,1,1),e.fillStyle=ye.DEER_NOSE,e.beginPath(),e.arc(18,-3,2,0,Math.PI*2),e.fill();const k=Math.sin(r*.08)*.2+.3;if(e.fillStyle=`rgba(255,80,60,${k})`,e.beginPath(),e.arc(18,-3,4,0,Math.PI*2),e.fill(),e.strokeStyle=ye.DEER_ANTLER,e.lineWidth=1.5,e.lineCap="round",e.beginPath(),e.moveTo(11,-7),e.lineTo(9,-13),e.stroke(),e.beginPath(),e.moveTo(9,-11),e.lineTo(7,-14),e.stroke(),e.beginPath(),e.moveTo(9,-11),e.lineTo(11,-14),e.stroke(),e.beginPath(),e.moveTo(14,-7),e.lineTo(15,-13),e.stroke(),e.beginPath(),e.moveTo(15,-11),e.lineTo(13,-14),e.stroke(),e.beginPath(),e.moveTo(15,-11),e.lineTo(17,-14),e.stroke(),e.fillStyle=ye.DEER_LIGHT,e.beginPath(),e.arc(-6,-1,2,0,Math.PI*2),e.fill(),e.restore(),e.restore(),t.activePowerups.WIDE>0){const I=Math.sin(r*.15)*.3+.4;e.strokeStyle=`rgba(255,215,0,${I})`,e.lineWidth=2,rr(e,i.x-1,i.y-1,i.w+2,i.h+2,4),e.stroke(),e.fillStyle=`rgba(255,215,0,${I+.2})`;const D=c+4;for(let z=0;z<3;z++){const H=M+(V-M)*((z+1)/4);e.beginPath(),e.arc(H,D,2,0,Math.PI*2),e.fill()}}if(u&&Math.abs(o)>1.5){const I=Cn>0?i.x+i.w-2:i.x+2;e.fillStyle=`rgba(255,255,255,${.15+Math.random()*.1})`;for(let D=0;D<2;D++){const z=I+(Math.random()-.5)*6,H=c+i.h-2+Math.random()*4;e.beginPath(),e.arc(z,H,1+Math.random()*1.5,0,Math.PI*2),e.fill()}}}function Zk(e,t){for(const i of t.balls){const r=t.frameCount;if(!i.stuck&&t.phase==="playing"&&(eo(e,i.x-i.vx*2,i.y-i.vy*2,3,r*.8,.2),eo(e,i.x-i.vx*4,i.y-i.vy*4,2,r*.5,.1)),e.shadowColor=ye.BALL_GLOW,e.shadowBlur=14,Jk(e,i.x,i.y,ct.RADIUS,r),e.shadowBlur=0,t.activePowerups.SLOW>0){const o=Math.sin(r*.1)*.3+.4;e.strokeStyle=`rgba(136,187,255,${o})`,e.lineWidth=2,e.beginPath(),e.arc(i.x,i.y,ct.RADIUS+5,0,Math.PI*2),e.stroke()}}}function Jk(e,t,i,r,o){const u=o*.03,c=r*1.3;e.save(),e.translate(t,i),e.rotate(u),e.strokeStyle="#FFFFFF",e.lineWidth=1.8,e.lineCap="round";for(let m=0;m<6;m++){const _=m*Math.PI/3,p=Math.cos(_)*c,y=Math.sin(_)*c;e.beginPath(),e.moveTo(0,0),e.lineTo(p,y),e.stroke();const v=c*.4,w=.6,R=Math.cos(_)*c*w,M=Math.sin(_)*c*w;e.lineWidth=1.2,e.beginPath(),e.moveTo(R,M),e.lineTo(R+Math.cos(_+.6)*v,M+Math.sin(_+.6)*v),e.stroke(),e.beginPath(),e.moveTo(R,M),e.lineTo(R+Math.cos(_-.6)*v,M+Math.sin(_-.6)*v),e.stroke(),e.lineWidth=1.8}e.fillStyle="#FFFFFF",e.beginPath(),e.arc(0,0,1.5,0,Math.PI*2),e.fill(),e.restore()}function eo(e,t,i,r,o,u){e.globalAlpha=u,e.save(),e.translate(t,i),e.rotate(o*.05),e.strokeStyle=ye.SNOWFLAKE,e.lineWidth=.8;for(let c=0;c<6;c++){const m=c*Math.PI/3;e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(m)*r,Math.sin(m)*r),e.stroke()}e.restore(),e.globalAlpha=1}function eD(e,t){for(const i of t.powerups){const r=eu[i.type],o=Math.sin(t.frameCount*.08+i.x)*2;e.shadowColor=r.color,e.shadowBlur=8,e.fillStyle=r.color,rr(e,i.x-tn.POWERUP_SIZE,i.y+o-tn.POWERUP_SIZE/2,tn.POWERUP_SIZE*2,tn.POWERUP_SIZE,tn.POWERUP_SIZE/2),e.fill(),e.fillStyle="#000000",e.font=Xt.TINY,e.textAlign="center",e.textBaseline="middle",e.fillText(r.label,i.x,i.y+o),e.shadowBlur=0}}function tD(e,t){for(const i of t.particles){const r=i.life/40;e.globalAlpha=r,e.fillStyle=i.color||ye.PARTICLE,e.beginPath(),e.arc(i.x,i.y,1.5+Math.random()*.5,0,Math.PI*2),e.fill(),i.life>15&&(e.fillStyle="rgba(255,255,255,0.8)",e.fillRect(i.x-.5,i.y-.5,1,1))}e.globalAlpha=1}function nD(e,t){if(t.phase==="ready")return;e.fillStyle=ye.TEXT_WHITE,e.font=Xt.HUD,e.textAlign="left",e.textBaseline="top",e.fillText(`SCORE ${String(t.score).padStart(6,"0")}`,10,10),e.textAlign="center",e.fillStyle=ye.TEXT_ICE,e.fillText(`LVL ${t.level}`,se.WIDTH/2,10),e.textAlign="right";for(let r=0;r<t.lives;r++)iD(e,se.WIDTH-16-r*22,18);if(t.combo>1){const r=Math.sin(t.frameCount*.12)*.3+.7;e.fillStyle=`rgba(255,221,0,${r})`,e.font=Xt.SMALL,e.textAlign="center",e.fillText(`${t.combo}x COMBO!`,se.WIDTH/2,36)}let i=54;e.font=Xt.TINY,e.textAlign="center",t.activePowerups.WIDE>0&&(e.fillStyle=eu.WIDE.color,e.fillText(`WIDE ${Math.ceil(t.activePowerups.WIDE/60)}s`,se.WIDTH/2,i),i+=16),t.activePowerups.SLOW>0&&(e.fillStyle=eu.SLOW.color,e.fillText(`FREEZE ${Math.ceil(t.activePowerups.SLOW/60)}s`,se.WIDTH/2,i))}function iD(e,t,i){e.strokeStyle=ye.TEXT_ICE,e.lineWidth=1.5;const r=6;for(let o=0;o<6;o++){const u=o*Math.PI/3;e.beginPath(),e.moveTo(t,i),e.lineTo(t+Math.cos(u)*r,i+Math.sin(u)*r),e.stroke()}e.fillStyle=ye.TEXT_ICE,e.beginPath(),e.arc(t,i,1.5,0,Math.PI*2),e.fill()}function aD(e,t){e.fillStyle="rgba(5,10,25,0.8)",e.fillRect(0,0,se.WIDTH,se.HEIGHT);const i=t.frameCount;eo(e,80,se.HEIGHT*.25,12,i*.3,.3),eo(e,se.WIDTH-80,se.HEIGHT*.35,10,i*.4,.25),eo(e,60,se.HEIGHT*.5,8,i*.5,.2),eo(e,se.WIDTH-60,se.HEIGHT*.22,9,i*.35,.22),e.shadowColor=ye.TEXT_ICE,e.shadowBlur=25,e.fillStyle="#FFFFFF",e.font=Xt.TITLE,e.textAlign="center",e.textBaseline="middle",e.fillText("ICE",se.WIDTH/2,se.HEIGHT*.28),e.fillText("BREAKER",se.WIDTH/2,se.HEIGHT*.38),e.shadowBlur=0,e.fillStyle=ye.TEXT_GOLD,e.font=Xt.SUBTITLE,e.fillText("SNOWPEAK ARCADE",se.WIDTH/2,se.HEIGHT*.48);const r=se.WIDTH/2-160,o=se.HEIGHT*.56,u=320,c=130;e.fillStyle="rgba(10,20,40,0.85)",e.strokeStyle=ye.TEXT_ICE,e.lineWidth=2,rr(e,r,o,u,c,8),e.fill(),rr(e,r,o,u,c,8),e.stroke(),e.fillStyle=ye.TEXT_DIM,e.font=Xt.SMALL,dh?(e.fillText("SLIDE to move paddle",se.WIDTH/2,o+28),e.fillText("TAP to serve the ball",se.WIDTH/2,o+52)):(e.fillText("  or MOUSE to move",se.WIDTH/2,o+28),e.fillText("SPACE to serve the ball",se.WIDTH/2,o+52)),e.fillText("Smash the snow bricks!",se.WIDTH/2,o+76),e.fillText(`${tn.MAX_LEVELS} levels to conquer`,se.WIDTH/2,o+100),Math.floor(Date.now()/500)%2&&(e.fillStyle=ye.TEXT_WHITE,e.font=Xt.OVERLAY,e.fillText(dh?"TAP TO START":"PRESS START",se.WIDTH/2,se.HEIGHT*.88))}function rD(e,t){Math.floor(Date.now()/400)%2&&(e.fillStyle=ye.TEXT_ICE,e.font=Xt.SMALL,e.textAlign="center",e.textBaseline="middle",e.fillText(dh?"TAP TO SERVE":"PRESS SPACE TO SERVE",se.WIDTH/2,se.HEIGHT*.7))}function sD(e,t){e.fillStyle="rgba(5,10,25,0.6)",e.fillRect(0,0,se.WIDTH,se.HEIGHT);const i=Math.sin(t.frameCount*.1)*.3+.7;e.shadowColor=ye.TEXT_ICE,e.shadowBlur=15,e.fillStyle=`rgba(170,221,255,${i})`,e.font=Xt.BIG,e.textAlign="center",e.textBaseline="middle",e.fillText("LEVEL CLEAR!",se.WIDTH/2,se.HEIGHT*.4),e.shadowBlur=0,e.fillStyle=ye.TEXT_GOLD,e.font=Xt.SUBTITLE,e.fillText(`SCORE: ${t.score}`,se.WIDTH/2,se.HEIGHT*.52)}function oD(e,t){e.fillStyle="rgba(5,10,25,0.8)",e.fillRect(0,0,se.WIDTH,se.HEIGHT),t.winner==="player"?(e.shadowColor=ye.TEXT_GOLD,e.shadowBlur=20,e.fillStyle=ye.TEXT_GOLD,e.font=Xt.TITLE,e.textAlign="center",e.textBaseline="middle",e.fillText("VICTORY!",se.WIDTH/2,se.HEIGHT*.3),e.shadowBlur=0,e.fillStyle=ye.TEXT_WHITE,e.font=Xt.SUBTITLE,e.fillText("ALL LEVELS CLEARED",se.WIDTH/2,se.HEIGHT*.42),e.fillStyle=ye.TEXT_ICE,e.font=Xt.OVERLAY,e.fillText("FINAL SCORE",se.WIDTH/2,se.HEIGHT*.54),e.fillStyle=ye.TEXT_GOLD,e.font=Xt.BIG,e.fillText(`${t.score}`,se.WIDTH/2,se.HEIGHT*.62)):(e.shadowColor="#4488BB",e.shadowBlur=15,e.fillStyle=ye.TEXT_ICE,e.font=Xt.TITLE,e.textAlign="center",e.textBaseline="middle",e.fillText("FROZEN OUT",se.WIDTH/2,se.HEIGHT*.3),e.shadowBlur=0,e.fillStyle=ye.TEXT_DIM,e.font=Xt.SUBTITLE,e.fillText(`REACHED LEVEL ${t.level}`,se.WIDTH/2,se.HEIGHT*.42),e.fillStyle=ye.TEXT_WHITE,e.font=Xt.OVERLAY,e.fillText(`SCORE: ${t.score}`,se.WIDTH/2,se.HEIGHT*.54)),Math.floor(Date.now()/500)%2&&(e.fillStyle=ye.TEXT_DIM,e.font=Xt.SMALL,e.fillText(dh?"TAP TO CONTINUE":"PRESS SPACE TO CONTINUE",se.WIDTH/2,se.HEIGHT*.8))}function rr(e,t,i,r,o,u){e.beginPath(),e.moveTo(t+u,i),e.lineTo(t+r-u,i),e.quadraticCurveTo(t+r,i,t+r,i+u),e.lineTo(t+r,i+o-u),e.quadraticCurveTo(t+r,i+o,t+r-u,i+o),e.lineTo(t+u,i+o),e.quadraticCurveTo(t,i+o,t,i+o-u),e.lineTo(t,i+u),e.quadraticCurveTo(t,i,t+u,i),e.closePath()}let jc=null;function Ki(){return(!jc||jc.state==="closed")&&(jc=new(window.AudioContext||window.webkitAudioContext)),jc}function TT(e){try{const t=lD[e];t&&t()}catch{}}const lD={paddle(){const e=Ki(),t=e.createOscillator(),i=e.createGain();t.type="square",t.frequency.setValueAtTime(440,e.currentTime),t.frequency.exponentialRampToValueAtTime(880,e.currentTime+.05),i.gain.setValueAtTime(.15,e.currentTime),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.1),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.1)},brick_hit(){const e=Ki(),t=e.createOscillator(),i=e.createGain();t.type="triangle",t.frequency.setValueAtTime(220,e.currentTime),t.frequency.exponentialRampToValueAtTime(110,e.currentTime+.08),i.gain.setValueAtTime(.12,e.currentTime),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.08),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.1)},brick_break(){const e=Ki(),t=e.currentTime,i=e.createOscillator(),r=e.createGain();i.type="square",i.frequency.setValueAtTime(600,t),i.frequency.exponentialRampToValueAtTime(1200,t+.04),r.gain.setValueAtTime(.12,t),r.gain.exponentialRampToValueAtTime(.001,t+.08),i.connect(r),r.connect(e.destination),i.start(),i.stop(t+.1);const o=e.createBuffer(1,e.sampleRate*.06,e.sampleRate),u=o.getChannelData(0);for(let p=0;p<u.length;p++)u[p]=(Math.random()*2-1)*.15;const c=e.createBufferSource();c.buffer=o;const m=e.createGain();m.gain.setValueAtTime(.08,t+.03),m.gain.exponentialRampToValueAtTime(.001,t+.1);const _=e.createBiquadFilter();_.type="bandpass",_.frequency.value=2e3,c.connect(_),_.connect(m),m.connect(e.destination),c.start(t+.03),c.stop(t+.12)},wall(){const e=Ki(),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(330,e.currentTime),i.gain.setValueAtTime(.06,e.currentTime),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.04),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.05)},serve(){const e=Ki(),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(200,e.currentTime),t.frequency.exponentialRampToValueAtTime(800,e.currentTime+.12),i.gain.setValueAtTime(.08,e.currentTime),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.15),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.15)},ball_lost(){const e=Ki(),t=e.createOscillator(),i=e.createGain();t.type="square",t.frequency.setValueAtTime(440,e.currentTime),t.frequency.exponentialRampToValueAtTime(110,e.currentTime+.4),i.gain.setValueAtTime(.12,e.currentTime),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.4),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.45)},powerup(){const e=Ki(),t=e.currentTime;[523,659,784].forEach((r,o)=>{const u=e.createOscillator(),c=e.createGain();u.type="square",u.frequency.setValueAtTime(r,t+o*.06),c.gain.setValueAtTime(.1,t+o*.06),c.gain.exponentialRampToValueAtTime(.001,t+o*.06+.12),u.connect(c),c.connect(e.destination),u.start(t+o*.06),u.stop(t+o*.06+.15)})},level_complete(){const e=Ki(),t=e.currentTime;[523,659,784,1047].forEach((r,o)=>{const u=e.createOscillator(),c=e.createGain();u.type="square",u.frequency.setValueAtTime(r,t+o*.12),c.gain.setValueAtTime(.12,t+o*.12),c.gain.exponentialRampToValueAtTime(.001,t+o*.12+.3),u.connect(c),c.connect(e.destination),u.start(t+o*.12),u.stop(t+o*.12+.35)})},victory(){const e=Ki(),t=e.currentTime;[523,659,784,659,784,1047].forEach((r,o)=>{const u=e.createOscillator(),c=e.createGain();u.type="square",u.frequency.setValueAtTime(r,t+o*.15),c.gain.setValueAtTime(.13,t+o*.15),c.gain.exponentialRampToValueAtTime(.001,t+o*.15+.3),u.connect(c),c.connect(e.destination),u.start(t+o*.15),u.stop(t+o*.15+.35)})},game_over(){const e=Ki(),t=e.currentTime;[392,330,262,196].forEach((r,o)=>{const u=e.createOscillator(),c=e.createGain();u.type="sawtooth",u.frequency.setValueAtTime(r,t+o*.2),c.gain.setValueAtTime(.1,t+o*.2),c.gain.exponentialRampToValueAtTime(.001,t+o*.2+.35),u.connect(c),c.connect(e.destination),u.start(t+o*.2),u.stop(t+o*.2+.4)})}},ET=()=>typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0);function m_({standalone:e=!1,onGameOver:t}){const i=ae.useRef(null),r=ae.useRef(_T()),o=ae.useRef(null),u=ae.useRef(null),[c,m]=ae.useState(ET);ae.useEffect(()=>{const O=()=>{const G=window.innerHeight*.01;document.documentElement.style.setProperty("--wo-vh",`${G}px`)};return O(),window.addEventListener("resize",O),window.addEventListener("orientationchange",()=>{setTimeout(O,150)}),()=>{window.removeEventListener("resize",O)}},[]),ae.useEffect(()=>{const O=()=>m(ET());return window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]),ae.useCallback((O,G)=>{const J=i.current;if(!J)return null;const re=J.getBoundingClientRect(),Ce=se.WIDTH/re.width,we=se.HEIGHT/re.height;return{x:(O-re.left)*Ce,y:(G-re.top)*we}},[]);const _=ae.useCallback(()=>{const O=r.current;if(O.events.length>0)for(const re of O.events)TT(re);const G=qk({...O,events:[]});r.current=G;for(const re of G.events)TT(re);const J=i.current;if(J){const re=J.getContext("2d");gT(re,G)}o.current=requestAnimationFrame(_)},[]);ae.useEffect(()=>{const O=i.current;if(O){const G=O.getContext("2d");gT(G,r.current)}return o.current=requestAnimationFrame(_),()=>{o.current&&cancelAnimationFrame(o.current)}},[_]);const p=ae.useCallback(O=>{e?r.current={..._T(),phase:"ready"}:t&&t({score:O.score,level:O.level,won:O.winner==="player"})},[e,t]);ae.useEffect(()=>{const O=J=>{const re=r.current;if(J.key===" "||J.code==="Space"){if(J.preventDefault(),re.phase==="ready"){r.current={...re,phase:"serving",startTime:Date.now()};return}if(re.phase==="serving"){r.current=Gc(re);return}if(re.phase==="gameover"){p(re);return}}if(J.key==="Escape"){J.preventDefault(),!e&&t&&t({score:re.score,level:re.level,won:!1});return}J.key==="ArrowLeft"&&(J.preventDefault(),r.current={...r.current,input:{...r.current.input,left:!0}}),J.key==="ArrowRight"&&(J.preventDefault(),r.current={...r.current,input:{...r.current.input,right:!0}})},G=J=>{J.key==="ArrowLeft"&&(r.current={...r.current,input:{...r.current.input,left:!1}}),J.key==="ArrowRight"&&(r.current={...r.current,input:{...r.current.input,right:!1}})};return window.addEventListener("keydown",O),window.addEventListener("keyup",G),()=>{window.removeEventListener("keydown",O),window.removeEventListener("keyup",G)}},[e,t,p]);const y=ae.useRef(null),v=ae.useCallback((O,G)=>{const J=r.current;if(J.phase==="ready"){r.current={...J,phase:"serving",startTime:Date.now()};return}if(J.phase==="serving"){r.current=Gc(J);return}if(J.phase==="gameover"){p(J);return}},[p]),w=ae.useCallback(O=>{const G=r.current;if(G.phase!=="playing"&&G.phase!=="serving")return;const J=i.current;if(!J)return;const re=J.getBoundingClientRect(),Ce=se.WIDTH/re.width,we=(O-re.left)*Ce,k=Math.max(0,Math.min(se.WIDTH-G.paddle.w,we-G.paddle.w/2));if(r.current={...G,paddle:{...G.paddle,x:k}},G.phase==="serving"&&G.balls[0]&&G.balls[0].stuck){const I=G.balls[0];r.current={...r.current,balls:[{...I,x:k+G.paddle.w/2}]}}},[]),R=ae.useCallback((O,G)=>{r.current={...r.current,input:{...r.current.input,[O]:G}}},[]),M=ae.useCallback(()=>{const O=r.current;O.phase==="ready"?r.current={...O,phase:"serving",startTime:Date.now()}:O.phase==="serving"?r.current=Gc(O):O.phase==="gameover"&&p(O)},[p]),V=ae.useCallback(O=>{O.preventDefault();const G=O.touches[0];if(!G)return;y.current={x:G.clientX,y:G.clientY,time:Date.now()};const J=r.current;if(J.phase==="ready"||J.phase==="gameover"){v(G.clientX,G.clientY);return}w(G.clientX),J.phase==="serving"&&(r.current=Gc(J))},[v,w]),L=ae.useCallback(O=>{O.preventDefault();const G=O.touches[0];G&&w(G.clientX)},[w]);return ae.useEffect(()=>{const O=u.current;if(!O)return;const G=J=>{J.target.closest(".wo-game-container")&&J.preventDefault()};return O.addEventListener("touchmove",G,{passive:!1}),()=>O.removeEventListener("touchmove",G)},[]),S.jsx("div",{className:"slalom-container wo-game-container",ref:u,children:S.jsxs("div",{className:"arcade-cabinet",children:[S.jsx("div",{className:"arcade-top"}),S.jsx("div",{className:"arcade-marquee wo-marquee",children:"ICE BREAKER"}),S.jsx("div",{className:"arcade-screen-bezel wo-screen-bezel",children:S.jsx("canvas",{ref:i,width:se.WIDTH,height:se.HEIGHT,className:"slalom-canvas",style:{cursor:"pointer",touchAction:"none"},onClick:O=>v(O.clientX,O.clientY),onMouseMove:O=>w(O.clientX),onTouchStart:V,onTouchMove:L})}),c?S.jsx("div",{className:"arcade-controls wo-controls-mobile",children:S.jsxs("div",{className:"arcade-controls-inner wo-controls-inner-mobile",children:[S.jsx("button",{className:"arcade-touch-btn wo-mobile-btn",onTouchStart:O=>{O.preventDefault(),R("left",!0)},onTouchEnd:O=>{O.preventDefault(),R("left",!1)},children:""}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-start wo-mobile-btn",onTouchStart:O=>{O.preventDefault(),M()},children:"START"}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-throw wo-mobile-btn",onTouchStart:O=>{O.preventDefault(),M()},children:"SERVE"}),S.jsx("button",{className:"arcade-touch-btn wo-mobile-btn",onTouchStart:O=>{O.preventDefault(),R("right",!0)},onTouchEnd:O=>{O.preventDefault(),R("right",!1)},children:""})]})}):S.jsx("div",{className:"arcade-controls",children:S.jsxs("div",{className:"arcade-controls-inner",children:[S.jsx("button",{className:"arcade-touch-btn",onTouchStart:O=>{O.preventDefault(),R("left",!0)},onTouchEnd:O=>{O.preventDefault(),R("left",!1)},onMouseDown:()=>R("left",!0),onMouseUp:()=>R("left",!1),onMouseLeave:()=>R("left",!1),children:""}),S.jsx("button",{className:"arcade-touch-btn",onTouchStart:O=>{O.preventDefault(),R("right",!0)},onTouchEnd:O=>{O.preventDefault(),R("right",!1)},onMouseDown:()=>R("right",!0),onMouseUp:()=>R("right",!1),onMouseLeave:()=>R("right",!1),children:""}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-start",onTouchStart:O=>{O.preventDefault(),M()},onMouseDown:M,children:"START"}),S.jsx("button",{className:"arcade-touch-btn arcade-touch-throw",onTouchStart:O=>{O.preventDefault(),M()},onMouseDown:M,children:"SERVE"})]})}),S.jsx("div",{className:"arcade-base"})]})})}function uD({onBack:e}){const[t,i]=ae.useState("menu"),r=ae.useCallback(()=>{i("menu")},[]),o=ae.useCallback(()=>{i("menu")},[]),u=ae.useCallback(()=>{i("menu")},[]),c=ae.useCallback(()=>{i("menu")},[]);return ae.useEffect(()=>{const m=_=>{const p=_.key;t==="menu"?p==="1"?i("slalom"):p==="2"?i("defend"):p==="3"?i("snowball"):p==="4"?i("icebreaker"):p==="5"?i("trailer"):p==="6"?i("notes"):p==="7"&&e():t==="notes"&&(p==="Escape"||p==="b"||p==="B")&&i("menu")};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[t,e]),t==="slalom"?S.jsx(c_,{standalone:!1,onGameOver:r}):t==="defend"?S.jsx(f_,{standalone:!1,onGameOver:o}):t==="snowball"?S.jsx(d_,{standalone:!1,onGameOver:u}):t==="icebreaker"?S.jsx(m_,{standalone:!1,onGameOver:c}):t==="trailer"?S.jsx(Tv,{onBack:()=>i("menu")}):t==="notes"?S.jsxs("div",{className:"terminal",children:[S.jsxs("div",{className:"terminal-output",children:[S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-ascii welcome-art",children:`         *  .  *  .  *  .  *  .  *
      .     *     .     *     .
            .  *  .  *  .  *
               *  .  *
                 /\\
                /  \\         *  .  *
               / /\\ \\       .  *  .
              / /  \\ \\        *  .
             / /    \\ \\      .  *
            /  \\    /  \\
           /____\\  /____\\
          / ~~~~ SNOWPEAK ~~~~ \\
         / ~~~~~ RESORT  ~~~~~ \\
        /________________________\\
       /     est. 1976            \\
      /____________________________\\`}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"welcome-title",children:"RELEASE NOTES"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-system",children:"=".repeat(40)}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.9 -- Ice Breaker"}),S.jsx("div",{className:"output-line output-normal",children:"  - New arcade mini-game: Ice Breaker!"}),S.jsx("div",{className:"output-line output-normal",children:"  - Classic brick-breaking action with 5 levels"}),S.jsx("div",{className:"output-line output-normal",children:"  - Powerups: wide paddle, multiball, slow motion"}),S.jsx("div",{className:"output-line output-normal",children:"  - Hidden arcade cabinet in the Summit Shelter (expert mode)"}),S.jsx("div",{className:"output-line output-normal",children:"  - Requires bag of tokens to play"}),S.jsx("div",{className:"output-line output-normal",children:"  - Combo scoring system for consecutive hits"}),S.jsx("div",{className:"output-line output-normal",children:"  - Touch/click and keyboard controls"}),S.jsx("div",{className:"output-line output-normal",children:"  - Available in Bonus Content menu and in-game"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.8 -- Snowball Showdown"}),S.jsx("div",{className:"output-line output-normal",children:"  - New arcade mini-game: Snowball Showdown!"}),S.jsx("div",{className:"output-line output-normal",children:"  - Turn-based snowball fight with AI opponent"}),S.jsx("div",{className:"output-line output-normal",children:"  - Hidden arcade cabinet in the general store (expert mode)"}),S.jsx("div",{className:"output-line output-normal",children:"  - Requires game tokens from the abandoned cabin to play"}),S.jsx("div",{className:"output-line output-normal",children:"  - Old Dad NPC hints at tokens and the arcade"}),S.jsx("div",{className:"output-line output-normal",children:"  - Touch/click controls for mobile play"}),S.jsx("div",{className:"output-line output-normal",children:"  - Available in Bonus Content menu and in-game"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.7 -- Defend the Village"}),S.jsx("div",{className:"output-line output-normal",children:"  - New arcade mini-game: Defend the Village from wolves and bears!"}),S.jsx("div",{className:"output-line output-normal",children:"  - Hidden dusty arcade cabinet in the locked basement"}),S.jsx("div",{className:"output-line output-normal",children:"  - Boss bear finale after 20 animals defeated"}),S.jsx("div",{className:"output-line output-normal",children:"  - Ammo/reload system with 5-shot clips"}),S.jsx("div",{className:"output-line output-normal",children:"  - Available in Bonus Content menu and in-game"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.6 -- Expert Mode (BETA)"}),S.jsx("div",{className:"output-line output-normal",children:"  - New Expert Mode with double-size map (24 rooms vs 12)"}),S.jsx("div",{className:"output-line output-normal",children:"  - 12 new locations: Staff areas, village expansion, mountain zones"}),S.jsx("div",{className:"output-line output-normal",children:"  - Modified item discovery: explore to find critical items"}),S.jsx("div",{className:"output-line output-normal",children:"  - Expert mode winners prioritized on leaderboard"}),S.jsx("div",{className:"output-line output-normal",children:"  - Quit/restart command added to all modes"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.5 -- Mobile & Responsive"}),S.jsx("div",{className:"output-line output-normal",children:"  - Fully responsive layout for phones and tablets"}),S.jsx("div",{className:"output-line output-normal",children:"  - Touch controls for the slalom arcade game"}),S.jsx("div",{className:"output-line output-normal",children:"  - Smarter obstacle placement for fairer gameplay"}),S.jsx("div",{className:"output-line output-normal",children:"  - NPC portraits for all characters"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.4 -- Game Room & Custom Arcade Game"}),S.jsx("div",{className:"output-line output-normal",children:"  - Added a game room off the lodge bar"}),S.jsx("div",{className:"output-line output-normal",children:"  - Custom-built slalom arcade mini-game with retro 80s graphics"}),S.jsx("div",{className:"output-line output-normal",children:"  - NPC rival skiers and cheering spectator crowds"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.3 -- High Score Table"}),S.jsx("div",{className:"output-line output-normal",children:"  - Leaderboard tracking for completed adventures"}),S.jsx("div",{className:"output-line output-normal",children:"  - Player stats: steps taken, elapsed time, game mode"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.2 -- Images & Sound"}),S.jsx("div",{className:"output-line output-normal",children:"  - Character portraits and location images"}),S.jsx("div",{className:"output-line output-normal",children:"  - Web Audio API sound effects throughout the adventure"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.1 -- Easy Mode"}),S.jsx("div",{className:"output-line output-normal",children:"  - Multiple choice option for beginner-friendly gameplay"}),S.jsx("div",{className:"output-line output-normal",children:"  - Smart context-sensitive choice generation"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-title",children:"v1.0 -- First Playable Version"}),S.jsx("div",{className:"output-line output-normal",children:"  - Complete Zork-style text adventure"}),S.jsx("div",{className:"output-line output-normal",children:"  - 10+ rooms, NPCs, puzzles, and the Secret of Snowpeak Resort"}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-system",children:"=".repeat(40)}),S.jsx("div",{className:"output-line output-normal",children:""})]}),S.jsx("div",{className:"mode-select",children:S.jsxs("button",{className:"mode-button",onClick:()=>i("menu"),autoFocus:!0,children:["BACK",S.jsx("span",{className:"mode-desc",children:"Return to bonus content menu"})]})})]}):S.jsxs("div",{className:"terminal",children:[S.jsxs("div",{className:"terminal-output",children:[S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"output-line output-ascii welcome-art",children:`         *  .  *  .  *  .  *  .  *
      .     *     .     *     .
            .  *  .  *  .  *
               *  .  *
                 /\\
                /  \\         *  .  *
               / /\\ \\       .  *  .
              / /  \\ \\        *  .
             / /    \\ \\      .  *
            /  \\    /  \\
           /____\\  /____\\
          / ~~~~ SNOWPEAK ~~~~ \\
         / ~~~~~ RESORT  ~~~~~ \\
        /________________________\\
       /     est. 1976            \\
      /____________________________\\`}),S.jsx("div",{className:"output-line output-normal",children:""}),S.jsx("div",{className:"welcome-title",children:"BONUS CONTENT"}),S.jsx("div",{className:"welcome-subtitle",children:"Mini-games & extras"}),S.jsx("div",{className:"output-line output-normal",children:""})]}),S.jsxs("div",{className:"mode-select",children:[S.jsxs("button",{className:"mode-button",onClick:()=>i("slalom"),autoFocus:!0,children:["[1] PLAY SLALOM CHALLENGE",S.jsx("span",{className:"mode-desc",children:"Hit the slopes in the 80s arcade ski game"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>i("defend"),children:["[2] PLAY DEFEND THE VILLAGE",S.jsx("span",{className:"mode-desc",children:"Protect the village from wolves and bears!"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>i("snowball"),children:["[3] PLAY SNOWBALL SHOWDOWN",S.jsx("span",{className:"mode-desc",children:"Turn-based snowball fight  dodge and throw!"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>i("icebreaker"),children:["[4] PLAY ICE BREAKER",S.jsx("span",{className:"mode-desc",children:"Classic brick-breaking arcade action!"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>i("trailer"),children:["[5] WATCH TRAILER",S.jsx("span",{className:"mode-desc",children:"Drive-in movie theater experience"})]}),S.jsxs("button",{className:"mode-button",onClick:()=>i("notes"),children:["[6] RELEASE NOTES",S.jsx("span",{className:"mode-desc",children:"View version history and changelog"})]}),S.jsxs("button",{className:"mode-button",onClick:e,children:["[7] BACK",S.jsx("span",{className:"mode-desc",children:"Return to the start screen"})]})]})]})}function cD(e){let t={...e};return t.puzzles.victory&&(t={...t,gameOver:!0}),t}function hD(e,t){if(e.gameOver&&t.type!=="ADD_OUTPUT")return e;let i;switch(t.type){case"MOVE":i=V2(e,t.payload);break;case"LOOK":i=L2(e,t.payload);break;case"TAKE":i=H2(e,t.payload);break;case"DROP":i=P2(e,t.payload);break;case"INVENTORY":i=x2(e);break;case"TALK":i=yv(e,t.payload);break;case"GIVE":i=U2(e,t.payload);break;case"USE":i=z2(e,t.payload);break;case"READ":i=B2(e,t.payload);break;case"QUIT":i=G2(e);break;case"HELP":{const r=Oh(Date.now()-(e.startTime||Date.now())),o={text:`Current stats:  ${e.turnCount} steps  |  ${r} elapsed`,type:"system"},c={text:`Current mode:   ${e.mode==="expert"?"Expert (BETA)":e.mode==="easy"?"Easy":e.mode==="standard"?"Standard":e.mode||"Standard"}`,type:"system"};i={...e,output:[...e.output,...hb,o,c]};break}case"SCORES":{const r=Zl(),o=t.payload?.showAll||!1;r.length===0?i={...e,output:[...e.output,{text:"No high scores yet. Be the first to complete the adventure!",type:"system"}]}:i={...e,output:[...e.output,...gv(r,o)]};break}case"ERASE_SCORES":M2(),yI(),i={...e,output:[...e.output,{text:"High score tables have been erased.",type:"system"},{text:"Adventure scores reset to defaults.",type:"system"},{text:"Slalom scores reset to Coach Joe (1000).",type:"system"}]};break;case"SLALOM_RESULT":{const{score:r,gatesPassed:o,difficulty:u}=t.payload,c=pI(e.playerName||"Player",r),m=[{text:"",type:"normal"},{text:"The arcade screen fades and you step back from the machine.",type:"normal"},{text:`Final Score: ${r}  |  Gates: ${o}  |  Difficulty: ${u}`,type:"system"}];c.newAllTimeRecord?m.push({text:"NEW ALL-TIME HIGH SCORE!",type:"victory"}):c.newDailyRecord&&m.push({text:"NEW DAILY HIGH SCORE!",type:"victory"}),c.beatCoachJoe?m.push({text:"You beat Coach Joe's high score of 1000! You are the Slalom Champion!",type:"victory"}):m.push({text:"Coach Joe's high score is 1000. Think you can beat it?",type:"normal"}),i={...e,launchSlalom:!1,output:[...e.output,...m],puzzles:c.beatCoachJoe?{...e.puzzles,slalom_champion:!0}:e.puzzles};break}case"DEFEND_RESULT":{const{defeated:r,total:o,elapsedMs:u,won:c}=t.payload,m=[{text:"",type:"normal"},{text:"The old CRT fades to black and you step back from the dusty cabinet, blinking in the dim basement light.",type:"normal"}];c?(m.push({text:`You defended the village! ${r} animals + BOSS defeated in ${Math.round(u/1e3)}s!`,type:"victory"}),m.push({text:'The ancient machine plays a triumphant 8-bit fanfare. "VILLAGE CHAMPION" flashes across the screen.',type:"normal"})):(m.push({text:`The village fell... You deterred ${r} of ${o} animals before being overrun.`,type:"system"}),m.push({text:'The cabinet lets out a mournful beep. "GAME OVER - INSERT COIN" scrolls across the screen.',type:"normal"}));let _={...e,launchDefend:!1,output:[...e.output,...m],puzzles:c?{...e.puzzles,village_champion:!0}:e.puzzles};if(e.mode==="expert"&&!e.puzzles.fuse_dislodged){const p=_.rooms.basement,y=_.items.fuse;if(y&&y.hidden&&p){const v=[{text:"",type:"normal"},{text:"As the ancient cabinet powers down, it shudders violently  decades of built-up static discharge and rickety wiring sending one final THUNK through its frame. The whole machine lurches sideways an inch on the stone floor.",type:"normal"},{text:"",type:"normal"},{text:"CLANG!",type:"title"},{text:"",type:"normal"},{text:"Something heavy and metallic tumbles out from behind the cabinet, bouncing across the basement floor with a ringing clatter. It spins to a stop at your feet  a heavy-duty electrical fuse! It must have been wedged between the cabinet and the wall for years, completely unreachable until the old machine shook it loose.",type:"normal"},{text:"",type:"normal"},{text:"[An electrical fuse has appeared on the floor!]",type:"system"}];_={..._,output:[..._.output,...v],items:{..._.items,fuse:{...y,hidden:!1}},puzzles:{..._.puzzles,fuse_dislodged:!0}}}}i=_;break}case"SNOWBALL_RESULT":{const{playerHits:r,computerHits:o,won:u}=t.payload,c=[{text:"",type:"normal"},{text:"The old screen flickers off and you step back, brushing pixelated snow from your imagination.",type:"normal"}];u?(c.push({text:`Snowball Champion! You landed ${r} hits to their ${o}!`,type:"victory"}),c.push({text:'The ancient cabinet buzzes triumphantly. "SNOWBALL CHAMPION" scrolls across the screen in icy blue letters.',type:"normal"})):(c.push({text:`Defeated... You only landed ${r} hits while taking ${o} snowballs to the face.`,type:"system"}),c.push({text:'The cabinet plays a sad little jingle. "BETTER LUCK NEXT TIME" blinks on screen.',type:"normal"})),i={...e,launchSnowball:!1,output:[...e.output,...c],puzzles:u?{...e.puzzles,snowball_champion:!0}:e.puzzles};break}case"ICEBREAKER_RESULT":{const{score:r,level:o,won:u}=t.payload,c=[{text:"",type:"normal"},{text:"The pixel bricks fade to black and you step back from the humming cabinet, eyes still adjusting to the dim shelter light.",type:"normal"}];u?(c.push({text:`Ice Breaker Champion! All ${o} levels cleared with a score of ${r}!`,type:"victory"}),c.push({text:'The old cabinet erupts in a triumphant 8-bit fanfare. "ICE BREAKER CHAMPION" blazes across the screen in neon letters.',type:"normal"})):(c.push({text:`Game Over... You reached level ${o} with a score of ${r}.`,type:"system"}),c.push({text:'The cabinet plays a melancholy dirge. "INSERT TOKEN TO CONTINUE" scrolls across the dim screen.',type:"normal"})),i={...e,launchIcebreaker:!1,output:[...e.output,...c],puzzles:u?{...e.puzzles,icebreaker_champion:!0}:e.puzzles};break}case"ADD_OUTPUT":return{...e,output:[...e.output,t.payload]};default:return e}return i={...i,turnCount:e.turnCount+1},i=cD(i),i}const qc={north:"north",n:"north",south:"south",s:"south",east:"east",e:"east",west:"west",w:"west",up:"up",u:"up",down:"down",d:"down"},fD=[{verbs:["go","walk","move","head","travel"],action:"MOVE"},{verbs:["look","l","examine","inspect","describe"],action:"LOOK"},{verbs:["take","get","grab","pickup"],action:"TAKE"},{verbs:["drop","put","discard","leave"],action:"DROP"},{verbs:["use","apply","play"],action:"USE"},{verbs:["give","offer","hand","show"],action:"GIVE"},{verbs:["talk","speak","ask","chat"],action:"TALK"},{verbs:["read"],action:"READ"},{verbs:["inventory","inv","i"],action:"INVENTORY"},{verbs:["help","h","?","commands"],action:"HELP"},{verbs:["scores","score","highscores","leaderboard"],action:"SCORES"},{verbs:["quit","exit","restart","reset"],action:"QUIT"}];function dD(e){return e.filter(t=>!["the","a","an","at","to","with","on","in"].includes(t))}function $d(e,t){const i=t.rooms[t.currentRoomId];for(const r of i.npcs){const o=t.npcs[r];if(o.name.toLowerCase().split(/\s+/).some(c=>e.includes(c))||e.includes(o.name.toLowerCase()))return r}for(const r of i.npcs)if(e.some(o=>r.includes(o)))return r;return null}const mD={"arcade game":"arcade_machine","defend game":"basement_arcade","defend the village":"basement_arcade","defend village":"basement_arcade","dusty arcade":"basement_arcade","old arcade":"basement_arcade","basement arcade":"basement_arcade","snowball game":"store_arcade","snowball fight":"store_arcade","snowball showdown":"store_arcade","store arcade":"store_arcade","store cabinet":"store_arcade","ice breaker":"shelter_arcade",icebreaker:"shelter_arcade","icebreaker game":"shelter_arcade","shelter arcade":"shelter_arcade","shelter cabinet":"shelter_arcade",tokens:"game_tokens","game tokens":"game_tokens","bag of tokens":"game_tokens","token bag":"game_tokens"};function vT(e,t){const i=t.rooms[t.currentRoomId],r=[...i.items,...t.inventory],o=e.join(" ");for(const[u,c]of Object.entries(mD))if(o.includes(u)&&r.includes(c))return c;for(const u of r){const c=t.items[u];if(!c||c.hidden&&i.items.includes(u))continue;if(c.name.toLowerCase().split(/\s+/).some(_=>e.includes(_))||e.includes(c.name.toLowerCase()))return u}for(const u of r){const c=t.items[u];if(c&&!(c.hidden&&i.items.includes(u))&&e.some(m=>u.includes(m)))return u}return null}function _D(e,t){const i=e.toLowerCase().trim();if(!i)return{error:"Say something!"};const r=i.split(/\s+/);if(i==="erase table")return{type:"ERASE_SCORES"};if(r.length===1&&qc[r[0]])return{type:"MOVE",payload:{direction:qc[r[0]]}};let o=r[0],u=r.slice(1);o==="pick"&&r[1]==="up"&&(o="pickup",u=r.slice(2));const c=fD.find(p=>p.verbs.includes(o));if(!c){const p=qc[r[r.length-1]];return p?{type:"MOVE",payload:{direction:p}}:{error:`I don't understand "${i}". Type "help" for a list of commands.`}}const m=c.action;if(m==="INVENTORY"||m==="HELP"||m==="QUIT")return{type:m};if(m==="SCORES")return{type:"SCORES",payload:{showAll:u.some(y=>["all","more","full","expand"].includes(y))}};if(m==="LOOK"&&u.length===0)return{type:"LOOK",payload:{}};const _=dD(u);if(m==="MOVE"){const p=_[0],y=qc[p];return y?{type:"MOVE",payload:{direction:y}}:{error:"Go where? Try a direction: north, south, east, west, up, down."}}if(m==="GIVE"){if(_.length===0)return{error:'Give what to whom? Try "give <item> to <character>".'};const p=t.rooms[t.currentRoomId],y=vT(_,t),v=$d(_,t);return y&&v?{type:"GIVE",payload:{itemId:y,npcId:v}}:y&&!v?p.npcs.length===1?{type:"GIVE",payload:{itemId:y,npcId:p.npcs[0]}}:p.npcs.length>1?{error:"Give it to whom? There are multiple people here."}:{error:"There's nobody here to give that to."}:v?{type:"TALK",payload:{npcId:v}}:p.npcs.length>0?{type:"TALK",payload:{npcId:p.npcs[0]}}:{error:"There's nobody here to give that to."}}if(m==="TALK"){if(_.length===0)return{error:'Talk to whom? Try "talk to <character name>".'};const p=$d(_,t);return p?{type:"TALK",payload:{npcId:p}}:{error:`There's nobody called "${u.join(" ")}" here.`}}if(["TAKE","DROP","USE","LOOK","READ"].includes(m)){if(_.length===0)return{error:`${m==="LOOK"?"Look at":m.charAt(0)+m.slice(1).toLowerCase()} what?`};if(m==="LOOK"){const y=$d(_,t);if(y)return{type:"LOOK",payload:{npcId:y}}}const p=vT(_,t);return p?{type:m,payload:{itemId:p}}:m==="LOOK"?{type:"LOOK",payload:{target:u.join(" ")}}:{error:`I don't see "${u.join(" ")}" here.`}}return{error:`I don't understand "${i}". Type "help" for a list of commands.`}}const pD={lodge_lobby:{id:"lodge_lobby",name:"Resort Lodge Lobby",ascii:`
        ___________________________
       |  SNOWPEAK RESORT - 1976  |
       |__________________________|
       |    |              |    |
       | [] |  ___    ___  | [] |
       |    | |   |  |   | |    |
       |    | | ~ |  | ~ | |    |
   ____|____|_|___|__|___|_|____|____
  |  _____                  _____  |
  | |     | /\\  ~~flames~~ |     | |
  | |     |/  \\  /\\ /\\ /\\  |     | |
  | |_____| __ \\/__\\/__\\/__\\|_____| |
  |________|____|__________|________|`,description:'You stand in the grand lobby of Snowpeak Resort. Once magnificent, the place has seen better days. A massive stone fireplace dominates one wall, though only embers glow within it. Dusty chandeliers hang overhead, and faded ski posters line the walls. A moth-eaten welcome banner reads "SNOWPEAK RESORT - EST. 1976."',exits:{north:"main_street",east:"lodge_bar",west:"lodge_balcony"},hiddenExits:{},lockedExits:{down:{roomId:"basement",keyId:"basement_key",message:"A heavy wooden door leads downward, but it's locked tight. You'd need a key."}},items:["old_map"],npcs:["mr_smiles"]},lodge_bar:{id:"lodge_bar",name:"Lodge Bar",ascii:`
     _________________________________
    |  _   _   _                     |
    | (o) (o) (o)  <-- ski goggles!  |
    |  |   |   |                     |
    |  ~~  ~~  ~~   taxidermy heads  |
    |________________________________|
    |          ____                  |
    |   ___   |    |  _  _  _        |
    |  |   |  |    | |_||_||_|       |
    |  | ~ |  |    | |  |  |         |
    |  |/\\.| |____|_|__|__|__        |
    |__|____|_|_______________|____ _|
    |====BAR COUNTER=================|
    |________________________________|`,description:"A dimly lit bar with a crackling fireplace that provides the only warmth in the whole resort. Taxidermied animal heads line the walls, all wearing tiny ski goggles. The shelves behind the bar are mostly empty, save for a few dusty bottles. The air smells of old wood and stale pretzels. To the east, a doorway leads to a game room.",exits:{west:"lodge_lobby",east:"game_room"},hiddenExits:{},lockedExits:{},items:["broken_radio","whiskey_bottle"],npcs:["angry_boss"]},game_room:{id:"game_room",name:"Game Room",ascii:`
     _________________________________
    |  ___   GAME ROOM          ___  |
    | |   |                    |   | |
    | | S |   ___________      | D | |
    | | L |  |           |     | A | |
    | | A |  | POOL TABLE|     | R | |
    | | L |  |    (o)    |     | T | |
    | | O |  |___________|     | S | |
    | | M |                    |   | |
    | |___|  [FREE PLAY]       |___| |
    |________________________________|`,description:"A recreation room off the bar, filled with old entertainment. A battered arcade cabinet dominates one corner, its screen glowing with green pixels. A pool table with faded felt sits in the center, and a dartboard hangs on the far wall. The room smells of old carpet and nostalgia.",exits:{west:"lodge_bar"},hiddenExits:{},lockedExits:{},items:["arcade_machine"],npcs:[]},lodge_balcony:{id:"lodge_balcony",name:"Lodge Balcony",ascii:`
               /\\
              /  \\        *
             /    \\      *
            //\\/\\\\    *  <-- glint!
           //    \\ \\
          / \\    /  \\
         /___\\  /____\\
        /   MOUNTAIN   \\
    ~~~~/~~~~~~~~~~~~~~~\\~~~~
       |                  |
    ===|====BALCONY=======|===
    |  |  []          []  |  |
    |  |__________________|  |
    |________________________|`,description:"A wide wooden balcony overlooking the resort grounds. The mountain rises dramatically to the north, its peak shrouded in mist. From here you can see the main street below and the ski slopes winding up the mountainside. The railing is icy to the touch. Something glints far up on the mountain, near the frozen waterfall.",exits:{east:"lodge_lobby"},hiddenExits:{},lockedExits:{},items:["binoculars"],npcs:[]},basement:{id:"basement",name:"Mysterious Basement",ascii:`
     ___________________________________
    |  ~  ~  ~  COBWEBS  ~  ~  ~       |
    |    _______                       |
    |   |       |   ____  ____         |
    |   | TOBIAS|  |    ||    |        |
    |   | SNOW- |  | __ || __ |        |
    |   | PEAK  |  ||__|||__| |        |
    |   | /__\\ |  |WORKBENCH |        |
    |   |_______|  |__________|  ___   |
    |                           |   |  |
    |  ///  ///   old ski      |???|  |
    |  ///  ///   equipment    |___|  |
    |__________________________________|`,description:"A damp stone basement beneath the lodge. Old ski equipment rusts in the corners. Cobwebs hang from exposed wooden beams. Against the far wall, a workbench is covered in old papers and tools. A portrait of a distinguished-looking man in vintage ski attire hangs crooked on the wall -- the resort's founder, Tobias Snowpeak. In a dark corner, half-buried under a dusty tarp, sits what appears to be an old arcade cabinet.",exits:{up:"lodge_lobby"},hiddenExits:{},lockedExits:{},items:["dusty_journal","basement_arcade"],npcs:[]},main_street:{id:"main_street",name:"Main Street",ascii:`
            *  *  *  *  *
         *  snowflakes   *
           *  *  *  *
     _____    (  )    _____
    |SHOP |   |  |   |SHOP |
    |_____|   |  |   |CLOSE|
    |XXXXX|   |  |   |XXXXX|
    |XXXXX|   |  |   |XXXXX|
    |_____|   |  |   |_____|
       |      |  |      |
    ---+------+--+------+---
    ~~~~ MAIN STREET ~~~~~~~~
    ---+------+--+------+---
       |  <- SKI    VILLAGE
       | RENTAL       -> |`,description:`The resort's main thoroughfare is covered in packed snow. Quaint shops line both sides, though most are boarded up for the season -- or perhaps permanently. Old-fashioned lamp posts flicker with weak electric light. To the north, the ski slopes begin their gentle ascent. A cheerful sign pointing east reads "Mountain Village" and another pointing west reads "Ski Rental."`,exits:{south:"lodge_lobby",north:"ski_slopes",east:"village",west:"ski_rental"},hiddenExits:{},lockedExits:{},items:[],npcs:["henrys_mom"]},ski_rental:{id:"ski_rental",name:"Ski Rental Shop",ascii:`
     _________________________________
    | "HELP YOURSELF" - Management   |
    |________________________________|
    |   /|  /|  /|     __|__         |
    |  / | / | / |    |BOOTS|        |
    | /  |/  |/  |    |pile |        |
    | SKIS SKIS  |    |o]_[o|        |
    |            |    |o]_[o|        |
    |  __|  __|  |    |_____|        |
    | |  | |  |  |                   |
    | |--| |--|  |  _O_  goggles     |
    | |__| |__|  | (___) basket      |
    |____________|___________________|`,description:'A chaotic shop overflowing with mismatched ski equipment. Skis of every era lean against the walls -- from modern carbon fiber to what appear to be actual wooden planks with leather straps. Boots are piled in heaps, helmets dangle from hooks, and a basket of goggles sits on the counter. A hand-written sign says "HELP YOURSELF - Management."',exits:{east:"main_street"},hiddenExits:{},lockedExits:{},items:["ski_poles"],npcs:["dill_pickle"]},village:{id:"village",name:"Mountain Village",ascii:`
          /\\           /\\
         /  \\   ^^^   /  \\
        / /\\ \\ ^^^  //\\ \\
       / /  \\ \\    //  \\ \\
      /  \\  /  \\  / \\  /  \\
     /____\\/____\\/___\\/____\\
      A-FRAMES     VILLAGE
            ______
           | /_\\ |
           ||   ||    TOBIAS
           || O ||    SNOWPEAK
           ||/\\||    statue
           |_____|
        "He who seeks the
       still water finds
           the path"`,description:'A picturesque alpine village with A-frame buildings covered in snow. Smoke rises from a few chimneys, but the streets are eerily quiet. In the center of the village square stands a bronze statue of a man on skis, one arm raised triumphantly. The plaque reads: "TOBIAS SNOWPEAK - He who seeks the still water finds the path." A small general store appears to be the only open business.',exits:{west:"main_street"},hiddenExits:{},lockedExits:{},items:["warm_coat","note_from_founder"],npcs:["dance_mom"]},ski_slopes:{id:"ski_slopes",name:"Ski Slopes",ascii:`
                           /\\
                          /  \\
                   /\\   / -- \\  lift
                  /  \\ /______\\ station
                 /    \\\\
                / ---- \\\\   ___
               / SLOPES \\\\  |:|
              /  ~~~~~~~~ \\  |:| <--lift
             / ~~~~~~~~~~~~\\ |:|
    ______  / ~~~~~~~~~~~~~~\\
   | :)  :)|~~~~~~~~~~~~~~~~|
   |BEGINR |~~~~~~~~~~~~~~~~|
   |_ZONE__|~~~~~~~~~~~~~~~~|`,description:`The bunny slope -- a comically gentle incline that wouldn't challenge a toddler on a sled. A faded sign reads "BEGINNER ZONE" with encouraging smiley faces. The snow is well-packed but the slope is deserted. To the north, the terrain rises more steeply toward a frozen waterfall. A rickety ski lift station is visible further up the mountain.`,exits:{south:"main_street",north:"frozen_waterfall",up:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:[],npcs:["coach_joe"]},ski_lift_top:{id:"ski_lift_top",name:"Ski Lift Top Station",ascii:`
     >>>>  FIERCE WIND  >>>>
         ________________
        |  SKI LIFT TOP |
        |    STATION    |
        |_______________|
        |  ___          |
        | | ! | FUSE    |
        | | ! | PANEL   |
        | |___| [EMPTY] |
        |_______________|
            |  |
    ~~~~~~~~|  |~~~~~~~~
      ___/  |  |  \\___
     |__|   |__|   |__|
     chairs  on  cable`,description:"The upper ski lift station sits on a windswept platform. The lift chairs hang motionless on the cable -- the machinery is dead. An electrical panel on the side of the station house hangs open, revealing a conspicuously empty fuse socket. If the lift were working, it could carry you up to the mountain peak.",exits:{down:"ski_slopes",east:"frozen_waterfall"},hiddenExits:{},lockedExits:{},items:[],npcs:[]},frozen_waterfall:{id:"frozen_waterfall",name:"Frozen Waterfall",ascii:`
        .  *  .  *  .  *  .
      *    icicles    *
        . \\ | / . \\ | / .
         \\\\|//   \\\\|//
    ______\\|/______\\|/____
    |  ~~~ FROZEN ~~~      |
    | |  WATERFALL  |      |
    | | icicicicic | ????  |
    | | icicicicic |       |
    | | icicicicic | crack |
    | | icicicicic |  in   |
    | | icicicicic |  ice  |
    |_|____________|_______|
    ~~~~~~~~~~~~~~~~~~~~~~~~
     water stands still...`,description:"A spectacular wall of ice rises before you -- a waterfall frozen mid-cascade. The ice is crystal blue and translucent, with strange shapes visible deep within. Icicles the size of swords hang from rocky outcrops above. The whole scene is eerily beautiful and perfectly, impossibly still. Water that stands still...",exits:{south:"ski_slopes",west:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["chewed_gum"],npcs:[]},hidden_cave:{id:"hidden_cave",name:"Hidden Cave",ascii:`
    _/\\_/\\___/\\_____/\\_/\\_
   /                       \\
  /  /\\/\\   strange  /\\  \\
 |  /  Y  \\  markings /  \\ |
 | |  ~~~  | on walls |****| |
 | | ~~~ ~ |  <> <>   |****| |
 | |  ~~~  |  <> <>   |****| |
 |  \\ ~~~ /   _____  | ** | |
 |   \\   /   |     | |    | |
 |    \\ /    | (O) | steps| |
  \\    V     |medal| down /
   \\_______ _|_____|_____/`,description:"A narrow cave behind the waterfall, its walls glistening with frost. The passage winds deeper into the mountain. Strange markings are scratched into the stone walls -- they look like a mix of ski trail markers and something much older. The air is cold and still. At the back of the cave, rough stone steps lead downward into darkness. A circular indentation in the wall beside the steps looks like something should fit into it.",exits:{west:"frozen_waterfall"},hiddenExits:{},lockedExits:{down:{roomId:"underground_vault",keyId:"strange_medallion",message:"Stone steps lead down to a heavy door with a circular indentation. It looks like a medallion-shaped key is needed."}},items:["torch"],npcs:[]},underground_vault:{id:"underground_vault",name:"Underground Vault",ascii:`
    .  *  .  *  .  *  .  *  .
   _____________________________
  |  *   THE UNDERGROUND   *   |
  |      ~~~~VAULT~~~~         |
  | *     ___________      *   |
  |      |           |         |
  |  /-\\|  __/\\__  |/-\\     |
  | |SKI||  \\    /  ||SKI|    |
  | |___|   \\\\  // ||___|    |
  |      |  TROPHY   |         |
  |      |___________|         |
  |  *     [======]        *   |
  |        [letter]            |
  |____________________________|`,description:"You descend into a hidden chamber carved from the living rock of the mountain. Torchlight dances across the walls, revealing intricate carvings of skiers, mountains, and snowflakes. In the center of the vault, on a pedestal of polished stone, sits a magnificent golden trophy shaped like a ski. Beside it lies a sealed envelope. This is it -- the legendary secret of Snowpeak Resort.",exits:{up:"hidden_cave"},hiddenExits:{},lockedExits:{},items:["golden_ski_trophy","founders_letter"],npcs:[]},mountain_peak:{id:"mountain_peak",name:"Mountain Peak",ascii:`
              YOU
             \\o/
              |         * . * . *
         ____/\\______  .  *  .  *  .
        /     SUMMIT  \\   *  .  *
       / ~~~~~~~~~~~~~ \\
      / /\\  /\\  /\\  /\\ \\
     / /  \\/  \\/  \\/  \\ \\
    / /    \\   \\   \\   \\ \\
   /_/______\\_  \\_  \\_  \\_\\
  /     SNOWPEAK     MOUNTAIN  \\
 /  PANORAMIC VIEW OF WORLD     \\
/________________________________\\`,description:"You stand at the summit of Snowpeak Mountain. The wind howls around you but the view is breathtaking -- an endless panorama of snow-covered peaks stretching to the horizon. Far below, the resort looks like a toy village. You can see everything from here: the frozen waterfall, the village, the winding slopes. Half-buried in the snow near a cairn of stacked rocks, something glints in the sunlight. The ski lift can carry you back down.",exits:{down:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["strange_medallion"],npcs:[]}},gD={lodge_lobby:{id:"lodge_lobby",name:"Resort Lodge Lobby",ascii:`
        ___________________________
       |  SNOWPEAK RESORT - 1976  |
       |__________________________|
       |    |              |    |
       | [] |  ___    ___  | [] |
       |    | |   |  |   | |    |
       |    | | ~ |  | ~ | |    |
   ____|____|_|___|__|___|_|____|____
  |  _____                  _____  |
  | |     | /\\  ~~flames~~ |     | |
  | |     |/  \\  /\\ /\\ /\\  |     | |
  | |_____| __ \\/__\\/__\\/__\\|_____| |
  |________|____|__________|________|`,description:'You stand in the grand lobby of Snowpeak Resort. Once magnificent, the place has seen better days. A massive stone fireplace dominates one wall, though only embers glow within it. Dusty chandeliers hang overhead, and faded ski posters line the walls. A moth-eaten welcome banner reads "SNOWPEAK RESORT - EST. 1976." To the south, a narrow hallway leads to the staff quarters.',exits:{north:"main_street",east:"lodge_bar",west:"lodge_balcony",south:"staff_hallway"},hiddenExits:{},lockedExits:{down:{roomId:"basement",keyId:"basement_key",message:"A heavy wooden door leads downward, but it's locked tight. You'd need a key."}},items:["old_map"],npcs:["mr_smiles"]},lodge_bar:{id:"lodge_bar",name:"Lodge Bar",ascii:`
     _________________________________
    |  _   _   _                     |
    | (o) (o) (o)  <-- ski goggles!  |
    |  |   |   |                     |
    |  ~~  ~~  ~~   taxidermy heads  |
    |________________________________|
    |          ____                  |
    |   ___   |    |  _  _  _        |
    |  |   |  |    | |_||_||_|       |
    |  | ~ |  |    | |  |  |         |
    |  |/\\.| |____|_|__|__|__        |
    |__|____|_|_______________|____ _|
    |====BAR COUNTER=================|
    |________________________________|`,description:"A dimly lit bar with a crackling fireplace that provides the only warmth in the whole resort. Taxidermied animal heads line the walls, all wearing tiny ski goggles. The shelves behind the bar are mostly empty, save for a few dusty bottles. The air smells of old wood and stale pretzels. To the east, a doorway leads to a game room. A swinging door to the south leads to the kitchen.",exits:{west:"lodge_lobby",east:"game_room",south:"kitchen"},hiddenExits:{},lockedExits:{},items:["broken_radio","whiskey_bottle"],npcs:["angry_boss"]},game_room:{id:"game_room",name:"Game Room",ascii:`
     _________________________________
    |  ___   GAME ROOM          ___  |
    | |   |                    |   | |
    | | S |   ___________      | D | |
    | | L |  |           |     | A | |
    | | A |  | POOL TABLE|     | R | |
    | | L |  |    (o)    |     | T | |
    | | O |  |___________|     | S | |
    | | M |                    |   | |
    | |___|  [FREE PLAY]       |___| |
    |________________________________|`,description:"A recreation room off the bar, filled with old entertainment. A battered arcade cabinet dominates one corner, its screen glowing with green pixels. A pool table with faded felt sits in the center, and a dartboard hangs on the far wall. The room smells of old carpet and nostalgia.",exits:{west:"lodge_bar"},hiddenExits:{},lockedExits:{},items:["arcade_machine"],npcs:[]},lodge_balcony:{id:"lodge_balcony",name:"Lodge Balcony",ascii:`
               /\\
              /  \\        *
             /    \\      *
            //\\/\\\\    *  <-- glint!
           //    \\ \\
          / \\    /  \\
         /___\\  /____\\
        /   MOUNTAIN   \\
    ~~~~/~~~~~~~~~~~~~~~\\~~~~
       |                  |
    ===|====BALCONY=======|===
    |  |  []          []  |  |
    |  |__________________|  |
    |________________________|`,description:"A wide wooden balcony overlooking the resort grounds. The mountain rises dramatically to the north, its peak shrouded in mist. From here you can see the main street below and the ski slopes winding up the mountainside. The railing is icy to the touch. Something glints far up on the mountain, near the frozen waterfall.",exits:{east:"lodge_lobby"},hiddenExits:{},lockedExits:{},items:["binoculars"],npcs:[]},basement:{id:"basement",name:"Mysterious Basement",ascii:`
     ___________________________________
    |  ~  ~  ~  COBWEBS  ~  ~  ~       |
    |    _______                       |
    |   |       |   ____  ____         |
    |   | TOBIAS|  |    ||    |        |
    |   | SNOW- |  | __ || __ |        |
    |   | PEAK  |  ||__|||__| |        |
    |   | /__\\ |  |WORKBENCH |        |
    |   |_______|  |__________|  ___   |
    |                           |   |  |
    |  ///  ///   old ski      |???|  |
    |  ///  ///   equipment    |___|  |
    |__________________________________|`,description:"A damp stone basement beneath the lodge. Old ski equipment rusts in the corners. Cobwebs hang from exposed wooden beams. Against the far wall, a workbench is covered in old papers and tools. A portrait of a distinguished-looking man in vintage ski attire hangs crooked on the wall -- the resort's founder, Tobias Snowpeak. A dark tunnel entrance is barely visible in the corner. In a dark corner, half-buried under a dusty tarp, sits what appears to be an old arcade cabinet. Something metallic glints behind it, wedged between the cabinet and the stone wall.",exits:{up:"lodge_lobby",north:"underground_tunnel"},hiddenExits:{},lockedExits:{},items:["dusty_journal","basement_arcade","fuse"],npcs:[]},main_street:{id:"main_street",name:"Main Street",ascii:`
            *  *  *  *  *
         *  snowflakes   *
           *  *  *  *
     _____    (  )    _____
    |SHOP |   |  |   |SHOP |
    |_____|   |  |   |CLOSE|
    |XXXXX|   |  |   |XXXXX|
    |XXXXX|   |  |   |XXXXX|
    |_____|   |  |   |_____|
       |      |  |      |
    ---+------+--+------+---
    ~~~~ MAIN STREET ~~~~~~~~
    ---+------+--+------+---
       |  <- SKI    VILLAGE
       | RENTAL       -> |`,description:`The resort's main thoroughfare is covered in packed snow. Quaint shops line both sides, though most are boarded up for the season -- or perhaps permanently. Old-fashioned lamp posts flicker with weak electric light. To the north, the ski slopes begin their gentle ascent. A cheerful sign pointing east reads "Mountain Village" and another pointing west reads "Ski Rental."`,exits:{south:"lodge_lobby",north:"ski_slopes",east:"village",west:"ski_rental"},hiddenExits:{},lockedExits:{},items:[],npcs:["henrys_mom"]},ski_rental:{id:"ski_rental",name:"Ski Rental Shop",ascii:`
     _________________________________
    | "HELP YOURSELF" - Management   |
    |________________________________|
    |   /|  /|  /|     __|__         |
    |  / | / | / |    |BOOTS|        |
    | /  |/  |/  |    |pile |        |
    | SKIS SKIS  |    |o]_[o|        |
    |            |    |o]_[o|        |
    |  __|  __|  |    |_____|        |
    | |  | |  |  |                   |
    | |--| |--|  |  _O_  goggles     |
    | |__| |__|  | (___) basket      |
    |____________|___________________|`,description:'A chaotic shop overflowing with mismatched ski equipment. Skis of every era lean against the walls -- from modern carbon fiber to what appear to be actual wooden planks with leather straps. Boots are piled in heaps, helmets dangle from hooks, and a basket of goggles sits on the counter. A hand-written sign says "HELP YOURSELF - Management." A dusty storage room is visible through a back door.',exits:{east:"main_street",north:"storage_room"},hiddenExits:{},lockedExits:{},items:["ski_poles"],npcs:["dill_pickle"]},village:{id:"village",name:"Mountain Village",ascii:`
          /\\           /\\
         /  \\   ^^^   /  \\
        / /\\ \\ ^^^  //\\ \\
       / /  \\ \\    //  \\ \\
      /  \\  /  \\  / \\  /  \\
     /____\\/____\\/___\\/____\\
      A-FRAMES     VILLAGE
            ______
           | /_\\ |
           ||   ||    TOBIAS
           || O ||    SNOWPEAK
           ||/\\||    statue
           |_____|
        "He who seeks the
       still water finds
           the path"`,description:'A picturesque alpine village with A-frame buildings covered in snow. Smoke rises from a few chimneys, but the streets are eerily quiet. In the center of the village square stands a bronze statue of a man on skis, one arm raised triumphantly. The plaque reads: "TOBIAS SNOWPEAK - He who seeks the still water finds the path." A small general store appears to be the only open business. To the north, an old chapel stands on a hill. To the south, a weathered cabin sits among the trees.',exits:{west:"main_street",north:"chapel",south:"old_cabin",east:"general_store"},hiddenExits:{},lockedExits:{},items:["warm_coat","note_from_founder"],npcs:["dance_mom"]},ski_slopes:{id:"ski_slopes",name:"Ski Slopes",ascii:`
                           /\\
                          /  \\
                   /\\   / -- \\  lift
                  /  \\ /______\\ station
                 /    \\\\
                / ---- \\\\   ___
               / SLOPES \\\\  |:|
              /  ~~~~~~~~ \\  |:| <--lift
             / ~~~~~~~~~~~~\\ |:|
    ______  / ~~~~~~~~~~~~~~\\
   | :)  :)|~~~~~~~~~~~~~~~~|
   |BEGINR |~~~~~~~~~~~~~~~~|
   |_ZONE__|~~~~~~~~~~~~~~~~|`,description:`The bunny slope -- a comically gentle incline that wouldn't challenge a toddler on a sled. A faded sign reads "BEGINNER ZONE" with encouraging smiley faces. The snow is well-packed but the slope is deserted. To the north, the terrain rises more steeply toward a frozen waterfall. A rickety ski lift station is visible further up the mountain. To the east, a narrow trail marked "DANGER: AVALANCHE ZONE" leads into treacherous terrain.`,exits:{south:"main_street",north:"frozen_waterfall",up:"ski_lift_top",east:"avalanche_zone"},hiddenExits:{},lockedExits:{},items:[],npcs:["coach_joe"]},ski_lift_top:{id:"ski_lift_top",name:"Ski Lift Top Station",ascii:`
     >>>>  FIERCE WIND  >>>>
         ________________
        |  SKI LIFT TOP |
        |    STATION    |
        |_______________|
        |  ___          |
        | | ! | FUSE    |
        | | ! | PANEL   |
        | |___| [EMPTY] |
        |_______________|
            |  |
    ~~~~~~~~|  |~~~~~~~~
      ___/  |  |  \\___
     |__|   |__|   |__|
     chairs  on  cable`,description:"The upper ski lift station sits on a windswept platform. The lift chairs hang motionless on the cable -- the machinery is dead. An electrical panel on the side of the station house hangs open, revealing a conspicuously empty fuse socket. If the lift were working, it could carry you up to the mountain peak. A treacherous ridge trail leads west along the mountain face. To the north, a narrow icy passage disappears into the mountain.",exits:{down:"ski_slopes",east:"frozen_waterfall",west:"ridge_trail"},hiddenExits:{},lockedExits:{north:{roomId:"ice_caves",requireItems:["rope","pickaxe"],message:"To the north, a narrow icy passage leads down into what looks like caves beneath the mountain. The walls are slick with ice and the descent is treacherous. You'd need both climbing rope and a pickaxe to make it down safely."}},items:[],npcs:[]},frozen_waterfall:{id:"frozen_waterfall",name:"Frozen Waterfall",ascii:`
        .  *  .  *  .  *  .
      *    icicles    *
        . \\ | / . \\ | / .
         \\\\|//   \\\\|//
    ______\\|/______\\|/____
    |  ~~~ FROZEN ~~~      |
    | |  WATERFALL  |      |
    | | icicicicic | ????  |
    | | icicicicic |       |
    | | icicicicic | crack |
    | | icicicicic |  in   |
    | | icicicicic |  ice  |
    |_|____________|_______|
    ~~~~~~~~~~~~~~~~~~~~~~~~
     water stands still...`,description:"A spectacular wall of ice rises before you -- a waterfall frozen mid-cascade. The ice is crystal blue and translucent, with strange shapes visible deep within. Icicles the size of swords hang from rocky outcrops above. The whole scene is eerily beautiful and perfectly, impossibly still. Water that stands still...",exits:{south:"ski_slopes",west:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["chewed_gum"],npcs:[]},hidden_cave:{id:"hidden_cave",name:"Hidden Cave",ascii:`
    _/\\_/\\___/\\_____/\\_/\\_
   /                       \\
  /  /\\/\\   strange  /\\  \\
 |  /  Y  \\  markings /  \\ |
 | |  ~~~  | on walls |****| |
 | | ~~~ ~ |  <> <>   |****| |
 | |  ~~~  |  <> <>   |****| |
 |  \\ ~~~ /   _____  | ** | |
 |   \\   /   |     | |    | |
 |    \\ /    | (O) | steps| |
  \\    V     |medal| down /
   \\_______ _|_____|_____/`,description:"A narrow cave behind the waterfall, its walls glistening with frost. The passage winds deeper into the mountain. Strange markings are scratched into the stone walls -- they look like a mix of ski trail markers and something much older. The air is cold and still. At the back of the cave, rough stone steps lead downward into darkness. A circular indentation in the wall beside the steps looks like something should fit into it.",exits:{west:"frozen_waterfall"},hiddenExits:{},lockedExits:{down:{roomId:"underground_vault",keyId:"strange_medallion",message:"Stone steps lead down to a heavy door with a circular indentation. It looks like a medallion-shaped key is needed."}},items:["torch"],npcs:[]},underground_vault:{id:"underground_vault",name:"Underground Vault",ascii:`
    .  *  .  *  .  *  .  *  .
   _____________________________
  |  *   THE UNDERGROUND   *   |
  |      ~~~~VAULT~~~~         |
  | *     ___________      *   |
  |      |           |         |
  |  /-\\|  __/\\__  |/-\\     |
  | |SKI||  \\    /  ||SKI|    |
  | |___|   \\\\  // ||___|    |
  |      |  TROPHY   |         |
  |      |___________|         |
  |  *     [======]        *   |
  |        [letter]            |
  |____________________________|`,description:"You descend into a hidden chamber carved from the living rock of the mountain. Torchlight dances across the walls, revealing intricate carvings of skiers, mountains, and snowflakes. In the center of the vault, on a pedestal of polished stone, sits a magnificent golden trophy shaped like a ski. Beside it lies a sealed envelope. This is it -- the legendary secret of Snowpeak Resort.",exits:{up:"hidden_cave"},hiddenExits:{},lockedExits:{},items:["golden_ski_trophy","founders_letter"],npcs:[]},mountain_peak:{id:"mountain_peak",name:"Mountain Peak",ascii:`
              YOU
             \\o/
              |         * . * . *
         ____/\\______  .  *  .  *  .
        /     SUMMIT  \\   *  .  *
       / ~~~~~~~~~~~~~ \\
      / /\\  /\\  /\\  /\\ \\
     / /  \\/  \\/  \\/  \\ \\
    / /    \\   \\   \\   \\ \\
   /_/______\\_  \\_  \\_  \\_\\
  /     SNOWPEAK     MOUNTAIN  \\
 /  PANORAMIC VIEW OF WORLD     \\
/________________________________\\`,description:"You stand at the summit of Snowpeak Mountain. The wind howls around you but the view is breathtaking -- an endless panorama of snow-covered peaks stretching to the horizon. Far below, the resort looks like a toy village. You can see everything from here: the frozen waterfall, the village, the winding slopes. Half-buried in the snow near a cairn of stacked rocks, something glints in the sunlight. A small stone shelter provides protection from the wind. The ski lift can carry you back down.",exits:{down:"ski_lift_top",east:"summit_shelter"},hiddenExits:{},lockedExits:{},items:["strange_medallion"],npcs:[]},staff_hallway:{id:"staff_hallway",name:"Staff Hallway",ascii:`
     _________________________________
    | ===== STAFF ONLY =====         |
    | ________________  ____________ |
    ||                ||            ||
    ||   STAFF        ||  KITCHEN   ||
    ||   QUARTERS     ||            ||
    ||    [locked]    ||    [open]  ||
    ||________________||____________||
    |                                |
    |  ~~~  ~~~  worn carpet  ~~~    |
    |________________________________|`,description:'A narrow hallway with faded wallpaper and worn carpet. Flickering fluorescent lights cast an institutional glow. Two doors line the hallway: one marked "STAFF QUARTERS" (locked), and another leading to the kitchen. Framed photos of smiling resort staff from decades past hang on the walls, their faces cheerful but somehow unsettling in the dim light.',exits:{north:"lodge_lobby",east:"kitchen"},hiddenExits:{},lockedExits:{west:{roomId:"staff_quarters",keyId:"staff_key",message:"The staff quarters door is locked. You need a staff key."}},items:[],npcs:[]},staff_quarters:{id:"staff_quarters",name:"Staff Quarters",ascii:`
     _________________________________
    |  STAFF    SLEEPING    QUARTERS |
    | ____  ____  ____  ____  ____   |
    ||    ||    ||    ||    ||    |  |
    || [] || [] || [] || [] || [] |  |
    ||____||____||____||____||____|  |
    | beds  beds  beds  beds  beds   |
    |   _______________              |
    |  |   FOOTLOCKER  |             |
    |  |   [unlocked]  |             |
    |  |_______________|             |
    |________________________________|`,description:"A cramped dormitory-style room with rows of narrow beds and metal lockers. The air smells of mothballs and old linens. Personal effects suggest the staff left in a hurry -- uniforms draped over chairs, magazines open on nightstands. An unlocked footlocker at the end of one bed contains various items left behind.",exits:{east:"staff_hallway"},hiddenExits:{},lockedExits:{},items:["staff_uniform","old_photograph"],npcs:[]},kitchen:{id:"kitchen",name:"Lodge Kitchen",ascii:`
     _________________________________
    |  KITCHEN - SNOWPEAK RESORT     |
    |   ___   ___   ___              |
    |  |   | |   | |   |  PANTRY     |
    |  |___| |___| |___|  DOOR       |
    |   OVENS (COLD)      [north]    |
    |                                |
    |  ######################        |
    |  ####  PREP TABLE  ####        |
    |  ######################        |
    |   pots    pans    knives       |
    |________________________________|`,description:"An industrial kitchen that once served hundreds of guests daily. Now it sits silent and cold. Stainless steel counters and hanging pots catch what little light filters through grimy windows. The ovens are cold, but a walk-in pantry to the north might still hold supplies. A calendar on the wall is frozen at February 1976.",exits:{north:"pantry",west:"staff_hallway",east:"lodge_bar"},hiddenExits:{},lockedExits:{},items:["rusty_knife","old_recipe"],npcs:[]},pantry:{id:"pantry",name:"Walk-in Pantry",ascii:`
     _________________________________
    |  [] [] [] [] [] [] [] [] []    |
    |  [] [] [] [] [] [] [] [] []    |
    |  SHELVES OF CANNED GOODS       |
    |  (most expired since 1976)     |
    |                                |
    |    _______________             |
    |   |  FREEZER      |            |
    |   |  [broken]     |            |
    |   |_______________|            |
    |                                |
    |   Fallen crates and old         |
    |   supplies litter the floor... |
    |________________________________|`,description:"A cold storage room lined with metal shelving. Hundreds of cans and jars sit gathering dust -- most decades past their expiration date. A broken freezer in the corner is frosted over. The shelves are mostly bare aside from some expired canned goods.",exits:{south:"kitchen"},hiddenExits:{},lockedExits:{},items:["canned_beans"],npcs:[]},storage_room:{id:"storage_room",name:"Equipment Storage",ascii:`
     _________________________________
    |  STORAGE - SKI RENTAL SHOP     |
    |  /|  /|  /|  /|  /|  /|  /|    |
    | / | / | / | / | / | / | / |    |
    |/  |/  |/  |/  |/  |/  |/  |    |
    | MORE SKIS AND POLES            |
    |                                |
    |   _______________              |
    |  | =-=-=-=-=-=- |  TOOLBOX     |
    |  | =-=-=-=-=-=- |              |
    |  |_____________|               |
    |________________________________|`,description:"A cluttered storage room packed with even more ski equipment. Skis are stacked floor to ceiling, and poles lean in every corner. A heavy toolbox sits on a workbench, filled with wrenches, screwdrivers, and other maintenance tools. The dust is thick enough to write in.",exits:{south:"ski_rental"},hiddenExits:{},lockedExits:{},items:["screwdriver","rope"],npcs:[]},general_store:{id:"general_store",name:"Village General Store",ascii:`
     _________________________________
    |  SNOWPEAK GENERAL STORE        |
    |  ____  ____  ____  ____        |
    | |    ||    ||    ||    |       |
    | |FOOD||MAPS||GEAR||MISC|       |
    | |____||____||____||____|       |
    |   SHELVES  (mostly empty)      |
    |                         ___    |
    |  #########################|S|  |
    |  #####  COUNTER  ########|N|  |
    |  #########################|O|  |
    |    [bell]  [register]   |W|  |
    |________________________________|`,description:'A quaint general store with wooden shelves and a friendly bell above the door. Most of the shelves are bare, but a few items remain: emergency supplies and old postcards. Behind the counter, an ancient cash register sits closed. A brass service bell sits on the counter with a small sign: "RING FOR SERVICE." Wedged into the far corner beside the shelves, an old arcade cabinet sits gathering dust. The side art shows two kids pelting each other with snowballs.',exits:{west:"village"},hiddenExits:{},lockedExits:{},items:["store_bell","matches","postcard","store_arcade"],npcs:[]},chapel:{id:"chapel",name:"Mountain Chapel",ascii:`
     _________________________________
    |           ___                  |
    |          /   \\                 |
    |         / === \\                |
    |        / ===== \\   STEEPLE     |
    |       /_________\\              |
    |      |  []   []  |             |
    |      |           |             |
    |   ___|___________|___          |
    |  |  _______________  |         |
    |  | |     ALTAR     | |         |
    |  | |_______________| |         |
    |  |  === === === ===  | PEWS   |
    |__|__________________|_|________|`,description:'A small wooden chapel perched on a hillside overlooking the village. Simple wooden pews face a modest altar. Stained glass windows depict mountains and snowflakes instead of religious scenes. A guest book sits open on a podium, its last entry dated February 12, 1976: "May the mountain protect all who ski here. - T.S."',exits:{south:"village"},hiddenExits:{},lockedExits:{},items:["candles","guest_book"],npcs:[]},old_cabin:{id:"old_cabin",name:"Abandoned Cabin",ascii:`
     _________________________________
    |        ____/\\____              |
    |       |          |             |
    |       |  []  []  |  LOG        |
    |       |          |  CABIN      |
    |    ___|__________|___          |
    |   |                   |        |
    |   |  ___          ___ |        |
    |   | |   |        |   ||        |
    |   | | O |  FIRE  | X ||        |
    |   | |___|  PLACE |___||        |
    |   |___________________|        |
    |________________________________|`,description:"An old log cabin hidden among snow-covered pines. The roof sags in places, and the windows are clouded with frost. Inside, a stone fireplace dominates one wall (cold and dark). Furniture is covered with dusty sheets. An old writing desk by the window holds yellowed papers. A small leather pouch sits on the desk, jingling faintly. A silver-haired man sits in a rocking chair by the fireplace, wrapped in a wool blanket, reading a battered paperback. He looks like he's been here a while  and likes it that way.",exits:{north:"village"},hiddenExits:{},lockedExits:{},items:["game_tokens","basement_key"],npcs:["old_dad"]},underground_tunnel:{id:"underground_tunnel",name:"Underground Tunnel",ascii:`
     _________________________________
    | ~~~~ DARK TUNNEL ~~~~          |
    |  /\\ /\\ /\\ /\\ /\\ /\\ /\\ /\\       |
    | /  V  V  V  V  V  V  V  \\      |
    ||  rock walls     lichen   |    |
    ||  dripping water          |    |
    ||   ________________       |    |
    ||  |                |      |    |
    | \\ |  LADDER (up)   | ____/     |
    |  \\|________________|/           |
    |     narrow passage              |
    |________________________________|`,description:"A narrow stone tunnel carved through the mountain. The walls are damp and covered with pale green lichen. Water drips from the ceiling, creating small puddles on the uneven floor. The tunnel extends both north and south. A rusty ladder leads upward to what might be an old observatory. Your footsteps echo strangely here.",exits:{south:"basement",up:"hidden_observatory"},hiddenExits:{},lockedExits:{},items:["pickaxe"],npcs:[]},hidden_observatory:{id:"hidden_observatory",name:"Hidden Observatory",ascii:`
     _________________________________
    |  *  .  *  .  *  .  *  .  *  .  |
    |    ____________________        |
    |   /  dome (cracked)     \\      |
    |  |  ==================  |      |
    |  |  ==   TELESCOPE  =  |       |
    |  |  =  (still works!) =  |     |
    |  |  ==================  |      |
    |  |     ____   ____      |      |
    |  |    |    | |    |     |      |
    |   \\   | [] | | [] |    /       |
    |    \\__|____|_|____|___/        |
    |       STAR    CHARTS           |
    |________________________________|`,description:'A secret observatory hidden within the mountain itself. The domed ceiling has a large crack letting in starlight and snow. An old brass telescope still stands on its mount, pointed toward the peak. Star charts and astronomical notes cover the walls. One note reads: "The summit aligns with Polaris on the winter solstice. The medallion is the key."',exits:{down:"underground_tunnel"},hiddenExits:{},lockedExits:{},items:["telescope","star_chart","astronomers_note"],npcs:[]},ice_caves:{id:"ice_caves",name:"Ice Caves",ascii:`
     _________________________________
    |  *  *  GLITTERING ICE  *  *    |
    | \\\\//  \\\\//  \\\\//  \\\\//  \\\\//   |
    |  \\\\ICICLES EVERYWHERE//        |
    |   \\\\//  \\\\//  \\\\//  \\\\//        |
    |    ===  ===  ===  ===          |
    |  CRYSTAL BLUE WALLS             |
    |   _______________               |
    |  /   FROZEN      \\              |
    | /   UNDERGROUND   \\             |
    ||   LAKE (solid)    |            |
    | \\                 /             |
    |  \\_____________/                |
    |________________________________|`,description:"A vast network of caves carved from solid ice. The walls shimmer with blue and white crystalline formations. Icicles hang from the ceiling like chandeliers, and your breath forms clouds in the frigid air. A frozen underground lake dominates the cavern floor -- perfectly smooth and glassy. Mysterious ice formations create natural sculptures. The acoustics are strange here; sounds echo in unusual ways.",exits:{south:"ski_lift_top"},hiddenExits:{},lockedExits:{},items:["ice_crystal","frozen_flower"],npcs:[]},avalanche_zone:{id:"avalanche_zone",name:"Avalanche Zone",ascii:`
     _________________________________
    |  !!!  DANGER  !!!  WARNING !!! |
    |                                |
    |   /\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\     |
    |  /  UNSTABLE  SNOW     \\       |
    | /   PRECARIOUS  SLOPE   \\      |
    |/  ~~~~~~~~~~~~~~~~~~~~   \\     |
    |  ~~~~  DEEP  SNOW  ~~~~  |     |
    | \\  ~~~~~~~~~~~~~~~~~~~~  /     |
    |  \\   fallen trees       /      |
    |   \\  broken skis       /       |
    |    \\/\\/\\/\\/\\/\\/\\/\\/\\/\\/       |
    |  This area is TREACHEROUS!     |
    |________________________________|`,description:"A dangerously steep slope where avalanches are common. The snow here is deep and unstable, marked by old debris flows. Broken trees and abandoned equipment poke through the snow -- remnants of past disasters. Warning signs are posted everywhere, though most are half-buried. To the north, you can see a precarious ridge trail. This is not a place to linger.",exits:{west:"ski_slopes",north:"ridge_trail"},hiddenExits:{},lockedExits:{},items:["avalanche_beacon","broken_ski"],npcs:[]},ridge_trail:{id:"ridge_trail",name:"Mountain Ridge Trail",ascii:`
     _________________________________
    |  >>>>  HOWLING WIND  >>>>      |
    |                                |
    |     /\\                         |
    |    /  \\    you are HERE       |
    |   /    \\   on a narrow         |
    |  /  /\\  \\  ridge trail         |
    | |  /  \\  |                     |
    | | /    \\ |  CLIFF  CLIFF       |
    | |/      \\|  DROP   DROP        |
    | |        |  (!)    (!)         |
    |  \\_____/                       |
    |    path continues              |
    |________________________________|`,description:"A narrow trail carved into the mountainside, with sheer drops on either side. The wind howls fiercely here, and the path is barely wider than your shoulders. Ice makes the footing treacherous. Far below, you can see the village and ski slopes looking impossibly small. To the east, the lift station is visible. To the south, the avalanche zone awaits. One wrong step here would be your last.",exits:{east:"ski_lift_top",south:"avalanche_zone"},hiddenExits:{},lockedExits:{},items:["climbing_gear"],npcs:[]},summit_shelter:{id:"summit_shelter",name:"Summit Shelter",ascii:`
     _________________________________
    |  ____/\\____                    |
    | |          |  EMERGENCY        |
    | |  []  []  |  SHELTER          |
    | |          |                   |
    | |__________|                   |
    |  STONE HUT                     |
    |   _______________              |
    |  |               |  SUPPLY     |
    |  |   EMERGENCY   |  CACHE      |
    |  |    SUPPLIES   |             |
    |  |_______________|             |
    |   firewood, blankets, rations  |
    |________________________________|`,description:'A small stone shelter built at the summit for emergencies. The walls provide blessed protection from the wind. Inside, emergency supplies are neatly organized: firewood, blankets, rations, first aid. In the corner, half-buried under frost and an emergency blanket, sits an old arcade cabinet  someone must have hauled it up here decades ago. A logbook records summit visitors dating back to the 1950s. The last entry is from February 1976, written in an elegant hand: "The secret lies beneath the still water. The mountain holds its treasures close. - T.S."',exits:{west:"mountain_peak"},hiddenExits:{},lockedExits:{},items:["emergency_kit","summit_logbook","staff_key","shelter_arcade"],npcs:[]}},yD={old_map:{id:"old_map",name:"old map",description:'A faded resort map printed on yellowed paper. Most of it shows standard ski trails and facilities, but someone has drawn a large red X near the north peak, right where the frozen waterfall would be. In the margin, hasty handwriting reads: "T.S. hid it where water stands still." Try "read old map" to study it.',takeable:!0,readable:!0,readText:`You unfold the old map and study it carefully:

                               [Mountain Peak]
                                     |
                               [Ski Lift Top]
                                     |
                               [Ski Slopes]---[Frozen Waterfall]
                                     |
                [Ski Rental]---[Main Street]---[Village]
                                     |
   [Game Room]---[Lodge Bar]---[Lodge Lobby]---[Balcony]
                                     |
                                [Basement]
                           (locked door, need key)

   --- = paths     | = trails

In the margin, hasty handwriting reads:
"The path begins where water stands
still." -- T.S.`},binoculars:{id:"binoculars",name:"binoculars",description:"A pair of heavy brass binoculars, scratched but functional. Looking through them toward the mountain, you can make out a strange glint of metal behind the frozen waterfall -- as if there's an opening in the ice.",takeable:!0},broken_radio:{id:"broken_radio",name:"broken radio",description:"An old transistor radio with a cracked case. It crackles with static when you shake it. The tuning dial is stuck. Someone who knows electronics might be able to fix it.",takeable:!0},whiskey_bottle:{id:"whiskey_bottle",name:"bottle of juice",description:'A half-full bottle of "Mountain Bear" juice. The label features a bear on skis. It looks like decent stuff -- aged 12 years, according to the label.',takeable:!0},basement_key:{id:"basement_key",name:"small brass key",description:`A small brass key with an ornate handle shaped like a snowflake. It looks old but well-made. There's a tiny tag attached that reads "B" -- probably for "basement."`,takeable:!0,hidden:!0},dusty_journal:{id:"dusty_journal",name:"dusty journal",description:`A leather-bound journal belonging to Tobias Snowpeak, dated 1978. The entries describe his grand vision for the resort and his obsession with creating the "perfect ski trophy." The final entry reads: "I've hidden my greatest creation in the vault beneath the mountain. The medallion is the key. Only those worthy -- who help others and seek the truth -- will find it. The path begins where water stands still."`,takeable:!0},ski_poles:{id:"ski_poles",name:"ski poles",description:"A pair of sturdy aluminum ski poles with rubber grips. They're in good condition -- much better than most of the equipment in this shop.",takeable:!0},warm_coat:{id:"warm_coat",name:"warm coat",description:"A heavy-duty mountaineering coat lined with down filling. It's bright orange with reflective strips. Toasty warm -- perfect for braving the mountain peak.",takeable:!0},note_from_founder:{id:"note_from_founder",name:"welcome note",description:'A weathered note pinned to the base of the statue. It reads: "To future adventurers: The greatest treasures are found not alone, but with the help of friends -- even the grumpy ones. Seek the still water, and bring light to the darkness below. -- T. Snowpeak"',takeable:!0},fuse:{id:"fuse",name:"electrical fuse",description:"A heavy-duty electrical fuse, the kind used in industrial machinery. It's rated for high amperage -- exactly what a ski lift motor would need.",takeable:!0},chewed_gum:{id:"chewed_gum",name:"chewed gum",description:"A wad of already-chewed bubblegum stuck to a rock. It's bright pink and still slightly warm. Gross. Someone was here recently.",takeable:!0},torch:{id:"torch",name:"torch",description:"A wooden torch mounted on the cave wall. It still has oil-soaked rags wrapped around the top. Surprisingly, it lights easily and burns with a warm, steady flame.",takeable:!0},strange_medallion:{id:"strange_medallion",name:"strange medallion",description:"A heavy bronze medallion half-buried in the snow near the summit cairn. It's about the size of your palm, shaped like a snowflake with a ski carved in the center. The craftsmanship is extraordinary. It feels important -- like a key to something ancient.",takeable:!0},golden_ski_trophy:{id:"golden_ski_trophy",name:"golden ski trophy",description:`A magnificent trophy crafted from solid gold, shaped like a miniature ski balanced on a crystal mountain. It gleams with an inner light. An engraving on the base reads: "To the worthy adventurer who found their way -- may you always have beginner's luck." This is the legendary treasure of Snowpeak Resort!`,takeable:!0},founders_letter:{id:"founders_letter",name:"founder's letter",description:'A sealed envelope with "To the Finder" written in elegant script.',takeable:!0,readable:!0,readText:`You break the seal and unfold the letter inside:

"Dear Adventurer,

If you are reading this, you have proven yourself worthy. You helped others along the way, you followed the clues, and you braved the mountain's secrets.

I built Snowpeak Resort as a place where beginners could find magic in the mountains. The Golden Ski Trophy was never about gold -- it was about the journey. The friends you made. The puzzles you solved. The courage to explore the unknown.

Keep the trophy as a reminder: every expert was once a beginner, and every mountain is climbed one step at a time.

With warm regards and fresh powder,
Tobias Snowpeak
Founder, Snowpeak Resort
1978"

THE END

Congratulations! You have completed THE SECRET OF SNOWPEAK RESORT!`},frozen_finger:{id:"frozen_finger",name:"frozen finger",description:"A stiff, frozen finger of mysterious origin, delivered to you by an enthusiastic Husky. It's ice-cold and slightly blue. You have no idea whose it is or why a dog had it. Probably best not to think about it too hard.",takeable:!0},arcade_machine:{id:"arcade_machine",name:"arcade machine",description:'A battered arcade cabinet in the game room. The side art shows a pixelated skier racing downhill through slalom gates. The screen glows with green text: "SLALOM CHALLENGE - INSERT COIN". A hand-written note taped to the coin slot reads "FREE PLAY." Try "play arcade game" to play!',takeable:!1},basement_arcade:{id:"basement_arcade",name:"dusty arcade cabinet",description:'An ancient arcade cabinet hidden under a tarp in the basement corner. Years of dust and cobwebs cover it, but when you wipe the grime away, the side art reveals a dramatic scene: wolves and bears charging through a moonlit forest toward a tiny village. The marquee reads "DEFEND THE VILLAGE" in faded red letters. Amazingly, a dim green power light still glows on the back panel. Someone must have left it plugged in decades ago. Try "play defend game" to play!',takeable:!1},staff_uniform:{id:"staff_uniform",name:"staff uniform",description:`A faded Snowpeak Resort staff uniform -- red polo shirt and khaki pants. A name tag still pinned to the shirt reads "SARAH." The uniform looks like it hasn't been worn in decades.`,takeable:!0},old_photograph:{id:"old_photograph",name:"old photograph",description:"A black and white photograph of the resort staff from 1976. Everyone is smiling in their uniforms. The photo is dated February 10, 1976 -- just two days before the resort mysteriously closed.",takeable:!0},rusty_knife:{id:"rusty_knife",name:"rusty knife",description:"A chef's knife, heavily rusted but still sharp. The handle is worn from years of use. It's seen better days but could still be useful.",takeable:!0},old_recipe:{id:"old_recipe",name:"old recipe",description:`A recipe card for "Snowpeak Hot Chocolate" -- the resort's signature drink. The ingredients include cocoa, milk, vanilla, and "a pinch of mountain magic." Someone has written in the margin: "The key is in the pantry."`,takeable:!0,readable:!0,readText:'SNOWPEAK HOT CHOCOLATE: Heat milk, add cocoa and vanilla, stir with love. "The warmth of the mountain in every cup!" Note in margin: "The key is in the pantry."'},canned_beans:{id:"canned_beans",name:"canned beans",description:"A can of beans with a faded label. Expired in 1977, but canned goods last forever, right? ...Right?",takeable:!0},screwdriver:{id:"screwdriver",name:"screwdriver",description:"A well-used flathead screwdriver with a wooden handle. Perfect for repairs or prying open stubborn panels.",takeable:!0},rope:{id:"rope",name:"climbing rope",description:"A coil of sturdy climbing rope, about 50 feet long. It looks trustworthy enough for serious mountaineering.",takeable:!0},trail_map:{id:"trail_map",name:"trail guide",description:"A detailed trail guide of the entire mountain, showing expert slopes, ridge trails, and danger zones marked in red. Much more comprehensive than the old map from the lobby.",takeable:!0},matches:{id:"matches",name:"waterproof matches",description:"A box of waterproof matches -- essential for mountain survival. The box is nearly full.",takeable:!0},postcard:{id:"postcard",name:"vintage postcard",description:'A vintage postcard showing Snowpeak Resort in its heyday -- crowded slopes, happy skiers, the lodge lit up at night. On the back, an unsent message reads: "Having a wonderful time! This place is magical. - T."',takeable:!0},candles:{id:"candles",name:"prayer candles",description:"Several tall white candles used for prayer or meditation. They smell faintly of beeswax.",takeable:!0},guest_book:{id:"guest_book",name:"chapel guest book",description:"A leather-bound guest book from the chapel, filled with entries from visitors over the years. The last entry is from T.S. on February 12, 1976.",takeable:!0,readable:!0,readText:'You flip through the guest book. Most entries are standard tourist fare. The last entry, in elegant script, reads: "May the mountain protect all who ski here. The greatest treasure is not gold, but the journey we share. - T.S., February 12, 1976"'},cabin_journal:{id:"cabin_journal",name:"cabin journal",description:"A personal journal found in the abandoned cabin. It appears to belong to Tobias Snowpeak himself. The entries describe his life at the resort and his secret project.",takeable:!0,readable:!0,readText:`You read the journal entries. Most describe daily resort operations, but later entries grow more mysterious: "I've completed the vault. Only those who truly understand the mountain -- who help others and explore thoroughly -- will find it. I've left clues throughout the resort. The medallion waits at the summit for the worthy."`},pickaxe:{id:"pickaxe",name:"pickaxe",description:"A sturdy mining pickaxe with a wooden handle. The metal head is still sharp. It could be useful for breaking through ice or rock.",takeable:!0},telescope:{id:"telescope",name:"brass telescope",description:"An antique brass telescope mounted on a stand. Despite the cracked observatory dome, it still functions perfectly. When pointed at the peak, you can see the summit in remarkable detail.",takeable:!1},star_chart:{id:"star_chart",name:"star chart",description:'An astronomical chart showing the winter night sky. Someone has circled Polaris (the North Star) and drawn lines connecting it to the mountain peak. A note reads: "Winter solstice alignment."',takeable:!0},astronomers_note:{id:"astronomers_note",name:"astronomer's note",description:"A yellowed note pinned to the observatory wall.",takeable:!0,readable:!0,readText:`The note reads: "The summit aligns with Polaris on the winter solstice. T.S. was obsessed with this alignment. He believed the mountain held ancient secrets. The medallion at the summit is more than decoration -- it's the KEY to the vault beneath the frozen waterfall."`},ice_crystal:{id:"ice_crystal",name:"ice crystal",description:"A perfectly formed ice crystal, about the size of your hand. It refracts light into beautiful rainbow patterns. Remarkably, it doesn't melt.",takeable:!0},frozen_flower:{id:"frozen_flower",name:"frozen flower",description:"A delicate alpine flower, perfectly preserved in clear ice. It must have been frozen instantly -- every petal is intact.",takeable:!0},avalanche_beacon:{id:"avalanche_beacon",name:"avalanche beacon",description:"An electronic avalanche beacon, partially buried in the snow. Its battery is dead, but it's still a somber reminder of the dangers here.",takeable:!0},broken_ski:{id:"broken_ski",name:"broken ski",description:"Half of a wooden ski, snapped in two. The wood is weathered and old -- from an avalanche years ago.",takeable:!0},climbing_gear:{id:"climbing_gear",name:"climbing gear",description:"Professional mountaineering equipment: carabiners, pitons, and anchors. Left here by previous climbers, perhaps for emergencies.",takeable:!0},emergency_kit:{id:"emergency_kit",name:"emergency kit",description:"A weatherproof emergency survival kit containing first aid supplies, emergency blankets, signal flares, and energy bars. All in good condition.",takeable:!0},summit_logbook:{id:"summit_logbook",name:"summit logbook",description:"A logbook recording everyone who reached the summit, dating back to 1950. The final entry is from February 1976.",takeable:!0,readable:!0,readText:'You flip through decades of summit entries. The last one, in elegant handwriting, reads: "February 12, 1976 - My final ascent. The secret lies beneath the still water. The mountain holds its treasures close to those who earn them. May future adventurers find what I have hidden. - Tobias Snowpeak"'},staff_key:{id:"staff_key",name:"staff key",description:'A brass key labeled "STAFF QUARTERS." It looks like it opens the locked staff area in the lodge.',takeable:!0,hidden:!1}},TD={old_map:{id:"old_map",name:"old map",description:'A faded resort map printed on yellowed paper, heavily marked with additions and notes. Parts of the map are worn and illegible -- some areas may be missing entirely. Someone has drawn a large red X near the north peak, right where the frozen waterfall would be. In the margin, hasty handwriting reads: "T.S. hid it where water stands still." Try "read old map" to study it.',takeable:!0,readable:!0,readText:`You unfold the old map and study it carefully:

        [Summit Shelter]---[Mountain Peak]
                                  |
           [Ridge Trail]---[Ski Lift Top]---[Ice Caves]
                 |                |
         [Avalanche Zone]---[Ski Slopes]---[Frozen Waterfall]
                                  |
 [Storage]---[Ski Rental]---[Main Street]---[Village]---[General Store]
                                  |             |
                                  |         [Chapel]
                                  |             |
                                  |        [Old Cabin]
                                  |
                [Balcony]---[Lodge Lobby]---[Bar]---[Game Room]
                                  |           |
                               [Staff]    [Kitchen]
                                  |           |
                              [Staff Q]   [Pantry]
                                  |
                             [Basement]

   --- = paths     | = trails
   [Basement] requires a key to access

   ADDITIONAL NOTES (in red ink):
   - Staff areas require special key
   - Ridge trail is DANGEROUS - proceed with caution
   - Map is faded and incomplete -- some areas not shown

In the margin, hasty handwriting reads:
"The path begins where water stands still.
Explore thoroughly - all areas matter now." -- T.S.`},binoculars:{id:"binoculars",name:"binoculars",description:"A pair of heavy brass binoculars, scratched but functional. Looking through them toward the mountain, you can make out a strange glint of metal behind the frozen waterfall -- as if there's an opening in the ice.",takeable:!0},broken_radio:{id:"broken_radio",name:"broken radio",description:"An old transistor radio with a cracked case. It crackles with static when you shake it. The tuning dial is stuck. Someone who knows electronics might be able to fix it.",takeable:!0},whiskey_bottle:{id:"whiskey_bottle",name:"bottle of juice",description:'A half-full bottle of "Mountain Bear" juice. The label features a bear on skis. It looks like decent stuff -- aged 12 years, according to the label.',takeable:!0},basement_key:{id:"basement_key",name:"old basement key",description:'An old brass key with an ornate handle shaped like a snowflake. A faded tag attached to the ring reads "BASEMENT" in block letters. It looks like it fits a heavy door.',takeable:!0},dusty_journal:{id:"dusty_journal",name:"dusty journal",description:`A leather-bound journal belonging to Tobias Snowpeak, dated 1978. The entries describe his grand vision for the resort and his obsession with creating the "perfect ski trophy." The final entry reads: "I've hidden my greatest creation in the vault beneath the mountain. The medallion is the key. Only those worthy -- who help others and seek the truth -- will find it. The path begins where water stands still."`,takeable:!0},ski_poles:{id:"ski_poles",name:"ski poles",description:"A pair of sturdy aluminum ski poles with rubber grips. They're in good condition -- much better than most of the equipment in this shop.",takeable:!0},warm_coat:{id:"warm_coat",name:"warm coat",description:"A heavy-duty mountaineering coat lined with down filling. It's bright orange with reflective strips. Toasty warm -- perfect for braving the mountain peak.",takeable:!0},note_from_founder:{id:"note_from_founder",name:"welcome note",description:'A weathered note pinned to the base of the statue. It reads: "To future adventurers: The greatest treasures are found not alone, but with the help of friends -- even the grumpy ones. Seek the still water, and bring light to the darkness below. -- T. Snowpeak"',takeable:!0},fuse:{id:"fuse",name:"electrical fuse",description:"A heavy-duty electrical fuse, the kind used in industrial machinery. It's rated for high amperage -- exactly what a ski lift motor would need. It must have been wedged behind that old arcade cabinet for decades.",takeable:!0,hidden:!0},chewed_gum:{id:"chewed_gum",name:"chewed gum",description:"A wad of already-chewed bubblegum stuck to a rock. It's bright pink and still slightly warm. Gross. Someone was here recently.",takeable:!0},torch:{id:"torch",name:"torch",description:"A wooden torch mounted on the cave wall. It still has oil-soaked rags wrapped around the top. Surprisingly, it lights easily and burns with a warm, steady flame.",takeable:!0},strange_medallion:{id:"strange_medallion",name:"strange medallion",description:"A heavy bronze medallion half-buried in the snow near the summit cairn. It's about the size of your palm, shaped like a snowflake with a ski carved in the center. The craftsmanship is extraordinary. It feels important -- like a key to something ancient.",takeable:!0},golden_ski_trophy:{id:"golden_ski_trophy",name:"golden ski trophy",description:`A magnificent trophy crafted from solid gold, shaped like a miniature ski balanced on a crystal mountain. It gleams with an inner light. An engraving on the base reads: "To the worthy adventurer who found their way -- may you always have beginner's luck." This is the legendary treasure of Snowpeak Resort!`,takeable:!0},founders_letter:{id:"founders_letter",name:"founder's letter",description:'A sealed envelope with "To the Finder" written in elegant script.',takeable:!0,readable:!0,readText:`You break the seal and unfold the letter inside:

"Dear Adventurer,

If you are reading this, you have proven yourself worthy. You helped others along the way, you followed the clues, and you braved the mountain's secrets.

I built Snowpeak Resort as a place where beginners could find magic in the mountains. The Golden Ski Trophy was never about gold -- it was about the journey. The friends you made. The puzzles you solved. The courage to explore the unknown.

Keep the trophy as a reminder: every expert was once a beginner, and every mountain is climbed one step at a time.

With warm regards and fresh powder,
Tobias Snowpeak
Founder, Snowpeak Resort
1978"

THE END

Congratulations! You have completed THE SECRET OF SNOWPEAK RESORT!`},frozen_finger:{id:"frozen_finger",name:"frozen finger",description:"A stiff, frozen finger of mysterious origin, delivered to you by an enthusiastic Husky. It's ice-cold and slightly blue. You have no idea whose it is or why a dog had it. Probably best not to think about it too hard.",takeable:!0},arcade_machine:{id:"arcade_machine",name:"arcade machine",description:'A battered arcade cabinet in the game room. The side art shows a pixelated skier racing downhill through slalom gates. The screen glows with green text: "SLALOM CHALLENGE - INSERT COIN". A hand-written note taped to the coin slot reads "FREE PLAY." Try "play arcade game" to play!',takeable:!1},basement_arcade:{id:"basement_arcade",name:"dusty arcade cabinet",description:'An ancient arcade cabinet hidden under a tarp in the basement corner. Years of dust and cobwebs cover it, but when you wipe the grime away, the side art reveals a dramatic scene: wolves and bears charging through a moonlit forest toward a tiny village. The marquee reads "DEFEND THE VILLAGE" in faded red letters. Amazingly, a dim green power light still glows on the back panel. Someone must have left it plugged in decades ago. Try "play defend game" to play!',takeable:!1},store_arcade:{id:"store_arcade",name:"snowball arcade cabinet",description:'A beat-up arcade cabinet wedged into the corner of the general store. The side art shows two pixelated kids in winter gear hurling snowballs at each other across a snowy field. The marquee reads "SNOWBALL SHOWDOWN" in icy blue letters. A brass token slot on the front panel reads "INSERT TOKEN." Try "play snowball game" to play!',takeable:!1},shelter_arcade:{id:"shelter_arcade",name:"frost-covered arcade cabinet",description:'An old arcade cabinet sits in the corner of the summit shelter, half-buried under frost and a dusty emergency blanket. The side art, barely visible under a layer of ice crystals, shows neon-colored bricks shattering as a glowing ball ricochets between walls. The marquee reads "ICE BREAKER" in electric cyan letters. A brass token slot on the front panel is nearly frozen shut. Try "play ice breaker" to play!',takeable:!1},staff_uniform:{id:"staff_uniform",name:"staff uniform",description:`A faded Snowpeak Resort staff uniform -- red polo shirt and khaki pants. A name tag still pinned to the shirt reads "SARAH." The uniform looks like it hasn't been worn in decades.`,takeable:!0},old_photograph:{id:"old_photograph",name:"old photograph",description:"A black and white photograph of the resort staff from 1976. Everyone is smiling in their uniforms. The photo is dated February 10, 1976 -- just two days before the resort mysteriously closed.",takeable:!0},rusty_knife:{id:"rusty_knife",name:"rusty knife",description:"A chef's knife, heavily rusted but still sharp. The handle is worn from years of use. It's seen better days but could still be useful.",takeable:!0},old_recipe:{id:"old_recipe",name:"old recipe",description:`A recipe card for "Snowpeak Hot Chocolate" -- the resort's signature drink. The ingredients include cocoa, milk, vanilla, and "a pinch of mountain magic." Someone has written in the margin: "The key is in the pantry."`,takeable:!0,readable:!0,readText:'SNOWPEAK HOT CHOCOLATE: Heat milk, add cocoa and vanilla, stir with love. "The warmth of the mountain in every cup!" Note in margin: "The key is in the pantry."'},canned_beans:{id:"canned_beans",name:"canned beans",description:"A can of beans with a faded label. Expired in 1977, but canned goods last forever, right? ...Right?",takeable:!0},screwdriver:{id:"screwdriver",name:"screwdriver",description:"A well-used flathead screwdriver with a wooden handle. Perfect for repairs or prying open stubborn panels.",takeable:!0},rope:{id:"rope",name:"climbing rope",description:"A coil of sturdy climbing rope, about 50 feet long. It looks trustworthy enough for serious mountaineering.",takeable:!0},trail_map:{id:"trail_map",name:"trail guide",description:"A detailed trail guide of the entire mountain, showing expert slopes, ridge trails, and danger zones marked in red. Much more comprehensive than the old map from the lobby.",takeable:!0},matches:{id:"matches",name:"waterproof matches",description:"A box of waterproof matches -- essential for mountain survival. The box is nearly full. Perfect for lighting candles or creating temporary light, though a single match won't last long in the mountain wind.",takeable:!0},postcard:{id:"postcard",name:"vintage postcard",description:'A vintage postcard showing Snowpeak Resort in its heyday -- crowded slopes, happy skiers, the lodge lit up at night. On the back, an unsent message reads: "Having a wonderful time! This place is magical. - T."',takeable:!0},candles:{id:"candles",name:"prayer candles",description:"Several tall white candles used for prayer or meditation. They smell faintly of beeswax. Unlit, but they could provide a comforting light if you had matches. The wax is thick and sturdy -- they might hold a flame better than matches alone, though strong winds would still snuff them out.",takeable:!0},guest_book:{id:"guest_book",name:"chapel guest book",description:"A leather-bound guest book from the chapel, filled with entries from visitors over the years. The last entry is from T.S. on February 12, 1976.",takeable:!0,readable:!0,readText:'You flip through the guest book. Most entries are standard tourist fare. The last entry, in elegant script, reads: "May the mountain protect all who ski here. The greatest treasure is not gold, but the journey we share. - T.S., February 12, 1976"'},game_tokens:{id:"game_tokens",name:"bag of game tokens",description:"A small drawstring pouch made of worn leather, jingling with brass tokens. Each token is stamped with the Snowpeak Resort logo  a tiny ski crossed with a snowflake. These must be for the old arcade machines around the resort.",takeable:!0},pickaxe:{id:"pickaxe",name:"pickaxe",description:"A sturdy mining pickaxe with a wooden handle. The metal head is still sharp. It could be useful for breaking through ice or rock.",takeable:!0},telescope:{id:"telescope",name:"brass telescope",description:"An antique brass telescope mounted on a stand. Despite the cracked observatory dome, it still functions perfectly. When pointed at the peak, you can see the summit in remarkable detail.",takeable:!1},star_chart:{id:"star_chart",name:"star chart",description:'An astronomical chart showing the winter night sky. Someone has circled Polaris (the North Star) and drawn lines connecting it to the mountain peak. A note reads: "Winter solstice alignment."',takeable:!0},astronomers_note:{id:"astronomers_note",name:"astronomer's note",description:"A yellowed note pinned to the observatory wall.",takeable:!0,readable:!0,readText:`The note reads: "The summit aligns with Polaris on the winter solstice. T.S. was obsessed with this alignment. He believed the mountain held ancient secrets. The medallion at the summit is more than decoration -- it's the KEY to the vault beneath the frozen waterfall."`},ice_crystal:{id:"ice_crystal",name:"ice crystal",description:"A perfectly formed ice crystal, about the size of your hand. It refracts light into beautiful rainbow patterns. Remarkably, it doesn't melt.",takeable:!0},frozen_flower:{id:"frozen_flower",name:"frozen flower",description:"A delicate alpine flower, perfectly preserved in clear ice. It must have been frozen instantly -- every petal is intact.",takeable:!0},avalanche_beacon:{id:"avalanche_beacon",name:"avalanche beacon",description:"An electronic avalanche beacon, partially buried in the snow. Its battery is dead, but it's still a somber reminder of the dangers here.",takeable:!0},broken_ski:{id:"broken_ski",name:"broken ski",description:"Half of a wooden ski, snapped in two. The wood is weathered and old -- from an avalanche years ago.",takeable:!0},climbing_gear:{id:"climbing_gear",name:"climbing gear",description:"Professional mountaineering equipment: carabiners, pitons, and anchors. Left here by previous climbers, perhaps for emergencies.",takeable:!0},emergency_kit:{id:"emergency_kit",name:"emergency kit",description:"A weatherproof emergency survival kit containing first aid supplies, emergency blankets, signal flares, and energy bars. All in good condition.",takeable:!0},summit_logbook:{id:"summit_logbook",name:"summit logbook",description:"A logbook recording everyone who reached the summit, dating back to 1950. The final entry is from February 1976.",takeable:!0,readable:!0,readText:'You flip through decades of summit entries. The last one, in elegant handwriting, reads: "February 12, 1976 - My final ascent. The secret lies beneath the still water. The mountain holds its treasures close to those who earn them. May future adventurers find what I have hidden. - Tobias Snowpeak"'},staff_key:{id:"staff_key",name:"staff key",description:'A brass key labeled "STAFF QUARTERS." It looks like it opens the locked staff area in the lodge.',takeable:!0,hidden:!1},store_bell:{id:"store_bell",name:"bell",description:`A brass service bell sitting on the counter. A small sign next to it reads "RING FOR SERVICE" though there's clearly nobody here to answer.`,takeable:!1}},ED={angry_boss:{id:"angry_boss",name:"Angry Boss",description:`A young woman with a permanently mad face, squeezed into a ski suit two sizes too big. She's gripping the bar counter like she's trying to strangle it, muttering furiously about "incompetent resort staff."`,currentRoomId:"lodge_bar",dialogueState:0,dialogue:[{state:0,text:`"WHAT DO YOU WANT?!" Angry Boss slams her fist on the bar. "This whole resort is a DISASTER! The ski lift is broken, my room smells like mildew, the hot tub is frozen solid, and NOW the radio is dead! I came here to RELAX and instead I'm having the WORST vacation of my LIFE!"`},{state:1,condition:{hasItem:"whiskey_bottle"},text:`You offer the bottle of juice. Angry Boss's eyes widen. Her red face softens just slightly.

"Well... maybe this trip isn't ALL bad." She takes a long swig and exhales. "You know what, kid? I'll tell you something. Yesterday I was stomping around the slopes in a rage -- don't judge me -- and I saw something STRANGE. Behind that frozen waterfall up north... there's a CAVE. I could see an opening in the ice. Looked like someone sealed it up years ago. Might be worth checking out."

She takes another swig and almost smiles. Almost.`,effects:{removeItem:"whiskey_bottle",setFlag:["angry_boss","calmed",!0]}},{state:1,text:`"I TOLD you, leave me ALONE! Can't a woman be furious in peace?! Unless you've got something to improve my day -- and I mean SIGNIFICANTLY -- then GET LOST!"`},{state:2,text:`"What, you want MORE from me? I told you about the cave behind the waterfall. Now let me enjoy my whiskey in peace. This is the first thing that's gone RIGHT all week."`}]},mr_smiles:{id:"mr_smiles",name:"Mr Smiles",description:"A happy boy with an impossibly wide grin, wearing a neon yellow ski jacket so bright it practically glows. Despite looking like he's never seen snow before, his enthusiasm is absolutely unshakeable.",currentRoomId:"lodge_lobby",dialogueState:0,dialogue:[{state:0,text:`"Oh HELLO there, friend! Isn't this resort just WONDERFUL?" Mr Smiles gestures enthusiastically at a boarded-up window. "I mean, sure, the ski lift is broken and I lost my ski poles somewhere, and I fell down seventeen times on the bunny slope, but WHAT. A. VIEW! I just know today is going to be AMAZING!"`},{state:1,condition:{hasItem:"ski_poles"},text:`"MY SKI POLES! You FOUND them! Oh you are just the BEST PERSON I have ever met, and I have met a LOT of people!"

Mr Smiles does a little dance of joy.

"Here, take this -- I found it rattling around in the ski lift machinery when I was, uh, definitely NOT trying to ride the broken lift. It looked important!" He hands you an electrical fuse. "Now if you'll excuse me, I'm going to CONQUER that bunny slope! WISH ME LUCK!"

Mr Smiles practically skips toward the door.`,effects:{removeItem:"ski_poles",addItem:"fuse",setFlag:["mr_smiles","helped",!0],moveNpc:["mr_smiles","ski_slopes"]}},{state:1,text:`"I'd LOVE to hit the slopes but I seem to have misplaced my ski poles! I had them in the rental shop, I'm SURE of it. Without them I just flop around like a happy noodle! Not that there's anything WRONG with being a happy noodle!"`},{state:2,text:`"HELLO AGAIN, best friend! I'm having the TIME OF MY LIFE on this slope! I've only fallen down six times! That's a PERSONAL BEST!"`}]},dill_pickle:{id:"dill_pickle",name:"Dill Pickle",description:"A cute boy with mischevious smile and wearing completely mismatched ski gear -- one red boot, one blue boot, goggles on their forehead, and a ski jacket worn inside-out. They're examining a ski boot with the intensity of an archaeologist studying an ancient artifact.",currentRoomId:"ski_rental",dialogueState:0,dialogue:[{state:0,text:`"Hmm, FASCINATING." Dill Pickle holds up a ski boot and peers inside it. "Did you know that ski boots were originally medieval torture devices repurposed for recreation? I read that on a bathroom wall once. Very reliable source."

They turn the boot upside down and shake it. A small brass key falls out and clatters to the floor.

"Oh. That was in there. Huh. You know, I've been shaking boots all morning hoping a sandwich would fall out, but a key is good too. Probably."`,effects:{revealItem:["basement_key","ski_rental"]}},{state:1,condition:{hasItem:"broken_radio"},text:`"Ooh, a BROKEN RADIO! Give it here!" Dill Pickle's eyes light up. "I once repaired a submarine's sonar system with a paperclip, a wad of gum, and an overwhelming sense of optimism. A radio should be easy."

They tinker with it for about ten seconds, somehow using a ski pole as a soldering iron. The radio crackles to life:

"...the founder hid his greatest treasure where water stands still... the medallion is the key to the vault below... seek the cave behind the ice..."

Dill Pickle nods sagely. "Sounds legit. Water standing still... like a frozen waterfall, maybe? I'm just spitballing here. I'm mostly thinking about sandwiches."`,effects:{removeItem:"broken_radio",setFlag:["dill_pickle","fixed_radio",!0]}},{state:1,text:`"Still trying to figure out which foot is the ski foot. Is it the left foot? The right foot? The THIRD foot? I feel like if I had a broken radio I could do something really useful. Don't ask me why. It's a FEELING."`},{state:2,text:`"That radio keeps repeating something about water standing still and a vault. Very mysterious. You know what ELSE is mysterious? Why they don't sell sandwiches at a ski resort. Criminal, really."`}]},coach_joe:{id:"coach_joe",name:"Coach Joe",description:"A muscular man in a whistle and tracksuit, somehow wearing sneakers in the snow. He keeps blowing his whistle at nobody in particular and shouting motivational phrases at the mountain.",currentRoomId:"ski_slopes",dialogueState:0,dialogue:[{state:0,condition:{hasFlag:"slalom_champion"},text:`"Good job, kid. I heard you beat my high score in Slalom Challenge." He gives you a respectful nod. "That's real talent right there. I've been holding that record since '82. You earned it, CHAMP!"`},{state:0,text:`"HUSTLE HUSTLE HUSTLE!" Coach Joe blows his whistle at a nearby tree. "You think this mountain is gonna ski ITSELF? Give me twenty push-ups! Actually, don't. The snow is cold. Give me twenty MENTAL push-ups. Think really hard about push-ups. GREAT WORK, CHAMP!"`},{state:1,text:`"You know what separates a WINNER from a LOSER on the slopes? NOTHING! They both fall down! But the WINNER falls down with CONFIDENCE!" He blows his whistle triumphantly. "That's free advice. Normally I charge for that."`},{state:2,text:`"I've been coaching ski beginners for thirty years and I've never actually been on skis myself. You know why? Because a true coach leads from the SIDELINES! Also I'm terrified of heights. DON'T TELL ANYONE!"`}]},dance_mom:{id:"dance_mom",name:"Social Media Influencer",description:"A woman in a sequined ski jacket and full stage makeup, filming everything on her phone with a ring light clipped to the top. She appears to be live-streaming her ski resort experience to an audience of possibly no one.",currentRoomId:"village",dialogueState:0,dialogue:[{state:0,text:`"And THIS, followers, is what we call RUSTIC CHARM!" She pans her phone across the village with practiced flair. "My daughter Samantha would have LOVED this mountain  she's got the best ski aesthetic of anyone I know. But her dance recital is this weekend so she couldn't make it. Her loss is YOUR gain, followers. CONTENT waits for no one!"`},{state:1,text:`"Excuse me, can you hold this phone and film me doing a dramatic pose by that statue? No? FINE. I'll use the selfie stick. You know, in MY day, mountains were taller AND the hot chocolate was free. This resort is a THREE out of TEN. But the lighting is GORGEOUS. Samantha is going to be SO jealous when she sees these stories."`},{state:2,text:`"My livestream just hit FOUR viewers! That's double from last time! One of them might be my mom, but engagement is engagement, honey. Samantha says I should try TikTok but I told her  mommy is a MULTI-PLATFORM creator. If you find any secret treasure in this dump, tag me. I need CONTENT."`}]},henrys_mom:{id:"henrys_mom",name:"Henry's Mom",description:"A warm, cheerful woman bundled in a cozy puffer jacket, surrounded by an impressive array of tote bags overflowing with snacks of every variety. Granola bars, fruit snacks, trail mix, string cheese, juice boxes  it's like a mobile convenience store. She has the kind smile of someone who's never met a stranger, though right now she keeps glancing around nervously for her son.",currentRoomId:"main_street",dialogueState:0,dialogue:[{state:0,text:`"Oh, hello sweetie!" She beams at you and immediately starts rummaging through one of her tote bags. "Have you seen my Henry? That boy took off to 'explore the mountain' about an hour ago and I just KNOW he didn't pack enough snacks. I gave him two granola bars but that's barely a warmup!"

She pulls out a fruit snack pouch and offers it to you. "Here, take this. You look like you could use a snack. I always say  you can never have too many snacks on an adventure. Do you want trail mix too? I have seven bags. SEVEN."`},{state:1,text:`"Still no Henry!" She shakes her head but manages a warm laugh. "That kid  he's got his father's sense of adventure and absolutely NONE of his common sense about packing food. I bet he's out there right now, climbing something he shouldn't be, with nothing but an empty granola bar wrapper in his pocket."

She holds up a thermos. "Hot cocoa? I made it from scratch this morning. I also have chicken soup, apple cider, and something that might be tea? Oh, and string cheese! The good kind, not the weird rubbery kind. Please, take something. I brought enough snacks for the entire resort and it would make me feel SO much better knowing at least someone out there is well-fed."`},{state:2,text:`"Henry just texted! He says he's been having the BEST time exploring the lodge. The LODGE! He was right here the whole time!" She laughs and wipes her eyes. "He says he made friends with some angry lady at the bar and they've been debating whether this resort needs better snack machines. That's my boy."

She starts reorganizing her tote bags with visible relief. "I swear, being a mom is 10% parenting and 90% making sure everyone has enough to eat. Are you SURE you don't want a juice box? I have a whole case. Take two. Take three! You're an adventurer  you need your energy!"`}]}},vD={angry_boss:{id:"angry_boss",name:"Angry Boss",description:`A young woman with a permanently mad face, squeezed into a ski suit two sizes too big. She's gripping the bar counter like she's trying to strangle it, muttering furiously about "incompetent resort staff."`,currentRoomId:"lodge_bar",dialogueState:0,dialogue:[{state:0,text:`"WHAT DO YOU WANT?!" Angry Boss slams her fist on the bar. "This whole resort is a DISASTER! The ski lift is broken, my room smells like mildew, the hot tub is frozen solid, and NOW the radio is dead! I came here to RELAX and instead I'm having the WORST vacation of my LIFE!"`},{state:1,condition:{hasItem:"whiskey_bottle"},text:`You offer the bottle of juice. Angry Boss's eyes widen. Her red face softens just slightly.

"Well... maybe this trip isn't ALL bad." She takes a long swig and exhales. "You know what, kid? I'll tell you something. Yesterday I was stomping around the slopes in a rage -- don't judge me -- and I saw something STRANGE. Behind that frozen waterfall up north... there's a CAVE. I could see an opening in the ice. Looked like someone sealed it up years ago. Might be worth checking out."

She takes another swig and almost smiles. Almost.`,effects:{removeItem:"whiskey_bottle",setFlag:["angry_boss","calmed",!0]}},{state:1,text:`"I TOLD you, leave me ALONE! Can't a woman be furious in peace?! Unless you've got something to improve my day -- and I mean SIGNIFICANTLY -- then GET LOST!"`},{state:2,text:`"What, you want MORE from me? I told you about the cave behind the waterfall. Now let me enjoy my whiskey in peace. This is the first thing that's gone RIGHT all week."`}]},mr_smiles:{id:"mr_smiles",name:"Mr Smiles",description:"A happy boy with an impossibly wide grin, wearing a neon yellow ski jacket so bright it practically glows. Despite looking like he's never seen snow before, his enthusiasm is absolutely unshakeable.",currentRoomId:"lodge_lobby",dialogueState:0,dialogue:[{state:0,text:`"Oh HELLO there, friend! Isn't this resort just WONDERFUL?" Mr Smiles gestures enthusiastically at a boarded-up window. "I mean, sure, the ski lift is broken and I lost my ski poles somewhere, and I fell down seventeen times on the bunny slope, but WHAT. A. VIEW! I just know today is going to be AMAZING!"`},{state:1,condition:{hasItem:"ski_poles"},text:`"MY SKI POLES! You FOUND them! Oh you are just the BEST PERSON I have ever met, and I have met a LOT of people!"

Mr Smiles does a little dance of joy.

"Thank you SO MUCH! Now if you'll excuse me, I'm going to CONQUER that bunny slope! WISH ME LUCK!"

Mr Smiles practically skips toward the door.`,effects:{removeItem:"ski_poles",setFlag:["mr_smiles","helped",!0],moveNpc:["mr_smiles","ski_slopes"]}},{state:1,text:`"I'd LOVE to hit the slopes but I seem to have misplaced my ski poles! I had them in the rental shop, I'm SURE of it. Without them I just flop around like a happy noodle! Not that there's anything WRONG with being a happy noodle!"`},{state:2,text:`"HELLO AGAIN, best friend! I'm having the TIME OF MY LIFE on this slope! I've only fallen down six times! That's a PERSONAL BEST!"`}]},dill_pickle:{id:"dill_pickle",name:"Dill Pickle",description:"A cute boy with mischevious smile and wearing completely mismatched ski gear -- one red boot, one blue boot, goggles on their forehead, and a ski jacket worn inside-out. They're examining a ski boot with the intensity of an archaeologist studying an ancient artifact.",currentRoomId:"ski_rental",dialogueState:0,dialogue:[{state:0,text:`"Hmm, FASCINATING." Dill Pickle holds up a ski boot and peers inside it. "Did you know that ski boots were originally medieval torture devices repurposed for recreation? I read that on a bathroom wall once. Very reliable source."

They turn the boot upside down and shake it vigorously.

"Nothing. Not even a sandwich. Disappointing, but I respect the boot's commitment to being empty. Very zen."`,effects:{}},{state:1,condition:{hasItem:"broken_radio"},text:`"Ooh, a BROKEN RADIO! Give it here!" Dill Pickle's eyes light up. "I once repaired a submarine's sonar system with a paperclip, a wad of gum, and an overwhelming sense of optimism. A radio should be easy."

They tinker with it for about ten seconds, somehow using a ski pole as a soldering iron. The radio crackles to life:

"...the founder hid his greatest treasure where water stands still... the medallion is the key to the vault below... seek the cave behind the ice..."

Dill Pickle nods sagely. "Sounds legit. Water standing still... like a frozen waterfall, maybe? I'm just spitballing here. I'm mostly thinking about sandwiches."`,effects:{removeItem:"broken_radio",setFlag:["dill_pickle","fixed_radio",!0]}},{state:1,text:`"Still trying to figure out which foot is the ski foot. Is it the left foot? The right foot? The THIRD foot? I feel like if I had a broken radio I could do something really useful. Don't ask me why. It's a FEELING."`},{state:2,text:`"That radio keeps repeating something about water standing still and a vault. Very mysterious. You know what ELSE is mysterious? Why they don't sell sandwiches at a ski resort. Criminal, really."`}]},coach_joe:{id:"coach_joe",name:"Coach Joe",description:"A muscular man in a whistle and tracksuit, somehow wearing sneakers in the snow. He keeps blowing his whistle at nobody in particular and shouting motivational phrases at the mountain.",currentRoomId:"ski_slopes",dialogueState:0,dialogue:[{state:0,condition:{hasFlag:"slalom_champion"},text:`"Good job, kid. I heard you beat my high score in Slalom Challenge." He gives you a respectful nod. "That's real talent right there. I've been holding that record since '82. You earned it, CHAMP!"`},{state:0,text:`"HUSTLE HUSTLE HUSTLE!" Coach Joe blows his whistle at a nearby tree. "You think this mountain is gonna ski ITSELF? Give me twenty push-ups! Actually, don't. The snow is cold. Give me twenty MENTAL push-ups. Think really hard about push-ups. GREAT WORK, CHAMP!"`},{state:1,text:`"You know what separates a WINNER from a LOSER on the slopes? NOTHING! They both fall down! But the WINNER falls down with CONFIDENCE!" He blows his whistle triumphantly. "That's free advice. Normally I charge for that."`},{state:2,text:`"I've been coaching ski beginners for thirty years and I've never actually been on skis myself. You know why? Because a true coach leads from the SIDELINES! Also I'm terrified of heights. DON'T TELL ANYONE!"`}]},dance_mom:{id:"dance_mom",name:"Social Media Influencer",description:"A woman in a sequined ski jacket and full stage makeup, filming everything on her phone with a ring light clipped to the top. She appears to be live-streaming her ski resort experience to an audience of possibly no one.",currentRoomId:"village",dialogueState:0,dialogue:[{state:0,text:`"And THIS, followers, is what we call RUSTIC CHARM!" She pans her phone across the village with practiced flair. "My daughter Samantha would have LOVED this mountain  she's got the best ski aesthetic of anyone I know. But her dance recital is this weekend so she couldn't make it. Her loss is YOUR gain, followers. CONTENT waits for no one!"`},{state:1,text:`"Excuse me, can you hold this phone and film me doing a dramatic pose by that statue? No? FINE. I'll use the selfie stick. You know, in MY day, mountains were taller AND the hot chocolate was free. This resort is a THREE out of TEN. But the lighting is GORGEOUS. Samantha is going to be SO jealous when she sees these stories."`},{state:2,text:`"My livestream just hit FOUR viewers! That's double from last time! One of them might be my mom, but engagement is engagement, honey. Samantha says I should try TikTok but I told her  mommy is a MULTI-PLATFORM creator. If you find any secret treasure in this dump, tag me. I need CONTENT."`}]},henrys_mom:{id:"henrys_mom",name:"Henry's Mom",description:"A warm, cheerful woman bundled in a cozy puffer jacket, surrounded by an impressive array of tote bags overflowing with snacks of every variety. Granola bars, fruit snacks, trail mix, string cheese, juice boxes  it's like a mobile convenience store. She has the kind smile of someone who's never met a stranger, though right now she keeps glancing around nervously for her son.",currentRoomId:"main_street",dialogueState:0,dialogue:[{state:0,text:`"Oh, hello sweetie!" She beams at you and immediately starts rummaging through one of her tote bags. "Have you seen my Henry? That boy took off to 'explore the mountain' about an hour ago and I just KNOW he didn't pack enough snacks. I gave him two granola bars but that's barely a warmup!"

She pulls out a fruit snack pouch and offers it to you. "Here, take this. You look like you could use a snack. I always say  you can never have too many snacks on an adventure. Do you want trail mix too? I have seven bags. SEVEN."`},{state:1,text:`"Still no Henry!" She shakes her head but manages a warm laugh. "That kid  he's got his father's sense of adventure and absolutely NONE of his common sense about packing food. I bet he's out there right now, climbing something he shouldn't be, with nothing but an empty granola bar wrapper in his pocket."

She holds up a thermos. "Hot cocoa? I made it from scratch this morning. I also have chicken soup, apple cider, and something that might be tea? Oh, and string cheese! The good kind, not the weird rubbery kind. Please, take something. I brought enough snacks for the entire resort and it would make me feel SO much better knowing at least someone out there is well-fed."`},{state:2,text:`"Henry just texted! He says he's been having the BEST time exploring the lodge. The LODGE! He was right here the whole time!" She laughs and wipes her eyes. "He says he made friends with some angry lady at the bar and they've been debating whether this resort needs better snack machines. That's my boy."

She starts reorganizing her tote bags with visible relief. "I swear, being a mom is 10% parenting and 90% making sure everyone has enough to eat. Are you SURE you don't want a juice box? I have a whole case. Take two. Take three! You're an adventurer  you need your energy!"`}]},old_dad:{id:"old_dad",name:"Old Dad",description:"A weathered, silver-haired man sitting in a creaky rocking chair by the cold fireplace. He's wrapped in a wool blanket with a thermos of coffee and a battered paperback novel. His eyes have the contented squint of someone who came here specifically to get away from everyone  and succeeded.",currentRoomId:"old_cabin",dialogueState:0,dialogue:[{state:0,text:`The old man looks up from his book with mild surprise  the kind that suggests he hasn't seen another human being in quite some time, and was perfectly fine with that.

"Well, well. A visitor." He takes a long sip of coffee. "Name's Dad. Well  Old Dad, if you ask the kids. Been holed up in this cabin since... what month is it? Doesn't matter. Came up here for some peace and quiet after thirty years of youth hockey tournaments, school drop-offs, and assembling furniture with missing screws."

He gestures at the cozy mess around him. "Found this place abandoned. Moved right in. Best decision I ever made. Nobody asking me to fix the WiFi out here."`},{state:1,text:`"Still here? Most people take the hint when a man's reading in an abandoned cabin in the middle of nowhere." He chuckles warmly. "I'm kidding. It's nice to have company. For exactly five minutes."

He leans forward conspiratorially. "You know, I've been hearing strange noises from under the lodge at night. Thumping. Buzzing. Like old machinery trying to wake up. The basement, I reckon. I tried the door once but it was locked tight. Found the key in that desk over there, but my knees aren't what they used to be. Too many stairs."

He glances at the leather pouch on the desk. "Oh, and take those game tokens while you're at it. Found 'em in a drawer. There's an old arcade cabinet in the general store over in the village  might still work if you feed it a token. Lord knows I have no use for 'em. Go play a game, stretch your legs, and let an old man read in peace."`},{state:2,text:`"You're back AGAIN? What is this, a social club?" He pretends to be annoyed but can't hide a grin. "Fine, fine. Sit down. Want some coffee? It's three days old but it builds character."

He stares out the frosty window. "This mountain has secrets, you know. Old Tobias Snowpeak  the founder  he was a peculiar fellow. Built this whole resort and then just... vanished. Left behind riddles and locked doors everywhere. Like a man who couldn't stop playing games even after he was gone."

He picks his book back up. "Now shoo. This chapter isn't going to read itself. And if you haven't tried that arcade in the general store yet, you should. Might find more than you expect over there."`}]}};function wD(e,t){const i=t==="expert"?gD:pD,r=t==="expert"?TD:yD,o=t==="expert"?vD:ED,u={};for(const[V,L]of Object.entries(i))u[V]={...L,items:[...L.items],npcs:[...L.npcs],hiddenExits:{...L.hiddenExits},lockedExits:L.lockedExits?{...L.lockedExits}:{},visited:!1};const c={};for(const[V,L]of Object.entries(r))c[V]={...L};const m={};for(const[V,L]of Object.entries(o))m[V]={...L,dialogue:[...L.dialogue],flags:{}};const _="lodge_lobby",p=u[_],y=[...lb,{text:`Good luck, ${e}!`,type:"system"},{text:"",type:"normal"}];p.ascii&&y.push({text:p.ascii,type:"ascii"}),y.push({text:p.name,type:"title"}),y.push({text:p.description,type:"normal"});const v=p.items.filter(V=>!c[V]?.hidden);if(v.length>0){const V=v.map(L=>c[L].name);y.push({text:`
You can see: ${V.join(", ")}.`,type:"normal"})}if(p.npcs.length>0){const V=p.npcs.map(L=>m[L].name);y.push({text:`${V.join(" and ")} ${p.npcs.length===1?"is":"are"} here.`,type:"normal"})}const w={...p.exits,...p.hiddenExits},R=p.lockedExits||{},M=[];for(const V of Object.keys(w)){const L=u[w[V]];L?M.push(`${V} (${L.name})`):M.push(V)}for(const V of Object.keys(R)){const L=u[R[V].roomId];L?M.push(`${V} (${L.name})`):M.push(V)}return M.length>0&&y.push({text:`
Exits: ${M.join(", ")}`,type:"system"}),u[_].visited=!0,{currentRoomId:_,previousRoomId:null,inventory:[],rooms:u,items:c,npcs:m,puzzles:{},output:y,gameOver:!1,turnCount:0,playerName:e||"Adventurer",mode:t||"standard",startTime:Date.now()}}function bD(e,t){const[i,r]=ae.useReducer(hD,{playerName:e,mode:t},({playerName:c,mode:m})=>wD(c,m)),o=ae.useRef(i);o.current=i;const u=ae.useCallback(c=>{const m=o.current;r({type:"ADD_OUTPUT",payload:{text:`> ${c}`,type:"command"}});const _=_D(c,m);_.error?r({type:"ADD_OUTPUT",payload:{text:_.error,type:"error"}}):r(_)},[]);return{gameState:i,processCommand:u,dispatch:r}}function AD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(3500,e.currentTime);const r=e.createOscillator(),o=e.createGain();r.frequency.value=6,o.gain.value=400,r.connect(o),o.connect(t.frequency),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.2,e.currentTime+.03),i.gain.setValueAtTime(.2,e.currentTime+.55),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.7),t.connect(i),i.connect(e.destination),r.start(),t.start(),t.stop(e.currentTime+.75),r.stop(e.currentTime+.75),setTimeout(()=>e.close(),1500)}catch{}}function SD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(180,e.currentTime),t.frequency.exponentialRampToValueAtTime(60,e.currentTime+.1),i.gain.setValueAtTime(.12,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.1),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.15),setTimeout(()=>e.close(),500)}catch{}}function RD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(80,e.currentTime),t.frequency.linearRampToValueAtTime(200,e.currentTime+.3),t.frequency.linearRampToValueAtTime(120,e.currentTime+.5),t.frequency.linearRampToValueAtTime(250,e.currentTime+.7),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.06,e.currentTime+.05),i.gain.setValueAtTime(.06,e.currentTime+.6),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.8),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.85),setTimeout(()=>e.close(),1500)}catch{}}function ID(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(55,e.currentTime),t.frequency.linearRampToValueAtTime(110,e.currentTime+.3),t.frequency.setValueAtTime(110,e.currentTime+.8),t.frequency.linearRampToValueAtTime(75,e.currentTime+1),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.08,e.currentTime+.1),i.gain.setValueAtTime(.08,e.currentTime+.8),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+1);const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=4,o.gain.value=.03,t.connect(i),i.connect(e.destination),r.connect(o),o.connect(e.destination),t.start(),r.start(),t.stop(e.currentTime+1.1),r.stop(e.currentTime+1.1),setTimeout(()=>e.close(),2e3)}catch{}}function kD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=Math.floor(e.sampleRate*.6),i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let m=0;m<t;m++)r[m]=Math.random()*2-1;const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="bandpass",u.frequency.setValueAtTime(600,e.currentTime),u.frequency.linearRampToValueAtTime(300,e.currentTime+.6),u.Q.value=1;const c=e.createGain();c.gain.setValueAtTime(0,e.currentTime),c.gain.linearRampToValueAtTime(.12,e.currentTime+.08),c.gain.setValueAtTime(.12,e.currentTime+.35),c.gain.exponentialRampToValueAtTime(.01,e.currentTime+.6),o.connect(u),u.connect(c),c.connect(e.destination),o.start(),setTimeout(()=>e.close(),1500)}catch{}}function DD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[0,.15,.32],i=[.15,.08,.03];for(let r=0;r<t.length;r++){const o=e.createOscillator(),u=e.createGain();o.type="sine",o.frequency.setValueAtTime(1800,e.currentTime+t[r]),o.frequency.exponentialRampToValueAtTime(600,e.currentTime+t[r]+.1),u.gain.setValueAtTime(i[r],e.currentTime+t[r]),u.gain.exponentialRampToValueAtTime(.001,e.currentTime+t[r]+.15),o.connect(u),u.connect(e.destination),o.start(e.currentTime+t[r]),o.stop(e.currentTime+t[r]+.18)}setTimeout(()=>e.close(),1500)}catch{}}function OD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(40,e.currentTime),t.frequency.linearRampToValueAtTime(55,e.currentTime+.3),t.frequency.linearRampToValueAtTime(35,e.currentTime+.8),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.25,e.currentTime+.1),i.gain.setValueAtTime(.25,e.currentTime+.5),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.8),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.85),setTimeout(()=>e.close(),1500)}catch{}}function CD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:523.25,start:0,dur:.15},{freq:659.25,start:.18,dur:.15},{freq:783.99,start:.36,dur:.15},{freq:1046.5,start:.54,dur:.4},{freq:783.99,start:1,dur:.12},{freq:1046.5,start:1.15,dur:.6}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="triangle",r.frequency.value=i.freq,o.gain.setValueAtTime(0,e.currentTime+i.start),o.gain.linearRampToValueAtTime(.3,e.currentTime+i.start+.03),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.05)}setTimeout(()=>e.close(),3e3)}catch{}}function ND(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:400,start:0,dur:.08},{freq:520,start:.09,dur:.07},{freq:620,start:.17,dur:.07},{freq:500,start:.25,dur:.07},{freq:680,start:.33,dur:.09},{freq:560,start:.44,dur:.07},{freq:720,start:.52,dur:.12}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sine",r.frequency.setValueAtTime(i.freq,e.currentTime+i.start),o.gain.setValueAtTime(0,e.currentTime+i.start),o.gain.linearRampToValueAtTime(.15,e.currentTime+i.start+.01),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),1500)}catch{}}function MD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:660,start:0,dur:.08},{freq:880,start:.1,dur:.08},{freq:1100,start:.2,dur:.15}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="square",r.frequency.value=i.freq,o.gain.setValueAtTime(0,e.currentTime+i.start),o.gain.linearRampToValueAtTime(.12,e.currentTime+i.start+.01),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.02)}setTimeout(()=>e.close(),800)}catch{}}function VD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(120,e.currentTime),t.frequency.linearRampToValueAtTime(80,e.currentTime+.25),i.gain.setValueAtTime(.15,e.currentTime),i.gain.linearRampToValueAtTime(.08,e.currentTime+.15),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.3),t.connect(i),i.connect(e.destination),t.start(e.currentTime),t.stop(e.currentTime+.35);const r=e.sampleRate*.15,o=e.createBuffer(1,r,e.sampleRate),u=o.getChannelData(0);for(let _=0;_<r;_++)u[_]=(Math.random()*2-1)*.3;const c=e.createBufferSource(),m=e.createGain();c.buffer=o,m.gain.setValueAtTime(.06,e.currentTime),m.gain.exponentialRampToValueAtTime(.01,e.currentTime+.15),c.connect(m),m.connect(e.destination),c.start(e.currentTime),setTimeout(()=>e.close(),600)}catch{}}function LD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(1200,e.currentTime),t.frequency.exponentialRampToValueAtTime(1e3,e.currentTime+.1),i.gain.setValueAtTime(.3,e.currentTime),i.gain.exponentialRampToValueAtTime(.01,e.currentTime+.6),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.65),setTimeout(()=>e.close(),1e3)}catch{}}function HD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.sampleRate*.15,i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let p=0;p<t;p++)r[p]=(Math.random()*2-1)*Math.exp(-p/(e.sampleRate*.03));const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="lowpass",u.frequency.value=600;const c=e.createGain();c.gain.setValueAtTime(.5,e.currentTime),o.connect(u),u.connect(c),c.connect(e.destination),o.start();const m=e.createOscillator();m.type="square",m.frequency.setValueAtTime(180,e.currentTime+.1),m.frequency.linearRampToValueAtTime(120,e.currentTime+.25);const _=e.createGain();_.gain.setValueAtTime(0,e.currentTime),_.gain.setValueAtTime(.15,e.currentTime+.1),_.gain.exponentialRampToValueAtTime(.01,e.currentTime+.3),m.connect(_),_.connect(e.destination),m.start(),m.stop(e.currentTime+.35),setTimeout(()=>e.close(),800)}catch{}}function PD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(60,e.currentTime),t.frequency.linearRampToValueAtTime(140,e.currentTime+.2),t.frequency.linearRampToValueAtTime(80,e.currentTime+.35),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.05,e.currentTime+.05),i.gain.setValueAtTime(.05,e.currentTime+.3),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.45),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.5);const r=e.createOscillator(),o=e.createGain();r.type="sawtooth",r.frequency.setValueAtTime(90,e.currentTime+.5),r.frequency.linearRampToValueAtTime(180,e.currentTime+.65),r.frequency.linearRampToValueAtTime(100,e.currentTime+.8),o.gain.setValueAtTime(0,e.currentTime+.5),o.gain.linearRampToValueAtTime(.04,e.currentTime+.55),o.gain.setValueAtTime(.04,e.currentTime+.75),o.gain.exponentialRampToValueAtTime(.001,e.currentTime+.9),r.connect(o),o.connect(e.destination),r.start(e.currentTime+.5),r.stop(e.currentTime+.95),setTimeout(()=>e.close(),1500)}catch{}}function xD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.sampleRate*.06,i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let p=0;p<t;p++){const y=p/t,v=y<.05?y/.05:Math.exp(-30*(y-.05));r[p]=(Math.random()*2-1)*v}const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="bandpass",u.frequency.value=3e3,u.Q.value=1.5;const c=e.createGain();c.gain.value=.25,o.connect(u),u.connect(c),c.connect(e.destination),o.start();const m=e.createOscillator(),_=e.createGain();m.type="sine",m.frequency.setValueAtTime(1200,e.currentTime+.03),m.frequency.exponentialRampToValueAtTime(600,e.currentTime+.08),_.gain.setValueAtTime(.08,e.currentTime+.03),_.gain.exponentialRampToValueAtTime(.001,e.currentTime+.1),m.connect(_),_.connect(e.destination),m.start(e.currentTime+.03),m.stop(e.currentTime+.12),setTimeout(()=>e.close(),500)}catch{}}function zD(){try{const e=new(window.AudioContext||window.webkitAudioContext);for(let t=0;t<2;t++){const i=t*.22,r=Math.floor(e.sampleRate*.15),o=e.createBuffer(1,r,e.sampleRate),u=o.getChannelData(0);for(let p=0;p<r;p++){const y=p/r,v=y<.1?y/.1:Math.exp(-8*(y-.1));u[p]=(Math.random()*2-1)*v}const c=e.createBufferSource();c.buffer=o;const m=e.createBiquadFilter();m.type="bandpass",m.frequency.value=1800,m.Q.value=.8;const _=e.createGain();_.gain.value=.1,c.connect(m),m.connect(_),_.connect(e.destination),c.start(e.currentTime+i)}setTimeout(()=>e.close(),1e3)}catch{}}function UD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sawtooth",t.frequency.setValueAtTime(100,e.currentTime),t.frequency.linearRampToValueAtTime(160,e.currentTime+.15),t.frequency.linearRampToValueAtTime(90,e.currentTime+.25),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.04,e.currentTime+.03),i.gain.setValueAtTime(.04,e.currentTime+.2),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.3),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.35),setTimeout(()=>e.close(),700)}catch{}}function BD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:2200,start:0,dur:.3},{freq:2600,start:.12,dur:.35}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sine",r.frequency.value=i.freq,o.gain.setValueAtTime(.12,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.001,e.currentTime+i.start+i.dur),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+i.dur+.05)}setTimeout(()=>e.close(),1e3)}catch{}}function GD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[220,330],i=[0,.08];for(let r=0;r<t.length;r++){const o=e.createOscillator(),u=e.createGain();o.type="sine",o.frequency.value=t[r],u.gain.setValueAtTime(0,e.currentTime+i[r]),u.gain.linearRampToValueAtTime(.08,e.currentTime+i[r]+.05),u.gain.exponentialRampToValueAtTime(.001,e.currentTime+i[r]+.6),o.connect(u),u.connect(e.destination),o.start(e.currentTime+i[r]),o.stop(e.currentTime+i[r]+.65)}setTimeout(()=>e.close(),1500)}catch{}}function jD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=[{freq:2400,start:0,vol:.12},{freq:1800,start:.25,vol:.08},{freq:2100,start:.45,vol:.06}];for(const i of t){const r=e.createOscillator(),o=e.createGain();r.type="sine",r.frequency.setValueAtTime(i.freq,e.currentTime+i.start),r.frequency.exponentialRampToValueAtTime(i.freq*.5,e.currentTime+i.start+.08),o.gain.setValueAtTime(i.vol,e.currentTime+i.start),o.gain.exponentialRampToValueAtTime(.001,e.currentTime+i.start+.12),r.connect(o),o.connect(e.destination),r.start(e.currentTime+i.start),r.stop(e.currentTime+i.start+.15)}setTimeout(()=>e.close(),1200)}catch{}}function qD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),i=e.createGain();t.type="sine",t.frequency.setValueAtTime(120,e.currentTime),t.frequency.linearRampToValueAtTime(180,e.currentTime+.4),t.frequency.linearRampToValueAtTime(140,e.currentTime+.7),i.gain.setValueAtTime(0,e.currentTime),i.gain.linearRampToValueAtTime(.06,e.currentTime+.1),i.gain.setValueAtTime(.06,e.currentTime+.5),i.gain.exponentialRampToValueAtTime(.001,e.currentTime+.7),t.connect(i),i.connect(e.destination),t.start(),t.stop(e.currentTime+.75),setTimeout(()=>e.close(),1200)}catch{}}function YD(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=Math.floor(e.sampleRate*.5),i=e.createBuffer(1,t,e.sampleRate),r=i.getChannelData(0);for(let m=0;m<t;m++){const _=m/e.sampleRate,p=.5+.5*Math.sin(_*8*Math.PI)*Math.sin(_*3*Math.PI);r[m]=(Math.random()*2-1)*p}const o=e.createBufferSource();o.buffer=i;const u=e.createBiquadFilter();u.type="bandpass",u.frequency.value=400,u.Q.value=2;const c=e.createGain();c.gain.setValueAtTime(0,e.currentTime),c.gain.linearRampToValueAtTime(.04,e.currentTime+.05),c.gain.setValueAtTime(.04,e.currentTime+.35),c.gain.exponentialRampToValueAtTime(.001,e.currentTime+.5),o.connect(u),u.connect(c),c.connect(e.destination),o.start(),setTimeout(()=>e.close(),1e3)}catch{}}function FD(){try{const e=new(window.AudioContext||window.webkitAudioContext);for(let t=0;t<3;t++){const i=t*.15,r=e.sampleRate*.12,o=e.createBuffer(1,r,e.sampleRate),u=o.getChannelData(0);for(let p=0;p<r;p++){const y=p/r,v=Math.sin(y*Math.PI);u[p]=(Math.random()*2-1)*v}const c=e.createBufferSource();c.buffer=o;const m=e.createBiquadFilter();m.type="highpass",m.frequency.value=2e3+t*800;const _=e.createGain();_.gain.value=.08,c.connect(m),m.connect(_),_.connect(e.destination),c.start(e.currentTime+i)}setTimeout(()=>e.close(),1e3)}catch{}}function WD(e){const i={whistle:AD,footstep:SD,creak_door:RD,lift_motor:ID,wind:kD,cave_echo:DD,vault_rumble:OD,kid_laugh:ND,victory:CD,arcade_start:MD,angry_grunt:VD,bell:LD,unlock:HD,rocking_chair:PD,camera_click:xD,bag_rummage:FD,snow_crunch:zD,wood_floor:UD,store_bell:BD,chapel_echo:GD,tunnel_drip:jD,observatory_hum:qD,lobby_chatter:YD}[e];i&&i()}function XD({playerInfo:e,onRestart:t}){const{gameState:i,processCommand:r,dispatch:o}=bD(e.name,e.mode),u=ae.useRef(0);ae.useEffect(()=>{gI()},[]),ae.useEffect(()=>{const y=i.output.slice(u.current);u.current=i.output.length;for(const v of y)v.type==="sound"&&WD(v.sound)},[i.output]);const c=ae.useCallback(y=>{o({type:"SLALOM_RESULT",payload:y})},[o]),m=ae.useCallback(y=>{o({type:"DEFEND_RESULT",payload:y})},[o]),_=ae.useCallback(y=>{o({type:"SNOWBALL_RESULT",payload:y})},[o]),p=ae.useCallback(y=>{o({type:"ICEBREAKER_RESULT",payload:y})},[o]);return ae.useEffect(()=>{if(i.gameRestart){const y=setTimeout(()=>{t()},1e3);return()=>clearTimeout(y)}},[i.gameRestart,t]),i.launchSlalom?S.jsx(c_,{standalone:!1,onGameOver:c}):i.launchDefend?S.jsx(f_,{standalone:!1,onGameOver:m}):i.launchSnowball?S.jsx(d_,{standalone:!1,onGameOver:_}):i.launchIcebreaker?S.jsx(m_,{standalone:!1,onGameOver:p}):S.jsx("div",{className:"terminal",children:S.jsx(X2,{output:i.output,onCommand:r,gameOver:i.gameOver,mode:e.mode,gameState:i})})}function KD(){const[e,t]=ae.useState(null),[i,r]=ae.useState(window.location.hash);return ae.useEffect(()=>{const o=()=>r(window.location.hash);return window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[]),i==="#slalom"?S.jsx(c_,{standalone:!0}):i==="#defend"?S.jsx(f_,{standalone:!0}):i==="#snowball"?S.jsx(d_,{standalone:!0}):i==="#icebreaker"?S.jsx(m_,{standalone:!0}):i==="#trailer"?S.jsx(Tv,{standalone:!0,onBack:()=>{window.location.hash="",r("")}}):e?e.mode==="bonus"?S.jsx(uD,{onBack:()=>t(null)}):S.jsx(XD,{playerInfo:e,onRestart:()=>t(null)}):S.jsx("div",{className:"terminal",children:S.jsx($2,{onSubmit:t})})}ob.createRoot(document.getElementById("root")).render(S.jsx(KD,{}));
